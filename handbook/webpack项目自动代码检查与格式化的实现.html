<!DOCTYPE html><html><head><meta charset="utf-8"><title>webpack项目自动代码检查与格式化的实现 | Congzhou&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="webpack"><meta name="description" content="当前解决方案● 使用 editorconfig 控制书写代码期间的基本风格统一。● 使用 eslint 做代码语法检查，实现代码质量控制。● 使用 prettier 做代码格式化，实现统一风格。● git commit 之前执行自动修复，无法自动修复的地方手动修改。 ps: 由于 eslint 也包含了代码格式化功能，所以 prettier 仅做非 js 类代码(js&#x2F;ts&#x2F;t"><meta property="og:type" content="article"><meta property="og:title" content="webpack项目自动代码检查与格式化的实现"><meta property="og:url" content="https://congzhou09.github.io/handbook/webpack%E9%A1%B9%E7%9B%AE%E8%87%AA%E5%8A%A8%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5%E4%B8%8E%E6%A0%BC%E5%BC%8F%E5%8C%96%E7%9A%84%E5%AE%9E%E7%8E%B0.html"><meta property="og:site_name" content="Congzhou&#39;s Blog"><meta property="og:description" content="当前解决方案● 使用 editorconfig 控制书写代码期间的基本风格统一。● 使用 eslint 做代码语法检查，实现代码质量控制。● 使用 prettier 做代码格式化，实现统一风格。● git commit 之前执行自动修复，无法自动修复的地方手动修改。 ps: 由于 eslint 也包含了代码格式化功能，所以 prettier 仅做非 js 类代码(js&#x2F;ts&#x2F;t"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-11-26T10:09:38.000Z"><meta property="article:modified_time" content="2025-03-19T13:37:34.684Z"><meta property="article:author" content="Congzhou"><meta property="article:tag" content="webpack"><meta name="twitter:card" content="summary"><link rel="alternate" type="application/atom+xml" title="Congzhou&#39;s Blog" href="/atom.xml"><link rel="shortcut icon" href="/tiger.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/lib/fancybox.css"><script>window.lazyScripts=[]</script><script src="/js/av-min.js"></script><script src="/js/util.min.js"></script><script src="/js/fancybox.umd.js"></script><meta name="generator" content="Hexo 7.2.0"></head><body><script>var VISIT_INFO={};defineObserveKey(VISIT_INFO,"totalPV"),defineObserveKey(VISIT_INFO,"curPagePV"),defineObserveKey(VISIT_INFO,"totalUV")</script><div id="loading" class="active"></div><aside id="menu"><div class="inner flex-row-vertical"><div class="brand-wrap"><img class="brand-wrap-img" finalsrc="/img/brand.jpg" src="/img/brand-loading.jpg" alt="brandBackground"><div class="brand"><a href="/" class="avatar waves-effect waves-circle waves-light"><img finalsrc="/img/avatar.jpg" src="/img/avatar-loading.jpg" style="width:100%" alt="avatar"></a><hgroup class="introduce"><div class="nickname" style="margin-left:5px">Congzhou</div><div class="mail"><span class="iconfont icon-youxiang" style="vertical-align:middle"></span><span>congzhou09@gmail.com</span></div><div class="github-link"><a target="_blank" href="https://github.com/congzhou09"><span class="iconfont icon-ic-github"></span>GitHub主页</a></div></hgroup><div class="hint-container"></div></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li class="waves-block waves-effect"><a href="/"><i class="iconfont icon icon-home" style="font-size:24px"></i>主页</a></li><li class="waves-block waves-effect"><a href="/archives"><i class="iconfont icon icon-archive" style="font-size:24px"></i>归档</a></li><li class="waves-block waves-effect"><a href="/tags"><i class="iconfont icon icon-tags" style="font-size:24px"></i>标签</a></li><li class="waves-block waves-effect"><a href="/categories"><i class="iconfont icon icon-categoryselected" style="font-size:24px"></i>分类</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" style="text-decoration:none" id="menu-toggle"><span class="iconfont icon-menu" style="font-size:21px;font-weight:700"></span></a><div class="flex-col header-title ellipsis">webpack项目自动代码检查与格式化的实现</div><div class="search-wrap" id="search-wrap"><input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" style="text-decoration:none" id="search"><span class="iconfont icon-search" style="font-size:24px;font-weight:700"></span></a></div></div></header><header class="content-header post-header"><div class="container fade-scale"><h2 class="title">webpack项目自动代码检查与格式化的实现</h2><h5 class="subtitle"><time datetime="2019-11-26T10:09:38.000Z" itemprop="datePublished" class="page-time">2019-11-26</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/handbook/">操作手册</a></li></ul></h5></div></header><div class="container body-wrap"><aside class="post-widget"><nav class="post-toc-wrap" id="post-toc"><h4>目录</h4><ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BD%93%E5%89%8D%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="post-toc-number">1.</span><span class="post-toc-text">当前解决方案</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#VSCode-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-IDE-%E7%9A%84%E9%85%8D%E7%BD%AE%E6%AD%A4%E5%A4%84%E5%8F%AA%E4%BB%A5-VSCode-%E4%B8%BA%E4%BE%8B"><span class="post-toc-number">2.</span><span class="post-toc-text">VSCode 环境配置(IDE 的配置此处只以 VSCode 为例)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%9C%AC%E6%9C%BA%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="post-toc-number">3.</span><span class="post-toc-text">本机环境配置</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%86%85%E9%85%8D%E7%BD%AE"><span class="post-toc-number">4.</span><span class="post-toc-text">项目内配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#vue-%E9%A1%B9%E7%9B%AE"><span class="post-toc-number">4.1.</span><span class="post-toc-text">vue 项目</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#react-%E9%A1%B9%E7%9B%AE"><span class="post-toc-number">4.2.</span><span class="post-toc-text">react 项目</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%A6%82%E6%9E%9C%E4%BD%BF%E7%94%A8%E4%BA%86-babel-eslint-%E6%97%A0%E6%B3%95%E8%AF%86%E5%88%AB%E7%9A%84-typescript-%E7%89%B9%E6%80%A7"><span class="post-toc-number">4.3.</span><span class="post-toc-text">如果使用了 babel-eslint 无法识别的 typescript 特性</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%89%8B%E5%8A%A8%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5"><span class="post-toc-number">5.</span><span class="post-toc-text">手动进行代码检查</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BC%BA%E5%88%B6%E8%BF%9B%E8%A1%8C-git-%E6%8F%90%E4%BA%A4%E5%89%8D%E7%9A%84%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5"><span class="post-toc-number">6.</span><span class="post-toc-text">强制进行 git 提交前的代码检查</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="post-toc-number">7.</span><span class="post-toc-text">常见问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="post-toc-number">8.</span><span class="post-toc-text">参考文献</span></a></li></ol></nav></aside><article id="post-webpack项目自动代码检查与格式化的实现" class="post-article article-type-post fade" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title">webpack项目自动代码检查与格式化的实现</h1><div class="post-meta"><time class="post-time" title="2019-11-26 18:09:38" datetime="2019-11-26T10:09:38.000Z" itemprop="datePublished">2019-11-26</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/handbook/">操作手册</a></li></ul><span id="container_page_pv" title="文章总阅读量" style="display:none"><span class="iconfont icon-eye" style="margin-right:5px;font-size:12px"></span><span id="value_page_pv"></span></span></div><div class="post-content" id="post-content" itemprop="postContent"><h3 id="当前解决方案"><a href="#当前解决方案" class="headerlink" title="当前解决方案"></a>当前解决方案</h3><p>● 使用 editorconfig 控制书写代码期间的基本风格统一。<br>● 使用 eslint 做代码语法检查，实现代码质量控制。<br>● 使用 prettier 做代码格式化，实现统一风格。<br>● git commit 之前执行自动修复，无法自动修复的地方手动修改。</p><p>ps: 由于 eslint 也包含了代码格式化功能，所以 prettier 仅做非 js 类代码(js&#x2F;ts&#x2F;tsx&#x2F;jsx)的格式化。</p><h3 id="VSCode-环境配置-IDE-的配置此处只以-VSCode-为例"><a href="#VSCode-环境配置-IDE-的配置此处只以-VSCode-为例" class="headerlink" title="VSCode 环境配置(IDE 的配置此处只以 VSCode 为例)"></a>VSCode 环境配置(IDE 的配置此处只以 VSCode 为例)</h3><p>○ 目的是让 IDE 插件的格式化与命令行执行命令的格式化统一使用 prettier。<br>○ 安装如下插件：EditorConfig for VS Code、ESLint、Vetur、Prettier-Code formatter。<br>○ 由于跟 Prettier 重复与键位冲突，如果有 Beautify 插件则删掉。<br>○ 打开 VSCode 的 setting.json 文件，增加如下配置内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">/*************vetur相关*****************/</span><br><span class="line">&quot;vetur.format.defaultFormatter.html&quot;: &quot;prettier&quot;,</span><br><span class="line">&quot;vetur.validation.template&quot;: false,</span><br><span class="line">&quot;vetur.validation.script&quot;: false,</span><br><span class="line">&quot;[vue]&quot;: &#123;</span><br><span class="line">    &quot;editor.defaultFormatter&quot;: &quot;octref.vetur&quot;</span><br><span class="line">&#125;,</span><br><span class="line">/*************eslint相关*****************/</span><br><span class="line">&quot;eslint.format.enable&quot;: true,</span><br><span class="line">&quot;eslint.validate&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;language&quot;: &quot;javascript&quot;,</span><br><span class="line">        &quot;autoFix&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;javascriptreact&quot;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;language&quot;: &quot;vue&quot;,</span><br><span class="line">        &quot;autoFix&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">],</span><br><span class="line">/*************prettier相关*****************/</span><br><span class="line">&quot;[javascript]&quot;: &#123;</span><br><span class="line">    &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;[html]&quot;: &#123;</span><br><span class="line">    &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;[sass]&quot;: &#123;</span><br><span class="line">    &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;[typescriptreact]&quot;: &#123;</span><br><span class="line">    &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="本机环境配置"><a href="#本机环境配置" class="headerlink" title="本机环境配置"></a>本机环境配置</h3><p>◇ 考虑版本兼容不推荐全局安装 eslint，通过全局安装 eslint-cli 以实现对全局 eslint 命令的支持。</p><h3 id="项目内配置"><a href="#项目内配置" class="headerlink" title="项目内配置"></a>项目内配置</h3><p>◆ 根目录下的&quot;.editorconfig&quot; 文件内容如下(此处以空 2 格作为标准)：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># EditorConfig is awesome: https://EditorConfig.org</span><br><span class="line"># top-most EditorConfig file</span><br><span class="line">root = true</span><br><span class="line">[*]</span><br><span class="line">charset = utf-8</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = 2</span><br><span class="line">end_of_line = lf</span><br><span class="line">insert_final_newline = true</span><br></pre></td></tr></table></figure><p>◆ 运行如下命令以安装 eslint、babel-eslint、prettier、eslint-config-google、eslint-config-prettier、eslint-plugin-prettier</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D eslint babel-eslint prettier eslint-config-google eslint-config-prettier eslint-plugin-prettier</span><br></pre></td></tr></table></figure><p>◆ 根目录下的&quot;.prettierrc&quot;文件内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;singleQuote&quot;: true,</span><br><span class="line">  &quot;trailingComma&quot;: &quot;all&quot;,</span><br><span class="line">  &quot;printWidth&quot;: 140,</span><br><span class="line">  &quot;endOfLine&quot;: &quot;lf&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>◆ 根目录下的&quot;package.json&quot; 文件中增加名为&quot;codecheck&quot;的 script：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;codecheck&quot;: &quot;eslint --ext .jsx,.js,.vue,.ts,.tsx --fix src &amp;&amp; prettier --write src/**/*.(css,scss,less) --log-level warn&quot;</span><br></pre></td></tr></table></figure><h4 id="vue-项目"><a href="#vue-项目" class="headerlink" title="vue 项目"></a>vue 项目</h4><p>◇ 安装 eslint-plugin-vue（使 eslint 支持 vue 语法的官方插件）<br>◇ 根目录下的&quot;.eslintrc.js&quot;文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    root: true,</span><br><span class="line">    extends: [&#x27;google&#x27;, &#x27;plugin:vue/essential&#x27;, &#x27;plugin:prettier/recommended&#x27;],</span><br><span class="line">    env: &#123;</span><br><span class="line">      &quot;browser&quot;: true,</span><br><span class="line">      &quot;commonjs&quot;: true,</span><br><span class="line">      &quot;es6&quot;: true,</span><br><span class="line">      &quot;node&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    parserOptions: &#123;</span><br><span class="line">      parser: &#x27;babel-eslint&#x27;,</span><br><span class="line">      sourceType: &#x27;module&#x27;  //配置JS文件加载模式: script--script标签方式 module--es6的import方式</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="react-项目"><a href="#react-项目" class="headerlink" title="react 项目"></a>react 项目</h4><p>● 安装 eslint-plugin-react<br>● 根目录下的&quot;.eslintrc.js&quot;文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    root: true,</span><br><span class="line">    extends: [&#x27;google&#x27;, &#x27;plugin:react/recommended&#x27;, &#x27;plugin:prettier/recommended&#x27;],</span><br><span class="line">    env: &#123;</span><br><span class="line">      &quot;browser&quot;: true,</span><br><span class="line">      &quot;commonjs&quot;: true,</span><br><span class="line">      &quot;es6&quot;: true,</span><br><span class="line">      &quot;node&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    parser: &#x27;babel-eslint&#x27;,</span><br><span class="line">    parserOptions: &#123;</span><br><span class="line">      sourceType: &#x27;module&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    settings:&#123;</span><br><span class="line">        react: &#123;</span><br><span class="line">            version: &#x27;detect&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="如果使用了-babel-eslint-无法识别的-typescript-特性"><a href="#如果使用了-babel-eslint-无法识别的-typescript-特性" class="headerlink" title="如果使用了 babel-eslint 无法识别的 typescript 特性"></a>如果使用了 babel-eslint 无法识别的 typescript 特性</h4><p>○ eslint 的 parser 改用“@typescript-eslint&#x2F;parser”，并安装“@typescript-eslint&#x2F;eslint-plugin”插件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn remove babel-eslint</span><br><span class="line">yarn add -D @typescript-eslint/parser @typescript-eslint/eslint-plugin</span><br></pre></td></tr></table></figure><p>○ “.eslint.js”文件修改如下部分：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  plugins: [&quot;@typescript-eslint&quot;],</span><br><span class="line">  parser: &#x27;@typescript-eslint/parser&#x27;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="手动进行代码检查"><a href="#手动进行代码检查" class="headerlink" title="手动进行代码检查"></a>手动进行代码检查</h3><p>○ 命令行运行：npm run codecheck</p><h3 id="强制进行-git-提交前的代码检查"><a href="#强制进行-git-提交前的代码检查" class="headerlink" title="强制进行 git 提交前的代码检查"></a>强制进行 git 提交前的代码检查</h3><p>△ 预备知识：<br>（1）通过在 git hooks 里配置各种预处理脚本，比如代码检查或者跑单元测试之类的事情，如果我们的代码没有通过代码检查或者测试用例覆盖率不够，我们的 push 甚至 commit 会直接被拒绝。<br>（2）预处理脚本位于 git 项目下隐藏文件夹“.git”的“hooks”文件夹中。<br>△husky 可用于自动完成上述动作，使用方法：<br>（1）安装 husky。<br>（2）执行&quot;npx husky install&quot;打开 git hooks 支持。<br>（3）为使项目每次 install 之后默认执行（2）中命令，在 package.json 的“scripts“中添加如下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;script&quot;: &#123;</span><br><span class="line">   &quot;prepare&quot;: &quot;husky install&quot;,</span><br><span class="line">   ... ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（4）将代码检查命令添加为 hook，执行：npx husky add .husky&#x2F;pre-commit &quot;npm run codecheck&quot;，此命令将创建文件&quot;.husky&#x2F;pre-commit&quot;，文件内容如下。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env sh</span><br><span class="line">. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;</span><br><span class="line"></span><br><span class="line">npm run codecheck</span><br></pre></td></tr></table></figure><p>△ 以上操作之后，项目 commit 前将自动执行代码检查脚本，结果将在执行 commit 的窗口中输出。</p><p>△ 对 codecheck 的改进<br>（1）当前 codecheck 脚本对指定范围的代码做全量处理，当代码量大时会拖慢速度。此时可使用&quot;lint-staged&quot;将范围限定在处于 staged 状态的文件(即文件被执行过 git add)。<br>（2）安装 lint-staged，将如下 lint-staged 的配置增加到 package.json 文件的第一级字段，lint-staged 也支持其他配置方式，参考<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/lint-staged#configuration">官方文档</a>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;lint-staged&quot;: &#123;</span><br><span class="line">  &quot;./src/!(**/node_modules)/*.&#123;ts,tsx,js,jsx,vue&#125;&quot;: &quot;eslint --fix&quot;,</span><br><span class="line">  &quot;./src/!(**/node_modules)/*.&#123;css,scss,less&#125;&quot;: &quot;prettier --write&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（3）将 husky 的 pre-commit 内容改为: yarn lint-staged。</p><h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><p>◇ 某些必须违背规则的地方（如服务器接口的参数），通过如下 eslint 专用注释忽略对其做自动化检查与格式化，例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">    method: &#x27;get&#x27;,</span><br><span class="line">    url: &#x27;oneUrl&#x27;,</span><br><span class="line">    data: &#123;</span><br><span class="line">       /* eslint-disable */</span><br><span class="line">       para_first: 1,</span><br><span class="line">       para_second: 2</span><br><span class="line">      /* eslint-enable */</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>◇ prettier 命令中的 file pattern 之前使用的是&quot;src&#x2F;**&#x2F;*.{css,scss,less}&quot;，当查找不到任何文件时候会报“No files matching the pattern”错误，改成&quot;src&#x2F;**&#x2F;*.(css,scss,less)&quot;就没有这个问题了。</p><p>◇ lint-staged 默认以并发方式执行任务，内容较多时可能导致内存不足而被强制退出，添加 --concurrent &lt;number | false&gt; 参数以限制并发数量或关闭并发。</p><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p>●<a target="_blank" rel="noopener" href="https://prettier.io/docs/en/cli.html#--write">prettier 官方文档</a><br>●<a target="_blank" rel="noopener" href="https://github.com/mrmlnc/fast-glob#pattern-syntax">file pattern 语法</a><br>●<a target="_blank" rel="noopener" href="https://typicode.github.io/husky/#/?id=install">husky 官方文档</a><br>●<a target="_blank" rel="noopener" href="https://daveceddia.com/vscode-use-eslintrc/">ESLint + VSCode: How to Format Your Code Using .eslintrc</a></p></div><blockquote class="post-copyright"><div class="content"></div><footer style="width:100%"><h5><span class="post-time">最后更新时间：<time datetime="2025-03-19T13:37:34.684Z" itemprop="dateUpdated">2025-03-19 21:37:34</time></span><span style="float:right"><img src="/img/avatar.jpg" alt="Congzhou">Congzhou</span></h5></footer></blockquote><div class="post-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/" rel="tag">webpack</a></li></ul></div></div><nav class="post-nav flex-row flex-justify-between"><div class="prev"><a href="/handbook/%E9%85%8D%E7%BD%AE%E5%85%AC%E5%8F%B8GitLab%E5%92%8C%E4%B8%AA%E4%BA%BAGitHub%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%9A%84Name%E5%92%8CEmail.html" id="post-prev" class="post-nav-link"><div class="tips"><i class="iconfont icon-arrow1l"></i>Prev</div><h4 class="title">配置公司GitLab和个人GitHub使用不同的Name和Email</h4></a></div><div class="next"><a href="/knowledge/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BB%84%E6%88%90%E4%B8%8EJS%E8%BF%90%E8%A1%8C%E6%97%B6%E7%8E%AF%E5%A2%83.html" id="post-next" class="post-nav-link"><div class="tips">Next<i class="iconfont icon-arrow1r"></i></div><h4 class="title">浏览器组成与JS运行时环境</h4></a></div></nav><div class="comments vcomment" id="comments"></div><script src="/js/valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)}),required_info="nick,mail".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)});new Valine({el:"#comments",appId:"tq4lHkryFNXHsw9SOypjPRwx-gzGzoHsz",appKey:"lFmuObNsezjTPj5e86R1TgOg",avatar:"mp",placeholder:"欢迎留言(支持Markdown语法), 将展示您邮箱绑定的Gravatar头像(如果有的话~)",meta:0==guest_info.length?GUEST_INFO:guest_info,pageSize:"10",recordIP:!1,requiredFields:required_info})</script></article></div><footer class="footer"><div class="bottom"><p><span>Copyright &copy; 2009-2025 Congzhou</span><span id="container_site_uv" style="display:none">总访客数：<span id="value_site_uv"></span></span><span id="container_site_pv" style="display:none">总访问量：<span id="value_site_pv"></span></span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light" style="text-decoration:none"><span class="iconfont icon-arrow-up" style="font-size:25px;font-weight:700"></span></a><script>var BLOG={ROOT:"/",SHARE:!1,REWARD:!1}</script><script src="/js/main.min.js"></script><div class="search-panel" id="search-panel"><ul class="search-result" id="search-result"></ul></div><template id="search-tpl"><li class="item"><a href="{path}" class="waves-block waves-effect"><div class="title ellipsis" title="{title}">{title}</div><div class="flex-row flex-middle"><div class="tags ellipsis">{tags}</div><time class="flex-col time">{date}</time></div></a></li></template><script src="/js/search.min.js"></script><script>Observer.callback=function(){var e=document.querySelector("#value_page_pv");e.innerText=VISIT_INFO.curPagePV,e.parentNode.style.display="inline-block"},VISIT_INFO.curPagePV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_pv");e.innerText=VISIT_INFO.totalPV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalPV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_uv");e.innerText=VISIT_INFO.totalUV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalUV,Observer.callback=null,setTimeout(function(){var a=AV.Object.extend("visit_pv"),e=AV.Object.extend("visit_uv"),t=new AV.Query(a),o=location.pathname;location.hostname.match("localhost")?(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times")}else VISIT_INFO.curPagePV=0})):(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times"),t.increment("times",1),t.save()}else{VISIT_INFO.curPagePV=0;var l=new a;l.set("url",o),l.set("times",1);var n=document.querySelector(".post-card-title").innerText;l.set("title",n),l.save()}}));var l=localStorage.getItem("blog_UID");l||(l=generateUID(),localStorage.setItem("blog_UID",l)),AV.Cloud.run("total_pv").then(function(e){VISIT_INFO.totalPV=e}),location.hostname.match("localhost")||AV.Cloud.run("rec_uv",{UID:l}).then(function(e){}),new AV.Query(e).count().then(function(e){VISIT_INFO.totalUV=e+1998})},100)</script><script>"serviceWorker"in navigator&&(window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("service-worker register ok")}).catch(function(e){console.log("service-worker register failed: "+e)})}),navigator.serviceWorker.addEventListener("controllerchange",function(){console.log("检测到缓存资源更新，刷新以获取新内容")}))</script></body></html>