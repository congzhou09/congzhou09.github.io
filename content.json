[{"title":"AFFiNEåç«¯å¼€å‘ç¯å¢ƒæ­å»º","date":"2025-04-28T04:25:49.000Z","path":"practice/AFFiNEåç«¯å¼€å‘ç¯å¢ƒæ­å»º.html","tags":[{"name":"AFFiNE","slug":"AFFiNE","permalink":"https://congzhou09.github.io/tags/AFFiNE/"}],"text":"ç¯å¢ƒå‚æ•°â—‡ æˆ‘æ˜¯åœ¨ Windows ä¸Šæ­å»ºçš„ï¼Œä»¥ä¸‹ç‰ˆæœ¬å·ä¿¡æ¯ä¾›å‚è€ƒï¼Œéå¿…é¡»å®Œå…¨ä¸€è‡´ã€‚ Name version Win11 24H2 Docker Desktop v4.40.0 rustc 1.86.0 node v20.19.0 PostgreSQL 17.4 Redis 7.4.3 AFFiNE canary: 7e4af90c0311e498f5119b034397b5ae8a7af9ec æ“ä½œæ­¥éª¤â—† åœ¨ AFFiNE é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ yarn install æˆåŠŸå®‰è£…æ‰€æœ‰ä¾èµ–ã€‚â—† åç«¯é¡¹ç›®æ˜¯å…¶ä¸­çš„ @affine&#x2F;server å­é¡¹ç›®ã€‚â—† å®‰è£… Docker Desktop ä¸ Rustã€‚â—† ä½¿ç”¨ docker è¿è¡Œ Redisï¼Œdocker-compose.yaml å†…å®¹å¦‚ä¸‹ï¼š 1234567services: affine-redis: image: redis:latest container_name: affine-redis restart: always ports: - &quot;6379:6379&quot; â—† ä½¿ç”¨ docker è¿è¡Œ PostgreSQLï¼Œdocker-compose.yaml å†…å®¹å¦‚ä¸‹ã€‚ï¼ˆ1ï¼‰ç”±äº Postgres è¦æ±‚æŒ‚è½½ç›®å½•æ”¯æŒç¡¬é“¾æ¥ï¼ˆhard linkï¼‰ï¼ŒWindows ä¸Šä¸èƒ½ä½¿ç”¨æœ¬åœ°ç£ç›˜ç›®å½•ã€‚äºæ˜¯ä½¿ç”¨è®© docker åˆ›å»ºçš„åä¸º&quot;affine_pgdata&quot;çš„ volume åšæ•°æ®æŒä¹…åŒ–ã€‚ 1234567891011services: affine-postgres: image: postgres:latest container_name: affine-postgres restart: always ports: - &quot;5432:5432&quot; volumes: - affine_pgdata:/var/lib/postgresql/datavolumes: affine_pgdata: â—† åœ¨æ•°æ®åº“ä¸­åˆ›å»ºé¡¹ç›®æ‰€ä½¿ç”¨çš„ç”¨æˆ·åã€å¯†ç ä¸æ•°æ®åº“å®ä¾‹ã€‚ 123456789# è¿›å…¥æ•°æ®åº“å®¹å™¨çš„æ•°æ®åº“å‘½ä»¤è¡Œdocker exec -it affine-postgres psql -U postgres# åˆ›å»ºé¡¹ç›®ç”¨æˆ·CREATE USER affine WITH PASSWORD &#x27;affine&#x27;;ALTER USER affine WITH SUPERUSER;# åˆ›å»ºæ•°æ®åº“CREATE DATABASE affine; â—† æˆ‘ä½¿ç”¨å¼€å‘ç¯å¢ƒä¸‹ä¼šè‡ªåŠ¨åˆ›å»ºçš„ç”¨æˆ·è°ƒè¯•(packages\\backend\\server\\src\\core\\auth\\dev.ts\\createDevUsers())ï¼Œæ‰€ä»¥æœªå¯åŠ¨ mailhog æœåŠ¡ä¹Ÿæœªåœ¨ä¸‹ä¸€æ­¥é…ç½® mail ç›¸å…³å­—æ®µã€‚ â—† é¡¹ç›®æ•°æ®åº“è¿æ¥é…ç½®ï¼Œè¿›å…¥é¡¹ç›® packages\\backend\\server è·¯å¾„ï¼Œå‚è€ƒ&quot;.env.example&quot;åˆ›å»ºé…ç½®æ–‡ä»¶&quot;.env&quot;ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ã€‚ 1DATABASE_URL=&quot;postgres://affine:affine@localhost:5432/affine&quot; â—† ä½¿ç”¨é¡¹ç›®æ‰€ä¾èµ–çš„ prisma åˆ›å»ºé¡¹ç›®æ•°æ®åº“è¡¨ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š 1yarn workspace @affine/server prisma db push â—† å¦‚æœä¸Šæ­¥æ‰§è¡ŒæŠ¥é”™ï¼šCould not open extension control file &quot;&#x2F;usr&#x2F;share&#x2F;postgresql&#x2F;17&#x2F;extension&#x2F;vector.control&quot;: No such file or directoryã€‚åˆ™æ‰§è¡Œä»¥ä¸‹æ­¥éª¤åé‡æ–°æ‰§è¡Œä¸Šæ­¥å‘½ä»¤ã€‚ 12345678# è¿›å…¥æ•°æ®åº“å®¹å™¨çš„bashå‘½ä»¤è¡Œdocker exec -it affine-postgres /bin/bash# æ›´æ–°apt-getå·¥å…·apt-get update# å®‰è£…ç¼ºå°‘çš„vectoræ‰©å±•ï¼Œå…¶ä¸­çš„&quot;17&quot;ä¸æŠ¥é”™ä¿¡æ¯é‡Œçš„ä¸€è‡´apt-get install postgresql-17-pgvector â—† åˆå§‹åŒ–æ•°æ®åº“ä¸­çš„é¡¹ç›®æ•°æ®ã€‚åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œæ³¨æ„è¦å¸¦ä¸Š&quot;run&quot;ï¼Œä¸ç„¶æ‰€æ‰§è¡Œçš„&quot;yarn init&quot;å°±æ˜¯ yarn è‡ªå¸¦çš„ init å‘½ä»¤äº†ã€‚ 1yarn workspace @affine/server run init â—† ç¼–è¯‘ @affine&#x2F;server æ‰€ä¾èµ–çš„ @affine&#x2F;server-nativeã€‚æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œæ­¤æ—¶ä¼šç”¨åˆ° Rust ç¯å¢ƒã€‚ 1yarn workspace @affine/server-native build:debug â—† å¦‚æœä¸Šæ­¥æ‰§è¡ŒæŠ¥é”™ï¼š&#39;cargo&#39; ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºã€‚åˆ™æ‰§è¡Œä»¥ä¸‹æ­¥éª¤åé‡æ–°æ‰§è¡Œä¸Šæ­¥å‘½ä»¤ã€‚ï¼ˆ1ï¼‰ç¡®è®¤ Rust å·²å®‰è£…ï¼Œpowershell å’Œ cmd ä¸­ cargo --version æ‰“å°æ­£å¸¸ã€‚ï¼ˆ2ï¼‰ç»ˆç«¯æ­£å¸¸å¯åŠ¨æ—¶ä¼šåŠ è½½ç”¨æˆ·çº§+ç³»ç»Ÿçº§çš„ PATH å˜é‡ï¼Œç¡®è®¤ç¯å¢ƒå˜é‡çš„ PATH ä¸­å­˜åœ¨&quot;C:\\Users\\ç”¨æˆ·å\\.cargo\\bin&quot;ã€‚ï¼ˆ3ï¼‰åœ¨æŠ¥é”™ä½ç½®&quot;node_modules\\@napi-rs\\cli\\dist\\utils\\metadata.js&quot;ï¼Œå¢åŠ  console.log(process.env.PATH)æ‰“å°ï¼Œçœ‹å…¶ä¸­æ˜¯å¦æ²¡æœ‰&quot;C:\\Users\\ç”¨æˆ·å\\.cargo\\bin&quot;ã€‚åŸå› å¾ˆå¯èƒ½æ˜¯åœ¨å®‰è£…å®Œ Rust åçš„å¹¿æ’­ PATH å˜æ›´ç¯èŠ‚å¼‚å¸¸ï¼Œé‡å¯ç”µè„‘å¯è§£å†³ã€‚ â—† å¯åŠ¨åç«¯ã€‚åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ yarn devï¼Œé€‰æ‹©&quot;@affine&#x2F;server&quot;ã€‚ admin ç®¡ç†é¡µé¢â–³ ä»¥ self-hosted æ¨¡å¼éƒ¨ç½²çš„ AFFiNE å¯ä»¥é€šè¿‡ http://locahost:3010/admin è®¿é—® admin ç®¡ç†é¡µé¢ã€‚æœ¬åœ°å¼€å‘ç¯å¢ƒéœ€è¦åšä¸‹é¢ä¸¤æ­¥æ“ä½œæ‰å¯ä»¥ã€‚ self-hosted æ¨¡å¼â–¡ åœ¨.env æ–‡ä»¶ä¸­è¿½åŠ  DEPLOYMENT_TYPE å­—æ®µã€‚ 1DEPLOYMENT_TYPE=&quot;selfhosted&quot; admin é¡µé¢èµ„æºâ—‹ ç¼–è¯‘ @affine&#x2F;adminã€‚é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š 1yarn affine @affine/admin build â—‹ æ‹·è´ packages\\frontend\\admin\\dist ä¸‹çš„æ‰€æœ‰å†…å®¹åˆ° packages\\backend\\server\\static\\admin å‚è€ƒæ–‡çŒ®â—å®˜æ–¹ Doc ç½‘ç«™-Node Dev Guideâ—self-hosted æ¨¡å¼ AFFiNE çš„éƒ¨ç½²"},{"title":"åŸºäºverdaccioçš„npmç§æœ‰ä»“åº“","date":"2024-11-25T13:03:36.000Z","path":"practice/åŸºäºverdaccioçš„npmç§æœ‰ä»“åº“.html","tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://congzhou09.github.io/tags/Node-js/"}],"text":"ç®€ä»‹â— Verdaccio æ˜¯ä¸ªè½»é‡çš„åŸºäº Node.js çš„ npm ç§æœ‰ä»“åº“ã€‚â— æ”¯æŒ npm ä¸»æµå®¢æˆ·ç«¯(yarn&#x2F;npm&#x2F;pnpm)ï¼Œæ”¯æŒä»£ç†åˆ°å…¶ä»– registry åœ°å€åŠç¼“å­˜åŠ é€Ÿã€‚ docker-compose æ–¹å¼è¿è¡Œ(linux)â—‡ å‚è€ƒå®˜æ–¹æ–‡æ¡£å¯¹ docker æ–¹å¼çš„è¯´æ˜ã€‚â—‡ æŒ‡å®šä¸€ä¸ªå­˜æ”¾è·¯å¾„ã€‚æ­¤å¤„ä»¥æ­¤è·¯å¾„ä¸ºä¾‹ï¼š&#x2F;app&#x2F;deploy&#x2F;verdaccioã€‚â—‡ åœ¨è·¯å¾„ä¸‹åˆ›å»ºä¸‰ä¸ªå­æ–‡ä»¶å¤¹ï¼šconfigã€pluginsã€storageã€‚â—‡ ç”±äº Verdaccio åœ¨å®¹å™¨å†…ä½¿ç”¨çš„æ˜¯ UID&#x3D;10001 ä¸” GID&#x3D;65533 çš„é root ç”¨æˆ·ï¼Œé€’å½’è®¾ç½®æŒ‚è½½ç›®å½•çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼š 1sudo chown -R 10001:65533 /app/deploy/verdaccio â—‡ å‚è€ƒå®˜æ–¹ç¤ºä¾‹é…ç½®æ–‡ä»¶åœ¨ config æ–‡ä»¶å¤¹ä¸‹å‡†å¤‡ config.yamlï¼Œç¤ºä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051# path to a directory with all packagesstorage: /verdaccio/storage# path to a directory with plugins to include, the plugins folder has the higher priority for loading plugins# disable this folder to avoid warnings if is not used# plugins: ./pluginsweb: enable: true title: npm | example logo: https://static-production.npmjs.com/b0f1a8318363185cc2ea6a40ac23eeb2.png favicon: https://static-production.npmjs.com/b0f1a8318363185cc2ea6a40ac23eeb2.png primary_color: &#x27;#3990f6&#x27; showInfo: false showSettings: false showFooter: false showUplinks: false showDownloadTarball: false showRaw: falseurl_prefix: &#x27;/&#x27;max_body_size: 300mb # max package&#x27;s size 300Mauth: htpasswd: file: /verdaccio/storage/htpasswd # where to store login info # Maximum amount of users allowed to register, defaults to &quot;+inf&quot;. # Set to -1 to disable registration. max_users: -1uplinks: npmjs: url: https://registry.npmjs.org/packages: &#x27;**&#x27;: # you can specify usernames/groupnames (depending on your auth plugin) # and three keywords: &quot;$all&quot;, &quot;$anonymous&quot;, &quot;$authenticated&quot; access: $authenticated publish: $authenticated # if package is not available locally, proxy requests to &#x27;npmjs&#x27; registry proxy: npmjssecurity: web: sign: expiresIn: 30d # login expiration time, examples: 1h, 7dlog: - &#123; type: stdout, format: pretty, level: trace &#125; #- &#123;type: file, path: verdaccio.log, level: info&#125; â—‡ åˆ›å»º docker-compose.yml æ–‡ä»¶ï¼Œå†…å®¹ç¤ºä¾‹å¦‚ä¸‹ã€‚å…¶ä¸­ VERDACCIO_PUBLIC_URL ä¸èƒ½ä¸ºç©ºï¼Œä¸”éœ€è®¾ç½®æˆåŸŸåç½‘å€è€Œä¸èƒ½æ˜¯ç›¸å¯¹è·¯å¾„(ä»¥ https://npm.my.cn ä¸ºä¾‹)ï¼Œå¦åˆ™ Verdaccio å°†ä½¿ç”¨é»˜è®¤çš„ http://localhost:4873/ ä½œä¸ºæ‰€ç”Ÿæˆæ‰€æœ‰èµ„æºé“¾æ¥(å¦‚åŒ…çš„è®¿é—®é“¾æ¥)çš„åŸºç¡€ URLã€‚ 123456789101112131415name: verdaccioservices: verdaccio: image: verdaccio/verdaccio:6.0.2 container_name: &#x27;verdaccio&#x27; environment: - VERDACCIO_PUBLIC_URL=https://npm.my.cn - VERDACCIO_PORT=4873 ports: - &#x27;4873:4873&#x27; volumes: - &#x27;./storage:/verdaccio/storage&#x27; - &#x27;./config:/verdaccio/conf&#x27; - &#x27;./plugins:/verdaccio/plugins&#x27; â—‡ åœ¨ docker-compose.yml æ–‡ä»¶åŒçº§ç›®å½•ä¸‹æ‰§è¡Œ&quot;docker compose up -d&quot;å‘½ä»¤å¯åŠ¨ã€‚ ç§æœ‰ä»“åº“çš„ä½¿ç”¨â–  ä»¥ä¸‹ç§æœ‰ä»“åº“åœ°å€ä»¥ https://npm.my.cn ä¸ºä¾‹ã€‚ ç”¨æˆ·ç®¡ç†â–  åˆ›å»ºç”¨æˆ·ã€‚åœ¨ä¸Šè¿° config.yaml é…ç½®ä¸­ max_users ä¸ç­‰äº -1 çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œï¼šnpm adduser --registry https://npm.my.cnã€‚ä»“åº“è¿æ¥æˆåŠŸä¼šè‡ªåŠ¨æç¤ºè¾“å…¥ç”¨æˆ·åå¯†ç ç­‰ä¿¡æ¯ã€‚â–  æ‰‹åŠ¨ç™»å½•ã€‚æ‰§è¡Œï¼šnpm login --registry https://npm.my.cnã€‚â–  è‡ªåŠ¨ç™»å½•ã€‚å°†ç™»å½•ä¿¡æ¯ä¿å­˜åˆ°é¡¹ç›®æ ¹ç›®å½•çš„.npmrc ä¸­å¯é¿å…æ‰‹åŠ¨ login çš„è¿‡ç¨‹ã€‚ç¤ºä¾‹å¦‚ä¸‹ã€‚å…¶ä¸­çš„&lt;passwordToBase64&gt;å¯é€šè¿‡æ‰§è¡Œ&quot;echo -n &lt;password&gt; | base64&quot;å¾—åˆ°ã€‚ 12//npm.my.cn/:username=&lt;username&gt;//npm.my.cn/:_password=&lt;passwordToBase64&gt; åŒ…çš„å‘å¸ƒâ–  å°†åŒ…å‘å¸ƒåˆ°ç§æœ‰ä»“åº“ï¼Œåœ¨ publish å‘½ä»¤ä¸Šå¢åŠ å‚æ•°ï¼š--registry https://npm.my.cnâ–  registry é™¤äº†å‘½ä»¤è¡Œå‚æ•°æ–¹å¼ä¹‹å¤–ï¼Œä¹Ÿæ”¯æŒæ·»åŠ åˆ°.npmrc æ–‡ä»¶ï¼Œä»¥åŠ package.json æ–‡ä»¶çš„ publishConfig å­—æ®µã€‚ä¸‰è€…ä¼˜å…ˆçº§ä¾æ¬¡é€’å‡ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112//.npmrc æ–‡ä»¶registry=https://npm.my.cn// package.jsonæ–‡ä»¶&#123; ... ... &quot;publishConfig&quot;: &#123; &quot;registry&quot;: &quot;https://npm.my.cn&quot; &#125; ... ...&#125; â–  åŒ…å¤§å°é™åˆ¶çš„è°ƒæ•´ï¼šï¼ˆ1ï¼‰nginx é»˜è®¤æ¶ˆæ¯ä½“å¤§å°é™åˆ¶ 1Mï¼Œé€šè¿‡ nginx æŒ‡ä»¤â€œclient_max_body_size 300Mâ€è°ƒæ•´ã€‚ï¼ˆ2ï¼‰verdiccio é»˜è®¤åŒ…å¤§å°é™åˆ¶ 10Mï¼Œé€šè¿‡ config.yaml ä¸­çš„â€œmax_body_size: 300mbâ€è°ƒæ•´ã€‚ åŒ…çš„å®‰è£…â–  æ‰€æœ‰åŒ…éƒ½ä»ç§æœ‰ä»“åº“ä¸‹è½½ã€‚é€šè¿‡ä¸Šè¿° --registry å‘½ä»¤è¡Œå‚æ•°æˆ– .npmrc ä¸­çš„ registry å­—æ®µå¯å®ç°ã€‚â–  ä»…ç§æœ‰åŒ…ä»ç§æœ‰ä»“åº“ä¸‹è½½ã€‚.npmrc æä¾›äº†ä¸ºç‰¹å®šåŸŸæˆ–åŒ…åæŒ‡å®šä»“åº“åœ°å€çš„é…ç½®è¯­æ³•ï¼Œä½†å®è·µå‘ç° pnpm å’Œ yarn å¯¹è¿™ç±»è¯­æ³•çš„æ”¯æŒä¸å®Œå–„æˆ–ä¸ç»Ÿä¸€ï¼Œå¯é€šè¿‡å°† package.json çš„ dependencies ä¸­åŒ…çš„ç‰ˆæœ¬å·æŒ‡å®šä¸ºå¸¦åŸºç¡€ URL çš„å®Œæ•´ä¸‹è½½åœ°å€å®ç°ï¼Œå¦‚ï¼š&quot;demo-pkg&quot;: &quot;https://npm.my.cn/demo-pkg/-/demo-pkg-0.0.11.tgz&quot;ã€‚"},{"title":"åŸºäºé˜¿é‡Œäº‘ACK Serverlessæ­å»ºæŒ‰é‡ä»˜è´¹çš„gitlab-runner","date":"2024-07-28T13:42:01.000Z","path":"practice/åŸºäºé˜¿é‡Œäº‘ACK-Serverlessæ­å»ºæŒ‰é‡ä»˜è´¹çš„gitlab-runner.html","tags":[{"name":"ACK Serverless","slug":"ACK-Serverless","permalink":"https://congzhou09.github.io/tags/ACK-Serverless/"},{"name":"gitlab","slug":"gitlab","permalink":"https://congzhou09.github.io/tags/gitlab/"}],"text":"æ–¹æ¡ˆè¯´æ˜â—† ç”±äº CI&#x2F;CD çš„éæŒç»­è¿è¡Œè€Œè¿è¡ŒæœŸé—´åˆéœ€è¦è¾ƒé«˜ç³»ç»Ÿèµ„æºçš„ç‰¹æ€§ï¼Œç¬¦åˆ ACK Serverless æŒ‰èµ„æºä½¿ç”¨æ—¶é—´è®¡è´¹çš„åœºæ™¯ï¼Œé™ä½ CI&#x2F;CD æˆæœ¬çš„åŒæ—¶åˆèƒ½æé«˜å¹¶è¡Œå¤šä»»åŠ¡çš„æ‰§è¡Œæ•ˆç‡ã€‚â—† æ–¹æ¡ˆçš„ç³»ç»Ÿç»“æ„ä¸æµç¨‹å¦‚ä¸‹é¢æ¥è‡ªå‚è€ƒæ–‡æ¡£[1]çš„æˆªå›¾ï¼Œå½“æ²¡æœ‰ä»»åŠ¡æ—¶ä»… gitlab-runner ä½œä¸ºä¸€ä¸ª pod å§‹ç»ˆè¿è¡Œï¼Œä»¥éšæ—¶æ¥å—æ¥è‡ª gitlab çš„ä»»åŠ¡åˆ†é…ã€‚å½“æœ‰ä»»åŠ¡éœ€è¦æ‰§è¡Œæ—¶ï¼Œé’ˆå¯¹æ¯ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ª kubernetes executor ç±»å‹çš„ pod æ‰§è¡Œä»»åŠ¡ï¼Œä¸”ä»»åŠ¡æ‰§è¡Œç»“æŸåï¼Œè¿™äº› kubernetes executor ç±»å‹çš„ pod ä¼šè‡ªåŠ¨é”€æ¯ã€‚ æ­¥éª¤å‡†å¤‡ ACK Serverless é›†ç¾¤ç¯å¢ƒâ— åœ¨é˜¿é‡Œäº‘å·¥ä½œå°é¡µé¢åˆ›å»º ACK Serverless ç±»å‹çš„ kubernetes é›†ç¾¤ã€‚â— æ ¹æ®&quot;é›†ç¾¤ä¿¡æ¯&quot;ä¸­çš„&quot;è¿æ¥ä¿¡æ¯&quot;ï¼Œé…ç½®æœ¬åœ° kubectlï¼Œä½¿å¯ä»¥åœ¨æœ¬åœ° kubectl ä¸Šå¯¹é›†ç¾¤åšæ“ä½œã€‚ å‡†å¤‡é…ç½®æ–‡ä»¶â—‡ ä» GitHub ä¸Š clone ç”±å‚è€ƒæ–‡æ¡£[1]æä¾›çš„é…ç½®æ–‡ä»¶æ ·ä¾‹åˆ°æœ¬åœ°ï¼Œä½¿ç”¨å…¶ä¸­&quot;eci-gitlab-runner&quot;æ–‡ä»¶å¤¹é‡Œçš„é…ç½®æ–‡ä»¶ã€‚â—‡ ä»¥ä¸‹é…ç½®çš„å†…å®¹æœ€ç»ˆå°†é›†ä¸­åˆ° config-map.yml å¹¶ç»ç”±é›†ç¾¤çš„ deployment è¢« mount åˆ° config.toml æ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿åœ°åº”ç”¨åˆ°æ‰€éƒ¨ç½²çš„ gitlab-runner pod ä¸­ã€‚â—‡ æœªæ¥ç”± gitlab-runner æ‹‰èµ·çš„ kubernetes executor ç±»å‹ pod çš„é…ç½®ä¹Ÿåœ¨è¿™ä¸ª config.toml æ–‡ä»¶é‡Œçš„ï¼Œéƒ¨åˆ†é…ç½®ä¹Ÿä¼šè¢« mount æˆ pod ä¸­çš„æ–‡ä»¶ã€‚â—‡ ä»¥ä¸‹é…ç½®å†…å®¹å’Œå‘½ä»¤ä¸­çš„æ‰€æœ‰ç”±&quot;${}&quot;åŒ…è£¹çš„å˜é‡éƒ½éœ€è¦æ›¿æ¢æˆå®é™…å€¼ã€‚ secretâ—† é€šè¿‡ secret å­˜æ”¾ kubernetes é›†ç¾¤ã€docker registryã€git ssh çš„é‰´æƒä¿¡æ¯ã€‚â—† ä¿®æ”¹æ ·ä¾‹ secret.yaml é…ç½®ï¼Œå…¶ä¸­çš„ ca.crtã€tls.crtã€tls.key ä¾æ¬¡å¡«å†™é›†ç¾¤è¿æ¥ä¿¡æ¯é‡Œçš„ certificate-authority-dataã€client-certificate-dataã€client-key-dataã€‚â—† æ‰§è¡Œ&quot;kubectl apply -f secret.yaml&quot;ä½¿ç”Ÿæ•ˆã€‚secret.yaml å®Œæ•´å†…å®¹å¦‚ä¸‹ï¼š 123456789apiVersion: v1kind: Secretmetadata: name: gitlab-runner-secrettype: kubernetes.io/tlsdata: ca.crt: $&#123;ca.crt&#125; tls.crt: $&#123;tls.crt&#125; tls.key: $&#123;tls.key&#125; â—† å¦‚æœ gitlab çš„ pipeline ä»»åŠ¡éœ€è¦æ¨é€ docker é•œåƒåˆ°é•œåƒä»“åº“ï¼Œåˆ™åœ¨é›†ç¾¤åˆ›å»ºåä¸º&quot;registry-auth-secret&quot;çš„ secretï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 1kubectl create secret docker-registry registry-auth-secret --docker-server=$&#123;registry-server-hostname&#125; --docker-username=$&#123;username&#125; --docker-password=$&#123;password&#125; â—† å¦‚æœ gitlab çš„ pipeline ä»»åŠ¡éœ€è¦ clone å…¶ä»– git ä»“åº“ï¼Œåˆ™åœ¨é›†ç¾¤åˆ›å»ºåä¸º&quot;gitlab-credentials&quot;çš„ secretï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 1kubectl create secret generic gitlab-credentials --from-file=id_rsa=$&#123;pathto_id_rsa&#125; --from-file=id_rsa.pub=$&#123;pathto_id_rsa.pub&#125; --from-file=known_hosts=$&#123;pathto_known_hosts&#125; â—† secret åˆ›å»ºæˆåŠŸåå¯åœ¨&quot;é˜¿é‡Œäº‘å·¥ä½œå°é¡µé¢é›†ç¾¤è¯¦æƒ…-&gt;é…ç½®ç®¡ç†-&gt;ä¿å¯†å­—å…¸&quot;ä½ç½®çœ‹åˆ°ã€‚ é…ç½® cacheâ— gitlab çš„ cache ç”¨äºè®© executor ç¼“å­˜æ–‡ä»¶ä¸æ–‡ä»¶å¤¹ä»¥å‡å°‘é‡å¤çš„ä¸‹è½½ã€å®‰è£…ç­‰å·¥ä½œã€‚â— executor å®¹å™¨çš„ cache å­˜å‚¨åˆ°çš„é»˜è®¤è·¯å¾„æ˜¯&quot;&#x2F;cache&quot;ï¼Œæ ·ä¾‹å·²ç»åœ¨ config-map.yaml ä¸­å°† pvc é…ç½®åˆ°äº†æ­¤è·¯å¾„ã€‚ â— å‡†å¤‡å¥½ NAS(Network Attached Storage) ç›˜ï¼Œå°†å…¶åœ°å€ä¸ç¼“å­˜æ–‡ä»¶å¤¹æ ¹ç›®å½•(æ­¤å¤„å®šä¹‰ä¸º&#x2F;gitlab-runner-cache)å¡«å†™åˆ° nas-pv.yamlã€‚nas-pv.yaml å®Œæ•´å†…å®¹å¦‚ä¸‹ï¼š 1234567891011121314151617181920apiVersion: v1kind: PersistentVolumemetadata: name: gitlab-runner-cache-pvspec: accessModes: - ReadWriteOnce capacity: storage: 10Gi mountOptions: - nolock,noresvport,noacl,hard - vers=3 - rsize=1048576 - wsize=1048576 - proto=tcp - timeo=600 - retrans=2 nfs: path: /gitlab-runner-cache server: $&#123;nas-server&#125; â— ç›¸åº”çš„ nas-pvc.yaml ç›´æ¥ä½¿ç”¨æ ·ä¾‹çš„å³å¯ã€‚nas-pvc.yaml å®Œæ•´å†…å®¹å¦‚ä¸‹ï¼š 1234567891011apiVersion: v1kind: PersistentVolumeClaimmetadata: name: gitlab-runner-cache-pvcspec: accessModes: - ReadWriteOnce resources: requests: storage: 10Gi volumeName: gitlab-runner-cache-pv â— åˆ†åˆ«æ‰§è¡Œ&quot;kubectl apply -f nas-pv.yaml&quot;å’Œ&quot;kubectl apply -f nas-pvc.yaml&quot;ä½¿ç”Ÿæ•ˆã€‚â—† pv ä¸ pvc åˆ›å»ºæˆåŠŸåå¯åˆ†åˆ«åœ¨&quot;é˜¿é‡Œäº‘å·¥ä½œå°é¡µé¢é›†ç¾¤è¯¦æƒ…-&gt;å­˜å‚¨-&gt;å­˜å‚¨å·|å­˜å‚¨å£°æ˜&quot;ä½ç½®çœ‹åˆ°ã€‚ é…ç½® image-cacheâ—‹ imagecache-crd(Custom Resource Definitionï¼ŒCRD)æ˜¯ç”¨äºå®ç°é•œåƒç¼“å­˜çš„ kubernetes æ§åˆ¶å™¨ï¼Œæ ·ä¾‹åœ¨ config-map.yaml å’Œ gitlab-runner-deployment.yaml ä¸­é€šè¿‡ k8s.aliyun.com&#x2F;eci-image-cache è¿™ä¸ªè‡ªå®šä¹‰æ³¨è§£æ ‡è¯†äº†å¯¹ imagecache çš„å¯ç”¨ã€‚ â—‹ é€šè¿‡&quot;kubectl get crd&quot;å‘½ä»¤æŸ¥çœ‹ imagecache-crd æ˜¯å¦å·²å®‰è£…ã€‚å¦‚æœæœªå®‰è£…åˆ™é€šè¿‡&quot;kubectl apply -f imagecache-crd.yaml&quot;å®‰è£…ã€‚ç›´æ¥ä½¿ç”¨æ ·ä¾‹çš„ imagecache-crd.yaml å³å¯ï¼Œå®Œæ•´å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051apiVersion: apiextensions.k8s.io/v1beta1kind: CustomResourceDefinitionmetadata: name: imagecaches.eci.alibabacloud.comspec: group: eci.alibabacloud.com version: v1 names: kind: ImageCache plural: imagecaches shortNames: - ic categories: - all scope: Cluster subresources: status: &#123;&#125; validation: openAPIV3Schema: required: - spec properties: spec: type: object required: - images properties: imagePullSecrets: type: array items: type: string images: minItems: 1 type: array items: type: string imageCacheSize: type: integer additionalPrinterColumns: - name: Age type: date JSONPath: .metadata.creationTimestamp - name: CacheId type: string JSONPath: .status.imageCacheId - name: Phase type: string JSONPath: .status.phase - name: Progress type: string JSONPath: .status.progress â—‹ æ ¹æ®å®é™…éœ€è¦å°†å¾…ç¼“å­˜çš„ docker é•œåƒåå¡«å†™åˆ° imagecache.yaml ä¸­ï¼Œæˆ‘ä½¿ç”¨çš„ imagecache.yaml å®Œæ•´å†…å®¹å¦‚ä¸‹ï¼š 123456789101112apiVersion: eci.alibabacloud.com/v1kind: ImageCachemetadata: name: gitlab-runnerspec: images: - gitlab/gitlab-runner-helper:x86_64-latest - gitlab/gitlab-runner:latest - node:20-alpine - node:20 - mcr.microsoft.com/playwright:v1.44.0-jammy - gcr.io/kaniko-project/executor:v1.14.0-debug â—‹ æ‰§è¡Œ&quot;kubectl apply -f imagecache.yaml&quot;ä½¿ç”Ÿæ•ˆã€‚â—‹ imagecache åˆ›å»ºæˆåŠŸåå¯åœ¨&quot;é˜¿é‡Œäº‘å·¥ä½œå°é¡µé¢é›†ç¾¤è¯¦æƒ…-&gt;å·¥ä½œè´Ÿè½½-&gt;è‡ªå®šä¹‰èµ„æº-&gt;èµ„æºå¯¹è±¡æµè§ˆå™¨&quot;ä½ç½®çœ‹åˆ°ã€‚ é…ç½® ConfigMapâ—‡ gitlab-runner çš„é…ç½®æ–‡ä»¶åœ¨å®¹å™¨è™šæ‹Ÿæœºçš„é»˜è®¤ä½ç½®æ˜¯&quot;&#x2F;etc&#x2F;gitlab-runner&#x2F;config.toml&quot;ï¼Œæ ·ä¾‹å·²ç»åœ¨ gitlab-runner-deployment.yaml ä¸­å°† configMap çš„ mountPath é…ç½®åˆ°äº†&#x2F;etc&#x2F;gitlab-runnerã€‚â—‡ å‚ç…§gitlab æ–‡æ¡£å¾—åˆ° authentication token(æ³¨æ„ä¸èƒ½æ˜¯ registration token)å¡«å†™åˆ° config-map.yamlã€‚â—‡ å°†ç§æœ‰ gitlab ç½‘ç«™ä¸ kubernetes é›†ç¾¤çš„è¿æ¥ä¿¡æ¯å¡«å†™åˆ° config-map.yaml æ–‡ä»¶æ ·ä¾‹ã€‚å…¶ä¸­ concurrent æ§åˆ¶æ”¯æŒåŒæ—¶æ‰§è¡Œä»»åŠ¡çš„æ•°é‡ï¼Œç”±äº Serverless ç‰¹æ€§å¯ä»¥è®¤ä¸ºä¸å—é™åˆ¶ã€‚ç„¶å executor çš„ cpu ä¸å†…å­˜é…ç½®é€šè¿‡ cpu_limitã€cpu_requestã€memory_limitã€memory_request æ§åˆ¶ã€‚â—‡ config.toml ä¸­æœ‰å…³ [runners.kubernetes] é…ç½®é¡¹çš„è¯´æ˜ä¹Ÿåœ¨gitlab æ–‡æ¡£ã€‚â—‡ config-map.yaml å®Œæ•´å†…å®¹å¦‚ä¸‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647apiVersion: v1kind: ConfigMapmetadata: name: gitlab-runner-configdata: config.toml: | concurrent = 10 check_interval = 0 [[runners]] name = &quot;runner-on-k8s&quot; url = $&#123;gitlab-url&#125; token = $&#123;authentication token&#125; executor = &quot;kubernetes&quot; output_limit = 51200 [runners.kubernetes] host = $&#123;k8s-connect-url&#125; cert_file = &quot;/etc/gitlab-runner/tls.crt&quot; key_file = &quot;/etc/gitlab-runner/tls.key&quot; ca_file = &quot;/etc/gitlab-runner/ca.crt&quot; namespace = &quot;default&quot; pull_policy = &quot;if-not-present&quot; cpu_limit = &quot;2&quot; cpu_request = &quot;2&quot; memory_limit = &quot;4Gi&quot; memory_request = &quot;4Gi&quot; helper_cpu_limit = &quot;0.5&quot; helper_cpu_request = &quot;0.5&quot; helper_memory_limit = &quot;1Gi&quot; helper_memory_request = &quot;1Gi&quot; helper_image = &quot;gitlab/gitlab-runner-helper:x86_64-latest&quot; [runners.kubernetes.pod_annotations] &quot;k8s.aliyun.com/eci-image-cache&quot; = &quot;true&quot; [runners.kubernetes.volumes] [[runners.kubernetes.volumes.pvc]] name = &quot;gitlab-runner-cache-pvc&quot; mount_path = &quot;/cache&quot; readonly = false [[runners.kubernetes.volumes.secret]] name = &quot;registry-auth-secret&quot; mount_path = &quot;/kaniko/.docker&quot; read_only = true [runners.kubernetes.volumes.secret.items] &quot;.dockerconfigjson&quot; = &quot;config.json&quot; [[runners.kubernetes.volumes.secret]] name = &quot;gitlab-credentials&quot; mount_path = &quot;/root/gitlab-credentials&quot; read_only = true â—‡ æ‰§è¡Œ&quot;kubectl apply -f config-map.yaml&quot;ä½¿ç”Ÿæ•ˆã€‚â—‡ ConfigMap åˆ›å»ºæˆåŠŸåå¯åœ¨&quot;é˜¿é‡Œäº‘å·¥ä½œå°é¡µé¢é›†ç¾¤è¯¦æƒ…-&gt;é…ç½®ç®¡ç†-&gt;é…ç½®é¡¹&quot;ä½ç½®çœ‹åˆ°ã€‚ ä½¿ç”¨ deployment éƒ¨ç½² gitlab-runner é›†ç¾¤â—† ç”¨äºéƒ¨ç½²é›†ç¾¤çš„ deployment ç›´æ¥ä½¿ç”¨æ ·ä¾‹çš„ gitlab-runner-deployment.yaml å³å¯ï¼Œå®Œæ•´å†…å®¹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041apiVersion: apps/v1kind: Deploymentmetadata: name: gitlab-runnerspec: selector: matchLabels: app: gitlab-runner template: metadata: labels: app: gitlab-runner annotations: k8s.aliyun.com/eci-image-cache: &quot;true&quot; spec: containers: - image: gitlab/gitlab-runner:latest imagePullPolicy: IfNotPresent name: gitlab-runner volumeMounts: - mountPath: /etc/gitlab-runner name: config volumes: - name: config projected: defaultMode: 420 sources: - secret: items: - key: ca.crt path: ca.crt - key: tls.crt path: tls.crt - key: tls.key path: tls.key name: gitlab-runner-secret - configMap: items: - key: config.toml path: config.toml name: gitlab-runner-config â—† æ‰§è¡Œ&quot;kubectl apply -f gitlab-runner-deployment.yaml&quot;å®Œæˆ gitlab-runner çš„éƒ¨ç½²ã€‚â—† éƒ¨ç½²æˆåŠŸåå¯åœ¨&quot;é˜¿é‡Œäº‘å·¥ä½œå°é¡µé¢é›†ç¾¤è¯¦æƒ…-&gt;å·¥ä½œè´Ÿè½½-&gt;å®¹å™¨ç»„&quot;ä½ç½®çœ‹åˆ° gitlab-runner çš„ podã€‚æ¥ä¸‹æ¥åœ¨ç§æœ‰ gitlab ç½‘ç«™é…ç½®å¥½ runnerï¼Œå½“æœ‰ pipeline ä»»åŠ¡æ‰§è¡Œæ—¶ä¹Ÿå¯ä»¥çœ‹åˆ°ç›¸åº” executor çš„ podã€‚ é…ç½® gitlab pipeline ä¸­çš„ç›¸å…³é—®é¢˜ä¸å¤„ç†artifacts ä¸ cacheâ™‚ artifacts ä¸ cache çš„åŒºåˆ«åœ¨ gitlab æ–‡æ¡£(https://docs.gitlab.com/ee/ci/caching/#how-cache-is-different-from-artifacts)é‡Œæœ‰è¯´æ˜ã€‚â™‚ å½“å‰ gitlab-runner çš„æ–¹æ¡ˆä¸­ï¼Œè€ƒè™‘åˆ° artifacts å­˜å‚¨ä½ç½®æ˜¯ gitlab æ‰€åœ¨è¿œç¨‹ä¸»æœºï¼Œè€Œ cache å­˜å‚¨ä½ç½®åœ¨æ¯ä¸ª executor çš„æœ¬åœ°ç£ç›˜(é€šè¿‡å°† NAS æŒ‚è½½åˆ°æ¯ä¸ª executor ä¸Šå®ç°äº† cache å†…å®¹çš„å…±äº«)ï¼Œç‰¹åˆ«å½“éœ€ç¼“å­˜å†…å®¹æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä½¿ç”¨ cache ä¼˜äº artifactsã€‚â™‚ cache æ²¡æœ‰ artifacts é‚£æ ·çš„è‡ªåŠ¨è¿‡æœŸåˆ é™¤æœºåˆ¶ï¼Œå¯¹äºæ‰“åŒ…ç»“æœè¿™ç§æ¯æ¬¡å­˜å‚¨è·¯å¾„ä¸åŒçš„ cacheï¼Œå¯åœ¨ after_script é˜¶æ®µå¢åŠ è„šæœ¬ä»¥é’ˆå¯¹ cache key æ¸…ç†ä¸å†ä½¿ç”¨çš„ cache å†…å®¹ã€‚ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132.dist-cache: &amp;dist-cache key: $CI_PIPELINE_ID paths: - ./diststages: - build - deploybuild-job: stage: build script: - echo &#x27;build&#x27;; cache: - &lt;&lt;: *dist-cache policy: pull-push allow_failure: falsedeploy-job: stage: deploy image: name: gcr.io/kaniko-project/executor:v1.14.0-debug entrypoint: [&#x27;&#x27;] script: - echo &#x27;build and push docker image based on cache&#x27;; after_script: - rm -rf /cache/$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME/$CI_PIPELINE_ID*; cache: - &lt;&lt;: *dist-cache policy: pull dependencies: [build-job] build docker é•œåƒâ™€ å¯¹äº docker é•œåƒçš„æ„å»ºä¸æ¨é€ï¼Œé‡‡ç”¨é…ç½®æ›´ç®€å•çš„ kaniko æ–¹å¼ï¼Œæ ¹æ®å‚è€ƒæ–‡æ¡£[3]ï¼Œå·²ç»åœ¨ä¹‹å‰ ConfigMap ä¸­é…ç½® docker ä»“åº“ secret çš„ mountPath åˆ°&quot;&#x2F;kaniko&#x2F;.docker&#x2F;config.json&quot;ã€‚â™€ kaniko é•œåƒæ˜¯ä¸ªç‰¹åˆ«ç²¾ç®€çš„ linuxï¼Œä¸é€‚åˆåœ¨å…¶ä¸­é…ç½®æ‰“åŒ…ç¯å¢ƒã€‚äºæ˜¯å°†æ‰“åŒ…ä¸ docker æ“ä½œæ‹†åˆ†åˆ°ä¸åŒ jobï¼Œæ‰“åŒ…ç»“æœé€šè¿‡ä¸Šæ­¥ cache çš„æ–¹å¼å…±äº«åˆ° kaniko é•œåƒå¯¹åº”çš„å®¹å™¨ä¸­ã€‚â™€ ä½¿ç”¨ kaniko çš„ deploy-job çš„ç¤ºä¾‹ï¼š 123456789101112131415161718192021.echo-variables: &amp;echo-variables - echo &quot;CI_PIPELINE_ID:&quot; $CI_PIPELINE_ID;deploy-job: stage: deploy image: name: gcr.io/kaniko-project/executor:v1.14.0-debug entrypoint: [&#x27;&#x27;] script: - /kaniko/executor --context &quot;$&#123;CI_PROJECT_DIR&#125;&quot; --dockerfile &quot;./Dockerfile&quot; --destination &quot;$&#123;registry_dist&#125;&quot; before_script: - *echo-variables after_script: - rm -rf /cache/$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME/$CI_PIPELINE_ID*; cache: - &lt;&lt;: *dist-cache policy: pull dependencies: [build-job] git ssh é‰´æƒâ–² git ssh ä¿¡æ¯çš„ mountPath ç›´æ¥æŒ‡å®šåˆ°&quot;&#x2F;root&#x2F;.ssh&quot;çš„æ—¶å€™é‡åˆ°äº†å¦‚ä¸‹é—®é¢˜ï¼šï¼ˆ1ï¼‰gitlab-runner çš„ config.toml é…ç½®ä¸­[runners.kubernetes.volumes.secret]ä¸æ”¯æŒæŒ‡å®š mout æ–‡ä»¶çš„ modeï¼Œä½¿ç”¨ id_rsa æ–‡ä»¶åš ssh é‰´æƒä¼šæŠ¥é”™ï¼š&quot;Permissions 0644 for &#39;&#x2F;root&#x2F;.ssh&#x2F;id_rsa&#39; are too open. This private key will be ignored&quot;ã€‚ï¼ˆ2ï¼‰å³ä½¿å°†é…ç½®ä¸­[runners.kubernetes.volumes.secret]çš„ read_only è®¾ç½®ä¸º falseï¼Œå¯¹ id_rsa æ‰§è¡Œ chmod æ“ä½œä¹ŸæŠ¥é”™&quot;chmod: changing permissions of &#39;&#x2F;root&#x2F;.ssh&#x2F;id_rsa&#39;: Read-only file system&quot;ã€‚â–² äºæ˜¯åœ¨ ConfigMap ä¸­å°† mountPath æŒ‡å®šåˆ°äº†&quot;&#x2F;root&#x2F;gitlab-credentials&quot;ï¼Œä¹‹ååœ¨ pipeline é‡Œå†å°†æ–‡ä»¶ä»&quot;&#x2F;root&#x2F;gitlab-credentials&quot;æ‹·è´åˆ°&quot;&#x2F;root&#x2F;.ssh&quot;å¹¶è®¾ç½®æ–‡ä»¶ modeã€‚â–² å¦‚ä¸‹ç¤ºä¾‹å®šä¹‰ä¸€ä¸ªåˆå§‹åŒ– git é‰´æƒæ–‡ä»¶çš„é”šç‚¹ä¾›éœ€è¦æ—¶å¼•ç”¨ã€‚ 123456.prepare-git: &amp;prepare-git - set +e;cat /root/.ssh/known_hosts;if [[ $? -ne 0 ]]; then mkdir /root/.ssh;cat /root/gitlab-credentials/id_rsa &gt; /root/.ssh/id_rsa;chmod 400 /root/.ssh/id_rsa; cp /root/gitlab-credentials/id_rsa.pub /root/gitlab-credentials/known_hosts /root/.ssh/; fi;set -e; - ssh -T git@$&#123;git_domain&#125; å‚è€ƒæ–‡æ¡£ ä»é›¶å…¥é—¨ Serverless | æ•™ä½  7 æ­¥å¿«é€Ÿæ„å»º GitLab æŒç»­é›†æˆç¯å¢ƒ gitlab å®˜æ–¹ doc kubernetes executor ä¸Šæ”¯æŒ docker å‘½ä»¤"},{"title":"<State of GPT>ç†è§£","date":"2024-05-08T11:00:57.000Z","path":"knowledge/State-of-GPT-ç†è§£.html","tags":[{"name":"GPT","slug":"GPT","permalink":"https://congzhou09.github.io/tags/GPT/"}],"text":"â–² å¯¹ Microsoft Build 2023 ä¸Š Andrej Karpathy æ¼”è®²State of GPTçš„å­¦ä¹ æ•´ç†ã€‚â–² æ¼”è®² PPT åœ°å€ã€‚ GPT Assistant æ˜¯å¦‚ä½•è®­ç»ƒå¾—åˆ°çš„â—‡ è®­ç»ƒè¿‡ç¨‹æŒ‰å…ˆåé¡ºåºåˆ†ä¸ºè‡ªå·¦è‡³å³çš„ 4 ä¸ªé˜¶æ®µï¼šPretrainingã€Supervised Finetuningã€Reward Modelingã€Reinforcement Learningã€‚â—‡ æ¯ä¸ªé˜¶æ®µéƒ½æ¶‰åŠ 3 é¡¹å†…å®¹ï¼šdatasetã€algorithmã€modelï¼Œå…¶ä¸­ model æ˜¯é€šè¿‡ dataset+algorithm è®­ç»ƒå¾—åˆ°çš„ã€‚ Pretrainingâ—‡ é¢„è®­ç»ƒé˜¶æ®µå‡ ä¹å äº†æ•´ä¸ªè®­ç»ƒ 99% çš„è¿ç®—æ€§èƒ½ä¸è¿ç®—æ—¶é—´ã€‚é•¿è¾¾æ•°æœˆï¼Œå…¶ä»–ä¸‰ç§é˜¶æ®µéƒ½å±äºå¾®è°ƒï¼Œè®­ç»ƒä»…æ¶ˆè€—æ•°å¤©ç”šè‡³æ•°å°æ—¶ã€‚â—‡ é¢„è®­ç»ƒå¾—åˆ°çš„æ¨¡å‹ç§°ä¸º base modelã€‚base model ä¸åŒäº assistant modelï¼Œç”¨äºå†…å®¹é¢„æµ‹ç”Ÿæˆè€Œä¸æ˜¯å›ç­”é—®é¢˜ã€‚â—‡ é¢„è®­ç»ƒæ•°æ®æœ‰å¤šç§æ¥æºï¼Œä¾‹å¦‚ Meta å…¬å¸çš„ LLaMA æ¨¡å‹çš„æ•°æ®æ¥æºå¦‚ä¸‹å›¾ã€‚æ—¢æœ‰ç½‘ç»œçˆ¬å–æ•°æ®ï¼Œä¹Ÿæœ‰é«˜è´¨é‡æ•°æ®é›†ã€‚ â—‡ æ•°æ®é›†å†…å®¹åœ¨ä½¿ç”¨å‰ä¼šé€šè¿‡ tokenization è¢«è½¬æ¢æˆæ•´æ•°åºåˆ—ã€‚ â—‡ LLaMA ç›¸æ¯” GPT-3 æ›´æ“…é•¿å¯¹å¤§é‡æ–‡æœ¬æ•°æ®åšæ·±å…¥ç†è§£è¯­ä¹‰çš„ä»»åŠ¡ï¼ˆå¦‚é˜…è¯»ç†è§£ä¸é—®ç­”ï¼‰ï¼ŒGPT çš„ä¼˜åŠ¿æ˜¯å¯¹å†™ä½œã€å¯¹è¯ã€ç¿»è¯‘ç­‰å„ç§é€šç”¨ä»»åŠ¡éƒ½è¡¨ç°å¥½ã€‚ä¸‹å›¾æ˜¯ LLaMA ä¸ GPT-3 çš„è®­ç»ƒå‚æ•°çš„å¯¹æ¯”ï¼Œå…¶ä¸­ vocabulary size è¡¨ç¤ºè®­ç»ƒæ•°æ®åŒ…å«çš„ä¸é‡å¤è¯æ±‡é‡ï¼Œcontext length è¡¨ç¤ºè®­ç»ƒçš„ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œparameters è¡¨ç¤ºè®­ç»ƒç”¨åˆ°çš„å‚æ•°æ•°é‡ï¼Œtrained on tokens è¡¨ç¤ºè®­ç»ƒæ•°æ®è½¬æ¢æˆçš„ token æ•°é‡ï¼Œå¯è§ LLaMA åœ¨ parameter å’Œ vocabulary æ–¹é¢çš„æ•°é‡æ›´å°‘ä½†åœ¨ trained on tokens æ–¹é¢çš„æ•°é‡æ›´å¤šã€‚æ¨¡å‹è¡¨ç°å—è®­ç»ƒæ•°æ®å¤šä¸ªç»´åº¦å‚æ•°çš„å½±å“ã€‚ â—‡ å¤§è‡´è®­ç»ƒè¿‡ç¨‹ï¼šè®­ç»ƒæ•°æ®è¢«æ”¾åˆ°æ•°ç»„(B,T)ï¼Œè¡Œæ•° B è¡¨ç¤ºè¾“å…¥åˆ†ä¸ºå¤šå°‘æ‰¹ï¼Œåˆ—æ•° T è¡¨ç¤ºæœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ã€‚æ•°ç»„çš„æ¯ä¸€è¡ŒåŒ…å«å¤šæ¡æ•°æ®åºåˆ—ï¼Œå„æ¡åºåˆ—ä¹‹é—´æœ‰çº¦å®šå¥½çš„åˆ†éš”ç¬¦ã€‚è®­ç»ƒç›®æ ‡æ˜¯è®© transformer ç¥ç»ç½‘ç»œèƒ½å¤Ÿåœ¨ä»»æ„å•å…ƒæ ¼(ä»¥å›¾ä¸­ç»¿æ ¼ä¸ºä¾‹)æ ¹æ®å½“å‰åŠå…¶å·¦ä¾§æ‰€æœ‰å•å…ƒæ ¼è¶‹äºå‡†ç¡®åœ°æ¨æ–­å‡ºçº¢è‰²å•å…ƒæ ¼çš„å†…å®¹ã€‚ â—‡ ç›¸è¾ƒäºä¼ ç»Ÿçš„ NLP æ¨¡å‹ï¼Œç”±äºæ­¤å¤„çš„ base model åœ¨é¢„è®­ç»ƒè¿‡ç¨‹ä¸­ç†è§£äº†å¤§é‡æ–‡æœ¬ç»“æ„ä¸æ¦‚å¿µï¼Œé’ˆå¯¹ç‰¹å®šä»»åŠ¡å¯¹å…¶è¿›è¡Œå¾®è°ƒæ—¶ä»…éœ€è¾ƒå°‘çš„æ ‡æ³¨æ•°æ®å°±èƒ½è¾¾åˆ°å¾ˆå¥½çš„æ€§èƒ½ã€‚è€Œä» GPT-2 å¼€å§‹ï¼Œäººä»¬å‘ç°ä»…é€šè¿‡ prompt è€Œæ— éœ€ finetuning å°±èƒ½è®© base model è¾ƒå¥½å®ŒæˆæŸäº›ç‰¹å®šä»»åŠ¡ï¼Œç”±æ­¤å¼€å¯äº†â€œprompting over finetuningâ€çš„æ—¶ä»£ã€‚ â—‡ GPT-2 çš„ base model å…¬å¸ƒåœ¨å®˜æ–¹ GitHub ä»“åº“ï¼ŒGPT-3 çš„ base model å¯é€šè¿‡å®˜æ–¹ api ä½¿ç”¨æ¨¡å‹&quot;Devanshi&quot;è°ƒç”¨ï¼ŒGPT-4 çš„ base model æ²¡æœ‰å‘å¸ƒã€‚å½“å‰æœ€å¥½çš„ base model æ˜¯ LLaMAï¼Œä½†ç›®å‰æœªæ”¯æŒå•†ç”¨ã€‚ â—‡ ä¸‹å›¾æ˜¯å½“å‰å„æ¨¡å‹ä¿¡æ¯ã€‚ SFTï¼ˆSupervised finetuningï¼‰â—† è¿™ä¸€é˜¶æ®µçš„ç®—æ³•ä¸å˜ï¼Œåªæ˜¯æ•°æ®é›†æ”¹æˆäº† 1-10 ä¸‡æ•°é‡çš„é«˜è´¨é‡&quot;prompt+response&quot;çš„é—®ç­”ç¤ºä¾‹ï¼Œä»¥å‘ assistant model çš„æ–¹å‘è®­ç»ƒã€‚â—† è®­ç»ƒç»“æœæ¨¡å‹ç§°ä¸º SFT modelã€‚ RLHFï¼ˆreinforcement learning from human feedback ï¼‰â–¡ RLHF ç”± Reward modeling å’Œ Reinforcement learning ä¸¤ä¸ªé˜¶æ®µç»„æˆã€‚â–¡ Reward modeling é˜¶æ®µçš„æ•°æ®é›†é‡çº§åœ¨ 10-100 ä¸‡ï¼Œå†…å®¹æ˜¯ï¼šä¸Šé˜¶æ®µ SFT model å¯¹åŒä¸€ä¸ª prompt å›ç­”çš„å¤šæ¬¡ response+äººä¸ºæŒ‡å®šçš„æ•ˆæœåˆ†æ•°æ’åºã€‚ä»¥æ­¤æŒ‡å¯¼æ¨¡å‹èƒ½é’ˆå¯¹ä¸€ä¸ª prompt ç»™ç›¸åº”çš„ response æ‰“åˆ†ã€‚æ­¤é˜¶æ®µå¾—åˆ°çš„æ¨¡å‹ç§°ä¸º RM modelã€‚â–¡ Reinforcement learning é˜¶æ®µçš„æ•°æ®é›†é‡çº§åœ¨ 1-10 ä¸‡ï¼Œå†…å®¹æ˜¯ï¼šprompt+SFT model çš„å¤šæ¬¡å›ç­”+RM model å¯¹ç›¸åº”å›ç­”çš„æ‰“åˆ†ã€‚ä»¥æ­¤å¼ºåŒ–æ¨¡å‹é’ˆå¯¹ prompt ç»™å‡ºåˆ†æ•°æ›´é«˜çš„ responseã€‚â–¡ ç»è¿‡ RLHF å¾—åˆ°çš„æ¨¡å‹ç§°ä¸º RLHF modelã€‚ChatGPT å°±å±äº RLHF modelã€‚â–¡ RLHF æé«˜äº†æ¨¡å‹çš„ç»“æœåˆ†æ•°ä½†ä¹Ÿä½¿å…¶ä¸§å¤±äº†éƒ¨åˆ†å¤šæ ·æ€§(variation)ï¼Œäºæ˜¯åœ¨å·²çŸ¥ N ä¸ªç›®æ ‡è¾“å‡ºæ ·ä¾‹å¹¶æœŸæœ›å¾—åˆ°å…·æœ‰æ›´å¤šå¤šæ ·æ€§è¾“å‡ºçš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ base modelã€‚â–¡ https://lmsys.org ç½‘ç«™æä¾›äº†å¤§è¯­è¨€æ¨¡å‹(LLM)çš„ç«æŠ€åœº(https://chat.lmsys.org/)ï¼Œå¹¶ä¼šå®šæœŸå‘å¸ƒæ’åç»“æœåˆ°blog(å¦‚ï¼šhttps://lmsys.org/blog/2023-12-07-leaderboard/)ï¼Œç›®å‰æ’åé å‰çš„æ¨¡å‹éƒ½æ˜¯RLHF modelã€‚ å®è·µä¸­å¦‚ä½•æœ‰æ•ˆä½¿ç”¨ GPT assistantâ–  ä¸åŒäºäººç±»ä»é—®é¢˜åˆ°ç­”æ¡ˆçš„æ€ç»´è¿‡ç¨‹ï¼Œtransformer çš„&quot;think&quot;æ˜¯ tokens ç»´åº¦çš„ï¼Œå®ƒå¾—å‡ºç­”æ¡ˆçš„è¿‡ç¨‹æ˜¯ä¸æ–­å¾—åŸºäºç°æœ‰ token(s) é¢„æµ‹ä¸‹ä¸ª tokenã€‚å› æ­¤ï¼Œå½“é—®é¢˜çš„å›ç­”éœ€è¦æ¨ç†æ—¶ï¼Œé€šè¿‡å°†é—®é¢˜æ‹†åˆ†æ­¥éª¤(Chain-of-Thought)çš„æ–¹å¼å‡å°‘é—®é¢˜ä¸­æ¯ä¸ª token éœ€è¦æ¨ç†çš„æ•°é‡ï¼Œèƒ½å¾—åˆ°æ›´å¥½çš„ç­”æ¡ˆã€‚æ‹†åˆ†æ–¹å¼æœ‰ä¸¤ç§ï¼šï¼ˆ1ï¼‰prompt ä¸­æŒ‰ç…§æ‹†åˆ†æ­¥éª¤çš„æ–¹å¼æä¾›ä¸€ç»„é—®ç­”æ ·ä¾‹ï¼ˆ2ï¼‰prompt ä¸­è¯´æ˜&quot;åˆ†æ­¥éª¤æ€è€ƒ&quot;(â€œthink step by stepâ€) â–  å½“ç”Ÿæˆç­”æ¡ˆæœŸé—´å¦‚æœæœ‰ä¸€ä¸ª token åç¦»äº†é—®é¢˜ï¼Œtransformer ä¸ä¼šè¿”å›æ£€æŸ¥çº æ­£è€Œæ˜¯ç»§ç»­åŸºäºå·²ç”Ÿæˆ token ç»§ç»­ç”Ÿæˆåç»­å†…å®¹ã€‚ä½†å¯ä»¥é€šè¿‡å¸¦ä¸Šå†å²é—®ç­”å†…å®¹é‡æ–°æé—®ä¸Šæ¬¡å›ç­”æ˜¯å¦æ»¡è¶³æé—®éœ€æ±‚ä½¿å®ƒå¯¹ä¸Šæ¬¡å›ç­”æ£€æŸ¥å¹¶è¿”å›çº æ­£åçš„å›ç­”ã€‚ç›®å‰æœ‰ç§°ä¸º&quot;Tree of Thoughts&quot;æ–¹å‘çš„ç ”ç©¶ï¼Œç›®çš„æ˜¯å°†è®¸å¤š prompts ä¸æ ‘æ£€ç´¢ç®—æ³•ç»“åˆä»¥åŠ¨æ€å¾—åˆ°æœ€ä¼˜çš„ç”Ÿæˆç­”æ¡ˆä»è€Œé¿å…å‡ºç°éœ€è¦çº æ­£çš„æƒ…å†µã€‚ â–  LLM çš„&quot;å¿ƒç†ç™–å¥½&quot;ï¼šLLM ä»…å€¾å‘äºæ¨¡ä»¿æ‰€æœ‰ç›¸å…³è®­ç»ƒæ•°æ®ç”Ÿæˆå®Œæ•´ç­”æ¡ˆè€Œä¸ä¼šå¯¹è®­ç»ƒæ•°æ®ä¸­ä¸åŒçº§åˆ«çš„ç­”æ¡ˆåšåŒºåˆ†ï¼Œæ¯”å¦‚å¯¹äºä¸€ä¸ªç‰©ç†é—®é¢˜ï¼Œè®­ç»ƒæ•°æ®ä¸­é€šå¸¸æ—¢æœ‰ä¸“å®¶çº§åˆ«çš„ç­”æ¡ˆä¹Ÿæœ‰å­¦ç”Ÿçº§åˆ«çš„ç­”æ¡ˆç”šè‡³è¿˜æœ‰å¼€ç©ç¬‘çš„ç­”æ¡ˆï¼ŒLLM é»˜è®¤ä¼šåŒæ—¶æ¨¡ä»¿æ‰€æœ‰çº§åˆ«çš„ç­”æ¡ˆï¼Œè¿™æ—¶å¯é€šè¿‡è®¾ç½®â€œLet&#39;s work this out in a step by step way to be sure we have the right answer.â€ã€â€œYou&#39;re a leading expert on this topic.â€ã€â€œPretend you have IQ 120.â€è¿™æ ·çš„ prompt æ¥æ’é™¤å¯¹ä½è´¨é‡ç­”æ¡ˆçš„æ¨¡ä»¿ã€‚â–  ä¸º LLM æŒ‡å®šå¯ä»¥ä½¿ç”¨çš„ tools(or plugin) çš„åœºæ™¯ä¸­ï¼Œåœ¨ prompt ä¸­å‘Šè¯‰ LLM ä¸æ“…é•¿å¯¹åº” tool çš„èƒ½åŠ›å¯ä»¥è®© tool çš„è°ƒç”¨æ›´å‡†ç¡®ï¼Œå› ä¸º LLM å¹¶ä¸çŸ¥é“å®ƒè‡ªå·±ä¸æ“…é•¿çš„æ–¹é¢ã€‚â–  æ£€ç´¢å¢å¼º(retrieval-augmented)çš„ LLMï¼ŒLLM åªæœ‰ä»è®­ç»ƒæ•°æ®å¾—æ¥çš„çŸ¥è¯†è®°å¿†(memory)ï¼Œå¦‚æœå°†æ£€ç´¢å¾—åˆ°çš„æé—®ç›¸å…³ä¿¡æ¯æ”¾å…¥ LLM çš„ä¸Šä¸‹æ–‡çª—å£(å¯ç§°ä¸º working memory)å°±å¯ä»¥åŒæ—¶å‘æŒ¥ä¸¤è€…ä¼˜åŠ¿å¾—åˆ°æ›´å¥½çš„ç­”æ¡ˆã€‚å½“å‰å‡ºç°çš„æ–¹æ¡ˆæ˜¯å°†ä¿¡æ¯åˆ†å—åå­˜å…¥å‘é‡å­˜å‚¨(å¦‚ LlamaIndex)ï¼Œé’ˆå¯¹æé—®å…ˆæ£€ç´¢å¾—åˆ°ç›¸å…³ä¿¡æ¯å†å°†å…¶ç»„ç»‡æˆ promptã€‚â–  åœ¨å¸Œæœ›é™åˆ¶ LLM æŒ‰ç…§å›ºå®šæ¨¡æ¿æ ¼å¼è¾“å‡ºç»“æœçš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨guidanceã€‚â–  finetuning çš„æœ¬è´¨æ˜¯æ›´æ–°æ¨¡å‹çš„å‚æ•°æƒé‡ï¼Œæ¶‰åŠæ›´å¤šä¸“ä¸šæŠ€æœ¯ï¼Œå·²çŸ¥ä¼˜åŒ–ç­–ç•¥ä¸ç›¸å…³å·¥å…·ï¼šï¼ˆ1ï¼‰Parameter Efficient Finetuning(PEFT)ã€‚PEFT æ˜¯æ·±åº¦å­¦ä¹ é¢†åŸŸçš„ä¸€ç§ä¼˜åŒ–ç­–ç•¥ï¼Œç›®æ ‡æ˜¯åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­å°½å¯èƒ½å‡å°‘éœ€è¦æ›´æ–°çš„å‚æ•°æ•°é‡ï¼Œè€Œè®©æ¨¡å‹çš„å¤§éƒ¨åˆ†å‚æ•°æƒé‡å›ºå®šï¼Œä»è€Œå¤§å¹…é™ä½ finetuning æˆæœ¬ã€‚å·¥å…·å¦‚ï¼šLoRAã€‚ï¼ˆ2ï¼‰Low-precision inference(ä½ç²¾åº¦æ¨ç†)ã€‚ä½ç²¾åº¦æ¨ç†æ˜¯æ·±åº¦å­¦ä¹ é¢†åŸŸçš„ä¸€ç§ä¼˜åŒ–ç­–ç•¥ï¼Œé€šè¿‡é™ä½æ¨¡å‹æƒé‡å’Œæ¿€æ´»çš„ç²¾åº¦ï¼Œå‡å°‘æ¨¡å‹çš„å†…å­˜å ç”¨å’Œè®¡ç®—éœ€æ±‚è€Œæé«˜è¿è¡Œé€Ÿåº¦ï¼Œåœ¨æ¨¡å‹è®­ç»ƒ&#x2F;å¾®è°ƒå®Œæˆåä½¿ç”¨ã€‚ç»“åˆå‰é¢ PEFT åªé’ˆå¯¹å¾®è°ƒéƒ¨åˆ†åšä½ç²¾åº¦æ¨ç†ä¹Ÿå¯é™ä½è®¡ç®—æˆæœ¬ã€‚å·¥å…·å¦‚ï¼šbitsandbytesã€‚â–  ç›®å‰çš„ LLM é€‚åˆåº”ç”¨åœ¨ä¸äººä¸ºç›‘ç£ç›¸ç»“åˆçš„ä½é£é™©é¢†åŸŸï¼Œå¦‚çµæ„Ÿã€å»ºè®®ã€copilotã€‚ æ¥è‡ª GPT-4 çš„æ¿€åŠ±"},{"title":"AFFiNEçº¯å‰ç«¯è°ƒè¯•ç¯å¢ƒæ­å»º","date":"2024-04-29T10:10:17.000Z","path":"practice/AFFiNEçº¯å‰ç«¯è°ƒè¯•ç¯å¢ƒæ­å»º.html","tags":[{"name":"AFFiNE","slug":"AFFiNE","permalink":"https://congzhou09.github.io/tags/AFFiNE/"}],"text":"åœºæ™¯â—‡ AFFiNE é¡¹ç›®åŒ…å«äº†å‰ç«¯å’Œåç«¯çš„ä»£ç ã€‚æƒ³è¦åœ¨æœ¬åœ°ä»…è°ƒè¯• web å‰ç«¯ä»£ç (åŒ…æ‹¬ Cloud Workspace çš„å†…å®¹)ï¼Œè€Œæ— éœ€é…ç½®ä¸å¯åŠ¨å…¶ä¸­çš„åç«¯éƒ¨åˆ†ã€‚ å®ç°æ–¹å¼â— é¡¹ç›® package.json æ–‡ä»¶æä¾›çš„ dev è„šæœ¬å·²ç»æä¾›äº†äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢æ¥å¯åŠ¨æœ¬åœ° web å¼€å‘æœåŠ¡ï¼Œå…¶é»˜è®¤è¿æ¥çš„åç«¯æ˜¯ http://localhost:3010ï¼Œå°†è¿æ¥ç›®æ ‡æ”¹ä¸ºå®˜æ–¹ç½‘å€(https://app.affine.pro/)å¯¹åº”çš„åç«¯ã€‚ æ“ä½œæ­¥éª¤ä¿®æ”¹æœ¬åœ° web å¼€å‘æœåŠ¡çš„é…ç½®â—† é¡¹ç›® dev è„šæœ¬è¿è¡Œçš„æ˜¯é¡¹ç›®å†…çš„ @affine&#x2F;cli åŒ…ï¼Œå®ƒçš„é…ç½®æ–‡ä»¶ä½äºï¼š&quot;tools\\cli\\src\\webpack\\config.ts&quot;ã€‚â—† å°†é…ç½®æ–‡ä»¶å†…å®¹ä¸­æ‰€æœ‰çš„&quot;target: &#39;http://localhost:3010&#39;&quot;æ”¹ä¸º&quot;target: &#39;https://app.affine.pro/&#39;&quot;ï¼Œå¹¶æ·»åŠ &quot;changeOrigin: true&quot;å’Œ&quot;secure: false&quot;ã€‚â—† ä¾‹å¦‚å…¶ä¸­çš„{context: &#39;&#x2F;socket.io&#39;, ...}è¿™æ¡ï¼Œä¿®æ”¹åå¦‚ä¸‹ã€‚ 1234567&#123; context: &#x27;/socket.io&#x27;, target: &#x27;https://app.affine.pro/&#x27;, changeOrigin: true, secure: false, ws: true,&#125;, å¯åŠ¨æœ¬åœ° web å¼€å‘æœåŠ¡â–  è¿è¡Œ&quot;yarn dev&quot;å¯åŠ¨æœ¬åœ° web å¼€å‘æœåŠ¡ã€‚â–  æµè§ˆå™¨è¿›å…¥æœ¬åœ°å¼€å‘é¡µé¢ï¼šhttp://localhost:8080ã€‚ åœ¨å®˜æ–¹ç½‘ç«™ä¸Šç™»å½•â— è¦ä½¿ç”¨&quot;Cloud Workspace&quot;æ¶‰åŠåˆ°ç¬¬ä¸‰æ–¹ç½‘ç«™çš„ç™»å½•é‰´æƒï¼Œç”±äºå®˜æ–¹ç½‘ç«™åç«¯ API ç™»å½•æˆåŠŸåçš„é‡å®šå‘åœ°å€æ˜¯å®˜æ–¹ç½‘ç«™çš„åœ°å€ï¼Œæ‰€ä»¥ç™»å½•æµç¨‹æ— æ³•åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒå®Œæˆã€‚æ‰‹åŠ¨åœ¨å®˜æ–¹ç½‘ç«™(https://app.affine.pro/)ä¸Šå®Œæˆç™»å½•ã€‚â— ç™»å½•æˆåŠŸå¹¶è¿›å…¥&quot;Cloud Workspace&quot;ä¹‹åï¼Œæ‹·è´å½“å‰ç½‘å€ä¸­çš„è·¯å¾„ï¼Œå¦‚ï¼š&quot;https://app.affine.pro/workspace/xx-xx-xx/all&quot;å¯¹åº”çš„è·¯å¾„æ˜¯&quot;/workspace/xx-xx-xx/all&quot;ã€‚â— æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹å·²ç™»å½•å®˜æ–¹ç½‘ç«™ä¸‹çš„ cookie å­—æ®µï¼šaffine_sessionã€‚ æ‹·è´å®˜ç½‘èº«ä»½ä¿¡æ¯åˆ°æœ¬åœ°â–² å°†ä¸ŠèŠ‚ä¸­ affine_session å­—æ®µåŠå€¼åˆ›å»ºä¸æ‹·è´åˆ°æœ¬åœ° cookieï¼Œå…¶ä¸­çš„ domain å€¼ä½¿ç”¨ä¸æœ¬åœ°å¼€å‘é¡µé¢ç›¸åŒçš„&quot;localhost&quot;ã€‚ â–² åœ¨æœ¬åœ°ç¯å¢ƒè®¿é—®ä¸ŠèŠ‚è·¯å¾„ï¼Œå¦‚ï¼š&quot;http://localhost:8080/workspace/xx-xx-xx/all&quot;ï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸å®˜ç½‘ç›¸åŒçš„å†…å®¹å¹¶è°ƒè¯•å‰ç«¯ä»£ç äº†ã€‚"},{"title":"GitHubçš„workflowä¸­cloneç§æœ‰ä»“åº“","date":"2024-04-18T11:44:40.000Z","path":"practice/GitHubçš„workflowä¸­cloneç§æœ‰ä»“åº“.html","tags":[{"name":"GitHub","slug":"GitHub","permalink":"https://congzhou09.github.io/tags/GitHub/"},{"name":"workflow","slug":"workflow","permalink":"https://congzhou09.github.io/tags/workflow/"}],"text":"åœºæ™¯â—‡ GitHub çš„é¡¹ç›® A ä¸­ï¼ŒæŸä¸ªå­æ–‡ä»¶å¤¹éœ€ä»å¦ä¸€ä¸ªç§æœ‰é¡¹ç›® B é€šè¿‡ git clone å¾—åˆ°ï¼Œæœ‰äº†è¿™ä¸ªå­æ–‡ä»¶å¤¹ï¼Œé¡¹ç›® A çš„ workflow ä¸­æŸ step æ‰èƒ½æ­£ç¡®æ‰§è¡Œã€‚ å®ç°æ–¹å¼â—† ä½¿ç”¨ workflow æä¾›çš„ actions&#x2F;checkout@v4 æ¥ clone ä»£ç ï¼Œä¸ºå…¶æŒ‡å®šé‰´æƒ token ä»¥å®ç°å¯¹ç§æœ‰ä»“åº“çš„è®¿é—®ã€‚ æ“ä½œæ­¥éª¤é‰´æƒ token çš„è·å–â–  è¿›å…¥å¯¹é¡¹ç›® B æœ‰è®¿é—®æƒé™çš„ GitHub ç”¨æˆ·çš„ Settings é¡µé¢ã€‚â–  è¿›å…¥ Developer Settings-&gt;Presonal access tokens-&gt;Tokens(classic)èœå•ï¼Œåˆ›å»ºä¸€ä¸ª&quot;personal access token (classic)&quot;ï¼ŒæœŸé—´æŒ‡å®šæœ‰æ•ˆæœŸï¼Œä»¥åŠå‹¾é€‰ clone é¡¹ç›® B æ‰€éœ€æƒé™ç›¸å…³çš„ scopesã€‚ é…ç½® token åˆ°é¡¹ç›® Aâ–  è¿›å…¥é¡¹ç›® A çš„ Settings é¡µé¢ã€‚â–  è¿›å…¥ Security-&gt;Secrets and variables-&gt;Actions èœå•ï¼Œé€šè¿‡&quot;New repository secret&quot;æŒ‰é’®åˆ›å»ºä¸€ä¸ª secretï¼ŒæœŸé—´çš„ Secret å†…å®¹å¡«å†™ä¸Šä¸€æ­¥çš„ token å€¼ã€‚ workflow é…ç½® clone é¡¹ç›® Bâ–  ç›¸åº” workflow çš„ yaml é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨ä¾èµ–äºå­æ–‡ä»¶å¤¹çš„ step ä¹‹å‰å¢åŠ ä¸€ä¸ª clone é¡¹ç›® B ä»£ç åˆ°å­æ–‡ä»¶å¤¹çš„ stepï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼Œå°†å…¶ä¸­çš„&lt;&gt;å€¼æ›¿æ¢ä¸ºçœŸå®å€¼ã€‚ 1234567891011- ...other steps ...- name: Clone private repository uses: actions/checkout@v4 with: repository: &lt;organization or personal space&gt;/&lt;repository name&gt; ref: &lt;branch name&gt; token: $&#123;&#123;secrets.&lt;secret name&gt;&#125;&#125; path: &lt;destination folder name of the git clone&gt;- ...other steps ..."},{"title":"ä»æŠ€æœ¯è§’åº¦çœ‹emojiè¡¨æƒ…","date":"2023-07-13T01:09:23.000Z","path":"knowledge/ä»æŠ€æœ¯è§’åº¦çœ‹emojiè¡¨æƒ….html","tags":[{"name":"web","slug":"web","permalink":"https://congzhou09.github.io/tags/web/"}],"text":"æ¦‚è§ˆâ—‹ emoji æ˜¯ä¸ªå½¢çŠ¶å›¾å½¢ï¼Œé€šå¸¸ä»¥å½©è‰²å¡é€šæ–¹å¼å±•ç°ï¼Œå†…å®¹æ¶µç›–è¡¨æƒ…ã€å¤©æ°”ã€é£Ÿç‰©ã€åŠ¨æ¤ç‰©ã€äº¤é€šå»ºç­‘ç­‰å¤šç§ç±»åˆ«ã€‚emoji èƒ½å†…åµŒåœ¨æ–‡å­—æ®µè½ä¸­ï¼Œæ‹“å®½äº†æ–‡å­—è¡¨è¾¾çš„ç•Œé™ã€‚â—‹ emoji æœ€æ—©äº 1999 å¹´å‡ºç°åœ¨æ—¥æœ¬ç§»åŠ¨ç”µè¯ä¸­ï¼Œâ€œemojiâ€è¿™ä¸ªè¯æºè‡ªæ—¥è¯­ï¼šçµµ (ãˆ â‰… picture) æ–‡å­— (ã‚‚ã˜ â‰… written character)ã€‚â—‹ emoji çš„å†…éƒ¨è¡¨ç¤ºæ–¹å¼æœ‰ä»¥ä¸‹ä¸¤ç§ã€‚ä½¿ç”¨å­—ä½“å­—å½¢æ–¹å¼æ—¶ä¸å…¶ä»–å­—ç¬¦ä¸€æ ·é€šè¿‡ç¼–ç è®©å­—ä½“å»è§£æä¸å±•ç¤ºï¼Œæ­¤æ—¶çš„ emoji æ›´ç¡®åˆ‡å¾—ç§°ä¸º&quot;emoji å­—ç¬¦&quot;ã€‚ï¼ˆ1ï¼‰å†…ç½®å›¾å½¢&lt;graphics&gt;æ–¹å¼ã€‚æ¯ä¸ª emoji å¯¹åº”ä¸€ä¸ªå›¾åƒæ•°æ®ã€‚ï¼ˆ2ï¼‰å­—ä½“å­—å½¢&lt;glyphs&gt;æ–¹å¼ã€‚æ¯ä¸ª emoji å¯¹åº”ä¸€ç§ç¼–ç ã€‚â—‹ éšç€ emoji åœ¨ä¸–ç•ŒèŒƒå›´å†…çš„æµè¡Œï¼Œä¸åŒå¹³å°å‚å•†çš„ emoji æ— æ³•äº’é€šçš„é—®é¢˜æ¶Œç°ï¼Œä½¿å¾—ç»Ÿä¸€ emoji é›†åˆä¸å­—ç¬¦ç¼–ç çš„éœ€æ±‚ä¸æ–­å¢åŠ ï¼ŒUnicode è”ç›Ÿäº 2007 å¹´é€šè¿‡äº†åœ¨ Unicode å­—ç¬¦é›†é‡Œæ‰©å±• emoji å­—ç¬¦çš„ææ¡ˆï¼Œ2009 å¹´å‘å¸ƒçš„ Unicode 5.2 é¦–æ¬¡æ˜ç¡®æ·»åŠ äº†ç¬¬ä¸€æ‰¹ä½œä¸º emoji å­—ç¬¦çš„ Unicode å­—ç¬¦ï¼Œä¹‹åä¸æ–­æœ‰æ–°æ‰¹æ¬¡çš„ emoji å­—ç¬¦éšç€ Unicode çš„æ–°ç‰ˆæœ¬è¢«æ·»åŠ è¿›å»ã€‚â—‹ ä» 2018 å¹´çš„&quot;Emoji 11.0&quot;å¼€å§‹ï¼Œemoji å­—ç¬¦é›†ç‰ˆæœ¬å·ä¸ Unicode Standard ä½¿ç”¨ç›¸åŒç‰ˆæœ¬å·åŒæ­¥å‘å¸ƒã€‚ â—‹ è¿™ä¸ªè¡¨æ ¼è¯¦ç»†åˆ—å‡ºäº†æ¯ä¸ªç‰ˆæœ¬åˆ†åˆ«æ–°å¢äº†å“ªäº› emojiã€‚â—‹ é€šå¸¸è¯´çš„å­—ç¬¦ç¼–ç æ˜¯å­—ç¬¦åœ¨ Unicode å­—ç¬¦é›†å†…è¢«åˆ†é…çš„ä¸€ä¸ªå”¯ä¸€çš„ç¼–ç æ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼ç§°ä¸ºä»£ç ç‚¹ï¼ˆcode pointï¼‰ã€‚ä»£ç ç‚¹é€šå¸¸ç”¨ 16 è¿›åˆ¶è¡¨ç¤ºï¼Œå¦‚ emoji ç¬‘è„¸çš„ä»£ç ç‚¹æ˜¯ U+1F600 ã€‚â—‹ è¿™ä¸ªç½‘ç«™ emojipedia å¯ç”¨äºæŸ¥çœ‹ emoji è¡¨æƒ…çš„ä»£ç ç‚¹ç»„æˆã€‚â—‹ emoji å­—ç¬¦æ¶‰åŠå¦‚ä¸‹å›¾ä¸­ 6 ä¸ªç›¸å…³å±æ€§ã€‚ â—‹ ä¸Šè¿°ç›¸å…³å±æ€§ï¼Œä¸€ä¸ª emoji å­—ç¬¦å¯èƒ½åŒæ—¶æœ‰å¤šä¸ªå±æ€§å€¼ä¸º Yes ï¼Œç›¸åº”å­—ç¬¦ä¹Ÿæœ‰å¯¹åº”çš„åç§°ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰emoji characterã€‚å…·æœ‰â€œEmojiâ€å±æ€§çš„å­—ç¬¦ï¼Œè¿™ç±»å­—ç¬¦é€šå¸¸ç›´æ¥å±•ç¤º emoji å†…å®¹ã€‚ï¼ˆ2ï¼‰emoji presentationã€‚å…·æœ‰â€œEmoji_Presentationâ€å±æ€§çš„å­—ç¬¦ï¼Œé»˜è®¤ä»¥å¤šå½©å›¾å½¢çš„ emoji æ–¹å¼å±•ç¤ºè€Œä¸æ˜¯æ–‡æœ¬æ–¹å¼ã€‚ä¸æ­¤å±æ€§ç›¸å…³æœ‰ä¸¤ä¸ªå˜ä½“é€‰æ‹©å™¨å­—ç¬¦ VARIATION SELECTOR-15(U+FE0E) å’Œ VARIATION SELECTOR-16(U+FE0F) åˆ†åˆ«ç”¨äºæ˜¾å¼æŒ‡å®šå‰é¢å­—ç¬¦çš„å‘ˆç°æ–¹å¼ä¸ºæ–‡æœ¬æˆ–å¤šå½©å›¾å½¢ã€‚ä¸¤ç§å±•ç¤ºæ–¹å¼çš„æœ€å¤§å·®åˆ«æ˜¯ï¼šæ–‡æœ¬æ–¹å¼å±•ç¤ºä¸ºå•è‰²ä¸”å¯ç”±å­—ä½“é¢œè‰²æ§åˆ¶å˜è‰²ï¼Œè€Œå¤šå½©å›¾å½¢æ–¹å¼è‰²å½©å¤šæ ·ä¸”ä¸å—å­—ä½“é¢œè‰²æ§åˆ¶ã€‚ï¼ˆ3ï¼‰emoji modifierã€‚å…·æœ‰â€œEmoji_Modifierâ€å±æ€§çš„å­—ç¬¦ï¼Œç”¨äºä¿®æ”¹å‰é¢çš„ emoji å­—ç¬¦çš„å¤–è§‚æˆ–è¯­ä¹‰(å¦‚è‚¤è‰²ã€æ€§åˆ«)ã€‚ï¼ˆ4ï¼‰emoji modifier baseã€‚å…·æœ‰â€œEmoji_Modifier_Baseâ€å±æ€§çš„å­—ç¬¦ï¼Œåªæœ‰è¿™äº›å­—ç¬¦æ‰æ”¯æŒè¢«éšåçš„ emoji modifier ä¿®æ”¹ã€‚ï¼ˆ5ï¼‰extended pictographic characterã€‚å…·æœ‰â€œExtended_Pictographicâ€å±æ€§çš„å­—ç¬¦ï¼Œè¯¥å±æ€§æä¾›äº†å­—ç¬¦åˆ†å‰²çš„è§„åˆ™ä¿¡æ¯ï¼Œç¡®ä¿ emoji åºåˆ— â†“ è¿™ç§è¢«å¤šä¸ªä»£ç ç‚¹ç»„æˆçš„ emoji è¡¨æƒ…èƒ½åœ¨åˆ†è¯æ—¶è¢«æ­£ç¡®åˆ†å‰²ã€‚ï¼ˆ6ï¼‰emoji componentã€‚å…·æœ‰â€œEmoji_Componentâ€å±æ€§çš„å­—ç¬¦ï¼Œç”¨äºç»„æˆ emoji åºåˆ—ï¼Œè¿™ç±»å­—ç¬¦å¯èƒ½æ˜¯ emoji character ä¹Ÿå¯èƒ½è‡ªèº«ä¸ç‹¬ç«‹å±•ç¤º emoji å†…å®¹ç”šè‡³åªæ˜¯ä¸ªæ™®é€šåŸºç¡€å­—ç¬¦ã€‚ä¾‹å¦‚é”®å¸½è¡¨æƒ…ç¬¦å· 1ï¸âƒ£ çš„åºåˆ—ç»„æˆæ˜¯ U+31 å’Œ U+FE0F å’Œ U+20E3ï¼Œå¯¹ç…§ emoji-data å¯çŸ¥ä¸‰ä¸ªå­—ç¬¦éƒ½æ˜¯ emoji componentï¼Œè€Œå…¶ä¸­ U+31 å¯¹åº”çš„æ•°å­— 1 æ˜¯ä¸ªåŸºç¡€å­—ç¬¦ã€‚å†å¦‚ä¸­å›½å›½æ—— ğŸ‡¨ğŸ‡³ çš„åºåˆ—ç»„æˆæ˜¯ U+1F1E8 å’Œ U+1F1F3ï¼Œä¸¤ä¸ªåœ°åŒºæ ‡å¿—(Regional Indicator)å­—ç¬¦åŒå±äº emoji component å’Œ emoji character å’Œ emoji presentationã€‚å†å¦‚å¥³ç§‘å­¦å®¶ ğŸ‘©â€ğŸ”¬ çš„åºåˆ—ç»„æˆæ˜¯ U+1F469 å’Œ U+200D å’Œ U+1F52Cï¼Œå…¶ä¸­ç¬¬ä¸€ç¬¬ä¸‰ä¸ªå­—ç¬¦åŒæ—¶æ˜¯ emoji character å’Œ extended pictographic characterï¼Œè€Œç¬¬äºŒä¸ªå­—ç¬¦ä»…æ˜¯ emoji componentã€‚â—‹ emoji å­—ç¬¦é›†ç‰ˆæœ¬å·æœ‰ä¸‰ä¸ªç‰¹æ®Šå€¼ï¼šE0.0 å’Œ E0.6 å’Œ E0.7ã€‚å…¶ä¸­ E0.0 åŒ…å«äº†æ‰€æœ‰ç‰ˆæœ¬çš„ emoji å­—ç¬¦é›†é‡Œçš„ emoji component å’Œé emoji character å­—ç¬¦ã€‚E0.6 å’Œ E0.7 åˆ†åˆ«åŒ…å«äº†å½“åˆæ·»åŠ åˆ° Unicode 6.0 å’Œ Unicode 7.0 çš„ emoji å­—ç¬¦ï¼Œå½“æ—¶çš„ emoji å­—ç¬¦é›†æ²¡æœ‰è‡ªå·±çš„ç‰ˆæœ¬å·ã€‚ æ˜¾ç¤ºå¤–è§‚â–  Unicode å­—ç¬¦é›†é‡Œå®šä¹‰çš„åŸå§‹ emoji æ˜¯ä¸‹å›¾è¿™ç§é»‘ç™½æœ´ç´ æ ·å¼ï¼ˆéœ€å°†é“¾æ¥æŒ‡å‘çš„ *.txt æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå†ä½¿ç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ï¼‰ã€‚ â–  ä¸å…¶ä»– Unicode å­—ç¬¦ä¸€æ ·ï¼ŒåŒä¸€ä¸ª emoji ç”±äºæ‰€ç”¨å­—ä½“ä¸åŒå¯ä»¥å±•ç¤ºä¸ºä¸åŒçš„æ ·å¼ã€‚emoji çš„æ ·å¼åˆ†ä¸º&quot;text presentation&quot;å’Œ&quot;emoji presentation&quot;ä¸¤å¤§ç±»ï¼Œè¿™åœ¨å‰é¢ emoji å­—ç¬¦çš„ emoji presentation å±æ€§éƒ¨åˆ†æœ‰é™ˆè¿°ã€‚â–  å¹³æ—¶æ›´ç»å¸¸çœ‹åˆ°çš„å„ç§å¤šå½©å›¾å½¢æ ·å¼æ˜¯å„å¹³å°å‚å•†è®¾è®¡ä¸æä¾›çš„ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹åˆ°åŒä¸€ä¸ª emoji åœ¨ä¸åŒå¹³å°å‚å•†çš„å¤–è§‚ã€‚â–  æ˜¾ç¤ºå¼‚å¸¸æƒ…å†µï¼šå½“å±•ç¤º emoji çš„å¹³å°æ‰€æ”¯æŒ Unicode ç‰ˆæœ¬ä½äºæŸä¸ª emoji å­—ç¬¦æ‰€åœ¨ç‰ˆæœ¬ï¼Œè¿™ä¸ªå­—ç¬¦å°†æ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚ emoji åºåˆ—ï¼ˆemoji Sequencesï¼‰â™‚ emoji æ ‡å‡†ä¸­å­˜åœ¨å¤šç§åºåˆ—ï¼Œè¿™äº›åºåˆ—ç”±ä¸¤ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ç»„æˆï¼Œæ¯ä¸ªåºåˆ—å±•ç¤ºä¸ºä¸€ä¸ªæ–°çš„å•ç‹¬çš„è¡¨æƒ…ç¬¦ã€‚â™‚ emoji å­—ç¬¦ä¸å˜ä½“é€‰æ‹©å™¨å­—ç¬¦(è§ä¸Šæ–‡)ç»„æˆçš„åºåˆ—ç§°ä¸ºå‘ˆç°åºåˆ—(emoji presentation sequence)ã€‚â™‚ emoji modifier base ä¸ emoji modifier ç»„æˆçš„åºåˆ—ç§°ä¸ºä¿®é¥°åºåˆ—(emoji modifier sequence)ã€‚â™‚ ç”±ä¸¤ä¸ª regional indicator character ç»„æˆçš„åºåˆ—ç§°ä¸ºæ——å¸œåºåˆ—(emoji flag sequence)ã€‚â™‚ ç”±è¡¨æƒ…å­—ç¬¦å’Œæ ‡ç­¾å­—ç¬¦ç»„æˆçš„åºåˆ—ç§°ä¸ºæ ‡ç­¾åºåˆ—(emoji tag sequence)ã€‚å¯ç”¨äºç»„æˆæ ‡ç­¾åºåˆ—çš„å­—ç¬¦åœ¨è¿™é‡Œå®šä¹‰ã€‚â™‚ ç”±[0-9#*]å­—ç¬¦å’Œé”®å¸½å­—ç¬¦(U+FE0F å’Œ U+20E3)ç»„æˆçš„åºåˆ—ç§°ä¸ºé”®å¸½åºåˆ—(emoji keycap sequence)ã€‚â™‚ é€šè¿‡ ZWJ ç»„åˆæˆçš„åºåˆ—ç§°ä¸º ZWJ åºåˆ—ã€‚ZWJ æ˜¯ Zero Width Joinerï¼ˆé›¶å®½è¿æ¥å™¨ï¼‰çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸ªç‰¹æ®Šçš„ Unicode ä¸å¯è§å­—ç¬¦ï¼Œç¼–ç ä¸º U+200Dã€‚â™‚ emoji ZWJ åºåˆ—å°±æ˜¯é€šè¿‡ ZWJ å­—ç¬¦è¿æ¥å·²æœ‰ emoji å­—ç¬¦å½¢æˆçš„ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªåˆæˆçš„ emoji å­—ç¬¦ã€‚â™‚ ä¸¾ä¾‹ï¼šğŸ‘©â€ğŸ”¬ï¼ˆå¥³ç§‘å­¦å®¶ï¼‰æ˜¯ç”±å¥³æ€§ç¬¦å·ï¼ˆğŸ‘©ï¼‰å’Œå®éªŒå®¤è®¾å¤‡ç¬¦å·ï¼ˆğŸ”¬ï¼‰é€šè¿‡ ZWJ è¿æ¥è€Œæˆã€‚â™‚ è¿™é‡Œåˆ—å‡ºäº†å½“å‰æ‰€æœ‰ emoji ZWJ åºåˆ—ã€‚â™‚ å› æ­¤æˆ‘ä»¬çœ‹åˆ°çš„ä¸€ä¸ª emoji å›¾åƒçš„èƒŒåå¯èƒ½åŒ…å«äº†å¤šä¸ª Unicode å­—ç¬¦ã€‚â™‚ emoji åºåˆ—çš„å­˜åœ¨ä½¿å¾—ç»Ÿè®¡ emoji æ•°é‡å˜å¾—ä¸å®¹æ˜“ï¼Œè¿‘æœŸå­—ç¬¦é›†ç‰ˆæœ¬éƒ½æä¾›äº† emoji counts è¡¨æ ¼ï¼Œä»¥15.0 ç‰ˆæœ¬çš„ emoji counts è¡¨æ ¼ä¸ºä¾‹ï¼Œå…¶ä»è¡¨æƒ…åˆ†ç±»ä¸å®ç°ç»“æ„ä¸¤ä¸ªç»´åº¦åšäº†æ•°é‡ç»Ÿè®¡ï¼Œå®ç°ç»“æ„ç»´åº¦çš„æœ¯è¯­è§£é‡Šåœ¨è¿™é‡Œã€‚ è‚¤è‰²çš„å®ç°â™€ å¯¹äºå±•ç¤ºäººç‰©å’Œèº«ä½“éƒ¨ä½çš„ emojiï¼Œæœ€åˆè®¡åˆ’æ˜¯åƒç¬‘è„¸é‚£æ ·ä½¿ç”¨ä¸€è‡´çš„éç°å®è‚¤è‰²(é»„è‰²æˆ–æ©™è‰²)ã€‚éšç€è‚¤è‰²éœ€æ±‚çš„å¢åŠ ï¼Œ2015 å¹´å‘å¸ƒçš„ Unicode Version 8.0 ä¸­å¢åŠ äº†å¦‚ä¸‹ 5 ä¸ªä¿®é¥°å­—ç¬¦(symbol modifier character)ã€‚ â™€ å…¶ä¸­çš„æ ·ä¾‹é¢œè‰²æ˜¯åŸºäºåä¸º Fitzpatrick scaleï¼ˆè²èŒ¨å¸•ç‰¹é‡Œå…‹è‚¤è‰²åˆ†ç±»æ³•ï¼‰çš„çš®è‚¤å­¦æ ‡å‡†åˆ¶å®šçš„ï¼Œè€Œä¸”æä¾›äº†ç›¸åº”çš„ç°åº¦è‰²ç”¨äºé€‚åº”é»‘ç™½è‰²ç¯å¢ƒã€‚â™€ è¿™å‡ ä¸ª modifier å­—ç¬¦å¯ç‹¬ç«‹æ˜¾ç¤ºï¼Œæ­¤æ—¶å±•ç¤ºå†…å®¹æ˜¯æ ·ä¾‹é¢œè‰²æ–¹å—ã€‚å½“æ”¾åœ¨ç‰¹å®šçš„ emoji å­—ç¬¦ä¹‹åæ—¶ï¼Œåˆ™ç»„æˆä¸€ä¸ªä¿®é¥°åºåˆ—(emoji modifier sequence)ï¼Œå±•ç¤ºå¯¹åº”è‚¤è‰²çš„ emoji å†…å®¹ã€‚â™€ å¸¸è§æ”¯æŒæ¢è‚¤è‰²çš„ emoji ç§ç±»æœ‰äººç‰©ã€èº«ä½“éƒ¨ä½ã€èŒä¸šã€è¿åŠ¨ï¼Œä»å­—ç¬¦å±æ€§ä¸Šçœ‹æ˜¯å‰é¢æåˆ°çš„ emoji modifier base å­—ç¬¦ï¼Œæ ‡å‡†è§„èŒƒä¸­å°†å®ƒä»¬ç»Ÿç§°ä¸º&quot;human emoji&quot;(éæ­£å¼æœ¯è¯­)ã€‚å½“ human emoji åé¢æ²¡æœ‰ emoji modifier æ—¶åˆ™å±•ç¤ºä¸ç¬‘è„¸ä¸€æ ·çš„éç°å®è‚¤è‰²ã€‚â™€ å®é™…åº”ç”¨ä¸­çš„å¸¦è‚¤è‰² emoji é€šå¸¸æ˜¯ç›´æ¥é€‰æ‹©çš„ï¼Œè€Œæ— éœ€å…ˆé€‰ human emoji å†é€‰ emoji modifierã€‚ åˆ†ç±»ä¸é¡ºåºâ–³ emoji å­—ç¬¦é»˜è®¤çš„åˆ†ç±»å’Œé¡ºåºå®šä¹‰åœ¨ Unicode çš„ CLDR ä¸­ã€‚CLDR(Common Locale Data Repository)æ˜¯ç”¨äºæä¾›å…¨çƒåŒ–å’Œæœ¬åœ°åŒ–æ•°æ®çš„å¼€æ”¾æ ‡å‡†ã€‚â–³ åˆ†ç±»å’Œé¡ºåºè¯¦æƒ…æä¾›åœ¨è¿™é‡Œã€‚ åç§°ä¸æ£€ç´¢å…³é”®è¯â™¥ ä¸å…¶ä»– Unicode å­—ç¬¦ä¸€æ ·ï¼Œæ¯ä¸ª emoji å­—ç¬¦éƒ½æœ‰ä¸ªæ­£å¼åç§°(formal Unicode name)ï¼Œè¿™ä¸ªåç§°æ˜¯å­—ç¬¦é›†å†…å”¯ä¸€çš„ä¸”ä¸ä¼šéšç‰ˆæœ¬å˜æ›´ï¼Œå³ä½¿éšç€å‘å±•æœ€æ–°å«ä¹‰ä¸æœ€åˆåç§°å‡ºç°äº†åå·®ï¼Œæ¯”å¦‚ ğŸ’ƒ(U+1F483)çš„æ­£å¼åç§°æ˜¯ DANCERï¼Œç°åœ¨çš„å«ä¹‰ woman dancing æ˜¯éšç€ ğŸ•º(man dancing)çš„åŠ å…¥è€Œå˜åŒ–çš„ã€‚æ­£å¼åç§°é€šå¸¸ä¹¦å†™ä¸ºå…¨å¤§å†™å­—æ¯ã€‚â™¥ æ¯ä¸ª emoji å­—ç¬¦æœ‰ä¸ª CLDR çŸ­åç§°(CLDR short name)ï¼Œé€šè¿‡å•è¯æˆ–çŸ­è¯­æè¿° emoji çš„å«ä¹‰æˆ–ç‰¹å¾ã€‚CLDR çŸ­åç§°ä¼šéšç€æ–°ç‰ˆæœ¬åšå¿…è¦çš„å˜æ›´ã€‚â™¥ emoji åºåˆ—ç”±äºå…¶å®ç°åŸç†æ˜¯å¤šä¸ªå­—ç¬¦çš„ç»„åˆï¼Œå› æ­¤å°±åªæœ‰ CLDR çŸ­åç§°è€Œæ²¡æœ‰æ­£å¼åç§°ã€‚â™¥ CLDR çŸ­åç§°åœ¨ CLDR ä¸­ä¹Ÿè¢«ç§°ä¸º TTS å(text-to-speech name)ã€‚â™¥ CLDR æ˜¯å¤šè¯­è¨€çš„ï¼Œå†…å®¹ç»´æŠ¤åœ¨ GitHub ä¸”æä¾›äº†å¤šç§æ•°æ®æ ¼å¼ï¼Œå¦‚ xml å’Œ jsonï¼ŒçŸ­åç§°ä¸æ£€ç´¢å…³é”®è¯(keywords)ä½äºå…¶ä¸­çš„ &quot;annotations&quot; æ–‡ä»¶å¤¹ï¼Œä»¥è¯­è¨€åç¼©å†™ä½œä¸ºå­è·¯å¾„æˆ–æ–‡ä»¶åï¼Œå¦‚ä¸­æ–‡çš„ json æ–‡ä»¶è·¯å¾„æ˜¯ï¼š&quot;cldr-json&#x2F;cldr-annotations-full&#x2F;annotations&#x2F;zh&#x2F;annotations.json&quot;ã€‚â™¥ CLDR ä¹Ÿæä¾›äº†åœ¨çº¿å·¥å…·survey-toolï¼Œåœ¨é¡µé¢å·¦ä¾§å…ˆé€‰æ‹©è¯­è¨€å†é€‰æ‹© Characters-&gt;åˆ†ç±»å°±å¯ä»¥çœ‹åˆ°åˆ†ç±»ä¸‹å„ä¸ª emoji è¡¨æƒ…çš„çŸ­åç§°å’Œæœç´¢å…³é”®è¯äº†ã€‚ æ¨èé¡¹ç›®â–² GitHub ä¸Šçš„ emoji-mart å®ç°äº† emoji è¡¨æƒ…é€‰æ‹©å™¨ï¼Œæ”¯æŒå›¾ç‰‡ä¸ Unicode å­—ç¬¦ä¸¤ç§æ–¹å¼ï¼Œé€‚åˆä½œä¸ºå¼€å‘ emoji è¡¨æƒ…ç›¸å…³å†…å®¹çš„å‚è€ƒã€‚ å‚è€ƒæ–‡çŒ®â—‡UnicodeÂ® Technical Standard - Unicode Emoji"},{"title":"åŠ¨æ€importå¼•èµ·çš„æ‰“åŒ…ä½“ç§¯å¢å¤§","date":"2023-03-21T07:24:23.000Z","path":"problem/åŠ¨æ€importå¼•èµ·çš„æ‰“åŒ…ä½“ç§¯å¢å¤§.html","tags":[{"name":"webpack","slug":"webpack","permalink":"https://congzhou09.github.io/tags/webpack/"}],"text":"èƒŒæ™¯â—† æ­£å¸¸æƒ…å†µä¸‹ webpack çš„ç¼–è¯‘æ˜¯ä»å…¥å£æ–‡ä»¶å¼€å§‹æŒ‰ç…§æ¨¡å—ä¾èµ–å…³ç³»ä»…å¯¹è¢«ä¾èµ–çš„æ–‡ä»¶åšç¼–è¯‘çš„ã€‚ä»Šå¤©åœ¨æŸé¡¹ç›®é‡Œå¢åŠ äº†ä¸ªæ¨¡å—æ–‡ä»¶å†™åˆ°ä¸€åŠä¿å­˜è€Œè¿˜æ²¡å¯¹å…¶åš import ï¼Œä½†æ­¤æ—¶ webpackDevServer å°±å·²ç»æŠ¥å‡ºè¿™ä¸ªæ¨¡å—å†…çš„è¯­æ³•é”™è¯¯äº†ã€‚ è§£å†³ä¸æ€»ç»“â—‡ æ ¹æ®å †æ ˆä¿¡æ¯è¿½åˆ°å†ä¸Šä¸€çº§çš„æŠ¥é”™ä½ç½®ï¼Œæ¥åˆ°ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼Œç”±äºæŠŠåŠ¨æ€ import å°è£…åˆ°å‡½æ•°ï¼Œä¼ å…¥å‡½æ•°çš„å€¼æ˜¯ä¸ªå˜é‡ã€‚ 12345... ...function importFromPath(pathName) &#123; ... ... return import(`$&#123;pathName&#125;`);&#125; â—‡ æ ¹æ®webpack æ–‡æ¡£çš„è¯´æ˜å¹¶ç»“åˆè¯•éªŒå‘ç°ï¼Œæ­¤ç§æƒ…å†µä¸‹ï¼Œè¯¥æ–‡ä»¶åŒå±‚çº§åŠä»¥ä¸‹å±‚çº§ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¼šè¢«çº³å…¥ webpack çš„ç¼–è¯‘ä¸æ‰“åŒ…èŒƒå›´ï¼Œä»è€Œå¯¼è‡´äº†ä¸Šè¿°é—®é¢˜ã€‚ â—‡ éšç€é¡¹ç›®é‡çº§å¢åŠ ï¼Œå½“æœ‰æ›´å¤šä¸åœ¨ä¾èµ–å…³ç³»æ ‘ä¸Šçš„æ–‡ä»¶é€šè¿‡æ­¤æœºåˆ¶è¢«å¼•å…¥åå°±ä¼šå¼•èµ·æ•´ä½“æ‰“åŒ…é€Ÿåº¦å˜æ…¢å’Œæ‰“åŒ…ä½“ç§¯å¢å¤§ã€‚æ‰€å¹¸ webpack é’ˆå¯¹ import()é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ chunk å°†å…¶åˆ†ç¦»åˆ°å•ç‹¬çš„ bundle ï¼Œä¸ä¼šåœ¨æ‰“åŒ…ç»“æœéƒ¨ç½²åè¿˜å½±å“å…¶ä»–æ¨¡å—çš„è½½å…¥é€Ÿåº¦ã€‚ â—‡ webpack æä¾›äº†magic-commentsç”¨äºé…ç½®å¤„ç†åŠ¨æ€ import()çš„è¡Œä¸ºã€‚å…¶ä¸­çš„&quot;webpackInclude&quot;èƒ½é™å®šæœç´¢åŠ¨æ€æ¨¡å—çš„èŒƒå›´ï¼Œå¯ä»¥è§£å†³æˆ‘çš„é—®é¢˜ã€‚ â—‡ å› æ­¤åœ¨ webapck ä¸­ä½¿ç”¨&quot;import(å˜é‡)&quot;æ—¶æœ€å¥½å¢åŠ &quot;webpackInclude&quot;æ³¨é‡Šï¼Œä»¥é˜²æ­¢æ— å…³æ–‡ä»¶å¯¹æ‰“åŒ…çš„å½±å“ã€‚"},{"title":"Base64ç¼–ç ä¸DataUrl","date":"2022-12-31T13:58:56.000Z","path":"knowledge/Base64ç¼–ç ä¸DataUrl.html","tags":[{"name":"Base64","slug":"Base64","permalink":"https://congzhou09.github.io/tags/Base64/"},{"name":"DataUrl","slug":"DataUrl","permalink":"https://congzhou09.github.io/tags/DataUrl/"}],"text":"Base64 ç¼–ç â—‡ Base64 æ˜¯ä¸ªäºŒè¿›åˆ¶è½¬æ–‡æœ¬çš„ç¼–ç æ–¹æ¡ˆï¼Œå®ƒå°†æ¯ 3 ä¸ª 8bit æ•°æ®è¡¨ç¤ºä¸º 4 ä¸ªä½¿ç”¨ 6bit ç¼–ç çš„ Base64 å­—ç¬¦ã€‚â—‡ Base64 æ˜¯ Base ç¼–ç çš„ä¸€ç§ï¼Œå…¶ä»– Base ç¼–ç å¦‚ï¼šBase16ã€Base32ï¼Œ&quot;Base&quot;åçš„æ•°å­—è¶Šå°ï¼Œç”¨æ¥ç¼–ç çš„å­—ç¬¦æ•°é‡è¶Šå°‘ã€‚â—‡ Base ç¼–ç çš„ä½¿ç”¨åœºæ™¯æ˜¯åœ¨æŸäº›ä»…æ”¯æŒæ–‡æœ¬(ç”šè‡³ä»…æ”¯æŒæœ‰é™æ•°é‡çš„æ–‡æœ¬å­—ç¬¦)çš„ç¯å¢ƒä¸­å­˜å‚¨æˆ–ä¼ è¾“æ•°æ®ã€‚â—‡ Base ç¼–ç è§„åˆ™è¯¦ç»†å®šä¹‰åœ¨ RFC4648ã€‚â—‡ Base64 ç¼–ç çš„ 6 ä¸ª bit ä½ï¼ŒäºŒè¿›åˆ¶å€¼ä» 000000 åˆ° 111111 åˆ†åˆ«ç¼–ç ä¸ºå­—ç¬¦â€œA-Zâ€ï¼Œâ€œa-zâ€ï¼Œâ€œ0-9â€ï¼Œâ€œ+â€ï¼Œâ€œ&#x2F;â€ ã€‚å¦å¤–æœ‰ä¸ª padding å­—ç¬¦â€œ&#x3D;â€ï¼Œå½“æœ«å°¾ bit ç»„é•¿åº¦ä¸å¤Ÿ 24bit çš„æ—¶å€™ï¼Œç”¨ä¸€ä¸ªæˆ–ä¸¤ä¸ªâ€œ&#x3D;â€æ ‡è¯†ç¼–ç å‰ç¼ºå°‘å‡ ä¸ª 8bit æ‰å¤Ÿ 24bitï¼Œä»è€Œåœ¨è§£ç æ—¶èƒ½æ­£ç¡®è§£ç â€œ&#x3D;â€å‰çš„é‚£ä¸ªå­—ç¬¦ã€‚â—‡ ç»¼ä¸Šå¯å¾— Base64 ç¼–ç ç»“æœæœ‰å¦‚ä¸‹ç‰¹æ€§ï¼šï¼ˆ0ï¼‰Base64 ç¼–ç ç»“æœä¸­æœ€å¤šæœ‰ 65 ç§å­—ç¬¦ã€‚ï¼ˆ1ï¼‰â€œ&#x3D;â€å­—ç¬¦åªå¯èƒ½å‡ºç°åœ¨ç¼–ç ç»“æœæœ«å°¾ï¼Œæ•°é‡ä¸ä¼šè¶…è¿‡ä¸¤ä¸ªã€‚ï¼ˆ2ï¼‰ç¼–ç ç»“æœçš„å­—ç¬¦æ•°é‡æ˜¯ 4 çš„å€æ•°ã€‚ï¼ˆ3ï¼‰ç¼–ç åçš„ç»“æœå­—ç¬¦å¦‚æœä½¿ç”¨ ASCII ç¼–ç å­˜å‚¨æˆ–å±•ç¤ºï¼Œç”±äºæ¯ä¸ª ASCII å­—ç¬¦å ç”¨ 8bit ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ç”¨æ¯ 8bit å­˜å‚¨åŸæ¥æ•°æ®çš„ 6bitï¼Œæ‰€ä»¥å ç”¨å­˜å‚¨ç©ºé—´å¤§çº¦æ˜¯åŸæ•°æ®çš„ 8&#x2F;6&#x3D;4&#x2F;3 å€ã€‚ Base64 ç¤ºä¾‹ç¤ºä¾‹ 1â˜† å¾…ç¼–ç æ•°æ®æ˜¯ç”¨ ASCII ç¼–ç çš„â€œManâ€å¯¹åº”çš„äºŒè¿›åˆ¶æ•°æ® â— ç¼–ç å‰æ•°æ®çš„äºŒè¿›åˆ¶å†…å®¹å¦‚ä¸‹å›¾ã€‚ â— å°†æ¯ 24bit åˆ†æˆ 6bit ç»„ï¼Œæ¯ä¸ª 6bit ç»„ä½¿ç”¨ Base64 å­—ç¬¦è¡¨ç¤ºå¦‚ä¸‹ï¼Œå¯å¾—â€œTWFuâ€ã€‚ ç¤ºä¾‹ 2â˜† å¾…ç¼–ç æ•°æ®æ˜¯ç”¨ ASCII ç¼–ç çš„â€œManaâ€å¯¹åº”çš„äºŒè¿›åˆ¶æ•°æ® â— ç¼–ç å‰äºŒè¿›åˆ¶æ•°æ®æ˜¯ç¤ºä¾‹ 1 äºŒè¿›åˆ¶å†…å®¹åæ¥â€œ01100001â€ã€‚â— å°†æ¯ 24bit åˆ†æˆ 6bit ç»„ï¼Œç¬¬ 1 ä¸ª 24bit ç»„ä¸ç¤ºä¾‹ 1 ä¸€è‡´ã€‚ç¬¬ 2 ä¸ª 24bit ç»„ä¸­ç¬¬ 1 ä¸ª 6bit ç»„æ˜¯â€œ011000â€å¯¹åº”å­—ç¬¦â€œYâ€ï¼Œç¬¬ 2 ä¸ª 6bit ç»„æ˜¯â€œ01â€æœ«å°¾å¡«å…… 0 å¾—åˆ°â€œ010000â€å¯¹åº”å­—ç¬¦â€œQâ€ã€‚ç”±äºç¬¬ 2 ä¸ª 24bit ç»„åªæœ‰ 8bitï¼Œè¿˜å·®ä¸¤ä¸ª 8bit æ‰å¤Ÿ 24bitï¼Œæ‰€ä»¥ä½¿ç”¨ä¸¤ä¸ª padding å­—ç¬¦æ ‡è¯†ã€‚æœ€ç»ˆç¼–ç å°±æ˜¯â€œTWFuYQ&#x3D;&#x3D;â€ã€‚ JS ä¸­çš„ Base64 ç¼–ç â—‹ JS æä¾›äº† btoa() å‡½æ•°ç”¨äºå°†äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¸º Base64 å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚è°ƒç”¨ btoa(&quot;Mana&quot;)å¯å¾—åˆ°&quot;TWFuYQ&#x3D;&#x3D;&quot;ï¼Œå³ä¸Šè¿°ç¤ºä¾‹ 2 çš„ç»“æœã€‚å¦å¤–æœ‰ atob()å‡½æ•°æ‰§è¡Œç›¸åæ“ä½œã€‚â—‹ btoa() å‡½æ•°å°†è¾“å…¥å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦å½“åš 1 å­—èŠ‚äºŒè¿›åˆ¶æ•°æ®å¤„ç†ï¼Œå¦‚æœè¾“å…¥å­—ç¬¦ä¸²ä¸­åŒ…å«æœ‰æ•ˆé•¿åº¦è¶…è¿‡ 1 å­—èŠ‚çš„å­—ç¬¦ï¼Œå°±ä¼šæŠ¥å¼‚å¸¸é”™è¯¯ã€‚â—‹ JS çš„å­—ç¬¦æ˜¯é€šè¿‡ UTF-16 ç¼–ç çš„ï¼Œæ¯ä¸ªå­—ç¬¦å  2 å­—èŠ‚ç©ºé—´ï¼Œå…¶ä¸­çš„ ASCII å­—ç¬¦è™½ç„¶ä¹Ÿå  2 å­—èŠ‚ï¼Œä½†ä»…ç¬¬ 1 ä¸ªå­—èŠ‚å†…æ˜¯æœ‰æ•ˆå†…å®¹ï¼Œç¬¬äºŒä¸ªå­—èŠ‚å…¨é›¶ï¼Œæ‰€ä»¥ btoa()å¤„ç† ASCII å­—ç¬¦ä¸ä¼šæŠ¥å¼‚å¸¸ã€‚â—‹ å¯ä»¥é€šè¿‡ä»¥ä¸‹è¡¨è¾¾å¼å–å€¼é•¿åº¦æ˜¯å¦å¤§äº 2 åˆ¤æ–­æŸå­—ç¬¦æœ‰æ•ˆé•¿åº¦æ˜¯å¦è¶…è¿‡ 1 å­—èŠ‚ã€‚ 1&lt;string&gt;.charCodeAt(0).toString(16) DataUrlâ™‚ Base64 ç¼–ç çš„ä¸€ä¸ªåº”ç”¨åœºæ™¯æ˜¯åœ¨ HTML æˆ– CSS æ–‡ä»¶ä¸­å†…åµŒå›¾ç‰‡ã€SourceMap ç­‰äºŒè¿›åˆ¶èµ„æºï¼Œå†…åµŒé€šè¿‡ DataUrl å®ç°ã€‚â™‚ DataUrl æ˜¯ç§ç‰¹æ®Šçš„ urlï¼Œå®ƒå°†æ•°æ®å†…å®¹ç›´æ¥åµŒå…¥åœ¨ url é‡Œè€Œä¸éœ€è¦é¢å¤–çš„å¤–éƒ¨æ–‡ä»¶ã€‚å®ƒä»¥&quot;data:&quot;å¼€å¤´ï¼ŒåŒ…å«å¦‚ä¸‹ 4 ä¸ªéƒ¨åˆ†ã€‚ 1data:[&lt;mediatype&gt;][;base64],&lt;data&gt; â™‚ å…¶ä¸­ &lt;mediatype&gt; æ˜¯ä¸€ä¸ª MIME ç±»å‹å­—ç¬¦ä¸²ï¼Œæ ‡è¯† data å†…å®¹çš„æ ¼å¼ï¼Œå–å€¼å¦‚â€œimage&#x2F;jpegâ€ï¼Œâ€œapplication&#x2F;x-www-form-urlencodedâ€ï¼Œå¦‚æœçœç•¥åˆ™æŒ‰ç…§â€œtext&#x2F;plain;charset&#x3D;US-ASCIIâ€å¤„ç†ã€‚â™‚ å½“æœ‰â€œ;base64â€æ—¶è¡¨ç¤º data æ˜¯ç»è¿‡ Base64 ç¼–ç çš„ã€‚ DataUrl ç¤ºä¾‹ç¤ºä¾‹ 1â˜† webpack çš„ devtool é…ç½®é¡¹ â–  devtool é…ç½®é¡¹çš„â€œinline-â€å’Œâ€œeval-â€ä¸¤ä¸ªå‰ç¼€çš„å«ä¹‰æ˜¯å°† SourceMap åµŒå…¥åœ¨æ‰“åŒ…æ–‡ä»¶ä¸­ã€‚â–  â€œinline-â€æ–¹å¼ï¼Œä»¥â€œinline-source-mapâ€ä¸ºä¾‹ï¼Œæ¯ä¸ª bundle å¯¹åº”ä¸€ä¸ª SourceMapï¼Œé™„åŠ åˆ°æ•´ä¸ª bundle æ–‡ä»¶çš„æœ«å°¾ã€‚â–  â€œeval-â€æ–¹å¼ï¼Œä»¥â€œeval-source-mapâ€ä¸ºä¾‹ï¼Œæ¯ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ª SourceMapï¼Œé™„åŠ åˆ°æ¯ä¸ªæ¨¡å— eval åŒ…è£¹å†…éƒ¨çš„æœ«å°¾ã€‚æ­¤ç§æƒ…å†µä¸‹ï¼ŒäºŒæ¬¡ç¼–è¯‘æ—¶èƒ½åšåˆ°æ¨¡å—çº§ SourceMap çš„å•ç‹¬æ›¿æ¢ï¼Œå› æ­¤åœ¨ webpack dev rebuild æ—¶æ›´æœ‰é€Ÿåº¦ä¼˜åŠ¿ã€‚ ç¤ºä¾‹ 2â˜† webpack çš„ url-loader â–  url-loader çš„ â€œoptionsâ€ æä¾›äº†ä¸€ä¸ª â€œlimitâ€ é…ç½®é¡¹ï¼Œå½“æ–‡ä»¶å¤§äºè¿™ä¸ªé…ç½®é¡¹å€¼æ—¶æ‰§è¡Œ file-loader çš„è¡Œä¸ºï¼Œå¦åˆ™ä¾¿å°†èµ„æºè½¬æ¢æˆ DataUrl åµŒå…¥åˆ°å¼•å…¥ä½ç½®ã€‚â–  url-loader å’Œ file-loader è‡ª webpack5 èµ·è¢«â€œmodule.rules.typeâ€é…ç½®é¡¹æ›¿ä»£ã€‚ ç¤ºä¾‹ 3â˜† å ç”¨ç©ºé—´æœ€å°çš„ base64 å›¾ç‰‡çš„ DataUrl â–  web é¡µé¢ä¸­æœ‰æ—¶éœ€è¦ä¸€ä¸ªæœ‰æ•ˆçš„ å…ƒç´ å ä½ï¼Œé€šå¸¸å°†å…¶ src å±æ€§è®¾ç½®ä¸ºå¦‚ä¸‹ DataUrl å†…å®¹ã€‚ 1data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw== â–  è¿™ä¸ªå­—ç¬¦ä¸²ä¸­çš„ Base64 ç¼–ç å†…å®¹æ˜¯ä¸€ä¸ª 1x1 åƒç´ çš„é€æ˜ GIF å›¾ç‰‡çš„æ•°æ®ã€‚ å‚è€ƒæ–‡çŒ®â—† Base64 wikiâ—† MDN Data URLsâ—† webpack devtool"},{"title":"é˜¿é‡Œä½ä»£ç å¼€æºé¡¹ç›®å­¦ä¹ -é¡¹ç›®åˆè¯†","date":"2022-06-27T13:05:08.000Z","path":"knowledge/é˜¿é‡Œä½ä»£ç å¼€æºé¡¹ç›®å­¦ä¹ -é¡¹ç›®åˆè¯†.html","tags":[{"name":"ä½ä»£ç ","slug":"ä½ä»£ç ","permalink":"https://congzhou09.github.io/tags/%E4%BD%8E%E4%BB%A3%E7%A0%81/"}],"text":"æ¦‚å¿µå…±è¯†â—»ï¸ ä½ä»£ç å¹³å°çš„ç»„æˆéƒ¨åˆ†ï¼šç‰©æ–™ä½“ç³»ã€ä½ä»£ç è®¾è®¡å™¨ã€å·¥ç¨‹åŒ–ä½“ç³»(å¦‚é…ç½®çš„å­˜å–ã€ç‰ˆæœ¬çš„ç®¡ç†ã€äº§ç‰©çš„æ‰“åŒ…å‘å¸ƒ)ã€‚â—»ï¸ ä½ä»£ç è®¾è®¡å™¨ï¼šä½ä»£ç å¹³å°æä¾›çš„ç”¨äºå¯è§†åŒ–æ­å»ºé¡µé¢æˆ–æ¨¡å—çš„åœ°æ–¹ï¼Œé€šå¸¸å°±åœ¨å¹³å°çš„&quot;&#x2F;edit&quot;é¡µé¢ã€‚æ˜¯ä½ä»£ç å¹³å°çš„æ ¸å¿ƒã€‚â—»ï¸ ä½ä»£ç å¼•æ“ï¼šç”¨äºç ”å‘ä½ä»£ç è®¾è®¡å™¨çš„æ¡†æ¶ï¼Œä½œç”¨æ˜¯å¸®åŠ©ä½ä»£ç å¹³å°å¼€å‘è€…å¿«é€Ÿäº§å‡ºè‡ªå®šä¹‰çš„ä½ä»£ç è®¾è®¡å™¨ã€‚æ€»ç»“ä¸ºä¸¤ç‚¹,ï¼ˆ1ï¼‰å®ç°äº†ä½ä»£ç è®¾è®¡å™¨åŸºç¡€åŠŸèƒ½;ï¼ˆ2ï¼‰æä¾›äº†å®šåˆ¶æ‰©å±•èƒ½åŠ›ã€‚â—»ï¸ é˜¿é‡Œä½ä»£ç å¼•æ“æä¾›çš„å®šåˆ¶æ‰©å±•èƒ½åŠ›ä½“ç°åœ¨å¦‚ä¸‹å‡ ä¸ªæ–¹é¢ï¼šç‰©æ–™ã€æ’ä»¶ã€è®¾ç½®å™¨ã€‚ â—»ï¸ ä½ä»£ç è®¾è®¡å™¨æ’ä»¶æ˜¯è®¾è®¡å™¨ä¸­çš„è‡ªå®šä¹‰æŒ‰é’®å’Œå›¾æ ‡ï¼Œæ”¯æŒä¸¤ç§å½¢å¼ï¼šï¼ˆ1ï¼‰PanelDockï¼Œå±•ç¤ºå›¾æ ‡ï¼Œå†…å®¹åœ¨å±•å¼€é¢æ¿ä¸­å±•ç¤ºï¼ˆ2ï¼‰Widgetï¼Œå†…å®¹ç›´æ¥å±•ç¤ºã€‚ æ¶‰åŠåˆ°çš„ä»“åº“â—build-scriptsã€‚é¡¹ç›®ä½¿ç”¨çš„å·¥ç¨‹æ„å»ºè„šæ‰‹æ¶å·¥å…·ï¼ŒåŸºäº webpackï¼ŒåŒ…åè‡ª 1.x ç‰ˆæœ¬èµ·ä»&quot;@alib&#x2F;build-scripts&quot;æ›´åä¸º&quot;build-scripts&quot;ã€‚â— lowcode-engineã€‚ä½ä»£ç å¼•æ“ï¼Œéµå¾ªä½ä»£ç å¼•æ“ç™½çš®ä¹¦ä»‹ç»çš„è®¾è®¡æ€è·¯ã€‚â—lowcode-demoã€‚å°†å¼•æ“ã€è®¾ç½®å™¨ã€æ’ä»¶ã€ç‰©æ–™ç­‰ç»„åˆèµ·æ¥çš„ç¤ºä¾‹å·¥ç¨‹ã€‚â—lowcode-materialsã€‚åŒ…å« Demo ä¸­ä½¿ç”¨çš„ç‰©æ–™åº“(antd, fusion)ã€‚â—lowcode-engine-extã€‚åŒ…å« Demo ä¸­ä½¿ç”¨çš„è®¾ç½®å™¨ã€‚â—lowcode-pluginsã€‚åŒ…å« Demo ä¸­ä½¿ç”¨çš„æ’ä»¶ã€‚ build-scriptsâ–  é€šè¿‡ build-scripts ç»„ç»‡çš„é¡¹ç›®æœ¬è´¨è¿˜æ˜¯ä½¿ç”¨ webpack ç”Ÿæ€(API å‡½æ•°ã€loaderã€pluginã€webpack-dev-server)ã€‚â–  è®¾è®¡æ€è·¯ï¼Œå°†è°ƒè¯•&amp;æ„å»º&amp;æµ‹è¯•æµç¨‹åšäº†å¦‚ä¸‹ä¸‰ä¸ªå±‚çº§çš„æŠ½è±¡ï¼šï¼ˆ1ï¼‰å°†é€šç”¨æµç¨‹åŒ–çš„å†…å®¹å°è£…åˆ° build-scripts å‘½ä»¤è¡Œ(start-å¼€å‘è°ƒè¯• &amp; build-æ‰“åŒ… &amp; test-æµ‹è¯•)ã€‚ï¼ˆ2ï¼‰å°†é’ˆå¯¹ç‰¹å®šåœºæ™¯åŠç‰¹æ€§çš„é€šç”¨é…ç½®ä¸å¤„ç†é€»è¾‘å°è£…åˆ° build-scripts æ’ä»¶ã€‚ï¼ˆ3ï¼‰é€šè¿‡æœ¬åœ°è‡ªå®šä¹‰æ’ä»¶æä¾›é¡¹ç›®ç‰¹æœ‰çš„ä¸ªæ€§åŒ–é…ç½®ã€‚â–  ä»¥ä¸Š(2)(3)ä½“ç°åœ¨ build.json æ–‡ä»¶å†…å®¹ä¸­ã€‚ 1234567891011121314&#123; &quot;entry&quot;: &#123; &quot;preview&quot;: &quot;./src/preview.tsx&quot; &#125;, ... ... &quot;plugins&quot;: [ [ &quot;build-plugin-react-app&quot; ], ... ... &quot;./build.plugin.js&quot; ]&#125; â–  ä»¥ä¸‹æ˜¯å®˜æ–¹æä¾›çš„ build-scripts æ’ä»¶ã€‚æ”¯æŒå‘å¸ƒè‡ªå·±çš„ build-scripts æ’ä»¶ã€‚ â–  build-scripts ä½¿ç”¨ webpack-chain ç®¡ç† webpack é…ç½®ï¼Œæœ€ç»ˆé€šè¿‡ webpack-chain çš„ toConfig()æ–¹æ³•è½¬ä¸ºç¬¦åˆæ ¼å¼è§„åˆ™çš„é…ç½®å†…å®¹ä¼ å…¥å†…éƒ¨ webpack ä½¿ç”¨ã€‚æœ¬åœ°è‡ªå®šä¹‰æ’ä»¶ä¸­ä¿®æ”¹é…ç½®ä¹Ÿé€šè¿‡ç¼–å†™ webpack-chain çš„è¿‡ç¨‹åŒ–è¯­å¥å®ç°ã€‚ä¾‹å¦‚ï¼š 123456789101112131415161718192021222324252627module.exports = (&#123; onGetWebpackConfig, context &#125;) =&gt; &#123; onGetWebpackConfig((config) =&gt; &#123; ... ... // è®¾ç½®alias config.resolve.alias.set(&#x27;@&#x27;, path.resolve(__dirname, &#x27;./src&#x27;)); // ä¿®æ”¹publicPath config.output.publicPath((process.env.PUBLIC_PATH || &#x27;&#x27;) + &#x27;/&#x27;); // å®šä¹‰å¸¸é‡ config.plugin(&#x27;define&#x27;).use(context.webpack.DefinePlugin, [ &#123; &#x27;process.env.DEPLOY_ENV&#x27;: process.env.DEPLOY_ENV, &#125;, ]); // è®¾ç½®webpackDevServerçš„ä»£ç† config.devServer.proxy(&#123; &#x27;/api&#x27;: &#123; target: &#x27;https://api.service.com&#x27;, changeOrigin: true, &#125;, &#125;); ... ... &#125;);&#125; lowcode-engineâ—‹ é¡¹ç›®é€šè¿‡ lerna ç®¡ç†ï¼ŒåŠŸèƒ½æ¨¡å—ä»¥ npm åŒ…çš„å½¢å¼ç»„ç»‡ï¼Œå„ä¸ª npm åŒ…ä½¿ç”¨ build-scripts ç®¡ç†ã€‚â—‹ é¡¹ç›®ä¸»è¦è¾“å‡ºçš„åŒ…æœ‰ä¸‰ä¸ªï¼š@alilc&#x2F;lowcode-engineã€@alilc&#x2F;lowcode-react-rendererã€@alilc&#x2F;lowcode-react-simulator-rendererã€‚â—‹ @alilc&#x2F;lowcode-engine æ˜¯ä½ä»£ç å¼•æ“çš„æ ¸å¿ƒåŒ…ï¼Œä¹Ÿä¼šä¾èµ–é¡¹ç›®ä¸­çš„å…¶ä»–åŒ…ï¼Œå¦‚@alilc&#x2F;lowcode-designerã€@alilc&#x2F;lowcode-editor-coreã€@alilc&#x2F;lowcode-editor-skeletonã€‚æ¨¡å—ä¾èµ–ä¸æ‰€å±åŒ…çš„å…³ç³»å¦‚ä¸‹å›¾ã€‚ â—‹ å„æ¨¡å—ä½œç”¨çš„ç®€è¦è¯´æ˜ï¼š æ¨¡å— ä½œç”¨ pulgins ç”¨äºè®¾è®¡å™¨å®šåˆ¶å†…å®¹(æ’ä»¶ã€è®¾ç½®å™¨ã€ç‰©æ–™)çš„åŠ¨æ€å¼•å…¥ skeleton æ³¨å†Œç®¡ç†æ’ä»¶ setters æ³¨å†Œç®¡ç†è®¾ç½®å™¨ material æ³¨å†Œç®¡ç†ç‰©æ–™ hotkey ç»‘å®šç®¡ç†å¿«æ·é”® event è‡ªå®šä¹‰äº‹ä»¶å¤„ç† project ç®¡ç†ç¼–æ’åŠŸèƒ½ç›¸å…³çš„æ¨¡å‹ç³»ç»Ÿ config è´Ÿè´£é…ç½®çš„è¯»å†™ â—‹ @alilc&#x2F;lowcode-react-renderer æ˜¯ä½ä»£ç è®¾è®¡å™¨äº§ç‰©çš„æ¸²æŸ“ç»„ä»¶ã€‚â—‹ @alilc&#x2F;lowcode-react-simulator-renderer æ˜¯ä½ä»£ç è®¾è®¡å™¨ä¸­çš„ç”»å¸ƒç»„ä»¶ã€‚ lowcode-demoâ–  é¡¹ç›®ä¸»è¦è¾“å‡ºä¸¤ç±»é¡µé¢ï¼šï¼ˆ1ï¼‰å¯è§†åŒ–ç¼–è¾‘é¡µé¢ï¼ˆ2ï¼‰å¯è§†åŒ–ç¼–è¾‘é¡µé¢äº§ç‰©çš„é¢„è§ˆé¡µé¢ã€‚â–  é¡¹ç›®å…¥å£å¦‚ä¸‹ï¼Œé™¤äº† â€œbuild.jsonâ€ ä¸­çš„ preview ä¹‹å¤–ï¼Œè¿˜æœ‰åœ¨â€œbuild.plugin.jsâ€ä¸­åŠ¨æ€å†™å…¥çš„ scenarios æ–‡ä»¶å¤¹ä¸­å„å­æ–‡ä»¶å¤¹ã€‚ 123456789101112131415161718&#123; preview: [ &quot;src/preview.tsx&quot;, // é¢„è§ˆé¡µé¢å…¥å£ ], &quot;antd-pro-with-formily&quot;: [ &quot;src/scenarios/antd-pro-with-formily/index.ts&quot;, ], &quot;basic-antd&quot;: [ &quot;src/scenarios/basic-antd/index.ts&quot;, ], &quot;basic-formily&quot;: [ &quot;src/scenarios/basic-formily/index.ts&quot;, ], ... ... // scenariosæ–‡ä»¶å¤¹ä¸­å„ä¸ªå­æ–‡ä»¶å¤¹ï¼Œå¯¹åº”å„åœºæ™¯çš„ç¼–è¾‘é¡µé¢ index: [ &quot;src/scenarios/index/index.ts&quot;, // ç»¼åˆç¼–è¾‘é¡µé¢ï¼Œæä¾›äº†åœºæ™¯åˆ‡æ¢åŠŸèƒ½ ],&#125; ç¼–è¾‘é¡µé¢â— ç¼–è¾‘é¡µé¢é¦–å…ˆä½¿ç”¨å®˜æ–¹æä¾›çš„æ’ä»¶ã€è®¾ç½®å™¨ã€ç‰©æ–™åº“å¯¹å¼•æ“åšäº†å®šåˆ¶ã€‚å…¶ä¸­åŠ¨æ€å¼‚æ­¥åŠ è½½çš„åœ°æ–¹éƒ½é€šè¿‡ plugins.register() å®ç°ã€‚ 123456789101112131415161718192021222324252627282930/** src/universal/plugin.tsx **/import AliLowCodeEngineExt from &#x27;@alilc/lowcode-engine-ext&#x27;; // å®˜æ–¹è®¾ç½®å™¨import CodeGenPlugin from &#x27;@alilc/lowcode-plugin-code-generator&#x27;;... &#x27;@alilc/lowcode-plugin-xxxx&#x27;;import DataSourcePanePlugin from &#x27;@alilc/lowcode-plugin-datasource-pane&#x27;; // ...å®˜æ–¹æ’ä»¶...const &#123; setterMap, pluginMap &#125; = AliLowCodeEngineExt;setters.registerSetter(setterMap); // æ³¨å†Œè®¾ç½®å™¨...// æ³¨å†Œæ’ä»¶skeleton.add(&#123; name: &#x27;saveSample&#x27;, area: &#x27;topArea&#x27;, type: &#x27;Widget&#x27;, props: &#123; align: &#x27;right&#x27;, &#125;, content: &lt;Button onClick=&#123;() =&gt; saveSchema()&#125;&gt;ä¿å­˜åˆ°æœ¬åœ°&lt;/Button&gt;,&#125;);...// ä»¥èµ„äº§åŒ…çš„æ–¹å¼æ³¨å†Œç‰©æ–™åº“await material.setAssets(await injectAssets(assets));... â— å…¶ä¸­çš„ assets æ˜¯ä½¿ç”¨&quot;èµ„äº§åŒ…&quot;çš„å½¢å¼æè¿°çš„ç‰©æ–™åº“ï¼Œæ ¼å¼éµå¾ªä½ä»£ç å¼•æ“ç‰©æ–™è§„èŒƒï¼Œç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031&#123; &quot;packages&quot;: [ &#123; &quot;package&quot;: &quot;moment&quot;, &quot;version&quot;: &quot;2.24.0&quot;, &quot;urls&quot;: [ &quot;https://g.alicdn.com/mylib/moment/2.24.0/min/moment.min.js&quot; ], &quot;library&quot;: &quot;moment&quot; &#125;, ... ], &quot;components&quot;: [ &#123; &quot;exportName&quot;: &quot;AlilcLowcodeMaterialsMeta&quot;, &quot;npm&quot;: &#123; &quot;package&quot;: &quot;@alilc/lowcode-materials&quot; &#125;, &quot;url&quot;: &quot;https://alifd.alicdn.com/npm/@alilc/lowcode-materials@1.0.2/build/lowcode/meta.js&quot;, &quot;urls&quot;: &#123; &quot;default&quot;: &quot;https://alifd.alicdn.com/npm/@alilc/lowcode-materials@1.0.2/build/lowcode/meta.js&quot;, &quot;design&quot;: &quot;https://alifd.alicdn.com/npm/@alilc/lowcode-materials@1.0.2/build/lowcode/meta.design.js&quot; &#125; &#125;, ... ], &quot;sort&quot;: &#123; &quot;groupList&quot;: [] &#125;, ...&#125; â— æœ€ç»ˆé€šè¿‡@alilc&#x2F;lowcode-engine æä¾›çš„ init()å‡½æ•°å®Œæˆæ¸²æŸ“ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ã€‚ 123456import &#123; init &#125; from &#x27;@alilc/lowcode-engine&#x27;;init(document.getElementById(&#x27;lce-container&#x27;), &#123; ...options,&#125;, preference); é¢„è§ˆé¡µé¢â—‹ é¢„è§ˆé¡µé¢å°†&quot;schema+ç‰©æ–™åº“æè¿°&quot;æ¸²æŸ“æˆé¡µé¢ã€‚å…¶ä¸­ç‰©æ–™åº“æè¿°å°±æ˜¯&quot;èµ„äº§åŒ…&quot;ä¸­çš„â€œpackagesâ€å†…å®¹ï¼Œschema åŒ…å«äº†ç»„ä»¶æ ‘ç»“æ„åŠç›¸å…³é…ç½®ä¿¡æ¯ï¼Œå†…å®¹æ ¼å¼éµå¾ªä½ä»£ç å¼•æ“æ­å»ºåè®®è§„èŒƒï¼Œç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435&#123; &quot;version&quot;: &quot;1.0.0&quot;, &quot;componentsMap&quot;: [ &#123; &quot;package&quot;: &quot;@alifd/pro-layout&quot;, &quot;version&quot;: &quot;1.0.1-beta.6&quot;, &quot;exportName&quot;: &quot;Col&quot;, &quot;main&quot;: &quot;lib/index.js&quot;, &quot;destructuring&quot;: true, &quot;subName&quot;: &quot;&quot;, &quot;componentName&quot;: &quot;NextCol&quot; &#125;, ... ], &quot;componentsTree&quot;: [ &#123; &quot;componentName&quot;: &quot;Page&quot;, &quot;id&quot;: &quot;node_dockcviv8fo1&quot;, &quot;props&quot;: &#123; &quot;ref&quot;: &quot;outerView&quot;, &quot;style&quot;: &#123; &quot;height&quot;: &quot;100%&quot; &#125; &#125;, &quot;fileName&quot;: &quot;/&quot;, ... &quot;children&quot;: [ &#123; &quot;componentName&quot;: &quot;NextPage&quot;, &quot;id&quot;: &quot;node_ockzs2vw431&quot;, &quot;props&quot;: &#123; ... &#125;, &quot;children&quot;: ... &#125; ] &#125; ], &quot;i18n&quot;: &#123;&#125;&#125; â—‹ æœ€ç»ˆæ˜¯é€šè¿‡@alilc&#x2F;lowcode-react-renderer å®Œæˆæ¸²æŸ“ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ã€‚ 123456789import ReactRenderer from &#x27;@alilc/lowcode-react-renderer&#x27;;import ReactDOM from &#x27;react-dom&#x27;;ReactDOM.render(( &lt;ReactRenderer schema=&#123;schema&#125; components=&#123;components&#125; /&gt;), document.getElementById(&#x27;root&#x27;)); å…³äºè®¾è®¡å™¨çš„å®šåˆ¶å®è·µâ–² API æ–‡æ¡£â–² starter é¡¹ç›®ï¼Œè§ç™½çš®ä¹¦ä¸­â€œå®šåˆ¶æ’ä»¶â€ã€â€œå®šåˆ¶è®¾ç½®å™¨â€â€œå®šåˆ¶ç‰©æ–™â€ç« èŠ‚ã€‚"},{"title":"TypeScriptä½¿ç”¨å°è´´å£«","date":"2022-04-25T12:49:46.000Z","path":"handbook/TypeScriptä½¿ç”¨å°è´´å£«.html","tags":[{"name":"TypeScript","slug":"TypeScript","permalink":"https://congzhou09.github.io/tags/TypeScript/"}],"text":"ç¯å¢ƒé…ç½®ç›¸å…³â–  åœ¨è¿˜æœªæ‰‹åŠ¨å®‰è£… TypeScript çš„æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿæˆ– IDE å¾ˆå¯èƒ½å·²ç»è‡ªå¸¦äº† TypeScriptã€‚æ­¤æ—¶åœ¨æ‰‹åŠ¨å®‰è£…äº† TypeScript ä¹‹åå¦‚æœä¸åšç›¸åº”çš„é…ç½®ï¼Œç³»ç»Ÿå‘½ä»¤è¡ŒåŠ IDE å¯èƒ½ä¾æ—§ä½¿ç”¨åŸæœ‰çš„ TypeScriptã€‚ ç³»ç»Ÿå‘½ä»¤è¡Œçš„é…ç½®â–²Windows ç³»ç»Ÿé»˜è®¤åœ¨â€œC:\\Program Files (x86)\\Microsoft SDKs\\TypeScript\\1.0â€ç›®å½•ä¸‹å®‰è£…äº† Typescriptï¼Œä¸”å°†æ­¤è·¯å¾„é…ç½®åˆ°äº†ç³»ç»Ÿ pathã€‚å¯¼è‡´é—®é¢˜ï¼šï¼ˆ1ï¼‰å³ä½¿ npm -g å…¨å±€å®‰è£…äº†æœ€æ–° Typescriptï¼Œè¿è¡Œâ€œtsc --versionâ€è¿”å›çš„ä»ç„¶æ˜¯è€æ—§ç‰ˆæœ¬å·ã€‚ï¼ˆ2ï¼‰tsc å‘½ä»¤è¯¯æŠ¥ï¼š&quot;error TS1005: &#39;;&#39; expected&quot;â–² è§£å†³åŠæ³•æ˜¯å°†ä¸Šè¿°ç›®å½•æ–‡ä»¶å’Œç³»ç»Ÿ path é‡Œé…ç½®çš„è·¯å¾„éƒ½åˆ æ‰ã€‚ IDE çš„é…ç½®â— åœ¨ä»»ä½•ä¸€ä¸ª&quot;*.ts&quot;æ–‡ä»¶ä¸­æŸ¥çœ‹ä¸è·³è½¬åˆ°æŸä¸ªåŸç”Ÿ JS å¯¹è±¡æˆå‘˜å‡½æ•°å®šä¹‰æ‰€åœ¨çš„æ–‡ä»¶ï¼Œå¦‚ Array çš„ find()å‡½æ•°ã€‚é»˜è®¤è·³è½¬åˆ°çš„ç±»å‹å®šä¹‰æ–‡ä»¶ä½äº VSCode çš„å®‰è£…ç›®å½•ä¸‹ã€‚(MacOS ç¯å¢ƒæ˜¯&quot;&#x2F;Applications&#x2F;Visual Studio Code.app&#x2F;Contents&#x2F;Resources&#x2F;app&#x2F;extensions&#x2F;node_modules&#x2F;typescript&#x2F;lib&#x2F;lib.es2015.core.d.ts&quot;) â— å› ä¸ºé€šå¸¸æˆ‘ä»¬åœ¨å„é¡¹ç›®èŒƒå›´å†…å®‰è£…ä¸ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬çš„ TypeScriptï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®šä¸Šè¿° TypeScript ç›®å½•åˆ°å½“å‰é¡¹ç›®çš„ node_modules æ–‡ä»¶å¤¹ã€‚é€šè¿‡ä¸º VSCode æ·»åŠ å¦‚ä¸‹é…ç½®å®ç°ï¼Œä¿å­˜ Reload ä¸‹çª—å£å†æ¬¡æŸ¥çœ‹è·³è½¬å‡½æ•°å®šä¹‰æ‰€åœ¨æ–‡ä»¶è·³è½¬çš„å°±æ˜¯å½“å‰é¡¹ç›®çš„ node_modules æ–‡ä»¶å¤¹äº†ï¼Œä¸”åœ¨ VSCode æ‰“å¼€ ts æ–‡ä»¶çª—å£çš„å³ä¸‹æ–¹çŠ¶æ€æ å¯ä»¥çœ‹åˆ°å½“å‰ TypeScript çš„ç‰ˆæœ¬å·ã€‚ 1&quot;typescript.tsdk&quot;: &quot;node_modules/typescript/lib&quot;, é¡¹ç›®é…ç½®ç›¸å…³Node é¡¹ç›®â—‹ tsconfig.json å†…å®¹æ ·ä¾‹ã€‚ 1234567891011121314&#123; &quot;compilerOptions&quot;: &#123; &quot;target&quot;: &quot;es5&quot;, /* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */ &quot;module&quot;: &quot;commonjs&quot;, /* Specify what module code is generated. */ &quot;rootDir&quot;: &quot;./src&quot;, /* Specify the root folder within your source files. */ &quot;declaration&quot;: true, /* Generate .d.ts files from TypeScript and JavaScript files in your project. */ &quot;sourceMap&quot;: true, /* Create source map files for emitted JavaScript files. */ &quot;outDir&quot;: &quot;./lib&quot;, /* Specify an output folder for all emitted files. */ &quot;esModuleInterop&quot;: true, /* Emit additional JavaScript to ease support for importing CommonJS modules. This enables `allowSyntheticDefaultImports` for type compatibility. */ &quot;forceConsistentCasingInFileNames&quot;: true, /* Ensure that casing is correct in imports. */ &quot;strict&quot;: true, /* Enable all strict type-checking options. */ &quot;skipLibCheck&quot;: true /* Skip type checking all .d.ts files. */ &#125;&#125; â—‹ å®‰è£…@types&#x2F;node ä»¥æ”¯æŒ Node çš„ ts ç±»å‹å®šä¹‰ã€‚ Web é¡¹ç›®â—‹ tsconfig.json å†…å®¹æ ·ä¾‹ã€‚ 123456789101112&#123; &quot;compilerOptions&quot;: &#123; &quot;target&quot;: &quot;es5&quot;, /* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */ &quot;module&quot;: &quot;commonjs&quot;, /* Specify what module code is generated. */ &quot;lib&quot;: [&quot;dom&quot;, &quot;esnext&quot;] /* Specify library files to be included in the compilation. */, &quot;jsx&quot;: &quot;react&quot; /* Specify JSX code generation: &#x27;preserve&#x27;, &#x27;react-native&#x27;, &#x27;react&#x27;, &#x27;react-jsx&#x27; or &#x27;react-jsxdev&#x27;. */, &quot;declaration&quot;: true, /* Generate .d.ts files from TypeScript and JavaScript files in your project. */ &quot;strict&quot;: true, /* Enable all strict type-checking options. */ &quot;forceConsistentCasingInFileNames&quot;: true, /* Ensure that casing is correct in imports. */ &quot;skipLibCheck&quot;: true /* Skip type checking all .d.ts files. */ &#125;&#125; â—‹ react é¡¹ç›®å®‰è£…@types&#x2F;react å’Œ@types&#x2F;react-domã€‚â—‹ ts ä¹¦å†™æ ¼å¼å‚è€ƒã€‚â—‹ react å„åœºæ™¯çš„ ts ä¹¦å†™æ ¼å¼å‚è€ƒï¼ˆreact-typescript-cheatsheetï¼‰ webpack é¡¹ç›®çš„é…ç½®â—»ï¸ æ”¯æŒ ts è¯­æ³•çš„ä¸¤ç§æ–¹å¼ã€‚æ–¹å¼ä¸€ï¼šé€šè¿‡&quot;ts-loader&quot;å®ç°å¯¹ ts æ–‡ä»¶çš„ç±»å‹æ£€æŸ¥ä¸ç¼–è¯‘ã€‚æ–¹å¼äºŒï¼š&quot;babel-loader&quot;é€šè¿‡é…ç½®â€œ@babel&#x2F;preset-typescriptâ€presets ä¹Ÿå¯ä»¥è§£æä¸ç¼–è¯‘ ts è¯­æ³•ã€‚ â—»ï¸ ä¸¤ç§æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šç¬¬äºŒç§æ–¹å¼ï¼Œç”±äº babel ä»…åšè§£æå’Œç¼–è¯‘ï¼Œä¸ä¼šåš ts ç±»å‹æ£€æŸ¥ï¼Œè¿›è€Œä¸ä¼šåœ¨ webpack å‘½ä»¤è¡Œè¾“å‡ºä¸­æŠ¥å‡ºç±»å‹æ£€æŸ¥é”™è¯¯ã€‚å®˜æ–¹è¯¦ç»†è¯´æ˜ã€‚ ç¬¬ä¸‰æ–¹åº“çš„å¼•å…¥â–² ç¬¬ä¸‰æ–¹åº“çš„ ts ç±»å‹å®šä¹‰é€šå¸¸åœ¨åä¸ºâ€œ@types&#x2F;åº“åâ€çš„ npm åŒ…ä¸­ï¼Œå¯é€šè¿‡å‘½ä»¤&quot;npm view @types&#x2F;åº“å&quot;æŸ¥çœ‹è¯¥ npm åŒ…æ˜¯å¦å­˜åœ¨ã€‚è¿™ç§æ–¹å¼æ— éœ€é¢å¤–é…ç½®ï¼ŒTypeScript ä¼šè‡ªåŠ¨è¯»å–â€œnode_modules&#x2F;@typesâ€ç›®å½•ä¸‹çš„å£°æ˜æ–‡ä»¶ã€‚ â–² å½“æ²¡æœ‰å¯¹åº”ç¬¬ä¸‰æ–¹åº“çš„ç±»å‹å£°æ˜ npm åŒ…çš„æ—¶å€™ï¼Œéœ€è¦æ‰‹åŠ¨ä¹¦å†™*.d.ts æ–‡ä»¶ã€‚ç„¶åæœ‰ä¸¤ç§é…ç½®æ–¹å¼ã€‚ï¼ˆ1ï¼‰åœ¨ tsconfig.json é…ç½®ä¸­çš„ &quot;include&quot; å­—æ®µæ•°ç»„ä¸­å¢åŠ æ–‡ä»¶å®Œæ•´è·¯å¾„ã€‚æ³¨æ„è¿™é‡Œæ·»åŠ çš„è·¯å¾„ä¸èƒ½æ˜¯&quot;node_modules&quot;ç›®å½•ä¸‹çš„ï¼Œä¼šè¢« TypeScript å¿½ç•¥ã€‚ï¼ˆ2ï¼‰é€šè¿‡ä¸‰æ–œçº¿è¯­å¥å¼•å…¥ç±»å‹å®šä¹‰æ–‡ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ã€‚è¿™ç§æ–¹å¼çš„é…ç½®ä¸ä¸Šä¸€ç§ä¸åŒï¼Œå®ƒä»…å¯¹å½“å‰æ–‡ä»¶æœ‰æ•ˆï¼Œå½“åˆ«çš„æ–‡ä»¶ç¼ºå°‘è¿™ä¸ªå£°æ˜æ—¶ä¹Ÿéœ€è¦ä¹¦å†™å¼•å…¥è¯­å¥ã€‚ 12345678910// ç±»å‹å®šä¹‰æ–‡ä»¶ &quot;./types/one.d.ts&quot;declare module &#x27;Module_Name&#x27; &#123; export default (...)=&gt;any; export class ...;&#125;// å¼•å…¥ç±»å‹å®šä¹‰æ–‡ä»¶/// &lt;reference path=&quot;./types/one.d.ts&quot; /&gt;"},{"title":"ç‰¹å®šé¡¹ç›®ä¸‹è‡ªåŠ¨åˆ‡æ¢nodeåˆ°æŒ‡å®šç‰ˆæœ¬","date":"2022-04-12T13:20:42.000Z","path":"practice/ç‰¹å®šé¡¹ç›®ä¸‹è‡ªåŠ¨åˆ‡æ¢nodeåˆ°æŒ‡å®šç‰ˆæœ¬.html","tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://congzhou09.github.io/tags/Node-js/"}],"text":"åœºæ™¯â—‹ ä½¿ç”¨ nvm ç®¡ç†æœ¬åœ°å¤šç‰ˆæœ¬ Node.jsï¼Œé»˜è®¤ä½¿ç”¨ç‰ˆæœ¬ 14ã€‚æŸä¸ªé¡¹ç›®å½“å‰ä»…æ”¯æŒç‰ˆæœ¬ 10ï¼Œæ¯æ¬¡æ‰§è¡Œ&quot;nvm use&quot;æ‰‹åŠ¨åˆ‡æ¢å¤ªéº»çƒ¦äº†ã€‚â—‹ æƒ³åˆ°&quot;.npmrc&quot;æ–‡ä»¶å¯ä»¥æŒ‡å®šä»…å¯¹é¡¹ç›®ç”Ÿæ•ˆçš„é…ç½®ï¼Œå¯¹åº”åœ¨ç½‘ä¸Šæ‰¾&quot;.nvmrc&quot;æ‰¾åˆ°äº†è§£å†³åŠæ³•ã€‚ æ“ä½œæ­¥éª¤(MacOSç¯å¢ƒ)ä»¥åœºæ™¯éœ€æ±‚ä¸ºä¾‹çš„æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š â–  å‘½ä»¤è¡Œè¿›å…¥éœ€æŒ‡å®š node ç‰ˆæœ¬çš„é¡¹ç›®ä¸‹ï¼Œå…ˆä½¿ç”¨&quot;nvm use v10.17.0&quot;åˆ‡æ¢åˆ°ç›®æ ‡ç‰ˆæœ¬ï¼Œå†æ‰§è¡Œ&quot;node -v &gt; .nvmrc&quot;å°† node ç‰ˆæœ¬å·ä¿å­˜åˆ°&quot;.nvmrc&quot;æ–‡ä»¶ï¼Œå¦‚æœåªé™åˆ¶ç¬¬ä¸€çº§ç‰ˆæœ¬å·å¯å°†æ–‡ä»¶å†…å®¹æ”¹ä¸º&quot;v10&quot;ã€‚â–  æ·»åŠ å‘½ä»¤è¡Œåˆå§‹åŒ–è„šæœ¬ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯ zsh å‘½ä»¤è¡Œï¼Œé€šè¿‡&quot;vim $HOME&#x2F;.zshrc&quot;è¿½åŠ å¦‚ä¸‹è„šæœ¬å†…å®¹åˆ°æ–‡ä»¶ã€‚å…¶ä»–ç±»å‹å‘½ä»¤è¡Œè„šæœ¬å‚è€ƒnvm çš„ README.md ä¸­è¯´æ˜ã€‚ 12345678910111213141516171819202122232425262728293031323334# nvm check when zsh initializingautoload -U add-zsh-hookload-nvmrc() &#123; local node_version=&quot;$(nvm version)&quot; local nvmrc_path=&quot;$(nvm_find_nvmrc)&quot; if [ -n &quot;$nvmrc_path&quot; ]; then local nvmrc_node_version=$(nvm version &quot;$(cat &quot;$&#123;nvmrc_path&#125;&quot;)&quot;) if [ &quot;$nvmrc_node_version&quot; = &quot;N/A&quot; ]; then nvm install elif [ &quot;$nvmrc_node_version&quot; != &quot;$node_version&quot; ]; then nvm use fi elif [ &quot;$node_version&quot; != &quot;$(nvm version default)&quot; ]; then echo &quot;Reverting to nvm default version&quot; nvm use default fi&#125;add-zsh-hook chpwd load-nvmrcload-nvmrc# nvm check when running cd commandcd-nvm() &#123; builtin cd &quot;$@&quot; if [[ -f .nvmrc ]]; then load-nvmrc fi&#125;alias cd=&#x27;cd-nvm&#x27;# changes take effectsource ~/.bash_profile â–  ä»¥ä¸Šè„šæœ¬å®ç°äº†&quot;ä»é¡¹ç›®ç›®å½•ç›´æ¥æ‰“å¼€å‘½ä»¤è¡Œ&quot;å’Œ&quot;é€šè¿‡ cd å‘½ä»¤è¿›å…¥é¡¹ç›®ç›®å½•&quot;ä¸¤ç§æƒ…å†µä¸‹è‡ªåŠ¨åˆ‡æ¢ node åˆ° nvm é»˜è®¤ç‰ˆæœ¬æˆ–&quot;.nvmrc&quot;æ–‡ä»¶æŒ‡å®šç‰ˆæœ¬ã€‚ å‚è€ƒæ–‡çŒ®â–²How to write a .nvmrc file which automatically change node versionâ–²Automatically switch to correct version of Node based on projectâ–²nvm README.md"},{"title":"æµè§ˆå™¨æ–°å¼€Tabè¯»ä¸åˆ°sessionStorageçš„é—®é¢˜","date":"2021-12-24T12:32:56.000Z","path":"practice/æµè§ˆå™¨æ–°å¼€Tabè¯»ä¸åˆ°sessionStorageçš„é—®é¢˜.html","tags":[{"name":"HTMLè§„èŒƒ","slug":"HTMLè§„èŒƒ","permalink":"https://congzhou09.github.io/tags/HTML%E8%A7%84%E8%8C%83/"}],"text":"èƒŒæ™¯â–² ä¸ŠåŠå¹´è§£å†³&quot;url ä¼ å‚æ–¹å¼, å› å‚æ•°è¿‡é•¿å¯¼è‡´ url è¿‡é•¿&quot;é—®é¢˜æ—¶æƒ³åˆ°ä½¿ç”¨ sessionStorage ç¼“å­˜å‚æ•°ï¼Œä»Šå¤©çªç„¶å‘ç°è¿™ä¸ªåŠæ³•åœ¨æ–°é¡¹ç›®é‡Œä¸ç®¡ç”¨ï¼šè™½ç„¶æ–°å¼€çš„ Tab ä¸æºé¡µé¢åœ¨ç›¸åŒçš„åŸŸï¼Œä½†æºé¡µé¢è®¾ç½®çš„ sessionStorage åœ¨æ–°å¼€ Tab ä¸­è¯»å–ä¸åˆ°ã€‚ â–² ç½‘ä¸ŠæŸ¥æ‰¾å¦‚ä½•åœ¨ Tab ä¹‹é—´å…±äº« sessionStorage çš„æ–¹æ¡ˆï¼Œæ’åç¬¬ä¸€çš„æœç´¢ç»“æœå±…ç„¶æ˜¯é€šè¿‡ localStorage åšä¸­è½¬ã€‚ åˆ†æä¸è§£å†³â–  å°è±¡é‡Œ sessionStorage ä¸ localStorage çš„åŒºåˆ«åªæœ‰ç”Ÿå‘½å‘¨æœŸä¸åŒï¼ŒæŸ¥çœ‹MDN ä¸­å¯¹ sessionStorage çš„è¯´æ˜æ‰å‘ç°è‡ªå·±è®¤çŸ¥çš„æ¼æ´ï¼Œä»ä»¥ä¸‹æˆªå›¾æè¿°ï¼ˆç‰¹åˆ«æ˜¯çº¢æ¡†ä½ç½®ï¼‰å¯è§ sessionStorage è¿˜æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼šï¼ˆ1ï¼‰æµè§ˆå™¨æ‰“å¼€æ–° Tab çš„æ—¶å€™ä¼šä¸ºå…¶å•ç‹¬åˆ›å»ºä¸€ä»½æ–°çš„ sessionStorageã€‚ï¼ˆ2ï¼‰ç›¸åŒåŸŸä¸‹ä¸åŒ Tab çš„ sessionStorage æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ â–  ä½†ä¸ºä½•è‡ªå·±å½“æ—¶å¯ä»¥åœ¨æ–°å¼€çš„ Tab è¯»å–åˆ°æºé¡µé¢çš„ sessionStorage å‘¢ï¼Œä»æˆªå›¾ä¸­è“æ¡†ä½ç½®æè¿°çœ‹åˆ°äº†çº¿ç´¢ï¼šå½“å‰é¡µé¢çš„ sessionStorage æ˜¯æœ‰åŠæ³•æ‹·è´åˆ°æ–°å¼€ Tab ä¸­çš„ã€‚ â–  æŸ¥æ‰¾æ‹·è´ sessionStorage çš„æ–¹æ³•çœ‹åˆ°äº†è®¾ç½® rel&#x3D;&quot;opener&quot;çš„æ–¹æ³•ï¼Œå°†å…¶ä¸­æé—®è€…ç»™å‡ºçš„demoä¿®æ”¹å¦‚ä¸‹å°±å¯ä»¥åœ¨æ–°å¼€ Tab è¯»åˆ° sessionStorage å•¦ã€‚ 12345678910function openPageInNewTab() &#123; const link = document.createElement(&#x27;a&#x27;); link.target = &#x27;_blank&#x27;; link.href = &#x27;/&#x27;; link.setAttribute(&#x27;visibility&#x27;, &#x27;hidden&#x27;); link.setAttribute(&#x27;rel&#x27;, &#x27;opener&#x27;); // å¢åŠ æ­¤è¡Œ document.body.appendChild(link); link.click(); link.remove();&#125; é¢å¤–ä¿¡æ¯â—‹ Chrome ä»ç‰ˆæœ¬ 89 å¼€å§‹ï¼Œæ‰“å¼€æ–° Tab æ—¶ä¸å†é»˜è®¤å°†å½“å‰ sessionStorage æ‹·è´åˆ°æ–°å¼€ Tabï¼Œè¯¦è§ï¼šChrome Feature: Stop cloning sessionStorage for windows opened with noopener â—‹ æŸ¥äº†ä¹‹å‰é¡¹ç›®ä»£ç ï¼Œé‚£æ—¶å€™æ˜¯ä½¿ç”¨ window.open()å‡½æ•°å®ç°çš„æ–°å¼€ Tabã€‚ç»æµ‹è¯•ä¾ç„¶æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯å½“å‰é€šè¿‡ window.open()å‡½æ•°æ‰“å¼€æ–° Tab æ—¶ï¼Œä»ç„¶ä¼šå°†å½“å‰ sessionStorage æ‹·è´åˆ°æ–°å¼€ Tabã€‚ â—‹ æºå¸¦ rel&#x3D;&quot;opener&quot;è¦æ³¨æ„ä½¿ç”¨åœºæ™¯ï¼Œé˜²æ­¢å®‰å…¨ç±»é—®é¢˜ã€‚"},{"title":"Ant Designçš„Uploadç»„ä»¶å®šåˆ¶","date":"2021-11-15T06:37:29.000Z","path":"handbook/Ant-Designçš„Uploadç»„ä»¶å®šåˆ¶.html","tags":[{"name":"antd","slug":"antd","permalink":"https://congzhou09.github.io/tags/antd/"}],"text":"èƒŒæ™¯â– Ant Design å®˜æ–¹æ–‡æ¡£ä¸­å¯¹äºé™åˆ¶æ•°é‡ã€ä¸Šä¼ æ¥å£è¯·æ±‚ä¸å“åº”ã€ä¸‹è½½ç­‰åŠŸèƒ½çš„è‡ªå®šä¹‰å®ç°æ–¹æ³•æè¿°å¾—ä¸è¯¦ç»†ï¼Œåœ¨æ­¤åšä¸‹è®°å½•ã€‚â–  å®ç°åŠŸèƒ½å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰ä¸Šä¼ æ¥å£æŠ¥é”™æ—¶å¼¹å‡ºé”™è¯¯ä¿¡æ¯(ç”±äºåç«¯æ¥å£ç»Ÿä¸€å°†é”™è¯¯ä¿¡æ¯ä¸é”™è¯¯ç å°è£…åœ¨ http ç ä¸º 200 çš„ body ä¸­ï¼Œæ‰€ä»¥éœ€è¦ä¸Šä¼ æ¥å£è¯·æ±‚ä¸å“åº”çš„è‡ªå®šä¹‰)ï¼›ï¼ˆ2ï¼‰é™åˆ¶ä¸Šä¼ æ–‡ä»¶æ•°é‡ 10 ä¸ªï¼›ï¼ˆ3ï¼‰é€‰æ‹©æ–‡ä»¶å¯¹è¯æ¡†ä¸­å¯é€‰å¤šä¸ªæ–‡ä»¶ï¼›ï¼ˆ4ï¼‰é™åˆ¶æ¯ä¸ªæ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 20Mï¼›ï¼ˆ5ï¼‰ä¸Šä¼ æˆåŠŸåå±•ç¤ºçš„æ–‡ä»¶åˆ—è¡¨é¡¹å¯ç‚¹å‡»ä¸‹è½½ï¼›ï¼ˆ6ï¼‰onChange ä¼ å‡ºå€¼æ ¼å¼:[{fileName: string, fileUrl: string}] ä»£ç å®ä¾‹â–¡ ä»£ç å®ä¾‹å¦‚ä¸‹ï¼Œç»è°ƒè¯•å‘ç°æ— è®º onSuccess ä¼ å…¥æ€æ ·çš„å‚æ•°æ ¼å¼ï¼Œä¸‹è½½åŠŸèƒ½éƒ½éœ€è¦è‡ªå·±å®ç°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127import React, &#123; useCallback, useEffect, useRef, useState &#125; from &#x27;react&#x27;;import &#123; Upload, message, Button &#125; from &#x27;antd&#x27;;import axios from &#x27;axios&#x27;;const FileUpload = (&#123; maxFileSize = 20, maxFileCount = 10, onChange,&#125;) =&gt; &#123; // æ–‡ä»¶å¤§å°é™åˆ¶ const maxFileSizeRef = useRef(); useEffect(() =&gt; &#123; // Mè½¬byte maxFileSizeRef.current = maxFileSize * 1024 * 1024; &#125;, [maxFileSize]); // æ–‡ä»¶æ•°é‡è®°å½• const [fileListCount, setFileListCount] = useState(0); const [isDisabled, setIsDisabled] = useState(false); useEffect(() =&gt; &#123; if (fileListCount &gt;= maxFileCount) &#123; setIsDisabled(true); &#125; else &#123; setIsDisabled(false); &#125; &#125;, [fileListCount, maxFileCount]); // &quot;æ–‡ä»¶uid-ä¸‹è½½url&quot;æ˜ å°„è®°å½• const [downloadUrls, setDownloadUrls] = useState(&#123;&#125;); // onChangeæ ¼å¼è½¬æ¢ const customOnChange = useCallback( (&#123; fileList &#125;) =&gt; &#123; const outputValue = []; fileList.forEach((one) =&gt; &#123; if (one.status === &#x27;done&#x27;) &#123; outputValue.push(&#123; fileName: one.name, fileUrl: downloadUrls[one.uid], &#125;); &#125; &#125;); // console.log(&#x27;onChange: &#x27;, outputValue); onChange &amp;&amp; onChange(outputValue); &#125;, [onChange, downloadUrls] ); return ( &lt;Upload onChange=&#123;customOnChange&#125; showUploadList=&#123;&#123; showDownloadIcon: true, &#125;&#125; beforeUpload=&#123;(file, fileList) =&gt; &#123; const newCount = fileListCount + fileList.length; if (file.size &gt; maxFileSizeRef.current) &#123; message.warn(`æ–‡ä»¶&#x27;$&#123;file.name&#125;&#x27;è¶…è¿‡æ–‡ä»¶å¤§å°é™åˆ¶: $&#123;maxFileSize&#125;M`); return Upload.LIST_IGNORE; &#125; else if (newCount &gt; maxFileCount) &#123; message.warn(`è¶…è¿‡æœ€å¤§ä¸Šä¼ æ•°é‡: $&#123;maxFileCount&#125;`); return Upload.LIST_IGNORE; &#125; else if (newCount === maxFileCount) &#123; setIsDisabled(true); &#125; &#125;&#125; customRequest=&#123;(allData) =&gt; &#123; setFileListCount(fileListCount + 1); const &#123; onProgress, onSuccess, onError &#125; = allData; const reqFormData = new FormData(); // é€šè¿‡ç»„ä»¶çš„dataå±æ€§ä¼ å…¥çš„é¢å¤–è¯·æ±‚å‚æ•°ï¼Œæ ¹æ®æ¥å£è¦æ±‚å®šåˆ¶ Object.keys(allData.data).forEach((oneKey) =&gt; &#123; reqFormData.append(oneKey, allData.data[oneKey]); &#125;); reqFormData.append(&#x27;file&#x27;, allData.file); axios(&#123; method: &#x27;post&#x27;, url: &#x27;/common/file/upload&#x27;, data: reqFormData, onUploadProgress: (progress) =&gt; &#123; // ä¸Šä¼ è¿›åº¦æ¡ const progNum = progress.loaded / progress.total; onProgress(&#123; percent: progNum &#125;); &#125;, &#125;) .then((resData) =&gt; &#123; setDownloadUrls((prevState) =&gt; &#123; return &#123; ...prevState, [allData.file.uid]: resData.url, &#125;; &#125;); onSuccess(&#123; url: resData.url &#125;); &#125;) .catch((error) =&gt; &#123; onError(error); &#125;); &#125;&#125; multiple=&#123;true&#125; data=&#123;(file) =&gt; &#123; return &#123; typeId: 2, fileName: file.name, &#125;; &#125;&#125; onRemove=&#123;() =&gt; &#123; setFileListCount(fileListCount - 1); &#125;&#125; openFileDialogOnClick=&#123;!isDisabled&#125; onDownload=&#123;(file) =&gt; &#123; window.open(downloadUrls[file.uid]); &#125;&#125; &gt; &#123;isDisabled ? ( &lt;span style=&#123;&#123; color: &#x27;#ff7700&#x27; &#125;&#125;&gt; å·²è¾¾åˆ°æœ€å¤§ä¸Šä¼ æ•°é‡: &#123;maxFileCount&#125;ä¸ª &lt;/span&gt; ) : ( &lt;Button&gt;ä¸Šä¼ &lt;/Button&gt;; )&#125; &lt;/Upload&gt; );&#125;;... ... å‚è€ƒæ–‡çŒ®â—rc-uploadæ–‡æ¡£â—å‰ç«¯é€šè¿‡ axios å’Œ FormData å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½é‡åˆ°çš„å‘"},{"title":"gitåˆå¹¶åˆ†æ”¯ä¸¤ç§æ–¹å¼:rebaseä¸merge","date":"2021-02-16T03:55:15.000Z","path":"practice/gitåˆå¹¶åˆ†æ”¯ä¸¤ç§æ–¹å¼-rebaseä¸merge.html","tags":[{"name":"git","slug":"git","permalink":"https://congzhou09.github.io/tags/git/"}],"text":"åœºæ™¯â—‹ å½“å‰ git åˆ†æ”¯çŠ¶æ€å¦‚ä¸‹ç¤ºæ„å›¾ï¼Œæœ¬åœ° dev åˆ†æ”¯ä» master åˆ†æ”¯çš„ C2 ç‰ˆæœ¬åˆ‡å‡ºå¹¶ç»è¿‡ 2 æ¬¡æäº¤åˆ°è¾¾ C4 ç‰ˆæœ¬ï¼Œè¿œç¨‹ master åˆ†æ”¯ç»è¿‡ 1 æ¬¡æäº¤åˆ°è¾¾ C5 ç‰ˆæœ¬ã€‚â—‹ æ­¤æ—¶è¦åœ¨æœ¬åœ°å°† dev åˆ†æ”¯åˆå¹¶åˆ° masterã€‚ merge æ–¹å¼â™‚ ç›´æ¥ä½¿ç”¨ merge å‘½ä»¤åˆå¹¶ dev åˆ†æ”¯åˆ° master åˆ†æ”¯ï¼Œç”±äº C2 ä¸æ˜¯ master æœ€æ–°ç‰ˆæœ¬ï¼Œå°†æŠŠ C2 åˆ° C4 çš„ä¿®æ”¹åˆå¹¶åˆ° master æœ€æ–°ç‰ˆæœ¬ C5 å¹¶è‡ªåŠ¨ç”Ÿæˆä¸€æ¡ commitã€‚â™‚ ä¸¤ä¸ªåˆ†æ”¯ä¸Šçš„ commit è®°å½•åœ¨ log ä¸­çš„é¡ºåºä¸ pull ä¸ merge æ“ä½œå…ˆåæœ‰å…³ã€‚å…ˆ pull å† merge æ˜¯å…ˆåˆå¹¶è¿œç¨‹ä¿®æ”¹å†åˆå¹¶æœ¬åœ°ä¿®æ”¹ï¼Œå…ˆ merge å† pull æ˜¯å…ˆåˆå¹¶æœ¬åœ°ä¿®æ”¹å†åˆå¹¶è¿œç¨‹ä¿®æ”¹ï¼Œä»æ€è·¯ä¸Šéƒ½è¯´å¾—é€šã€‚â™‚ æœ¬åœ°åˆ‡åˆ° master åˆ†æ”¯åï¼Œå…ˆ pull master åˆ†æ”¯ï¼Œå† merge dev åˆ†æ”¯çš„ log ç»“æœå¦‚ä¸‹å›¾ï¼Œå…¶ä¸­çš„ parent1 æ˜¯ C5ã€‚ â™‚ æœ¬åœ°åˆ‡åˆ° master åˆ†æ”¯åï¼Œå…ˆ merge dev åˆ†æ”¯ï¼Œå† pull master åˆ†æ”¯çš„ log ç»“æœå¦‚ä¸‹å›¾ï¼Œè¿œç¨‹ master ä¸Šçš„æ–°æäº¤ C5 è¢«æ˜¾ç¤ºä¸ºè¢«åˆå¹¶åˆ†æ”¯ï¼Œå…¶ä¸­çš„ parent1 æ˜¯ C4ã€‚ â™‚ merge æ–¹å¼è‡ªåŠ¨ç”Ÿæˆçš„é‚£æ¡ commit è®°å½•äº†åˆå¹¶ç»“æœåˆ†åˆ«ä¸ä¸¤ä¸ªåˆ†æ”¯æœ€æ–°ç‰ˆæœ¬çš„å·®å¼‚ã€‚â™‚ ä½¿ç”¨ merge æ–¹å¼åˆå¹¶åˆ†æ”¯ï¼Œmerge ä¸ pull é¡ºåºåªå½±å“ä¸¤åˆ†æ”¯ commit è®°å½•çš„é¡ºåºï¼Œä¸å½±å“åˆå¹¶å®Œçš„ä»£ç ç»“æœã€‚ rebase æ–¹å¼â™€ rebase æ€è·¯æ˜¯å°† dev åˆ†æ”¯ä¸Šçš„åŸå…ˆåŸºäºçš„ C2 æ›´æ–°ä¸ºåŸºäº C5ï¼Œå°†å¯¹åŸåŸºå‡†ç‰ˆæœ¬åçš„æ¯ä¸ª commit(C3 å’Œ C4)æ‰§è¡Œæ›´æ–°åŸºå‡†è¿‡ç¨‹ï¼Œæ¯ä¸ª commit å¯èƒ½éƒ½è¦è§£å†³ä¸€æ¬¡å†²çªï¼Œrebase å®Œæˆä¹‹ååˆ†æ”¯çŠ¶æ€ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œæ­¤æ—¶å†å°† dev åˆ†æ”¯åˆå¹¶åˆ° master ç”±äºåŸºå‡†ç‰ˆæœ¬å°±æ˜¯ master æœ€æ–°ç‰ˆæœ¬å°±åªæ˜¯ç®€å•çš„åŒæ­¥äº†ã€‚ â™€ â€œgit rebase masterâ€å’Œâ€œgit rebase --continueâ€å‘½ä»¤å¯¹åº”åœ¨ TortoiseGit çš„æ“ä½œç•Œé¢å¦‚ä¸‹ï¼Œå…¶ä¸­ Branch æ˜¯æ‰§è¡Œ rebase çš„åˆ†æ”¯ï¼ŒUpstream æ˜¯ base æ‰€åœ¨åˆ†æ”¯ã€‚ â™€ rebase çš„ log ç»“æœå¦‚ä¸‹å›¾ï¼Œç»è¿‡ rebase ä¹‹åï¼ŒC3 ä¸ C4 çš„ commit log è®°å½•çš„ä¿®æ”¹å†…å®¹å°†å˜æˆåŸºäº C5 çš„ä¿®æ”¹ï¼Œç›¸åº” SHA ç ä¹Ÿä¼šæ›´æ”¹ã€‚ rebase æ–¹å¼ä¸ merge æ–¹å¼åŒºåˆ«â–¡ æ‰§è¡Œ rebase æœŸé—´å¯èƒ½éœ€è¦è§£å†³å¤šæ¬¡å†²çªã€‚â–¡ rebase çš„ log ç»“æœä¸­æ²¡æœ‰å•ç‹¬ç”Ÿæˆä¸€æ¡è®°å½•åˆå¹¶çš„ commitï¼Œlog graph æ˜¯çº¿æ€§æ²¡æœ‰åˆ†å‰çš„ã€‚â–¡ rebase çš„ log ç»“æœä¸­ commit è®°å½•å›ºå®šæŒ‰ç…§åˆå¹¶åˆ° master åˆ†æ”¯çš„å…ˆåé¡ºåºæ’åˆ—ã€‚ å‚è€ƒæ–‡çŒ®â— ä½ çœŸçš„æ‡‚ git rebase å—-ç®€ä¹¦â— git å®˜æ–¹ Reference æ‰‹å†Œ"},{"title":"æœ¬åœ°è‡ªç­¾åHTTPSç¯å¢ƒæ­å»º","date":"2021-02-13T02:23:50.000Z","path":"practice/æœ¬åœ°è‡ªç­¾åHTTPSç¯å¢ƒæ­å»º.html","tags":[{"name":"HTTPS","slug":"HTTPS","permalink":"https://congzhou09.github.io/tags/HTTPS/"}],"text":"å‰ç½®çŸ¥é“â—‹OpenSSLæ˜¯ä¸ºå®ç°SSLå’ŒTLSæä¾›æ”¯æŒçš„å·¥å…·åŒ…ï¼›â—‹HTTPSè¯ä¹¦åªèƒ½ç»‘å®šåŸŸåè€Œä¸èƒ½ç»‘å®šæŸä¸ªIPï¼›â—‹1.1.1ç‰ˆæœ¬OpenSSLå‘½ä»¤ç”¨æ³•çš„å®˜æ–¹æ–‡æ¡£ï¼›â—‹æ“ä½œç¯å¢ƒï¼š 123Windows 10openssl 1.1.1(é€šè¿‡&quot;openssl version&quot;å‘½ä»¤æŸ¥çœ‹)ï¼›nginx 1.17.1 æ“ä½œæ­¥éª¤æ·»åŠ æœ¬åœ°åŸŸåâ—å®šä¹‰æœ¬åœ°åŸŸåä»¥&quot;blog.congzhou.com&quot;ä¸ºä¾‹ï¼Œå°†åŸŸåè§£ææ·»åŠ åˆ°â€œWindows\\System32\\drivers\\etcâ€ä¸‹çš„hostsæ–‡ä»¶ï¼Œhostsæ–‡ä»¶ä¸­çš„åŸŸåä¸æ”¯æŒé€šé…ç¬¦ï¼› 1127.0.0.1 blog.congzhou.com ç”ŸæˆHTTPSæ‰€éœ€ç§é’¥ä¸è¯ä¹¦â—æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ›å»ºæœ¬åœ°æ¨¡æ‹ŸCAçš„ç§é’¥ä¸CAæ ¹è¯ä¹¦ï¼Œåˆ†åˆ«ç”Ÿæˆ&quot;RootCA.key&quot;å’Œ&quot;RootCA.pem&quot;ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ç”¨åˆ°çš„å›½å®¶ç¼–ç åœ¨è¿™é‡Œ 12345678910111213openssl req -x509 -nodes -new -days 365 -newkey rsa:2048 -keyout RootCA.key -out RootCA.pem -subj &quot;/C=CN/CN=YCZ-Root-CA&quot;/****** * å‘½ä»¤è§£è¯» * openssl-reqä¸»è¦ç”¨äºåˆ›å»ºä¸å¤„ç†è¯ä¹¦è¯·æ±‚(CSR, certificate signing request)ï¼Œä¹Ÿç”¨äºåˆ›å»ºè‡ªç­¾åæ–¹å¼çš„æ ¹è¯ä¹¦ * å‚æ•°è§£è¯» * -x509: è¾“å‡ºè¯ä¹¦è€Œä¸æ˜¯CSR * -nodes: ç”Ÿæˆçš„ç§é’¥ä¸åšåŠ å¯† * -new: å½“æ²¡æœ‰-keyå‚æ•°æ—¶å°†ä½¿ç”¨-newkeyå’Œ-pkeyoptå‚æ•°ç”Ÿæˆç§é’¥ * -days: è¯ä¹¦æœ‰æ•ˆå¤©æ•°ï¼Œé»˜è®¤30å¤© * -newkey rsa:2048 : ç”Ÿæˆ2048bité•¿åº¦çš„rsaæ ¼å¼ç§é’¥ * -subj: è®¾ç½®è¯ä¹¦æ¶‰åŠåˆ°çš„å­—æ®µ(ç§°ä¸ºè¯ä¹¦çš„subject)å€¼ï¼Œ/Cæ˜¯CountryNameç¼–ç ï¼Œ/CNæ˜¯CommonNameå³CAæœºæ„åç§°****/ â—æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ç”Ÿæˆä¸Šä¸€æ­¥pemè¯ä¹¦çš„å¯¹åº”crtæ ¼å¼çš„è¯ä¹¦æ–‡ä»¶&quot;RootCA.crt&quot;ï¼ŒWindowsä¸­crtæ‰©å±•åçš„è¯ä¹¦æ–‡ä»¶å³é”®èœå•æ‰æœ‰&quot;å®‰è£…&quot;é€‰é¡¹ï¼› 123456789openssl x509 -inform pem -in RootCA.pem -out RootCA.crt/****** * å‘½ä»¤è§£è¯» * openssl-x509ç”¨é€”è¾ƒå¤šï¼Œå¯ç”¨äºè½¬æ¢è¯ä¹¦æ ¼å¼å’Œä¸ºCSRç­¾å * å‚æ•°è§£è¯» * -inform è¾“å…¥è¯ä¹¦çš„æ ¼å¼ï¼Œå–å€¼ä¸ºpemæˆ–derï¼Œé»˜è®¤å€¼pemï¼Œpemæ˜¯base64ç¼–ç çš„æ–‡æœ¬æ ¼å¼ï¼Œderæ˜¯DER(Distinguished Encoding Rules)ç¼–ç çš„äºŒè¿›åˆ¶æ ¼å¼ * -outform è¾“å‡ºè¯ä¹¦çš„æ ¼å¼ï¼Œé»˜è®¤ä¸è¾“å…¥æ•´æ•°çš„æ ¼å¼ä¸€è‡´****/ â—æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ›å»ºæœ¬åœ°åŸŸåç½‘ç«™ç§é’¥ä¸ç½‘ç«™è¯ä¹¦reqï¼Œåˆ†åˆ«ç”Ÿæˆ&quot;congzhou.key&quot;å’Œ&quot;congzhou.csr&quot;ä¸¤ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œå°†è¯ä¹¦ç­¾åˆ°åŸŸå&quot;*.congzhou.com&quot;æ–¹ä¾¿ä»¥åä¹Ÿå¯ä»¥ç»™å…¶ä»–äºŒçº§å­åŸŸåä½¿ç”¨ï¼› 12345678910openssl req -new -nodes -newkey rsa:2048 -keyout congzhou.key -out congzhou.csr -subj &quot;/C=CN/ST=Beijing/L=Beijing/O=Example Company Limited/CN=*.congzhou.com&quot;/****** * å‚æ•°è§£è¯» * -new: ç”Ÿæˆä¸€ä¸ªæ–°çš„CSR * -subjå‚æ•°ä½¿ç”¨åˆ°çš„subjectå«ä¹‰ï¼š/STæ˜¯StateOrProvinceNameï¼Œ/Læ˜¯Localityï¼Œ/Oæ˜¯Organizationã€‚/CNç”¨äºç½‘ç«™æ—¶å°±æ˜¯ç½‘ç«™çš„åŸŸåï¼Œæ”¯æŒ&quot;*.example.com&quot;å½¢å¼çš„é€šé…ç¬¦ï¼Œä½†åªèƒ½å¡«å†™ä¸€æ¡ * * * Subject Alternative Nameï¼ˆç®€ç§°SANï¼Œä¹Ÿç§°&quot;ä½¿ç”¨è€…å¤‡ç”¨åç§°&quot;ï¼‰ç”¨äºå¼¥è¡¥CNæ•°é‡çš„é™åˆ¶ï¼Œå¹¶ä¼šåœ¨å°†æ¥é€æ¸æ›¿ä»£Common Nameï¼Œè€Œä¸”Chromeç‰ˆæœ¬58åŠä»¥ä¸Šå·²ç»å°†SANä½œä¸ºè¯ä¹¦æ ¡éªŒé¡¹ï¼Œç¼ºå°‘SANæŠ¥â€œSubject Alternative Name Missingâ€é”™è¯¯****/ â—åˆ›å»ºåŒ…å«SANç­‰è¯ä¹¦æ‰©å±•ä¿¡æ¯çš„congzhou.extæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼› 12345678authorityKeyIdentifier=keyid,issuerbasicConstraints=CA:FALSEkeyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEnciphermentsubjectAltName = @alt_names[alt_names]DNS.1 = *.congzhou.comDNS.2 = localhost â—ä½¿ç”¨CAè¯ä¹¦&quot;RootCA.pem&quot;æ–‡ä»¶åŠè¯ä¹¦æ‰©å±•ä¿¡æ¯&quot;congzhou.ext&quot;æ–‡ä»¶ç»™ç½‘ç«™è¯ä¹¦ç­¾åç”Ÿæˆè¯ä¹¦åˆ°&quot;congzhou.crt&quot;æ–‡ä»¶ï¼› 12345678910openssl x509 -req -days 1024 -in congzhou.csr -CA RootCA.pem -CAkey RootCA.key -CAcreateserial -extfile congzhou.ext -out congzhou.crt/****** * å‘½ä»¤è§£è¯» * openssl-x509ç”¨é€”è¾ƒå¤šï¼Œæ­¤å¤„ç”¨äºä¸ºCSRç­¾å * å‚æ•°è§£è¯» * -req æŒ‡æ˜æ­¤å¤„x509å‘½ä»¤ç”¨äºä¸ºCSRç­¾å * -CAserial æ— é¡»é€šè¿‡-set_serialæ‰‹åŠ¨æŒ‡å®šserial number * -extfile æŒ‡å®šCAæ‰©å±•ä¿¡æ¯æ‰€åœ¨æ–‡ä»¶****/ æ·»åŠ å¯¹CAè¯ä¹¦çš„ä¿¡ä»»â™‚æ–¹å¼1ï¼šåœ¨&quot;RootCA.crt&quot;æ–‡ä»¶çš„å³é”®èœå•é€‰&quot;å®‰è£…è¯ä¹¦&quot;ï¼Œ&quot;è¯ä¹¦å­˜å‚¨&quot;é€‰æ‹©&quot;å—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„&quot;ï¼›â™‚æ–¹å¼2ï¼šè¿è¡Œ&quot;certmgr.msc&quot;ï¼Œåœ¨å·¦ä¾§â€œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„-&gt;è¯ä¹¦â€ä¸Šå³é”®èœå•â€œæ‰€æœ‰ä»»åŠ¡-&gt;å¯¼å…¥â€é€‰æ‹©RootCA.crtæ–‡ä»¶å®‰è£…ï¼›â™‚å®‰è£…æˆåŠŸååœ¨&quot;certmgr.msc&quot;è¯ä¹¦ç®¡ç†ç¨‹åºä¸­å¯ä»¥çœ‹åˆ°åˆšåˆšåˆ›å»ºçš„æœ¬åœ°æ¨¡æ‹ŸCAä¿¡æ¯ï¼› æœ¬åœ°ç½‘ç«™ä½¿ç”¨è¯ä¹¦â™€ä½¿ç”¨è¯ä¹¦ï¼Œä»¥nginxä¸ºä¾‹ï¼Œserveræ®µæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š 123456server_name blog.congzhou.com;listen 443 ssl; # sslæŒ‡å®šä½¿ç”¨httpsssl_certificate &quot;/certificate_path/congzhou.crt&quot;; # ç½‘ç«™è¯ä¹¦ssl_certificate_key &quot;/certificate_path/congzhou.key&quot;; # ç½‘ç«™è¯ä¹¦å¯¹åº”ç§é’¥... ... ç»“æœéªŒè¯â–²éªŒè¯1ï¼šè®¿é—®æœ¬åœ°httpsç½‘ç«™ï¼Œæµè§ˆå™¨æ ¡éªŒé€šè¿‡ï¼› â–²éªŒè¯2ï¼šæµè§ˆå™¨ä¸­ç‚¹å¼€è¯ä¹¦è¯¦æƒ…ï¼Œå¯ä»¥çœ‹åˆ°é¢å‘è€…ã€ä½¿ç”¨è€…ä¿¡æ¯ï¼Œå…¶ä¸­çš„SANåœ¨&quot;ä½¿ç”¨è€…å¯é€‰åç§°&quot;å­—æ®µï¼› å‚è€ƒæ–‡çŒ®â—How to Create Trusted Self-Signed SSL Certificates and Local Domains for Testingâ—How to create an HTTPS certificate for localhost domainsâ—Solve Errors: &quot;Subject Alternative Name Missing&quot; â€œNET::ERR_CERT_COMMON_NAME_INVALIDâ€ â—What is the SSL Certificate Common Name"},{"title":"FiddleræŠ“å–HTTPSåŒ…ä¸æ‰‹æœºåŒ…","date":"2021-01-11T09:50:23.000Z","path":"practice/FiddleræŠ“å–HTTPSåŒ…ä¸æ‰‹æœºåŒ….html","tags":[{"name":"Fiddler","slug":"Fiddler","permalink":"https://congzhou09.github.io/tags/Fiddler/"},{"name":"HTTPS","slug":"HTTPS","permalink":"https://congzhou09.github.io/tags/HTTPS/"}],"text":"åŸºæœ¬åŸç†â—‡FiddleræŠ“åŒ…åŸºäºæ³¨å†ŒæˆHTTP(S)åè®®æ•°æ®çš„æ”¶å‘ä»£ç†ï¼›â—‡åªè¦æ”¯æŒé…ç½®httpä»£ç†çš„ç¯å¢ƒï¼Œå°±å¯ä»¥ä½¿ç”¨FiddleræŠ“åŒ…ï¼Œæ®æ­¤å¯ä»¥æŠ“å–ç»è¿‡æ‰‹æœºçš„HTTP(S)åŒ…ï¼›â—‡HTTPSæ¯”HTTPå¤šäº†éå¯¹ç§°åŠ å¯†æœºåˆ¶ï¼ŒåŒ…å«ä¸€å¯¹äº’ç›¸è§£å¯†çš„å…¬é’¥å’Œç§é’¥ï¼Œå‘èµ·HTTPSè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼ŒæŠ“å–HTTPSå†…å®¹é™¤äº†ä½œä¸ºä»£ç†æ‹¿åˆ°å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“çš„æ•°æ®è¿˜éœ€è¦èƒ½å¯¹æ•°æ®è§£å¯†ï¼› â—‡FiddleræŠ“å–HTTPSåŒ…å€Ÿé‰´ä¸­é—´äººæ”»å‡»(Man-in-the-MiddleAttackï¼Œç®€ç§°MITMæ”»å‡»)åŸç†ï¼Œä»£ç†æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´ä½¿ç”¨ä¸­é—´äººçš„å…¬é’¥ç§é’¥ï¼Œä¸æœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨æœåŠ¡å™¨çš„å…¬é’¥ï¼› â—‡æœåŠ¡å™¨å…¬é’¥åŒ…å«åœ¨æœåŠ¡å™¨æä¾›çš„SSLè¯ä¹¦ä¸­ï¼Œé™¤äº†å…¬é’¥è¿˜åŒ…å«:è¯ä¹¦é¢å‘æœºæ„(å³CA)ã€æœ‰æ•ˆæœŸã€å…¬é’¥ã€è¯ä¹¦æŒæœ‰è€…ã€CAæŒ‡çº¹å’ŒæŒ‡çº¹ç®—æ³•ç­‰ã€‚çœŸå®CAçš„æ•°å­—è¯ä¹¦(å³æ ¹è¯ä¹¦)ç”±äºæ‹¿ä¸åˆ°ç§é’¥æ˜¯æ— æ³•ä¼ªé€ çš„ï¼Œä¸­é—´äººéœ€è¦ä¼ªé€ ä¸€ä¸ªCAï¼Œå¹¶èƒ½éšæ—¶é¢å‘è¦è®¿é—®ä»»ä½•ç½‘ç«™çš„SSLè¯ä¹¦ï¼ŒåŒæ—¶éœ€è¦åœ¨ç³»ç»Ÿæ ¹è¯ä¹¦ç®¡ç†ä¸­æ·»åŠ å¯¹ä¼ªé€ CAæ ¹è¯ä¹¦çš„ä¿¡ä»»å¦åˆ™æµè§ˆå™¨ä¼šè·³å‡ºå®‰å…¨æç¤ºï¼› æŠ“å–HTTPSåŒ…çš„æ–¹æ³•â—‡ä¼ªé€ ä¸€ä¸ªCAå¹¶èƒ½éšæ—¶é¢å‘è¦è®¿é—®ä»»ä½•æœåŠ¡å™¨çš„SSLè¯ä¹¦çš„æœºåˆ¶Fiddlerå·²ç»æä¾›ï¼Œæ‰“å¼€Fiddlerè®¾ç½®ï¼šTools-&gt;Options-&gt;HTTPS-&gt;Capture HTTPS CONNECTs-&gt;Decrypt HTTPS trafficï¼Œæ ¹æ®æç¤ºç”Ÿæˆåä¸º&quot;DO_NOT_TRUST_FiddlerRoot&quot;çš„æ ¹è¯ä¹¦å¹¶æ·»åŠ åˆ°ç³»ç»Ÿä¿¡ä»»æ ¹è¯ä¹¦åˆ—è¡¨ï¼› â—‡windowsä¸‹è¿è¡Œ&quot;certmgr.msc&quot;å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿå½“å‰ä¿¡ä»»çš„æ ¹è¯ä¹¦åˆ—è¡¨ï¼› â—‡æ‰“å¼€FiddleræŠ“åŒ…å¼€å…³ï¼Œè®¿é—®HTTPSç›®æ ‡ç½‘å€ï¼Œç‚¹å¼€åœ°å€æ é”å›¾æ ‡æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸­çš„è¯ä¹¦é¢å‘ç»„ç»‡éƒ½å˜æˆäº†&quot;DO_NOT_TRUST&quot;ï¼ŒFiddlerä¸­æ­¤æ—¶ä¹Ÿå¯æŸ¥çœ‹HTTPSåŒ…å†…å®¹ï¼› æŠ“å–æ‰‹æœºåŒ…(åŒ…æ‹¬HTTPS)çš„æ–¹æ³•â– å¦‚å·²ç»æŒ‰ä¸Šä¸€æ®µæ­¥éª¤ç”Ÿæˆæ ¹è¯ä¹¦åˆ™ç›´æ¥è¿›å…¥ä¸‹ä¸€æ­¥ï¼›â– è®¾ç½®Fiddlerä½œä¸ºå±€åŸŸç½‘ä»£ç†æœåŠ¡å™¨ï¼šTools-&gt;Options-&gt;Connections â– æ‰‹æœºè¿å…¥ä¸è¿è¡ŒFiddlerçš„PCç«¯ç›¸åŒçš„å±€åŸŸç½‘ï¼Œé…ç½®æ‰‹æœºçš„å±€åŸŸç½‘ä»£ç†ä¸ºPCå±€åŸŸç½‘IPåŠFiddlerè®¾ç½®çš„ç«¯å£ï¼›â– æ‰‹æœºç«¯å®‰è£…ä¿¡ä»»è¯ä¹¦ï¼ˆ1ï¼‰æ‰‹æœºè®¿é—®ç½‘å€http:&#x2F;&#x2F;PCå±€åŸŸç½‘IP:fiddlerè®¾ç½®çš„ç«¯å£ï¼Œé¡µé¢å†…ä¸‹è½½&quot;FiddlerRoot Certificate&quot;å®‰è£…å¹¶è®¾ç½®ç³»ç»Ÿä¿¡ä»»ï¼›ï¼ˆ2ï¼‰iOSç‰ˆæœ¬é«˜äº10.3éœ€é¢å¤–æ“ä½œæ‰‹æœºï¼šè®¾ç½®-&gt;é€šç”¨-&gt;å…³äºæœ¬æœº-&gt;è¯ä¹¦ä¿¡ä»»è®¾ç½®ï¼›"},{"title":"æµè§ˆå™¨å†…æ ¸åˆ—ä¸¾","date":"2020-12-25T06:48:39.000Z","path":"knowledge/æµè§ˆå™¨å†…æ ¸åˆ—ä¸¾.html","tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"https://congzhou09.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"text":"ç®€ä»‹â— æµè§ˆå™¨å†…æ ¸åŒ…å«ä¸¤ç§å¼•æ“ï¼šæ’ç‰ˆå¼•æ“ã€JS å¼•æ“ã€‚ç”±äº JS å¼•æ“è¶Šæ¥è¶Šç‹¬ç«‹ï¼Œæµè§ˆå™¨å†…æ ¸å€¾å‘äºå•æŒ‡æ’ç‰ˆå¼•æ“ã€‚â— æ’ç‰ˆå¼•æ“ä¹Ÿç§°&quot;æ¸²æŸ“å¼•æ“ï¼ˆRendering Engineï¼‰&quot;ï¼Œè´Ÿè´£æ¸²æŸ“ç½‘é¡µå†…å®¹çš„æ€»ä½“æ§åˆ¶ã€‚â— æ‰€æœ‰ç½‘é¡µæµè§ˆå™¨ã€ç”µå­é‚®ä»¶å®¢æˆ·ç«¯ä»¥åŠå…¶å®ƒéœ€è¦ç¼–è¾‘æ˜¾ç¤º HTML å†…å®¹çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦æ’ç‰ˆå¼•æ“ã€‚ æ’ç‰ˆå¼•æ“â— Tridentï¼ˆ&#x2F;`traidnt&#x2F; åˆç§°ä¸º MSHTMLï¼‰ï¼Œæ˜¯ Windows æ“ä½œç³»ç»Ÿæ›¾ç»æ­è½½çš„ IE æµè§ˆå™¨æ‰€ä½¿ç”¨çš„æ’ç‰ˆå¼•æ“ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬è¯ç”Ÿäº 1997 å¹´ 10 æœˆçš„ Internet Explorer ç¬¬å››ç‰ˆï¼Œ2015 å¹´å¾®è½¯æ¨å‡ºçš„ Edge æµè§ˆå™¨ä½¿ç”¨çš„æ˜¯ EdgeHTML æ’ç‰ˆå¼•æ“ï¼Œ2019 å¹´æ”¹ç”¨è°·æ­Œçš„ Blinkã€‚â— Geckoï¼ˆ&#x2F;`gekÉ™ÊŠ&#x2F;ï¼‰æ˜¯ä»¥ C++ç¼–å†™çš„å¼€æºæ’ç‰ˆå¼•æ“ï¼Œèƒ½åœ¨ Windowsã€Linux å’Œ Mac ç­‰ä¸»è¦æ“ä½œç³»ç»Ÿä¸Šè·¨å¹³å°è¿è¡Œï¼Œç”±ç½‘æ™¯é€šè®¯å…¬å¸å¼€å‘ï¼Œç°åœ¨ç”± Mozilla åŸºé‡‘ä¼šç»´æŠ¤ï¼Œè¢« Mozilla ç³»åˆ—äº§å“(å¦‚ Firefox æµè§ˆå™¨)æ‰€ä½¿ç”¨ã€‚â— KHTML æ˜¯è‡ªç”±è½¯ä»¶é¡¹ç›® KDE(K Desktop Environmentï¼ŒåŸºäº Qt å¼€å‘)ä¸­å®ç°çš„æ’ç‰ˆå¼•æ“ï¼Œæœ€åˆç”¨äº Linux å¼€æºæ“ä½œç³»ç»Ÿï¼Œè‹¹æœå°† KHTML é¡¹ç›® fork åˆ°è‡ªå·±çš„ WebKit é¡¹ç›®å¹¶åœ¨å…¶åŸºç¡€ä¸Šå¼€å‘å¹¶å‘½åä¸º WebCoreï¼Œç”¨äº Safari æµè§ˆå™¨ï¼Œåæ¥ WebKit é¡¹ç›®ä¹Ÿå¼€æºäº†ï¼ŒChrome æœ€åˆçš„æ’ç‰ˆå¼•æ“ä¹Ÿä½¿ç”¨ WebCoreã€‚â— Prestoï¼ˆ&#x2F;ËˆprestÉ™ÊŠ&#x2F;ï¼‰æ˜¯ç”± Opera Software å¼€å‘çš„æµè§ˆå™¨æ’ç‰ˆå¼•æ“ï¼Œåº”ç”¨äº Opera æµè§ˆå™¨ï¼ŒOpera åæ¥æ”¾å¼ƒäº†è‡ªæœ‰æ’ç‰ˆå¼•æ“è·Ÿéš Chromiumã€‚â— Blinkï¼ŒChrome åæ¥ä» WebCore fork å‡ºåˆ†æ”¯å¹¶å‘½åä¸º Blinkã€‚ JS å¼•æ“â—‡ JScriptï¼Œè€ç‰ˆæœ¬ IE ä½¿ç”¨ï¼Œ2011 å¹´å‘å¸ƒçš„ IE9 ä»¥åŠä¹‹å Edge æµè§ˆå™¨ä½¿ç”¨ Chakraï¼Œ2019 å¹´æ”¹ç”¨è°·æ­Œçš„ V8ã€‚â—‡ Monkey ç³»åˆ—ï¼ŒFirefox ä½¿ç”¨ã€‚â—‡ SquirrelFish ç³»åˆ—ï¼ŒSafari ä½¿ç”¨ã€‚â—‡ Carakanï¼ŒOpera ä½¿ç”¨ã€‚â—‡ V8ï¼ŒChrome ä»ç¬¬ä¸€ä¸ªç‰ˆæœ¬èµ·å°±ä½¿ç”¨çš„ JS å¼•æ“ï¼Œä»¥ C++ç¼–å†™çš„è°·æ­Œå¼€æºé¡¹ç›®ã€‚ æµè§ˆå™¨å†…æ ¸ï¼ˆä¹Ÿç§°ä¸ºæµè§ˆå™¨å¼•æ“ï¼ŒåŒ…å«äº†æ’ç‰ˆå¼•æ“å’Œ JS å¼•æ“ï¼‰â— WebKitï¼ˆ1ï¼‰WebKit æ˜¯è‹¹æœçš„æµè§ˆå™¨å†…æ ¸ï¼Œå§‹äº 2001 å¹´ï¼Œäº 2005 å¹´å¼€æºï¼Œå®ƒæ‰€åŒ…å«çš„ WebCore æ’ç‰ˆå¼•æ“å’Œ JavaScriptCore JS å¼•æ“åˆ†åˆ«æ˜¯ä» KDE çš„ KHTML å’Œ KJS è¡ç”Ÿè€Œæ¥ã€‚ï¼ˆ2ï¼‰2008 å¹´ WebKit å›¢é˜Ÿé‡å†™äº† JS å¼•æ“å‘½åä¸º SquirrelFishï¼Œå¹¶åœ¨ Chrome å‘å¸ƒçš„ä¸¤ä¸ªæ˜ŸæœŸåå‘å¸ƒã€‚ï¼ˆ3ï¼‰ç”±äºå®½æ¾çš„åè®®ã€è½»é‡çº§çš„è®¾è®¡å’Œä¾¿æ·çš„åº”ç”¨ç¨‹åºå†…åµŒ APIï¼ŒWebKit å˜å¾—æµè¡Œï¼Œé™¤äº† Google Chrome&#x2F;Chromium å’Œ Safariï¼Œå®ƒåœ¨ç§»åŠ¨ç»ˆç«¯ï¼ˆ Symbian S60ï¼ŒAndroidï¼ŒiOSï¼ŒKindleï¼‰åˆ° Toolkit é›†æˆ(GTK+, Qt4) éƒ½æœ‰ä¸é”™çš„æ”¶è·ï¼Œè¢«ç»Ÿç§°ä¸º WebKitã€‚â— Blinkï¼ˆ1ï¼‰&quot;Blink&quot;æœ‰æ—¶ä¹Ÿä½œä¸ºåŒ…å« Blink æ’ç‰ˆå¼•æ“å’Œ V8 JS å¼•æ“çš„æµè§ˆå™¨å†…æ ¸çš„åå­—ã€‚ï¼ˆ2ï¼‰Chrome æµè§ˆå™¨æœ€åˆä½¿ç”¨ WebKit çš„æ’ç‰ˆå¼•æ“ï¼ˆå³ WebCoreï¼‰æ˜¯ Android å›¢é˜Ÿçš„å»ºè®®ï¼Œç”±äºè°·æ­Œä¸è‹¹æœçš„ç«äº‰å…³ç³»ä½¿å¼€æºçš„åˆä½œæ— æ³•ç»´ç³»ï¼Œäºæ˜¯è¯ç”Ÿäº† Blinkã€‚ï¼ˆ3ï¼‰Google è‡ª 2013 å¹´èµ·åœ¨ Google Chrome&#x2F;Chromium ä¸­ä½¿ç”¨ Blinkï¼ŒiOS ä¸­çš„ Chrome ä»ç„¶ä½¿ç”¨çš„ WebCoreã€‚"},{"title":"ç½‘é¡µæ¸²æŸ“è¿‡ç¨‹","date":"2020-12-16T02:03:54.000Z","path":"knowledge/ç½‘é¡µæ¸²æŸ“è¿‡ç¨‹.html","tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"https://congzhou09.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"text":"æ€»è§ˆâ— ä» Web å†…å®¹åˆ°å±å¹•åƒç´ çš„å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼šé¦–å…ˆ Render è¿›ç¨‹ä¸»çº¿ç¨‹(Render çº¿ç¨‹)ä¸Šçš„æµè§ˆå™¨å†…æ ¸å®ä¾‹å°† HTML åŠå…³è”çš„ CSS ä¿¡æ¯è½¬æ¢ä¸ºç»˜åˆ¶ä¿¡æ¯ï¼Œç„¶åå°†ç»˜åˆ¶ä¿¡æ¯äº¤ç»™ Compositor çº¿ç¨‹å¹¶ç”± GPU è¿›ç¨‹ååŠ©å®Œæˆåˆ°å±å¹•åƒç´ çš„è½¬æ¢(æ­¤è¿‡ç¨‹ç§°ä¸ºå…‰æ …åŒ–&lt;rasterize&gt;)ï¼› â— Render çº¿ç¨‹å’Œ Compositor çº¿ç¨‹éƒ½ä½äºæµè§ˆå™¨çš„ Render è¿›ç¨‹ä¸­ã€‚æµè§ˆå™¨ä¸­è¿›ç¨‹ä¸çº¿ç¨‹ç›¸å…³æ•´ç†åœ¨è¿™ç¯‡æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹ï¼›â— Compositor çº¿ç¨‹çš„&quot;åˆæˆ&quot;åå­—æºè‡ªç°ä»£æµè§ˆå™¨å®ç°å…‰æ …åŒ–ä½¿ç”¨çš„åˆæˆæŠ€æœ¯ï¼ŒRender çº¿ç¨‹ä¼šå°†é¡µé¢æ‹†åˆ†ä¸ºå¤šä¸ª layer ï¼Œå„ä¸ª layer å°†åˆ†åˆ«å…‰æ …åŒ–å†åˆæˆä¸ºæœ€ç»ˆç»“æœï¼Œè¿™æ ·åšçš„ä¼˜ç‚¹æ˜¯å½“é¡µé¢æ»šåŠ¨æˆ–å®ç°åŠ¨ç”»æ—¶æŸäº›å›¾å±‚çš„ä¸Šæ¬¡å…‰æ …åŒ–ç»“æœå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼›â— æ¸²æŸ“æ¶‰åŠåˆæ¬¡æ¸²æŸ“ä¸æ›´æ–°æ¸²æŸ“ä¸¤ç§æƒ…å†µï¼Œæ›´æ–°æ¸²æŸ“åªæœ‰åœ¨å¿…è¦çš„æ—¶å€™æ‰è¿›è¡Œï¼ˆå¦‚ JS æ“ä½œ DOM&#x2F;CSSã€ç”¨æˆ·è¾“å…¥ã€å¼‚æ­¥åŠ è½½ã€é¡µé¢æ»šåŠ¨ä¸ç¼©æ”¾ã€åŠ¨ç”»ï¼‰ï¼Œæ›´æ–°æ¸²æŸ“æ—¶ä¼šå°½å¯èƒ½é‡ç”¨ä¸Šä¸€æ¬¡æ¸²æŸ“çš„ç»“æœï¼› åˆæ¬¡æ¸²æŸ“è¿‡ç¨‹ï¼ˆä»¥ Chrome ä¸ºä¾‹ï¼‰â—‹ æ„å»º DOMæ ‘ï¼ŒRender çº¿ç¨‹è§£æ HTML ç”Ÿæˆ DOM æ ‘ï¼ŒæœŸé—´é‡åˆ°çš„å›¾ç‰‡ã€CSSã€JS ç­‰å¤–éƒ¨èµ„æºæ–‡ä»¶ä¼šé€šçŸ¥ Browser è¿›ç¨‹ä»ç½‘ç»œæˆ–ç¼“å­˜è·å–è¿‡æ¥ï¼Œå½“è§£æåˆ° HTML ä¸­çš„ JS æˆ–è€…éå»¶è¿Ÿçš„ JS æ–‡ä»¶åŠ è½½å®Œæˆæ—¶å°±æš‚åœ DOM è§£æå…ˆå»æ‰§è¡Œå®Œ JS å†è¿”å›ï¼›â—‹ æ„å»º CSSOMæ ‘ï¼ŒRender çº¿ç¨‹å†ä¸€æ¬¡è§£æ HTML æ”¶é›†å„ä¸ªæ¥æº(style æ ‡ç­¾ã€css æ–‡ä»¶ã€æµè§ˆå™¨é»˜è®¤è§„åˆ™)çš„ style è§„åˆ™æ„å»ºæˆæ–¹ä¾¿æŸ¥æ‰¾çš„ CSSOM æ ‘ç»“æ„ï¼›â—‹ æ„å»º render æ ‘ï¼Œrender æ ‘æ¥è‡ª DOM æ ‘ä¸ CSSOM æ ‘ä¿¡æ¯çš„åˆå¹¶ï¼ŒRender çº¿ç¨‹éå† DOM æ ‘åŒæ—¶é’ˆå¯¹æ¯ä¸ªå…ƒç´ æŸ¥æ‰¾ CSSOM æ ‘ç¡®å®šå…¶æœ€ç»ˆ style(ComputedStyle)åŠå½“å‰å…ƒç´ æ˜¯å¦æ¸²æŸ“ï¼Œæ„å»ºå‡ºçš„ render æ ‘ä¸­ä¸åŒ…å« DOM æ ‘ä¸­çš„ä¸å¯è§å…ƒç´ ï¼ˆå¦‚ scriptã€metaï¼‰ï¼Œä¹Ÿä¸ä¼šåŒ…å« display å±æ€§å€¼ä¸º none çš„èŠ‚ç‚¹ï¼Œä½†ä¼šåŒ…å«ä¼ªå…ƒç´ ï¼Œrender æ ‘çš„èŠ‚ç‚¹ç§°ä¸º RenderObjectï¼› â—‹ layoutï¼ŒRender çº¿ç¨‹éå† render æ ‘æ„å»º layout æ ‘ï¼Œlayout æ ‘çš„èŠ‚ç‚¹æ˜¯ LayoutObjectï¼ŒLayoutObject èŠ‚ç‚¹åŒ…å«äº†å¯¹åº” render æ ‘èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œä»¥åŠç»è®¡ç®—å¾—å‡ºçš„è¯¥å…ƒç´ çš„ layout ä¿¡æ¯ï¼ˆä¸»è¦æ˜¯ xy åæ ‡ã€æ‰€å é¡µé¢ç©ºé—´å¤§å°ç­‰å‡ ä½•ä¿¡æ¯ï¼‰ï¼›â—‹ layerï¼ŒRender çº¿ç¨‹éå† layout æ ‘ï¼Œå°†é¡µé¢æ‹†åˆ†æˆå¤šä¸ª layer å­æ ‘ï¼›â—‹ prepaintï¼ŒRender çº¿ç¨‹åˆ›å»º property æ ‘é›†åˆè®°å½•å„ layer å­æ ‘çš„å›¾å½¢å›¾åƒå˜æ¢å±æ€§ï¼ˆtransformã€clipã€effectã€scrollï¼‰ï¼Œæ¯ä¸ª layer åˆ†åˆ«è¿›å…¥ä¹‹åçš„ paint é˜¶æ®µï¼› â—‹ paintï¼ŒRender çº¿ç¨‹éå† layer å­æ ‘åˆ›å»ºæè¿°å…¶ç»˜åˆ¶è¿‡ç¨‹çš„æ“ä½œè®°å½•(ç§°ä¸º paint records)åˆ—è¡¨ï¼Œç”±äºæ“ä½œè®°å½•çš„é¡ºåºä¼šå½±å“åˆ°å…ƒç´ é‡å åŒºåŸŸçš„å‰åé®æŒ¡å…³ç³»ï¼Œç»˜åˆ¶è¿‡ç¨‹ä¼šå¤§è‡´æŒ‰ç…§å¦‚ä¸‹é˜¶æ®µåˆ›å»ºç»˜åˆ¶å¯¹è±¡ï¼Œäºæ˜¯æ¯ä¸ªå…ƒç´ é€šå¸¸å¯¹åº”å¤šä¸ªç»˜åˆ¶å¯¹è±¡ï¼› â—‹ commitï¼ŒRender çº¿ç¨‹åŒæ­¥åœ°å°† layer ç»˜åˆ¶å¯¹è±¡åˆ—è¡¨åŠ property æ ‘é›†åˆä¼ è¾“åˆ° Compositor çº¿ç¨‹ï¼Œä¹‹åçš„æ­¥éª¤ä¸å†å ç”¨ Render çº¿ç¨‹ï¼›â—‹ tilingï¼ŒCompositor çº¿ç¨‹å°† layer æ‹†åˆ†ä¸ºå¤šä¸ª tileï¼Œlayer æ‰€å åŒºåŸŸå¯èƒ½æ¯”è¾ƒå¤§ä¸”è·ç¦»å½“å‰è§†å£è¾ƒè¿œï¼Œtile æŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºè¿›å…¥ raster é˜¶æ®µï¼›â—‹ rasterï¼ŒGPU è¿›ç¨‹ä¸­çš„ Raster çº¿ç¨‹(Rasterizer Thread)ä»¬å°†å„ä¸ªç»˜åˆ¶å¯¹è±¡é€šè¿‡ Skia åº“è½¬æ¢æˆ GL å‡½æ•°çš„è°ƒç”¨åºåˆ—ï¼ŒGL å‡½æ•°çš„è°ƒç”¨åºåˆ—æ‰§è¡Œåç”Ÿæˆå­˜å‚¨äº GPU å†…å­˜ä¸­çš„ç”±åƒç´ é¢œè‰²å€¼ç»„æˆçš„ bitmapï¼›â—‹ drawï¼ŒCompositor çº¿ç¨‹æ”¶é›†å½“å‰è§†å£åŒºåŸŸå†…çš„æ‰€æœ‰ tile çš„ GPU å†…å­˜åœ°å€å’Œå±å¹•ä½ç½®ç­‰ä¿¡æ¯(è¿™äº›ä¿¡æ¯ç§°ä¸º draw quads)å°è£…æˆä¸€ä¸ª CompositorFrame æäº¤ç»™ Browser è¿›ç¨‹ï¼Œé™¤äº† Render è¿›ç¨‹ä¹‹å¤–ï¼ŒBrowser è¿›ç¨‹ä¹ŸåŒæ—¶æ”¶é›†æ¥è‡ª UI çº¿ç¨‹ã€æ’ä»¶è¿›ç¨‹çš„ CompositorFrameï¼Œå°†å®ƒä»¬ä¸€å¹¶äº¤ç»™ GPU è¿›ç¨‹åšèšåˆä¹‹åç»˜åˆ¶åˆ°å±å¹•ï¼› æ›´æ–°æ¸²æŸ“è¿‡ç¨‹ï¼ˆä»¥ Chrome ä¸­çš„ input äº‹ä»¶ä¸ºä¾‹ï¼‰â˜† è¿™é‡Œçš„ input äº‹ä»¶åŒ…æ‹¬é’ˆå¯¹ç½‘é¡µåŒºåŸŸçš„æ‰€æœ‰ç‚¹å‡»ã€è¾“å…¥ã€æ»šè½®ã€é¼ æ ‡ç§»åŠ¨ã€é¼ æ ‡æ‚¬åœã€è§¦æ‘¸ã€ç¼©æ”¾ç­‰é¼ æ ‡é”®ç›˜è§¦æ‘¸äº‹ä»¶ï¼›â˜†input äº‹ä»¶é¦–å…ˆè¢« Browser è¿›ç¨‹æ•æ‰åˆ°ï¼ŒBrowser è¿›ç¨‹åˆ¤æ–­äº‹ä»¶çš„åæ ‡åŠæ‰€åœ¨é¡µé¢ï¼Œå°†äº‹ä»¶åŠåæ ‡ä¿¡æ¯å‘é€ç»™å¯¹åº”çš„ Render è¿›ç¨‹ï¼Œäº‹ä»¶å…ˆè¢« Compositor çº¿ç¨‹å¤„ç†ï¼ŒCompositor çº¿ç¨‹åˆ¤æ–­äº‹ä»¶æ˜¯å¦ä½äºäº‹ä»¶ç›‘å¬åŒºåŸŸï¼Œå¦‚æœåœ¨ç›‘å¬åŒºåŸŸä¹‹å¤–åˆ™ä¸ç»è¿‡ Render çº¿ç¨‹è€Œç”± Compositor çº¿ç¨‹ç›´æ¥ç”Ÿæˆæ–°çš„ CompositorFrameï¼Œå¦åˆ™å°†äº‹ä»¶äº¤ç»™ Render çº¿ç¨‹ï¼ŒRender çº¿ç¨‹å¤„ç†äº‹ä»¶æµåŠäº‹ä»¶ç›‘å¬å›è°ƒï¼Œä¹‹åç”± Event Loop è§¦å‘ Compositor çº¿ç¨‹ç”Ÿæˆæ–° CompositorFrame çš„è¿‡ç¨‹ï¼› è¦ç‚¹è¡¥å……â—‡ æ¸²æŸ“æµç¨‹ä¸­çš„æ¯ä¸€æ­¥ç»“æœéƒ½æ˜¯åŸºäºä¸Šä¸€æ­¥ç»“æœçš„ï¼Œæ‰€ä»¥å½“ä¸Šæ¸¸å†…å®¹æœ‰å˜åŒ–æ—¶ï¼Œä¸‹æ¸¸æ­¥éª¤éƒ½éœ€è¦é‡æ–°æ‰§è¡Œä¸€éï¼›â—‡ reflow ä¸ repaintï¼ˆ1ï¼‰reflow æŒ‡æµè§ˆå™¨éœ€è¦é‡æ–°è®¡ç®—å…ƒç´ çš„å‡ ä½•ç‰¹æ€§ï¼Œä» layout é˜¶æ®µé‡æ–°ç”Ÿæˆä¸€æ¬¡ CompositorFrameï¼Œå¼•èµ· reflow çš„æ“ä½œå¦‚ï¼šæ”¹å˜å…ƒç´ çš„ display å±æ€§ã€DOM æ ‘å¢å‡å…ƒç´ ã€æ”¹å˜å…ƒç´ çš„å¤§å°æˆ–ä½ç½®ï¼Œè¯¦ç»†å±æ€§å¦‚ä¸‹å›¾ï¼› ï¼ˆ2ï¼‰repaint éœ€è¦é‡æ–°ç»˜åˆ¶å…ƒç´ ï¼Œä» paint é˜¶æ®µé‡æ–°ç”Ÿæˆä¸€æ¬¡ CompositorFrameï¼Œå¼•èµ· Repaint çš„æ“ä½œå¦‚ï¼šæ”¹å˜å…ƒç´ çš„èƒŒæ™¯è‰²æˆ– box-shadowï¼› ï¼ˆ3ï¼‰reflow è¿‡ç¨‹åŒ…å« repaintï¼›ï¼ˆ4ï¼‰repaint ä¼š repaint å˜åŒ–å…ƒç´ åŠä¸å…¶å±äºåŒä¸€ä¸ª layer çš„å…¶ä»–å…ƒç´ ï¼Œä¸ä¼š repaint å…¶ä»– layerï¼›â—‡ Compositor çº¿ç¨‹é‡Œä¼šç»´æŠ¤å½“å‰å¸§ä¸ä¸‹ä¸€å¸§çš„ç»˜åˆ¶ä¿¡æ¯ï¼Œå½“å‰å¸§(active tree)åœ¨ draw é˜¶æ®µæ—¶å¯ä»¥åŒæ—¶è¿›è¡Œä¸‹ä¸€å¸§(pending tree)çš„ raster é˜¶æ®µï¼› ç½‘é¡µæ¸²æŸ“è¯¦ç»†è¿‡ç¨‹å›¾ Chrome ç›¸å…³å·¥å…·â—‡ é€šè¿‡ Chrome çš„ Layers å·¥å…·å¯ä»¥æŸ¥çœ‹é¡µé¢è¢«åˆ†æˆäº†å“ªäº› layerï¼Œä»¥åŠæ¯ä¸ª layer çš„æ‹†åˆ†åŸå› å’Œ paint é˜¶æ®µçš„ç»˜åˆ¶å¯¹è±¡ï¼› â—‡ é€šè¿‡ Chrome çš„ Performance å·¥å…·å¯ä»¥æŸ¥çœ‹æ¸²æŸ“è¿‡ç¨‹ä¸­ Render çº¿ç¨‹ã€Raster å·¥ä½œçº¿ç¨‹ã€GPU è¿›ç¨‹ã€Compositor çº¿ç¨‹çš„ timeline åŠä¸æµè§ˆå™¨å„å¸§çš„å¯¹åº”å…³ç³»ï¼› â—‡ ç›®å‰çš„æ‹†åˆ† layer è¿‡ç¨‹åŠå›¾å½¢å›¾åƒå˜æ¢å±æ€§åœ¨ paint é˜¶æ®µä¹‹å‰ç”± Render çº¿ç¨‹å®Œæˆï¼Œè¿™ä»ç›®å‰çš„ Performance é‡Œå¯ä»¥çœ‹åˆ°ï¼Œå®˜æ–¹è®¡åˆ’ä¹‹åå°†æŠŠè¿™éƒ¨åˆ†å·¥ä½œæ”¾åˆ° paint é˜¶æ®µåé¢ï¼› ç›¸å…³ç¼–ç¨‹æŠ€å·§â—† å½“é¡µé¢å…ƒç´ å˜åŒ–æ—¶ï¼Œé€šè¿‡é¿å… reflow ç”šè‡³åŒæ—¶é¿å… repaint è€Œåªé€šè¿‡ Compositor çº¿ç¨‹å®Œæˆæ›´æ–°æ¸²æŸ“ï¼Œå¯ä»¥æé«˜é¡µé¢çš„æ€§èƒ½ï¼Œä¸ä»…å› ä¸ºæ€»ä½“è¿ç®—é‡å°‘ï¼Œä¹Ÿå› ä¸º paint ä¹‹åçš„é˜¶æ®µéƒ½ä¸åœ¨ Render çº¿ç¨‹ä¸Šè¿›è¡Œï¼›â—† å½“ä¸‹ä¸»æµæµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariã€Operaï¼‰éƒ½å®ç°äº†ä»…é€šè¿‡ compositing å®Œæˆ transform ä¸ opacity ä¸¤ç§ CSS å±æ€§ï¼Œæå¤§æé«˜äº†åŸºäºäºŒè€…æ‰€å®ç°é¡µé¢åŠ¨ç”»(ç§°ä¸º compositing only animations)çš„æµç•…åº¦ï¼Œæ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰å°†åŠ¨ç”»å…ƒç´ æå‡åˆ°å•ç‹¬ä¸€å±‚ layerï¼Œå®ç°æ­¤ç›®çš„çš„ä¸“ç”¨ CSS å±æ€§&quot;will-change&quot;è¿˜åœ¨å®éªŒé˜¶æ®µï¼Œä¸‹å›¾å„æ–¹å¼å¯ä»¥æ›´å…¼å®¹åœ°å°†å…ƒç´ æå‡ä¸ºå•ç‹¬çš„ layerï¼Œä¾‹å¦‚ï¼š&quot;transform: translateZ(0)&quot;ï¼Œè¿™ä¸€æ­¥æ˜¯ä¸‹ä¸€æ­¥æ›¿ä»£ CSS å±æ€§çš„å‰æï¼Œå³ä½¿ä¸‹ä¸€æ­¥æ— æ³•æ›¿ä»£ï¼Œlayer çš„æå‡ä¹Ÿå¯ä»¥å‡å°‘ reflow ä¸ repaint çš„æ³¢åŠèŒƒå›´ï¼› ï¼ˆ2ï¼‰å°½å¯èƒ½ä½¿ç”¨ transform ä»£æ›¿ leftã€top ç­‰å±æ€§ä»¥åŠä½¿ç”¨ opacity å±æ€§ä»£æ›¿ rgba é¢œè‰²å€¼æ¥å®ç°ç­‰ä»·çš„ CSS åŠ¨ç”»ï¼› å‚è€ƒæ–‡çŒ®â—life of a pixelâ—Inside look at modern web browser ç³»åˆ—â—Constructing the Object Modelâ—Render-tree Construction, Layout, and Paintâ—Chromium Source Code README.mdâ—Eliminate content repaints with the new Layers panel in Chromeâ—High Performance Animationsâ—Stick to Compositor-Only Properties and Manage Layer Countâ—GPU Accelerated Compositing in Chrome"},{"title":"æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹","date":"2020-12-11T09:08:00.000Z","path":"knowledge/æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹.html","tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"https://congzhou09.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"text":"æµè§ˆå™¨ä¸­çš„è¿›ç¨‹â—† ç°ä»£æµè§ˆå™¨éƒ½æ˜¯å¤šè¿›ç¨‹çš„ï¼Œä¸è¿‡ç›®å‰æ²¡æœ‰æ ‡å‡†è§„èŒƒçº¦å®šæµè§ˆå™¨å…·ä½“è¦åˆ†ä¸ºå“ªäº›è¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œæ‰€ä»¥å„æµè§ˆå™¨å‚å•†å®ç°ç»†èŠ‚ä¼šæœ‰ä¸åŒä¸”éšç€å‘å±•åœ¨ä¸æ–­è°ƒæ•´ä¸­ï¼Œæœ¬æ–‡ä»¥ Chrome æµè§ˆå™¨ä¸ºä¾‹ï¼ŒChrome çš„æµè§ˆå™¨å†…æ ¸æ˜¯ Blinkï¼›â—† Chrome ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹è¿›ç¨‹ï¼šï¼ˆ1ï¼‰Browser è¿›ç¨‹ï¼Œæµè§ˆå™¨ä¸»è¿›ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªï¼Œè´Ÿè´£æµè§ˆå™¨åŸºæœ¬ç•Œé¢å’ŒåŠŸèƒ½ï¼ˆå¦‚åœ°å€æ ã€ä¹¦ç­¾ã€å‰è¿›åé€€æŒ‰é’®ï¼‰çš„å±•ç¤ºä¸äº¤äº’ã€æ“ä½œç³»ç»Ÿç‰¹æƒåŠŸèƒ½å¦‚ç½‘ç»œè¯·æ±‚å’Œæ–‡ä»¶è®¿é—®ï¼Œä»¥åŠå„å­è¿›ç¨‹çš„ç®¡ç†ï¼›ï¼ˆ2ï¼‰Render è¿›ç¨‹ï¼Œä¹Ÿç§°ä¸ºâ€œRendererâ€ï¼Œé€šå¸¸æœ‰å¤šä¸ªï¼Œè´Ÿè´£ç½‘é¡µå†…å®¹ç›¸å…³çš„äº‹åŠ¡ï¼Œé€šå¸¸è¯´çš„â€œæµè§ˆå™¨å†…æ ¸â€è¿è¡Œåœ¨ Render è¿›ç¨‹ï¼Œé»˜è®¤æ¯ä¸ª tab é¡µå¯¹åº”ä¸€ä¸ª Render è¿›ç¨‹ï¼Œå½“æ»¡è¶³æŸäº›æ¡ä»¶å¦‚ tab é¡µè¶…è¿‡ä¸€å®šæ•°é‡æˆ–ç³»ç»Ÿèµ„æºç´§ç¼ºæ—¶ä¼šåšåˆå¹¶ä¼˜åŒ–ï¼ˆæ¯”å¦‚ç›¸åŒç½‘ç«™ tab å…±ç”¨ä¸€ä¸ª Render è¿›ç¨‹ç”šè‡³ä¸åŒç½‘ç«™ tab å…±ç”¨ä¸€ä¸ª Render è¿›ç¨‹ï¼‰ï¼›ï¼ˆ3ï¼‰Utility è¿›ç¨‹ï¼Œæœ‰å¤šä¸ªï¼Œç”¨äºç½‘ç»œã€å­˜å‚¨ã€éŸ³é¢‘æ’­æ”¾ç­‰é€šç”¨åŠŸèƒ½ï¼›ï¼ˆ4ï¼‰GPU è¿›ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªï¼Œé›†ä¸­å¤„ç† GPU ä»»åŠ¡ï¼›ï¼ˆ5ï¼‰Plugin è¿›ç¨‹ï¼Œæœ‰å¤šä¸ªï¼Œè´Ÿè´£åœ¨åå°è¿è¡Œæµè§ˆå™¨æ’ä»¶ï¼› â—† é€šè¿‡â€œShift+Escâ€æ‰“å¼€æµè§ˆå™¨çš„â€œä»»åŠ¡ç®¡ç†å™¨â€å¯ä»¥çœ‹åˆ°å½“å‰è¿è¡Œçš„æ‰€æœ‰æµè§ˆå™¨è¿›ç¨‹ï¼›â—† ä¸Šè¿°è¿›ç¨‹éƒ½æ˜¯å¤šçº¿ç¨‹çš„ï¼Œè€Œä¸”æ‰€æœ‰è¿›ç¨‹éƒ½æœ‰ä¸¤ä¸ªåŸºç¡€çº¿ç¨‹ï¼šMain çº¿ç¨‹å’Œ I&#x2F;O çº¿ç¨‹ï¼Œå¦å¤–å¯èƒ½æœ‰äº›åšç‰¹å®šå·¥ä½œçš„çº¿ç¨‹ï¼Œä»¥åŠåšé€šç”¨å·¥ä½œçš„çº¿ç¨‹æ± ï¼›â—† Browser è¿›ç¨‹ä¸­çš„ Main çº¿ç¨‹ä¹Ÿç§°ä¸º UI çº¿ç¨‹ï¼Œä¸»è¦è´Ÿè´£ UI ç›¸å…³ï¼ŒBrowser è¿›ç¨‹ä¸­çš„ I&#x2F;O çº¿ç¨‹å¤„ç† IPCï¼ˆInter-process communication è¿›ç¨‹é—´é€šä¿¡ï¼‰ä¸ç½‘ç»œè¯·æ±‚ï¼›â—† Render è¿›ç¨‹ä¸­çš„ Main çº¿ç¨‹ä¹Ÿç§°ä¸º Render çº¿ç¨‹(æœ‰æ—¶ä¹ŸæŒ‰ç…§æµè§ˆå™¨å†…æ ¸åå‘½åå¦‚ Blink ä¸»çº¿ç¨‹)ï¼ŒåŒæ ·æœ‰ I&#x2F;O çº¿ç¨‹å¤„ç† IPCï¼›â—† å‡ ä¹æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¸æ–­ä»ä»»åŠ¡é˜Ÿåˆ—è·å–è¦æ‰§è¡Œä»»åŠ¡çš„ loopï¼Œå¤šä¸ªçº¿ç¨‹å¯èƒ½å…±äº«åŒä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼› Render è¿›ç¨‹ä¸­çš„çº¿ç¨‹â—† Render çº¿ç¨‹ä¼šåˆ›å»ºäº†ä¸€ä¸ªæµè§ˆå™¨å†…æ ¸å®ä¾‹ï¼Œç”¨äºå¤„ç†æ¥æ”¶åˆ°çš„ç½‘é¡µå†…å®¹ï¼Œå®ƒä¼šé’ˆå¯¹æ¯ä¸ªç½‘é¡µå»ºç«‹ä¸€ä¸ª RenderView å®ä¾‹ï¼Œæ¯ä¸ª RenderView å®ä¾‹åˆä¼šè¢«å…³è”åˆ° Browser è¿›ç¨‹ä¸­çš„ä¸€ä¸ª RenderViewHost å®ä¾‹ä»¥ä¾¿ Browser è¿›ç¨‹çš„ç»Ÿä¸€ç®¡ç†ï¼›â—† Browser è¿›ç¨‹ä¸ Render è¿›ç¨‹åŠå„è‡ªä¸»è¦çº¿ç¨‹çš„å…³ç³»å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­ Render è¿›ç¨‹çš„çº¿ç¨‹åœ¨ç¬¬ä¸€å¼ å›¾ä¸­ä¸å‡†ç¡®ï¼Œä»¥ç¬¬äºŒå¼ å›¾ä¸ºå‡†ï¼› â—† æµè§ˆå™¨å†…æ ¸å®ä¾‹åŒ…å«å¦‚ä¸‹åŠŸèƒ½ï¼šï¼ˆ1ï¼‰æ’ç‰ˆå¼•æ“ï¼Œè´Ÿè´£å°†ä»ç½‘ç»œè·å–åˆ°çš„ç½‘é¡µå†…å®¹æ•°æ®å¯è§†åŒ–åœ°å±•ç¤ºåˆ°å±å¹•ã€‚æ’ç‰ˆå¼•æ“ä¸­åŒ…å«äº†è´Ÿè´£è§£æç¼–è¯‘ä¸è¿è¡Œ JS ä»£ç çš„ JS å¼•æ“ï¼›ï¼ˆ2ï¼‰å¯¹HTML Living Standardçš„å®ç°ï¼ŒåŒ…æ‹¬ï¼šäº‹ä»¶å¾ªç¯(Event Loop)ã€ä»»åŠ¡é˜Ÿåˆ—ï¼ˆTask Queueï¼‰ã€å„ç§ Workerã€åƒåœ¾å›æ”¶ï¼Œä»¥åŠ HTMLElementã€setTimeoutã€XMLHttpRequest ç­‰å„ç§æ¥å£ä¸ APIï¼›â—† æµè§ˆå™¨å†…æ ¸å®ä¾‹ä¸ºå®ŒæˆåŠŸèƒ½ä¼šå†å¼€å¯æ–°çº¿ç¨‹ï¼Œå¦‚ worker çº¿ç¨‹(Web Workersã€ServiceWorker ä¸ Worklets)ä¸ internal çº¿ç¨‹(webaudioã€databaseã€GC ç­‰)ï¼Œä»¥åŠè¾…åŠ©é¡µé¢æ¸²æŸ“çš„ Compositor çº¿ç¨‹ï¼›â—† JS å¼•æ“æ˜¯å†…åµŒåœ¨æ’ç‰ˆå¼•æ“è¢«è¢«åŠ¨è°ƒç”¨çš„ï¼ŒäºŒè€…éƒ½åœ¨ Render çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œä»è€Œäº§ç”Ÿå¹³æ—¶çœ‹åˆ°çš„â€œæ’ç‰ˆå¼•æ“ä¸ JS å¼•æ“çš„æ‰§è¡Œæ˜¯äº’æ–¥çš„ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œå…¶ä¸­ä¸€ä¸ªâ€çš„ç»“æœï¼›â—† å¯¹äº Blink ï¼Œ Event Loop æœºåˆ¶ç”± Scheduler å®Œæˆã€‚Scheduler å®ä¾‹å­˜åœ¨äº Render çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä½†åˆæœ‰è‡ªå·±çš„ç‹¬ç«‹çº¿ç¨‹ï¼Œå®ƒç»´æŠ¤äº†å¤šä¸ªæŒ‰ä»»åŠ¡ç±»å‹åˆ’åˆ†çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰€æœ‰å¸Œæœ› post ç»™ Render çº¿ç¨‹å¤„ç†çš„ä»»åŠ¡(å¦‚è§£æ Html )éƒ½å…ˆé€šè¿‡è°ƒç”¨ Scheduler æä¾›çš„ API å°†ä»»åŠ¡æ”¾å…¥å¯¹åº”ç±»å‹çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œ Scheduler ä¼šæ ¹æ®ä¼˜å…ˆçº§ç­–ç•¥åŠ Render çº¿ç¨‹å½“å‰çŠ¶æ€ç¡®å®šè¦æ‰§è¡Œå“ªä¸€ä¸ªä»»åŠ¡ä¹‹åå†å°†å…¶ post ç»™ Render çº¿ç¨‹çš„ message loopï¼Œä¸‹å›¾è‡ªä¸Šè€Œä¸‹å±•ç¤ºäº†æ­¤è¿‡ç¨‹ï¼› â—† é»˜è®¤æƒ…å†µä¸‹ input ç±»ä»»åŠ¡ä¼˜å…ˆçº§æœ€é«˜ï¼Œå…¶æ¬¡æ˜¯ Compositor ç±»çš„ä»»åŠ¡ï¼Œå…·ä½“ä¼˜å…ˆçº§æƒé‡ä¼šæ ¹æ®ç­–ç•¥åšåŠ¨æ€è°ƒæ•´ï¼›â—† Compositor çº¿ç¨‹ç­‰ç½‘é¡µæ¸²æŸ“ç›¸å…³çš„çº¿ç¨‹åœ¨è¿™ç¯‡ç½‘é¡µæ¸²æŸ“è¿‡ç¨‹ï¼›â—† JS å¼•æ“ä¸ Event Loop ç›¸å…³æ•´ç†åœ¨è¿™ç¯‡æµè§ˆå™¨ç»„æˆä¸ JS è¿è¡Œæ—¶ç¯å¢ƒï¼› å‚è€ƒæ–‡çŒ®â—How Web Browsers Use Process &amp; Threadsâ—How Mozilla Firefox and Google Chrome Use Process &amp; Threadsâ—Google Developers: Inside Look At Modern Web Browser ç³»åˆ—â—How Blink Worksâ—The Chromium Projects: Multi-process Architectureâ—The Chromium Projects: How Chromium Displays Web Pagesâ—Chromium Source Code And Code Comments And Readme.md â—Threading and Tasks in Chromeâ—Blink Schedulerâ—JavaScript: How Is Callback Execution Strategy For Promises Different Than DOM Events Callback?"},{"title":"é’‰é’‰å¾®åº”ç”¨ä¸å°ç¨‹åºçš„å…ç™»æµç¨‹","date":"2020-10-21T08:41:46.000Z","path":"handbook/é’‰é’‰å¾®åº”ç”¨ä¸å°ç¨‹åºçš„å…ç™»æµç¨‹.html","tags":[{"name":"é’‰é’‰","slug":"é’‰é’‰","permalink":"https://congzhou09.github.io/tags/%E9%92%89%E9%92%89/"}],"text":"æ­£æ–‡â™‚é’‰é’‰å®˜æ–¹å¼€å‘æ–‡æ¡£ä¸­å¯¹å¾®åº”ç”¨å…å¯†ç ç™»å½•æµç¨‹çš„è¯´æ˜åœ¨æ­¤é¡µé¢ï¼Œæ€»ä½“åˆ†ä¸‰æ­¥ï¼šï¼ˆ1ï¼‰è·å–å…ç™»æˆæƒç ï¼›ï¼ˆ2ï¼‰è·å–access_tokenï¼›ï¼ˆ3ï¼‰è·å–useridï¼›â™‚ç”»äº†è¿™ä¸ªè¿‡ç¨‹çš„æ—¶åºå›¾å¦‚ä¸‹ï¼Œæ–¹ä¾¿å¯¹å…¶æ›´ç›´è§‚çš„äº†è§£ï¼Œå°ç¨‹åºçš„å…ç™»æµç¨‹åŸºæœ¬ä¸€è‡´ï¼Œä¹Ÿå«åœ¨å…¶ä¸­ï¼› ç”»è¿™ä¸ªå›¾çš„å·¥å…·â™€ä¹‹å‰ç”»å›¾ç”¨ProcessOnï¼Œè™½ç„¶ç”»å›¾åŠŸèƒ½å¥½ç”¨åˆå¯ä»¥å¤šäººåä½œä½†å…è´¹ç‰ˆåªèƒ½ä¿å­˜ä¸ºå›¾ç‰‡æ ¼å¼è€Œä¸”æœ‰æ•°é‡é™åˆ¶ï¼›â™€æ˜¨å¤©å‘ç°ä¸€ä¸ªè¶…çº§å¥½çš„åœ¨çº¿ç”»å›¾å·¥å…·ï¼šdiagrams.netï¼Œæ”¯æŒUMLç±»å›¾ã€æ—¶åºå›¾ã€ERå›¾ç­‰ï¼Œæˆ‘è¿™å¼ å›¾å°±æ˜¯ç”¨å®ƒç”»çš„ï¼Œæœ€å¤§çš„ä¼˜ç‚¹æœ‰ä¸¤ä¸ªï¼šï¼ˆ1ï¼‰å¯ä»¥ä¿å­˜æ–‡ä»¶åˆ°æœ¬åœ°åŠä¸‹æ¬¡æ‰“å¼€æ–‡ä»¶ï¼ˆpngå›¾ç‰‡æ ¼å¼åŒæ ·æ”¯æŒäºŒæ¬¡ç¼–è¾‘ï¼‰ï¼Œä¹Ÿå¯ä»¥æŠŠå›¾ä¿å­˜åˆ°çº¿ä¸Šä»£ç ä»“åº“å¦‚GitLabï¼Œé€šè¿‡é…ç½®ä»£ç ä»“åº“memberåŠgitå·¥ä½œæµä¹Ÿèƒ½å®ç°å¤šäººåä½œï¼Œå½“ç„¶ä¹Ÿå°±å…è´¹å’Œæ²¡æœ‰æ•°é‡é™åˆ¶å’§ï¼›ï¼ˆ2ï¼‰ä½¿ç”¨ä»£ç ä»“åº“çš„Pagesé™æ€èµ„æºåŠŸèƒ½å¯ä»¥å°†å›¾ä½œä¸ºå…¬ç½‘èµ„æºç”¨urlè®¿é—®ï¼Œè¿™æ ·æ¯æ¬¡æ”¹å›¾å°±å¯ä»¥è‡ªåŠ¨åŒæ­¥ä¿®æ”¹å’§ï¼›"},{"title":"Babelç›¸å…³å†…å®¹ä¸²è”","date":"2020-10-07T14:51:48.000Z","path":"knowledge/Babelç›¸å…³å†…å®¹ä¸²è”.html","tags":[{"name":"Babel","slug":"Babel","permalink":"https://congzhou09.github.io/tags/Babel/"}],"text":"åŸºæœ¬æ¦‚å¿µâ— Babel æ˜¯ä¸ª JS ç¼–è¯‘å™¨ï¼Œä¸å¤§å¤šæ•°ç¼–è¯‘å™¨ä¸€æ ·ï¼ŒåŒ…å«â€œparsingâ€ã€â€œtransformingâ€ã€â€œgenerationâ€ä¸‰ä¸ªå¤„ç†é˜¶æ®µã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»£ç é¦–å…ˆç»ç”± @babel&#x2F;parser(æ›¾ç”¨å Babylon) è§£ææˆæŠ½è±¡è¯­æ³•æ ‘(AST)ï¼Œç„¶åå¯¹ AST åšéå†(@babel&#x2F;traverse)å’Œè½¬æ¢(å„ç§@babel&#x2F;plugin-..)ï¼Œæœ€åæ ¹æ®è½¬æ¢åçš„ AST ç”Ÿæˆæ–°çš„å¸¸è§„ JS ä»£ç (@babel&#x2F;generator)ã€‚ â— Babel æœ¬èº«å¯çœ‹ä½œæ˜¯ä¸ªæµæ°´çº¿ç©ºç›’å­ï¼Œæ¯ä¸ªé˜¶æ®µå…·ä½“å¤„ç†è¿‡ç¨‹æ˜¯é€šè¿‡å„ç§æ’ä»¶(plugin)å®ç°çš„ï¼Œé€šè¿‡é…ç½®ä¸åŒçš„æ’ä»¶ç»„åˆè¾¾åˆ°ä¸åŒçš„å¤„ç†ç›®çš„ã€‚â— Babel çš„ plugin æœ‰ä¸¤ç±»ï¼šï¼ˆ1ï¼‰Syntax Plugins(è¯­æ³•æ’ä»¶)ï¼Œç”¨äºä½¿ babel æ”¯æŒå¯¹ç‰¹å®šè¯­æ³•çš„ parseã€‚ï¼ˆ2ï¼‰Transform Plugins(è½¬è¯‘æ’ä»¶)ï¼Œç”¨äº transforming é˜¶æ®µçš„æ’ä»¶ï¼Œæ­¤ç±»æ’ä»¶åŒ…å«äº† parse é˜¶æ®µç›¸å…³çš„ Syntax Plugin å¹¶ä¼šåœ¨ä»£ç è½¬è¯‘ä¸ºç›®æ ‡ç­‰çº§ä»£ç æœŸé—´è‡ªåŠ¨ä½¿ç”¨å®ƒä»¬ã€‚â— å¦‚æœä»…ç¼–è¯‘å°èŒƒå›´å†…å®¹ï¼Œå¯ä»¥é€šè¿‡ä»…å¼•å…¥å¯¹åº”çš„ plugin å®ç°ã€‚æ›´å¸¸è§çš„æ–¹å¼æ˜¯ä½¿ç”¨ presets(é¢„è®¾)ï¼Œå®ƒæ˜¯ä¸ºç‰¹å®šç›®çš„é¢„ç½®çš„ä¸€ç»„ plugin çš„é›†åˆã€‚â— æ ¹æ®ä¸åŒè½¬æ¢ç›®çš„ï¼Œå¸¸è§çš„ presets å¦‚ä¸‹ï¼Œæœ¬æ–‡ä¸»è¦é¢å‘è½¬æ¢ ES è¯­æ³•çš„åœºæ™¯ã€‚ï¼ˆ1ï¼‰ç”¨äºè½¬æ¢ ES è¯­æ³•çš„ @babel&#x2F;preset-envã€‚ï¼ˆ2ï¼‰ç”¨äºè½¬æ¢ React è¯­æ³•çš„ @babel&#x2F;preset-reactã€‚è¿™ä¸ª preset ä¸­åŒ…å«çš„æœ€è‘—åæ’ä»¶æ˜¯ç”¨äºè½¬æ¢ JSX è¯­æ³•çš„ @babel&#x2F;plugin-transform-react-jsxã€‚ï¼ˆ3ï¼‰ç”¨äºè½¬æ¢ TypeScript è¯­æ³•çš„@babel&#x2F;preset-typescriptã€‚â— preset åŠ plugin çš„ä½¿ç”¨ï¼Œé™¤äº† npm å®‰è£…ï¼Œè¿˜éœ€è¦é€šè¿‡ Babel é…ç½®æ–‡ä»¶(å¦‚â€œ.babelrcâ€)é…ç½®ï¼Œé…ç½®å†…å®¹æ˜¯ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡æ ¼å¼ç¤ºä¾‹å¦‚ä¸‹ï¼Œå¯¹è±¡å±æ€§å­—æ®µ &quot;presets&quot; å’Œ &quot;plugins&quot; çš„å–å€¼åˆ†åˆ«æ˜¯ä¸ªæ•°ç»„ï¼Œæ•°ç»„å†…å®¹æ˜¯å…·ä½“ preset æˆ– plugin åç§°çš„å­—ç¬¦ä¸²ï¼Œè€Œå½“ preset æˆ– plugin ä¹Ÿè¦æœ‰è‡ªå·±çš„ options æ—¶å°±ä½¿ç”¨æ•°ç»„è¡¨ç¤ºï¼Œæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ preset æˆ– plugin åç§°çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¯¹åº”çš„ options å¯¹è±¡ã€‚ 12345678910111213141516&#123; &quot;presets&quot;: [ [ &quot;@babel/preset-env&quot;, &#123; &quot;modules&quot;: false, &quot;useBuiltIns&quot;: &quot;usage&quot;, &quot;corejs&quot;: 3, &quot;targets&quot;: &#123; &quot;safari&quot;: &quot;6&quot; &#125; &#125; ] ], &quot;plugins&quot;: [&quot;@babel/plugin-external-helpers&quot;]&#125; â— é…ç½®å¤šä¸ª preset ä¸ plugin æƒ…å†µä¸‹çš„æ‰§è¡Œé¡ºåºï¼š 123ï¼ˆ1ï¼‰æ€»ä½“å…ˆæ‰§è¡Œ Plugin å†æ‰§è¡Œ Preset ï¼Œä¸äºŒè€…å£°æ˜æ¬¡åºæ— å…³ã€‚ï¼ˆ2ï¼‰å¤šä¸ªPlugin æŒ‰ç…§å£°æ˜æ¬¡åºé¡ºåºæ‰§è¡Œã€‚ï¼ˆ3ï¼‰å¤šä¸ªPreset æŒ‰ç…§å£°æ˜æ¬¡åºé€†åºæ‰§è¡Œã€‚ â— ES çš„è½¬æ¢é€šå¸¸æŒ‡ä» ES é«˜ç‰ˆæœ¬è½¬æ¢åˆ°ä½ç‰ˆæœ¬ï¼Œä»è€Œè®©æ–°çš„ ES ä»£ç èƒ½åœ¨è€ç‰ˆæœ¬çš„ ES ç¯å¢ƒä¸­è¿è¡Œã€‚è¿™é‡Œè¦è½¬æ¢çš„å†…å®¹åŒ…å«ä¸¤ç±»ï¼šæ–°è¯­æ³•å’Œæ–°ç‰¹æ€§ã€‚æ–°è¯­æ³•æŒ‡çš„æ˜¯ classã€import&#x2F;exportã€ç®­å¤´å‡½æ•°ã€constã€å¯¹è±¡è§£æ„è¿™ç±»åŸæœ‰ç‰¹æ€§çš„æ–°å†™æ³•ã€‚æ–°ç‰¹æ€§æŒ‡çš„æ˜¯åŸæ¥ç‰ˆæœ¬ä¸å­˜åœ¨çš„ç‰¹æ€§ï¼Œå¦‚ Promiseã€async&#x2F;awaitã€Array.prototype.includes()ã€‚å¯¹æ–°è¯­æ³•æ”¯æŒåœ¨ @babel&#x2F;preset-env é‡Œï¼Œå¯¹æ–°ç‰¹æ€§çš„æ”¯æŒåœ¨ç»Ÿç§°ä¸º polyfill çš„åº“ä¸­(å…·ä½“æ˜¯ @babel&#x2F;runtime ç­‰ï¼Œè¯¦è§ä¸‹æ–‡)ã€‚é€šè¿‡åˆç†é…ç½®ï¼Œ@babel&#x2F;preset-env ä¼šåœ¨è§£æè½¬æ¢è¿‡ç¨‹ä¸­å¼•å…¥ polyfill çš„å†…å®¹ã€‚ â— TypeScript é€šè¿‡é…ç½® target å­—æ®µä¹Ÿæ”¯æŒ ES çš„è¯­æ³•è½¬æ¢ï¼Œä½†ä¸æ”¯æŒ polyfill çš„è‡ªåŠ¨æ·»åŠ ã€‚ ä½¿ç”¨ Babel çš„æ–¹å¼â—‡ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼ä½¿ç”¨ Babel åšç¼–è¯‘å¤„ç†ï¼ˆ1ï¼‰é€šè¿‡ @babel&#x2F;cli(æ›¾ç”¨å babel-cli)ä½¿ç”¨&quot;babel&quot;å‘½ä»¤æ‰§è¡Œã€‚ï¼ˆ2ï¼‰é€šè¿‡ webpack(babel-loader)å’Œ rollup(@rollup&#x2F;plugin-babel)ç­‰æ‰“åŒ…æˆ–ç¼–è¯‘å·¥å…·è°ƒç”¨ã€‚ï¼ˆ3ï¼‰é€šè¿‡ @babel&#x2F;register(æ›¾ç”¨å babel-register)ä¸º Node.js çš„ require å‡½æ•°å¢åŠ é’©å­ï¼Œä»¥åœ¨è¿è¡Œæ—¶è°ƒç”¨ require åŠ è½½.es6, .es, .jsx å’Œ.js ç±»å‹æ–‡ä»¶çš„æ—¶å€™å…ˆç”¨ babel è¿›è¡Œè½¬ç å¤„ç†ï¼Œç”±äºæ˜¯å®æ—¶è½¬ç æ›´é€‚åˆåœ¨ Node.js å¼€å‘ç¯å¢ƒä½¿ç”¨ã€‚â—‡ æ— è®ºä½¿ç”¨å“ªç§æ–¹å¼ï¼Œéƒ½è¦å…ˆå®‰è£…@babel&#x2F;core å’Œæä¾› Babel é…ç½®æ–‡ä»¶ã€‚ @babel&#x2F;preset-envâ—† Babel å®˜æ–¹æ¨èä½¿ç”¨ @babel&#x2F;preset-env(æ›¾ç”¨å babel-preset-envï¼Œæ›¾ç»çš„ babel-preset-es2015 å’Œ babel-preset-es2016 ä»¥åŠ babel-preset-es2017 ç­‰ç‰¹å®šç‰ˆæœ¬çš„ preset éƒ½å·²ç»è¢«å®ƒå–ä»£)ã€‚â—† @babel&#x2F;preset-env åŒ…å« es æ‰€æœ‰ç‰ˆæœ¬çš„ presetï¼Œä¼šæ ¹æ®æ‰€é…ç½®çš„ç›®æ ‡ç¯å¢ƒè‡ªåŠ¨é€‰æ‹©ç‰¹å®šç‰ˆæœ¬ preset åŠç›¸å…³ pluginï¼Œè¿™é‡Œçš„è‡ªåŠ¨é€‰æ‹©æœºåˆ¶çš„å®ç°åŸºäº browserslistã€compat-tableã€electron-to-chromium ç­‰å¼€æºé¡¹ç›®ç»´æŠ¤çš„æµè§ˆå™¨ä¸ es æ–°ç‰¹æ€§åŠ plugin çš„æ˜ å°„å…³ç³»ã€‚â—† é…ç½® Babel ç›®æ ‡ç¯å¢ƒçš„æ–¹å¼æœ‰å¦‚ä¸‹ä¸¤ç§ï¼šï¼ˆ1ï¼‰browserslistï¼šåœ¨æ²¡æœ‰é…ç½®&quot;ignoreBrowserslistConfig&quot;ä¸”&quot;targets&quot;æ²¡æœ‰é…ç½® browserslist ç›¸å…³é€‰é¡¹æ—¶è¢«ä½¿ç”¨ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼Œbrowserslist ä¼šæ ¹æ®é…ç½®ç”Ÿæˆä¸€ä¸ªç›®æ ‡æµè§ˆå™¨çš„åˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨å¯ä»¥é€šè¿‡ npx browserslist &quot;é…ç½®å­—ç¬¦ä¸²&quot; å‘½ä»¤æŸ¥çœ‹ã€‚å¦å¤–æœ‰ç½‘ç«™æä¾›äº†ç›®æ ‡æµè§ˆå™¨åˆ—è¡¨çš„å›¾å½¢åŒ–å±•ç¤ºã€‚ 1&quot;browserslist&quot;: &quot;&gt; 0.25%, not dead&quot; // å¸‚åœºå æœ‰ç‡å¤§äº0.25%çš„æµè§ˆå™¨ï¼ˆä¸åŒ…æ‹¬IE10å’ŒBlackBerryç­‰åœæ­¢å‡çº§çš„æµè§ˆå™¨ï¼‰ ï¼ˆ2ï¼‰targetsï¼š&quot;targets&quot;é…ç½®æ”¯æŒæ›´å¤šçš„è¯­æ³•åŠå…¶ä»–å¯é…ç½®é¡¹ï¼šstring | Array | { [string]: string }ï¼Œè¯¦ç»†ï¼Œå¦‚ï¼š 12345678910&#123; &quot;targets&quot;: &quot;&gt; 0.25%, not dead&quot; // ä¸ä¸Šä¸€æ¡browserslistç­‰ä»·&#125;&#123; &quot;targets&quot;: &#123; // æŒ‡å®šç‰¹å®šå…·ä½“ç›®æ ‡ç¯å¢ƒ &quot;chrome&quot;: &quot;58&quot;, &quot;ie&quot;: &quot;11&quot; &#125;&#125; â—† browserslist å’Œ targets çš„ä¹¦å†™ä½ç½®å¯é€‰ä»¥ä¸‹ä»»ä¸€ç§ï¼šï¼ˆ1ï¼‰babel é…ç½®æ–‡ä»¶ä¸­ å…¨å±€ æˆ– preset æˆ– plugin çš„ optionã€‚ï¼ˆ2ï¼‰package.json æ–‡ä»¶ä¸­çš„å­—æ®µã€‚ï¼ˆ3ï¼‰å¯¹äº browserslistï¼Œå®˜æ–¹æ¨èå†™åœ¨.browserslistrc æ–‡ä»¶ï¼Œä»¥é€‚ç”¨äºâ€œ browserslist åŒæ—¶æä¾›ç»™ babel ä¹‹å¤–çš„åº“ä½¿ç”¨â€çš„åœºæ™¯ã€‚ â—† å¦‚æœæœªé…ç½®ç›®æ ‡è¿è¡Œå¹³å°ï¼Œ@babel&#x2F;preset-env ä¼šè½¬æ¢æ‰€æœ‰ ECMAScript 2015+ çš„ä»£ç ï¼Œè¿™æ ·å°±å¤±å»äº†é¢å‘å„å¹³å°å®šåˆ¶çš„æ„ä¹‰ï¼Œä¸æ¨èã€‚ @babel&#x2F;preset-env çš„å¸¸ç”¨é…ç½®é¡¹â—† modulesï¼ˆ1ï¼‰æ˜¯å¦å°† ES6 çš„ module è¯­æ³•ç»Ÿä¸€è½¬æ¢ä¸ºæŒ‡å®šçš„å¦ä¸€ç§ module å½¢å¼ã€‚ï¼ˆ2ï¼‰å–å€¼ï¼š&quot;amd&quot; | &quot;umd&quot; | &quot;systemjs&quot; | &quot;commonjs&quot; | &quot;cjs&quot;ï¼ˆcommonjs çš„ç®€å†™ï¼‰ | &quot;auto&quot; | falseï¼Œé»˜è®¤å€¼ä¸º&quot;auto&quot;ï¼Œè¡¨ç¤ºæ ¹æ® caller é…ç½®é¡¹åˆ¤æ–­ï¼Œä½¿ç”¨æ‰“åŒ…å·¥å…·è°ƒç”¨ Babel æƒ…å†µä¸‹æ‰“åŒ…å·¥å…·ä¼šè‡ªåŠ¨æä¾› caller é…ç½®é¡¹çš„å€¼ã€‚â—† targets.esmodulesï¼ˆ1ï¼‰é»˜è®¤å€¼æ˜¯ falseï¼Œå³è®¤ä¸ºç›®æ ‡å¹³å°ä¸æ”¯æŒ ES æ¨¡å—çš„å®šä¹‰ä¸å¯¼å…¥å¯¼å‡ºæ–¹å¼ã€‚ï¼ˆ2ï¼‰æ”¯æŒæ ‡ç­¾çš„æµè§ˆå™¨æ˜¯æ”¯æŒ ES æ¨¡å—çš„ã€‚ï¼ˆ3ï¼‰è®¾ç½® esmodules ä¹‹åå…¶ä»– targets è®¾ç½®å°†è¢«å¿½ç•¥ã€‚â—† useBuiltInsï¼ˆ1ï¼‰æ ‡è¯†å¦‚ä½•å¤„ç†å…¨å±€å«ç‰‡(polyfillï¼Œè¯¦è§ä¸‹ä¸€èŠ‚)ï¼Œå–å€¼ï¼š&quot;usage&quot; | &quot;entry&quot; | falseã€‚ï¼ˆ2ï¼‰é»˜è®¤å€¼ä¸º false ä¸åšå¤„ç†ï¼Œæ­¤æ—¶ Babel åªè½¬æ¢æ–°è¯­æ³•ï¼Œä¸ä¼šè½¬æ¢ polyfill æ‰€åŒ…å«çš„ Promise å’Œ Symbol ç­‰æ–°çš„å†…ç½®ç±»å‹ã€Array.from å’Œ Object.assign ç­‰æ–°çš„é™æ€æ–¹æ³•ã€Array.prototype.includes ç­‰æ–°çš„å®ä¾‹æ–¹æ³•ã€generator æ–¹æ³•ã€‚ï¼ˆ3ï¼‰å–å€¼&quot;usage&quot;æˆ–&quot;entry&quot;æ—¶éƒ½éœ€è¦å®‰è£…@babel&#x2F;polyfill(å®˜æ–¹æ¨èæŒ‰éœ€å®‰è£… core-js æˆ– regenerator-runtimeï¼Œè¯¦è§ä¸‹ä¸€èŠ‚)é…åˆä½¿ç”¨ï¼Œå¹¶è®¾ç½®ä¸&quot;useBuiltIns&quot;å¹¶åˆ—çš„&quot;corejs&quot;é…ç½®é¡¹æŒ‡æ˜æ‰€ä½¿ç”¨çš„ core-js ç‰ˆæœ¬ã€‚ï¼ˆ4ï¼‰å–å€¼â€œentryâ€ï¼Œéœ€è¦åœ¨é¡¹ç›®ä»£ç ä¸­æ‰‹åŠ¨å¼•å…¥ core-js æˆ– regenerator-runtimeï¼Œä¸”å½“ä»… import æŸä¸ªå•ç‹¬ç‰¹æ€§æ—¶æ”¯æŒæ¨¡ç³Šå†™æ³•(å¦‚ï¼šimport &quot;core-js&#x2F;es&#x2F;array&quot;)ï¼Œ@babel&#x2F;preset-env ä¼šæ ¹æ®ç›®æ ‡ç¯å¢ƒå¼•å…¥ä¸ç‰¹æ€§å…³è”çš„å„å…·ä½“æ–‡ä»¶ï¼ˆå¦‚åœ¨ç›®æ ‡ safari 6 é…ç½®ä¸‹ä¼šå¼•å…¥ core-js&#x2F;modules&#x2F;es.array.fromã€core-js&#x2F;modules&#x2F;es.array.for-eachã€core-js&#x2F;modules&#x2F;es.array.last-index-ofã€core-js&#x2F;modules&#x2F;es.array.copy-within ç­‰æ–‡ä»¶çš„å†…å®¹ï¼‰;ï¼ˆ5ï¼‰å–å€¼â€œusageâ€ï¼Œæ— éœ€åœ¨é¡¹ç›®ä»£ç ä¸­æ‰‹åŠ¨å¼•å…¥ä»»ä½• core-js æˆ– regenerator-runtimeï¼Œ@babel&#x2F;preset-env ä¼šæ ¹æ®ä»£ç å®é™…ä½¿ç”¨äº†å“ªäº›æ–°ç‰¹æ€§å¹¶ç»“åˆç›®æ ‡ç¯å¢ƒå¼•å…¥å…·ä½“æ–‡ä»¶å†…å®¹ã€‚â—† corejså–å€¼ string æˆ–{ version: string, proposals: boolean }ï¼Œä¸&quot;useBuiltIns&quot;é…åˆä½¿ç”¨ï¼Œè§&quot;useBuiltIns&quot;ï¼ˆ3ï¼‰çš„è¯´æ˜ã€‚ polyfill@babel&#x2F;polyfillâ–  @babel&#x2F;polyfill(æ›¾ç”¨å babel-polyfill)åŒ…å« core-js(polyfill ES features)å’Œ regenerator-runtime(to use transpiled generator functions)ä¸¤éƒ¨åˆ†ï¼Œç”¨äºæ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„ ES2015+ç›®æ ‡ç¯å¢ƒã€‚â–  å®˜æ–¹æ¨èæŒ‰éœ€åˆ†åˆ«å®‰è£… core-js æˆ– regenerator-runtime æ›¿ä»£ @babel&#x2F;polyfillï¼ˆ20230219 æ›´æ–°ï¼š@babel&#x2F;polyfill è¿™ä¸ªåŒ…å·²è¢«å¼ƒç”¨ï¼‰ï¼Œå¹¶ä¸”ä¸è¦ç›´æ¥æ•´ä½“å¼•å…¥ï¼Œè€Œæ¨èé€šè¿‡ä¸ŠèŠ‚æè¿°çš„ @babel&#x2F;preset-env çš„ UseBuiltins é€‰é¡¹é€‰æ‹©æ€§åœ°å¼•å…¥æ‰€éœ€ç‰¹æ€§ï¼Œä»è€Œé¿å…ä¸å¿…è¦çš„è¾“å‡ºåŒ…ä½“ç§¯å¢åŠ ã€‚â–  @babel&#x2F;polyfill å«ç‰‡é€šè¿‡åœ¨å…¨å±€ä½œç”¨åŸŸå¢åŠ ç±»å’Œå‡½æ•°å®šä¹‰ã€ä»¥åŠä¸ºå†…ç½®ç±»å‹å’Œå†…ç½®å¯¹è±¡å¢åŠ é™æ€æ–¹æ³•å’Œå¢åŠ  prototype å±æ€§ç­‰ä¿®æ”¹å…¨å±€ç¯å¢ƒçš„æ–¹å¼å®ç°çš„ï¼Œåœ¨ä¸å¸Œæœ›äº§ç”Ÿå‰¯ä½œç”¨çš„åœºæ™¯ä¸‹ï¼Œç‰¹åˆ«æ˜¯é¡¹ç›®å®šä½æ˜¯ tool&#x2F;library è€Œä¸æ˜¯ application çš„æ—¶å€™ï¼Œè¿™ç§å®ç°æ–¹å¼ä¸é€‚åˆã€‚â–  polyfill æ–¹å¼çš„é…ç½®ï¼šï¼ˆ1ï¼‰babel é…ç½®æ–‡ä»¶ä¸­é…ç½® @babel&#x2F;preset-env çš„&quot;useBuiltIns&quot;å’Œ&quot;corejs&quot;é¡¹ï¼Œä¾‹å¦‚ï¼š 123456789...&quot;presets&quot;: [ ... [&quot;@babel/preset-env&quot;,&#123; &quot;useBuiltIns&quot;: &quot;usage&quot;, &quot;corejs&quot;: &quot;3.28&quot;, ... &#125;], ...]... ï¼ˆ2ï¼‰å¦‚æœä½¿ç”¨ rollupï¼Œè¿˜éœ€é…ç½® @rollup&#x2F;plugin-babel çš„&quot;babelHelpers&quot;å€¼ä¸ºâ€œbundledâ€ã€‚ @babel&#x2F;runtimeâ—‹ @babel&#x2F;runtime(æ›¾ç”¨å babel-runtime)ä½œç”¨åŒ@babel&#x2F;polyfillï¼ŒåŒºåˆ«æ˜¯å®ƒé€šè¿‡æ³¨å…¥æ¨¡å—åŒ– helper(modular runtime helpers)çš„æ–¹å¼å®ç° core-js å’Œ regenerator-runtime ä¸¤éƒ¨åˆ†å«ç‰‡ã€‚â—‹ runtime ç›¸å…³åŒ…ç›®å‰æœ‰ä¸‰ä¸ªï¼šï¼ˆ1ï¼‰@babel&#x2F;runtimeï¼ˆä»…åŒ…å« regenerator-runtime ï¼‰ã€‚ï¼ˆ2ï¼‰@babel&#x2F;runtime-corejs2ï¼ˆåŒ…å« regenerator-runtime å’Œ core-jsï¼‰ã€‚ï¼ˆ3ï¼‰@babel&#x2F;runtime-corejs3ï¼ˆåŒ…å« regenerator-runtime å’Œ core-js-pureï¼‰ï¼Œå®ƒä¸@babel&#x2F;runtime-corejs2 çš„åŒºåˆ«æ˜¯é™¤äº†æ”¯æŒå…¨å±€ç±»å‹ä¸ç±»å‹æ–°çš„é™æ€æ–¹æ³•å«ç‰‡ä¹‹å¤–ï¼Œä¹Ÿæ”¯æŒç±»å‹æ–°çš„å®ä¾‹æ–¹æ³•å«ç‰‡ã€‚æ‰€ä»¥é€šå¸¸å®‰è£…è¿™ä¸ª runtime åŒ…ã€‚â—‹ é™¤äº†å®‰è£… @babel&#x2F;runtime-corejs3 ä¹‹å¤–ï¼Œä¹Ÿéœ€è¦å®‰è£…@babel&#x2F;plugin-transform-runtime æ’ä»¶ç”¨äºå¤„ç†é‡å¤ helper ä»£ç çš„å¤ç”¨ã€‚â—‹ runtime æ–¹å¼çš„é…ç½®ï¼šï¼ˆ1ï¼‰@babel&#x2F;plugin-transform-runtime æ’ä»¶æ²¡æœ‰åƒ polyfill æ–¹å¼é‚£æ ·çš„â€œuseBuiltIns: &#39;usage&#39;â€é€‰é¡¹ï¼Œè‡ªèº«ä¹Ÿæ²¡æœ‰â€œbrowserslistâ€æˆ–â€œtargetsâ€é€‰é¡¹ï¼Œä¼šå¯¹ä»£ç ä¸­å‡ºç°çš„æ‰€æœ‰å«ç‰‡ç‰¹æ€§æ³¨å…¥ helperï¼ˆç›¸å…³ issueï¼š7330ï¼Œ 10250ï¼‰ã€‚20230221 æ›´æ–°ï¼šå®è·µå‘ç° babel é…ç½®çš„å…¨å±€ targets é¡¹ â†“ å’Œå…¨å±€â€œ.browserslistrcâ€æ–‡ä»¶æ–¹å¼å¯ä½¿ @babel&#x2F;plugin-transform-runtime æ’ä»¶æŒ‰éœ€æ³¨å…¥ helperã€‚ï¼ˆ2ï¼‰babel é…ç½®ä¸­å¢åŠ  @babel&#x2F;plugin-transform-runtime çš„å¦‚ä¸‹é…ç½®ï¼š 123456789...&quot;targets&quot;: &quot;&gt; 0.25%, not dead&quot;, // â†‘ ä½¿ @babel/plugin-transform-runtime æ’ä»¶æŒ‰éœ€æ³¨å…¥ helper&quot;plugins&quot;: [ ... [&quot;@babel/plugin-transform-runtime&quot;,&#123; &quot;corejs&quot;: 3, &#125;], ...]... ï¼ˆ3ï¼‰å¦‚æœä½¿ç”¨ rollupï¼Œè¿˜éœ€é…ç½®@rollup&#x2F;plugin-babel çš„&quot;babelHelpers&quot;å€¼ä¸ºâ€œruntimeâ€ã€‚ ä»æ‰“åŒ…å†…å®¹çœ‹ polyfill æ–¹å¼ä¸ runtime æ–¹å¼åŒºåˆ«â—† ä»¥ webpack æ‰“åŒ…ç›®æ ‡ç¯å¢ƒä¸æ”¯æŒ Array.from å’Œ Array.prototype.includes çš„ä»¥ä¸‹åŸå§‹å†…å®¹ä¸ºä¾‹ã€‚ 12Array.from(&quot;how are you&quot;);[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;].includes(&quot;a&quot;); â—† ä½¿ç”¨çš„ polyfill æ–¹å¼çš„ç›¸åº”è¾“å‡ºå¤§è‡´å¦‚ä¸‹(å·²ç®€åŒ–) 1234567891011.../* 38 */ /*Array.fromçš„å®ç°ä¸å…¨å±€æ³¨å†Œ*/.../* 39 */ /*Array.prototype.includesçš„å®ç°ä¸å…¨å±€æ³¨å†Œ*/...var core_js_modules_es_array_from__IMPORTED_MODULE = __webpack_require__(38);var core_js_modules_es_array_includes__IMPORTED_MODULE = __webpack_require__(39);Array.from(&quot;how are you&quot;);[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;].includes(&quot;a&quot;);... â—† ä½¿ç”¨çš„ runtime æ–¹å¼çš„ç›¸åº”è¾“å‡ºå¤§è‡´å¦‚ä¸‹(å·²ç®€åŒ–) 1234567891011.../* 38 */ /*Array.fromçš„æ¨¡å—åŒ–å®ç°*/.../* 39 */ /*Array.prototype.includesçš„æ¨¡å—åŒ–å®ç°*/...var _babel_runtime_array_from__IMPORTED_MODULE = __webpack_require__(38);var _babel_runtime_instance_includes__IMPORTED_MODULE = __webpack_require__(39);_babel_runtime_array_from__IMPORTED_MODULE()(&quot;how are you&quot;);_babel_runtime_instance_includes__IMPORTED_MODULE().call( [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], &quot;a&quot;));... â—† æœ€å¤§åŒºåˆ«åœ¨äº polyfill æ–¹å¼ç”±äºä¿®æ”¹äº†å…¨å±€ç¯å¢ƒï¼ŒåŸå§‹ä»£ç å†™æ³•è¢«ä¿ç•™è€Œä¸ä¼šè¢«æ”¹å†™ã€‚â—† 20230221 æ›´æ–°ï¼špolyfill æ–¹å¼å½“å‰å·²æ”¯æŒé€šè¿‡polyfill provider RFCå®ç°éå…¨å±€å«ç‰‡ï¼Œissue è¯´æ˜ä¸ babel-plugin-polyfill-corejs3 çš„ä½¿ç”¨ã€‚ Babel é…ç½®æ–‡ä»¶â—‹ Babel æœ‰ä¸¤ç§é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨æˆ–å•ç‹¬ä½¿ç”¨ã€‚ï¼ˆ1ï¼‰é¡¹ç›®é…ç½®ï¼ˆProject-wide configurationï¼‰ï¼Œå¯¹æ•´ä¸ªé¡¹ç›®ç”Ÿæ•ˆï¼ŒåŒ…å«é¡¹ç›®ä¸‹çš„ node_modulesï¼ˆé™¤éé€šè¿‡&quot;exclude&quot;æ’é™¤ï¼‰ï¼Œé€‚åˆé¡¹ç›®èŒƒå›´å†…å¹¿æ³›ç”Ÿæ•ˆçš„é…ç½®ï¼Œæœ‰&quot;babel.config.js æ–‡ä»¶&quot;å’Œ&quot;babel.config.json æ–‡ä»¶&quot;ä¸¤ç§å…·ä½“å½¢å¼ã€‚ï¼ˆ2ï¼‰æ–‡ä»¶å…³è”é…ç½®ï¼ˆFile-relative configurationï¼‰ï¼Œæœ‰&quot;.babelrc(åŒ.babelrc.js)æ–‡ä»¶&quot;å’Œ&quot;é¡¹ç›® package.json æ–‡ä»¶ä¸­çš„ babel å­—æ®µ&quot;ä¸¤ç§å…·ä½“å½¢å¼ã€‚â—‹ å…³äº Project-wide é…ç½®ï¼šï¼ˆ1ï¼‰root å±æ€§æŒ‡æ˜å½“å‰é¡¹ç›®çš„æ ¹ç›®å½•ï¼ŒBabel é»˜è®¤ä»¥å½“å‰è·¯å¾„ä¸º root å±æ€§å€¼ï¼Œå¹¶åœ¨ root è·¯å¾„ä¸‹æŸ¥æ‰¾ä¸åº”ç”¨&quot;babel.config.js&quot;æ–‡ä»¶é…ç½®ã€‚â—‹ å…³äº File-relative é…ç½®ï¼šï¼ˆ1ï¼‰é€‚åˆä¸ºé¡¹ç›®çš„å­éƒ¨åˆ†åšé…ç½®ã€‚ï¼ˆ2ï¼‰Babel ä»è¢«ç¼–è¯‘æ–‡ä»¶å‘ä¸Šé€çº§æŸ¥æ‰¾ä¸åº”ç”¨ File-relative é…ç½®ï¼ŒæœªæŸ¥æ‰¾åˆ°åˆ™ç»ˆæ­¢äº package.json æ–‡ä»¶ã€‚ï¼ˆ3ï¼‰æŸ¥æ‰¾ File-relative é…ç½®çš„èŒƒå›´ä»…é™é€šè¿‡ babelrcRoots å±æ€§åŒ…å«çš„è·¯å¾„ï¼Œé»˜è®¤ä¸ root å±æ€§å€¼ä¸€è‡´ï¼ŒæŸ¥æ‰¾èŒƒå›´ä¹‹å¤–çš„æ–‡ä»¶å…³è”é…ç½® Babel ä¸ä¼šå¤„ç†ã€‚ï¼ˆ4ï¼‰Babel 7 æ–°å¢ç‰¹æ€§ï¼š File-relative é…ç½®çš„ä½œç”¨èŒƒå›´ä»…é™ package è‡ªå·±ï¼Œä¸åŒ…å«æ–‡ä»¶å±‚çº§ä¸‹é¢çš„ node_modulesï¼Œä¹Ÿä¸ä¼šæ£€æµ‹ node_modules å†…çš„.babelrcï¼Œå³ä½¿é€šè¿‡â€œincludeâ€åŒ…å«äº† node_modulesã€‚"},{"title":"Java web æŠ€æœ¯ä¸æ¶æ„æ¼”è¿›å†å²","date":"2020-09-30T06:46:35.000Z","path":"knowledge/Java-web-æŠ€æœ¯ä¸æ¶æ„æ¼”è¿›å†å².html","tags":[{"name":"Java","slug":"Java","permalink":"https://congzhou09.github.io/tags/Java/"},{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://congzhou09.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"text":"æ¢³ç† Java web ç›¸å…³çš„æŠ€æœ¯ä¸æ¶æ„æ¼”è¿›å†å²ï¼Œé™„å¸¦å¯è¿è¡Œ demoï¼Œä»¥æœŸä»å†å²å‘å±•è§’åº¦çœ‹åˆ°å„ä¸ªæŠ€æœ¯ç‚¹äº§ç”Ÿçš„èƒŒæ™¯ä¸ç›®çš„ï¼ŒåŠ æ·±å¯¹æœåŠ¡ç«¯æŠ€æœ¯æ ˆçš„äº†è§£ã€‚å„å°èŠ‚æŒ‰æ—¶é—´å…ˆåé¡ºåºæ’åˆ—ã€‚ Servletâ—‹ Servlet æŠ€æœ¯è¯ç”Ÿç”¨äºä½¿ web æœåŠ¡å™¨èƒ½å¤Ÿæä¾›é™æ€èµ„æºä¹‹å¤–çš„åŠ¨æ€å†…å®¹ï¼Œæ˜¯æ‰©å±•äº† Web æœåŠ¡å™¨èƒ½åŠ›çš„ Java è½¯ä»¶ç»„ä»¶ã€‚â—‹ Servlet çš„è¿è¡Œä¾èµ–äº Servlet å®¹å™¨ï¼ˆå¦‚ Tomcatã€Jettyï¼‰ã€‚â—‹ Servlet å®¹å™¨æä¾›äº†éµå¾ª Servlet è§„èŒƒçš„æ¥å£ï¼Œå¼€å‘è€…å®ç°è‡ª Servlet æ¥å£çš„ Java ç±»å°±ç§°ä¸ºä¸€ä¸ª Servletï¼Œåœ¨ Servlet ä¸­å®šä¹‰ç”¨äºå“åº”è¯·æ±‚çš„å…·ä½“åŠ¨æ€å†…å®¹ã€‚â—‹ åœ¨ Servlet å®¹å™¨çš„é…ç½®ä¸­æŒ‡å®šè¯·æ±‚ URL ä¸å¤„ç†è¯·æ±‚çš„ Servlet çš„æ˜ å°„å…³ç³»ï¼Œå¦‚ Tomcat é…ç½®æ–‡ä»¶ä½äº&quot;&#x2F;WEB-INF&#x2F;web.xml&quot;ï¼Œæ˜ å°„å…³ç³»å†…å®¹ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223&lt;?xml version=&quot;1.0&quot; ...&gt;&lt;web-app ...&gt; ... &lt;servlet&gt; &lt;servlet-name&gt;servlet1&lt;/servlet-name&gt; &lt;servlet-class&gt;servletClass1&lt;/servlet-class&gt; &lt;/servlet&gt; &lt;servlet&gt; &lt;servlet-name&gt;servlet2&lt;/servlet-name&gt; &lt;servlet-class&gt;servletClass2&lt;/servlet-class&gt; &lt;/servlet&gt; ... &lt;servlet-mapping&gt; &lt;servlet-name&gt;servlet1&lt;/servlet-name&gt; &lt;url-pattern&gt;/url1&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;servlet2&lt;/servlet-name&gt; &lt;url-pattern&gt;/url2&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; ...&lt;/web-app&gt; â—‹ Servlet å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚æµç¨‹ï¼šï¼ˆ1ï¼‰å®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾ Servlet å®¹å™¨ï¼ŒServlet å®¹å™¨è§£æè¯·æ±‚ä¿¡æ¯åˆ›å»ºç›¸åº”çš„&quot;HttpServletRequest&quot;å’Œ&quot;HttpServletResponse&quot;å¯¹è±¡ã€‚ï¼ˆ2ï¼‰Servlet å®¹å™¨æ ¹æ®è¯·æ±‚ URL æ˜ å°„é…ç½®åˆ›å»ºæˆ–æ‰¾åˆ°å¯¹åº”çš„ Servlet å®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶ä¼ å…¥â€œHttpServletRequestâ€ä¸â€œHttpServletResponseâ€å¯¹è±¡ï¼Œå†è°ƒç”¨ Servlet å®ä¾‹çš„ service()æ–¹æ³•ã€‚ï¼ˆ3ï¼‰Servlet å¯¹è±¡çš„ doGet()ã€doPost()ç­‰æ–¹æ³•å¤„ç†è¯·æ±‚ï¼Œè¿”å›å†…å®¹äº¤ç”± Servlet å®¹å™¨ç»„è£…æˆ HTTP æ ¼å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚â—‹demo åœ°å€ï¼šservlet_maven_demo JSP(Java Server Pages)â—‹ ç”±äº Servlet ç¼–å†™å‰ç«¯å†…å®¹å¤ªç¹çï¼Œsun å…¬å¸åˆæ¨å‡ºäº† JSPã€‚â—‹ JSP æ–‡ä»¶æ”¾åˆ° Servlet å®¹å™¨çš„ web ç›®å½•ä¸‹ã€‚â—‹ å®¢æˆ·ç«¯å¯ç›´æ¥è¯·æ±‚ JSP æ–‡ä»¶ï¼Œå¾—åˆ°çš„å†…å®¹ä¸æ˜¯ JSP åŸæ–‡ä»¶è€Œæ˜¯å…¶ä¸­ Java ä»£ç è¢«æ‰§è¡Œåçš„å†…å®¹ã€‚â—‹ Servlet å¤„ç†è¯·æ±‚çš„è¿”å›å†…å®¹ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª JSP æ–‡ä»¶ã€‚â—‹ demo åœ°å€åŒä¸Šï¼šservlet_maven_demo JSP Model1 ç¬¬ä¸€ä»£â—‹ JavaWeb æ—©æœŸçš„æ¨¡å‹ï¼Œå®ƒé€‚åˆå°å‹ Web é¡¹ç›®ï¼Œå¼€å‘æˆæœ¬ä½ã€‚æœåŠ¡å™¨ç«¯åªæœ‰ JSP é¡µé¢ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½åœ¨ JSP é¡µé¢ä¸­ï¼Œè¿è®¿é—®æ•°æ®åº“çš„ API ä¹Ÿåœ¨ JSP é¡µé¢ä¸­å®Œæˆã€‚ JSP Model1 ç¬¬äºŒä»£â—‹ å°†ä¸šåŠ¡é€»è¾‘å†…å®¹æ”¾åˆ° JavaBeanï¼ŒJSP é¡µé¢è´Ÿè´£æ˜¾ç¤ºä»¥åŠè¯·æ±‚è°ƒåº¦ã€‚è™½ç„¶ç¬¬äºŒä»£æ¯”ç¬¬ä¸€ä»£å¥½äº†äº›ï¼Œä½† JSP ä»ç„¶åšäº†è¿‡å¤šçš„å·¥ä½œï¼Œå®ƒè€¦åˆäº†è§†å›¾å·¥ä½œå’Œè¯·æ±‚è°ƒåº¦ï¼ˆæ§åˆ¶å™¨ï¼‰çš„å·¥ä½œã€‚ JSP Model2â—‹ Servlet ä¸ JSP ä¹‹é—´å¯ä»¥å…±äº«æ•°æ®ï¼ŒJSP Model2 æ¨¡å¼å°† Servlet ä¸ JSP ç»“åˆä½¿ç”¨ï¼Œåšäº†åˆçº§çš„ MVC åˆ†å±‚ï¼šï¼ˆ1ï¼‰JSPï¼šè§†å›¾å±‚ï¼Œç”¨æ¥ä¸ç”¨æˆ·æ‰“äº¤é“ã€‚è´Ÿè´£æ¥æ”¶ç”¨æˆ·çš„æ•°æ®ï¼Œä»¥åŠæ˜¾ç¤ºæ•°æ®ç»™ç”¨æˆ·ã€‚ï¼ˆ2ï¼‰Servletï¼šæ§åˆ¶å±‚ï¼Œè´Ÿè´£æ‰¾åˆ°åˆé€‚çš„æ¨¡å‹å¯¹è±¡æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæ ¹æ®å¤„ç†ç»“æœæ‰¾åˆ°åˆé€‚çš„ JSP é¡µé¢å¯¹ç”¨æˆ·è¿›è¡Œå“åº”ã€‚ï¼ˆ3ï¼‰JavaBeanï¼šæ¨¡å‹å±‚ï¼Œå®Œæˆå…·ä½“çš„ä¸šåŠ¡æ•°æ®å¤„ç†å·¥ä½œã€‚ Struts æ¡†æ¶ï¼ˆä»¥ Struts2 ä¸ºå‡†ï¼‰â—‡ Struts ç›®çš„æ˜¯ä½¿è§†å›¾å’Œä¸šåŠ¡é€»è¾‘æ¸…æ™°çš„åˆ†ç¦»ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼Œæ˜¾è‘—ç‰¹ç‚¹å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰æä¾› Action æœºåˆ¶æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚ï¼ˆ2ï¼‰æä¾›äº†ä¸€å¥—å¯åœ¨ JSP ä¸­ä½¿ç”¨çš„æ ‡ç­¾ï¼Œæ–¹ä¾¿åœ¨ Action ä¸ JSP ä¹‹é—´å…±äº«æ•°æ®ã€‚â—‡ Struts æä¾›çš„ action æœºåˆ¶çš„å®ç°åŸºäº Servlet çš„ Filterï¼Œç›¸å½“äºæ‰©å±•äº†çš„ Filterï¼Œä¹Ÿå°±æ˜¯ Filter æ˜¯ Struts æ¡†æ¶çš„å…¥å£ï¼ŒStruts æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚åŠæ˜ å°„é…ç½®(struts-config.xml)å®ä¾‹åŒ–å¯¹åº”çš„ action å’Œè°ƒç”¨å…¶æ–¹æ³•å¤„ç†ä¸šåŠ¡ä¸æ•°æ®ï¼Œæ ¹æ®æ–¹æ³•è¿”å›å€¼åŠæ˜ å°„é…ç½®è·³è½¬åˆ°å¯¹åº” JSP é¡µé¢æˆ–å…¶ä»–ç½‘ç»œèµ„æºæˆ–å¦ä¸€ä¸ª actionã€‚ â—‡ action ç›¸å¯¹äº Servlet çš„ä¼˜ç‚¹ï¼šï¼ˆ1ï¼‰action ä¸å†ç»§æ‰¿äº Servlet ä»è€Œä½¿ä¸šåŠ¡å¤„ç†ä¸ Servlet API è§£è€¦æ›´æ˜“äºæµ‹è¯•ã€‚ï¼ˆ2ï¼‰æ¯ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ª action å®ä¾‹ï¼Œç›¸æ¯” Servlet çš„åŒä¸€ä¸ª URL çš„å¤šä¸ªè¯·æ±‚å…±ç”¨ä¸€ä¸ª Servlet å¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚â—‡ äº’è”ç½‘æ›¾ç»å‡ºç°å¾ˆå¤š*.do ç½‘å€çš„ JSP ç½‘ç«™è€Œä¸æ˜¯*.jspï¼Œè¿™é€šå¸¸ç”±äºæ¯ä¸ª.do å¯¹åº”ä¸€ä¸ª actionï¼Œå½“ action å¤„ç†å®Œä¸€ç³»åˆ—çš„ä¸šåŠ¡é€»è¾‘åï¼Œå³ä½¿ forward åˆ° JSP é¡µé¢è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨çš„åœ°å€æ ä¸­æ˜¾ç¤ºçš„ä»ç„¶æ˜¯æœ€åˆè¯·æ±‚çš„*.do çš„ action åœ°å€ã€‚â—‡ demo åœ°å€ï¼šstruts2_maven_demo Javaweb ç»å…¸ä¸‰å±‚æ¶æ„â—‡ Struts é¡¹ç›®ä¸­ä¸ºé¿å…æ‰€æœ‰çš„è¿ç®—é€»è¾‘éƒ½æ”¾åœ¨ Action å¯¼è‡´ Action ç±»å¤ç”¨åº¦ä½å’Œé€»è¾‘æ··ä¹±ï¼Œé€šå¸¸è®© actionï¼ˆä»å±äº Servlet èŒƒç•´ï¼‰åªè´Ÿè´£æ˜¾ç¤ºï¼Œä¸ JSP å…±åŒç»„æˆè¡¨ç°å±‚ï¼ˆweb å±‚ï¼‰ï¼Œç‹¬ç«‹å‡ºä¸€å±‚ä¸šåŠ¡å±‚ï¼ˆservice å±‚ï¼‰è´Ÿè´£å…·ä½“ä¸šåŠ¡è¿ç®—é€»è¾‘ä¾› Action è°ƒç”¨ï¼Œç„¶åé€šè¿‡ JDBC è°ƒç”¨æŒä¹…å±‚å®Œæˆæ•°æ®åº“çš„è¯»å†™çš„éƒ¨åˆ†ç‹¬ç«‹æˆæ•°æ®è®¿é—®å±‚ï¼ˆdao å±‚ï¼‰ä¾›ä¸šåŠ¡å±‚ä½¿ç”¨ï¼Œç”±æ­¤å½¢æˆäº†ç»å…¸ä¸‰å±‚æ¶æ„ã€‚â—‹ ä¸šåŠ¡å±‚ä¸­ä¸åŒ…å« JavaWeb API è€Œåªå…³å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œæ•°æ®å±‚åªå…³å¿ƒå¯¹æ•°æ®åº“çš„è®¿é—®ç»†èŠ‚è€Œä¸æ¶‰åŠå…·ä½“ä¸šåŠ¡é€»è¾‘ï¼Œæé«˜äº†ä»£ç çš„å¯é‡ç”¨æ€§ã€‚â—‹ MVC å®šä½ä¸ºè¡¨ç°å±‚çš„è®¾è®¡æ¨¡å¼ã€‚ Hibernate æ¡†æ¶â—† Hibernate æ˜¯ä¸ª ORMï¼ˆObject Relational Mappingï¼Œå³å¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œé€šè¿‡åˆ›å»ºæŒä¹…åŒ–ç±»æ¥å¯¹åº”æ•°æ®åº“ä¸­è¡¨å±æ€§åŠå…³è”å…³ç³»ï¼Œç„¶åé€šè¿‡æ“ä½œæŒä¹…åŒ–å¯¹è±¡å°±èƒ½è¾¾åˆ°æ“ä½œæ•°æ®åº“çš„ç›®çš„ï¼Œè€Œä¸éœ€è¦ä¸ SQL è¯­å¥æ‰“äº¤é“ï¼Œå¤§å¤§é™ä½äº†åŸ JDBC æ–¹å¼çš„ç¼–ç¨‹é‡ã€‚â—† Hibernate åŸç†æ˜¯å¯¹ JDBC è¿›è¡Œäº†å°è£…ï¼Œå¹¶èƒ½è‡ªåŠ¨ç”Ÿæˆ SQL è¯­å¥ã€‚ Spring æ¡†æ¶â–  Spring æ¡†æ¶ï¼ˆSpring framworkï¼Œç®€ç§° Springï¼‰æ˜¯ä¸€ä¸ª JavaSE&#x2F;EE å…¨æ ˆå¼€æºæ¡†æ¶ï¼Œå®ƒä»è®¾è®¡ä¸Šå°±æ˜¯åˆ†å±‚åˆ†æ¨¡å—çš„æ¶æ„ï¼Œå¯ä»¥å°†å¯¹åº”æ¨¡å—åŠŸèƒ½çš„å­æ¡†æ¶æ•´åˆåˆ°ä½“ç³»ä¸­ã€‚â–  Spring å¸¦æ¥çš„æœ€æ˜¾è‘—æ”¹å˜ï¼šåœ¨ Spring ä¹‹å‰ï¼Œweb å±‚è°ƒç”¨ä¸šåŠ¡å±‚ã€ä¸šåŠ¡å±‚è°ƒç”¨æŒä¹…å±‚éƒ½æ˜¯é€šè¿‡è°ƒç”¨è€… new å‡ºè¢«è°ƒç”¨è€…çš„æ–¹å¼ï¼Œä¹‹é—´å¼ºè€¦åˆã€å¤ç”¨ç‡ä½ï¼ŒSpring é€šè¿‡å…¶æ ¸å¿ƒç‰¹æ€§ IoC å®ç°å¼ºä¾èµ–çš„è§£è€¦ï¼Œç”± Spring å®Œæˆè¢«è°ƒç”¨è€…çš„ new å®ä¾‹åŒ–å¹¶å°†å…¶æ³¨å…¥ç»™ä¾èµ–è€…ã€‚â— demo åœ°å€ï¼šspring_maven_demo SSH(Spring-Struts-Hibernate)æ¡†æ¶â— Spring æ¡†æ¶æ•´åˆäº† Struts å’Œ Hibernateï¼Œå½¢æˆäº† SSH è¿™ä¸ªåˆæˆæ¡†æ¶ã€‚â— SSH æ¡†æ¶ä¸­ï¼ŒStruts è´Ÿè´£è¡¨ç¤ºå±‚ï¼ŒHibernate è´Ÿè´£æŒä¹…å±‚ï¼ŒSpring é€šè¿‡ IoC ç‰¹æ€§å®ç°å¯¹ä¸šåŠ¡å±‚ JavaBean çš„ç®¡ç†ï¼Œä»¥åŠå¯¹è¡¨ç¤ºå±‚ä¸æŒä¹…å±‚çš„é»åˆã€‚ SpringMVCâ— Spring å¼€å‘è€…é€æ¸å‘ç° Struts å­˜åœ¨è®¾è®¡ç¼ºé™·ï¼Œä¼šå¯¼è‡´æ€§èƒ½ã€å®‰å…¨ã€å‡å°‘é…ç½®å¤æ‚åº¦ã€å¼€å‘æ•ˆç‡ç­‰æ–¹é¢çš„ä¸è¶³ï¼Œé‚å¼€å‘äº†è‡ªå·±çš„ MVC æ¡†æ¶ï¼šSpringMVCã€‚â— SpringMVC æ¥å—è¯·æ±‚çš„å…¥å£æ˜¯ DispatcherServlet ï¼Œä¸åŒäº Struts åŸºäº Servlet çš„ Filterï¼Œå®ƒæ˜¯æ´¾ç”Ÿè‡ª HttpServlet çš„ä¸€ä¸ª Servletï¼Œè¯·æ±‚ä¼šäº¤ä»˜ç»™å¯¹åº”çš„ Controller åšå¤„ç†ã€‚â— SpringMVC çš„å› å…¶æ›´æ¸…æ™°çš„å±‚çº§åˆ†ç¦»ã€æ›´å¼ºå¤§ç›´æ¥çš„é…ç½®ç­‰ä¼˜åŠ¿é€æ¸æˆä¸º Spring Web æ¨¡å—çš„ä¸»æµå­æ¡†æ¶ã€‚â— demo åœ°å€ï¼šspring_maven_demo SSM(Spring-SpringMVC-MyBatis)æ¡†æ¶â–³ SSM æ¡†æ¶åˆ†åˆ«ç”¨ SpringMVC å’Œ MyBatis æ›¿ä»£ SSH æ¡†æ¶ä¸­çš„ Struts å’Œ Hibernateï¼ŒMyBatis é€‚ç”¨äºæ•°æ®æºå¤æ‚åº¦è¾ƒä½çš„åœºæ™¯ã€‚ SpringBootâ— Spring Boot æ˜¯å¯¹ Spring å·¥ä½œæµå±‚é¢çš„æ¼”è¿›ï¼Œå®ç°åŸºäº Spring çš„æ›´ä¾¿æ·çš„ç”Ÿäº§çº§åˆ«åº”ç”¨ã€‚â— Spring Boot çš„ä¼˜ç‚¹ï¼šï¼ˆ1ï¼‰å†…åµŒ Servlet å®¹å™¨ï¼Œç‹¬ç«‹è¿è¡Œçš„ Spring é¡¹ç›®ï¼ŒSpring Boot å¯ä»¥å†…åµŒ Tomcatï¼Œä»¥ java -jar xx.jar åŒ…çš„å½¢å¼æ¥è¿è¡Œä¸€ä¸ª Spring Boot åº”ç”¨ï¼Œçœç•¥äº† war åŒ…éƒ¨ç½²çš„ç¹çã€‚ï¼ˆ2ï¼‰æä¾› starter æœºåˆ¶ç®€åŒ– Maven ä¾èµ–ç®¡ç†ä¸ Spring é…ç½®ï¼Œå¦‚ä»…éœ€è¦å¼•å…¥â€œspring-boot-starter-webâ€å°±å¯ä»¥åŒ…å« Spring å’Œ SpringMVC ç›¸å…³çš„ä¾èµ–å’Œé…ç½®ã€‚â— demo åœ°å€ï¼šspringboot_maven_demo"},{"title":"è¿›ç¨‹ã€çº¿ç¨‹ã€çº¤ç¨‹ã€åç¨‹","date":"2020-08-05T14:11:16.000Z","path":"knowledge/è¿›ç¨‹ã€çº¿ç¨‹ã€çº¤ç¨‹ã€åç¨‹.html","tags":[{"name":"è®¡ç®—æœºåŸºç¡€","slug":"è®¡ç®—æœºåŸºç¡€","permalink":"https://congzhou09.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"},{"name":"åç¨‹","slug":"åç¨‹","permalink":"https://congzhou09.github.io/tags/%E5%8D%8F%E7%A8%8B/"}],"text":"åŸºæœ¬æ¦‚å¿µâ—‡ è¿›ç¨‹æ˜¯åº”ç”¨ç¨‹åºå¯åŠ¨çš„å®ä¾‹ï¼Œæ‹¥æœ‰è‡ªå·±çš„ä»£ç æ®µã€å†…å­˜ç©ºé—´ã€æ‰€æ‰“å¼€æ–‡ä»¶ç­‰ç³»ç»Ÿèµ„æºã€‚â—‡ çº¿ç¨‹ä»å±äºè¿›ç¨‹ï¼Œæ˜¯ç¨‹åºçš„å®é™…æ‰§è¡Œè€…ï¼Œæ‹¥æœ‰è‡ªå·±çš„æ‰§è¡Œæ ˆç©ºé—´ã€ç¨‹åºè®¡æ•°å™¨ã€å¯„å­˜å™¨çŠ¶æ€ï¼Œè¿™äº›å¸¸è¢«ç§°ä¸º&quot;çº¿ç¨‹ä¸Šä¸‹æ–‡&quot;ï¼Œå…¶ä½™è¿›ç¨‹èµ„æºæ˜¯è¿›ç¨‹å†…æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ã€‚â—‡ è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„æœ€å°å•ä½ã€‚â—‡ CPU è°ƒåº¦çº¿ç¨‹æ—¶æ¶‰åŠåˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡çš„ä¿å­˜ä¸æ¢å¤ï¼Œä¸Šä¸‹æ–‡ä¿¡æ¯å­˜å‚¨åœ¨ç³»ç»Ÿå†…æ ¸çš„&quot;çº¿ç¨‹æ§åˆ¶å—(Thread Control Block, TCB)&quot;ä¸­ï¼Œå…¶ä¸­çš„ç¨‹åºè®¡æ•°å™¨ã€å¯„å­˜å™¨çŠ¶æ€ç›´æ¥ä¿å­˜å€¼ï¼Œæ‰§è¡Œæ ˆåˆ™ä¿å­˜çš„æ˜¯åœ°å€æŒ‡é’ˆã€‚çº¿ç¨‹æ‰§è¡Œæ ˆåŸå§‹å†…å®¹ä¿å­˜åœ¨æ‰€å±è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­ã€‚â—‡ çº¿ç¨‹çš„äº”ç§çŠ¶æ€åŠè½¬æ¢å¦‚ä¸‹å›¾ï¼š â—‡ å¤šçº¿ç¨‹é—´çš„åä½œæ¶‰åŠåˆ°å¦‚ä¸‹æ€§èƒ½é—®é¢˜ï¼šï¼ˆ1ï¼‰åŒæ­¥é”ã€‚ï¼ˆ2ï¼‰çº¿ç¨‹ä¸Šä¸‹æ–‡çš„åˆ‡æ¢ã€‚â—‡ çº¤ç¨‹(fiber)æ˜¯åœ¨ç”¨æˆ·ç©ºé—´æ¨¡ä»¿å‡ºçš„çº¿ç¨‹ã€‚ï¼ˆ1ï¼‰çº¤ç¨‹ä¸çº¿ç¨‹çš„ç›¸åŒç‚¹ï¼šçº¤ç¨‹æœ‰ç‹¬ç«‹äºåˆ›å»ºå®ƒä»£ç çš„ç”Ÿå‘½å‘¨æœŸï¼Œæœ‰è°ƒåº¦å™¨(scheduler)æ§åˆ¶è°æ˜¯ä¸‹ä¸€ä¸ªè¿è¡Œçš„çº¤ç¨‹ï¼Œæœ‰çº¤ç¨‹é—´åŒæ­¥æœºåˆ¶ã€‚ï¼ˆ2ï¼‰çº¤ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«ï¼šçº¤ç¨‹é‡‡ç”¨éæŠ¢å å¼ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå³å½“å‰æ‰§è¡Œçš„ä»»åŠ¡ä¼šä¸€ç›´æ‰§è¡Œåˆ°ä¸»åŠ¨æ”¾å¼ƒæ—¶é—´ç‰‡ã€‚ï¼ˆ3ï¼‰å¤šä¸ªçº¤ç¨‹å¯è¿è¡Œåœ¨åŒä¸€ä¸ªæˆ–ä¸åŒçš„çº¿ç¨‹ä¸Šï¼Œå½“ä¸åŒçº¿ç¨‹ä¸Šçš„çº¤ç¨‹æœ‰é˜Ÿåˆ—ä»»åŠ¡ç­‰å…±äº«æ•°æ®æ—¶ï¼Œä¹Ÿä¼šæ¶‰åŠ mutex ç­‰åŒæ­¥é—®é¢˜ï¼Œåªæ˜¯çº¤ç¨‹æŒ‚èµ·æ—¶ï¼Œå±äºåŒä¸€çº¿ç¨‹çš„å…¶ä»–çº¤ç¨‹ä»ç„¶å¯ä»¥è¿è¡Œã€‚ï¼ˆ4ï¼‰åŒä¸€çº¿ç¨‹ä¸Šå¤šä¸ªçº¤ç¨‹ä¸ä¼šåŒæ—¶è¿è¡Œï¼Œé¿å…äº†äº’ç›¸ç«äº‰èµ„æºã€‚ï¼ˆ5ï¼‰åŒä¸€çº¿ç¨‹ä¸Šå¤šä¸ªçº¤ç¨‹ä¸ä¼šè¿è¡Œäºå¤šä¸ª CPU æ ¸ä¸Šã€‚â—‡ åç¨‹(coroutine &#x2F;,kÉ™ÊŠruË&#39;tiËn&#x2F;)æ˜¯æ”¯æŒæŒ‚èµ·å’Œæ¢å¤çš„å­ç¨‹åºï¼Œç”¨äºæ‰§è¡ŒéæŠ¢å å¼å¤šä»»åŠ¡ï¼ˆnon-preemptive multitasking, cooperative multitaskingï¼‰ã€‚ï¼ˆ1ï¼‰åç¨‹ä¸è°ƒç”¨å®ƒçš„ä»£ç å¤„åœ¨åŒä¸€ä¸ªç”Ÿå‘½å‘¨æœŸã€‚ï¼ˆ2ï¼‰åç¨‹åœ¨è¡Œä¸ºä¸Šæ›´åƒå‡½æ•°è€Œä¸æ˜¯çº¿ç¨‹ï¼šåç¨‹å°†è°ƒç”¨å’Œæ¢å¤çš„æ§åˆ¶æƒäº¤ç”±è°ƒç”¨è€…ç®¡ç†ï¼Œè¢«è°ƒç”¨åä»£ç æ‰§è¡Œçš„æ§åˆ¶æƒç«‹å³è½¬ç§»åˆ°åç¨‹ï¼Œç›´åˆ°åç¨‹ä¸»åŠ¨æŒ‚èµ·ï¼Œä»£ç æ‰§è¡Œæ§åˆ¶æƒä¼šè‡ªåŠ¨å›åˆ°è°ƒç”¨è€…ã€‚ï¼ˆ3ï¼‰äº’ç›¸åä½œçš„å¤šä¸ªåç¨‹åªèƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸Šï¼Œè¿™äº›åç¨‹ä¸ä¼šåŒæ—¶è¿è¡Œï¼Œä¸å­˜åœ¨ç«äº‰èµ„æºçš„åŒæ­¥é—®é¢˜ã€‚ï¼ˆ4ï¼‰åç¨‹åˆ‡æ¢ä¸å‡½æ•°è°ƒç”¨çš„æœ€å¤§åŒºåˆ«åœ¨äºåˆ‡æ¢å…¥å£ç‚¹æ•°é‡ï¼Œæ™®é€šå‡½æ•°åªæœ‰ä¸€ä¸ªå…¥å£ç‚¹ï¼Œåç¨‹åˆ™æœ‰å¤šä¸ªã€‚â—‡ çº¤ç¨‹ä¸åç¨‹çš„å‚è€ƒæ–‡æ¡£ï¼šStackOverflow é—®ç­”é“¾æ¥ï¼Œé—®ç­”ä¸­æåˆ°çš„è®ºæ–‡ã€‚â—‡ çº¿ç¨‹çš„è°ƒåº¦æ˜¯æ“ä½œç³»ç»Ÿå®Œæˆçš„ã€‚çº¤ç¨‹å’Œåç¨‹çš„è°ƒåº¦åˆ™ç”±åº”ç”¨ç¨‹åºæˆ–è¿è¡Œæ—¶åº“å®Œæˆï¼Œæ‰€ä»¥è¢«ç§°ä¸º&quot;ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹&quot;ã€‚â—‡ çº¤ç¨‹ä¸åç¨‹æœ‰æ—¶è¢«è§†ä¸ºåŒä¸€æ¦‚å¿µï¼Œç‰¹åˆ«æ˜¯å½“çº¤ç¨‹è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸Šçš„æ—¶å€™ï¼Œå…·ä½“çœ‹è¯­å¢ƒã€‚ JS ä¸­çš„åç¨‹â—‡ ES6 æä¾›çš„ Generator å¯å®ç°åç¨‹ï¼Œä»¥ä¸‹ä½¿ç”¨ Generator æ–¹å¼å®ç°çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…ç¤ºä¾‹ï¼Œä¸»ç¨‹åºæ˜¯ç”Ÿäº§è€…è§†è§’ï¼Œç”±ç”Ÿäº§è€…é©±åŠ¨æ¶ˆè´¹è€…æ¶ˆè´¹äº§å“ã€‚ 123456789101112131415161718192021222324252627function* consume() &#123; console.log(&#x27;consume start&#x27;); while (true) &#123; var product = yield; // ç»“æŸæ ‡è¯† if (typeof product == &#x27;symbol&#x27; &amp;&amp; Symbol.keyFor(product) === &#x27;END&#x27;) &#123; break; &#125; console.log(`consume $&#123;product&#125;`); &#125; console.log(&#x27;consume exit&#x27;);&#125;const consumeIterator = consume();function produce() &#123; consumeIterator.next(); // å¯åŠ¨æ¶ˆè´¹è€… let count = 1; while (count &lt;= 5) &#123; console.log(`produce $&#123;count&#125;`); consumeIterator.next(count); count++; &#125; consumeIterator.next(Symbol.for(&#x27;END&#x27;));&#125;produce(); â—‡ Generator æœºåˆ¶ç”±ç›¸åº”çš„ JS å¼•æ“å®ç°ï¼Œå¯¹äº Generator å‡½æ•°ï¼Œè§£é‡Šå™¨ä¼šåœ¨ yield ä½ç½®é€‚æ—¶åœæ­¢ï¼Œå¹¶åœ¨è®°å½•æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶å€™é¢å¤–å¸¦ä¸Šå½“å‰æ‰§è¡Œåˆ°å‡½æ•°ä½“çš„å…·ä½“ä½ç½®ï¼Œç”¨äºå†æ¬¡è°ƒç”¨ next()æ–¹æ³•çš„æ—¶å€™æ¢å¤åˆ°ä¸Šæ¬¡æš‚åœçš„å‡½æ•°ä½“å†…ä½ç½®ç»§ç»­æ‰§è¡Œã€‚"},{"title":"äºŒè¿›åˆ¶æµ®ç‚¹æ•°çš„å­˜å‚¨:IEEE-754","date":"2020-06-13T08:32:31.000Z","path":"knowledge/äºŒè¿›åˆ¶æµ®ç‚¹æ•°çš„å­˜å‚¨IEEE-754.html","tags":[{"name":"è®¡ç®—æœºåŸºç¡€","slug":"è®¡ç®—æœºåŸºç¡€","permalink":"https://congzhou09.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"}],"text":"æ•°å­—çš„äºŒè¿›åˆ¶è¡¨ç¤ºâ—æ•°å­—çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ•°å­—13.125ç¤ºä¾‹å¦‚ä¸‹å›¾ï¼Œè§„åˆ™å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰æ•´æ•°éƒ¨åˆ†ä¸æ–­é™¤ä»¥2è®°å½•ä½™æ•°ç›´åˆ°å•†ä¸º0ï¼Œå°†ä½™æ•°é€†åºæ’åˆ—ä½œä¸ºç»“æœï¼›ï¼ˆ2ï¼‰å°æ•°éƒ¨åˆ†ä¸æ–­ä¹˜ä»¥2è®°å½•å»æ‰æ•´æ•°éƒ¨åˆ†ç›´åˆ°ä¹˜ç§¯å°æ•°éƒ¨åˆ†ç»“æœä¸º0ï¼Œå°†æ•´æ•°éƒ¨åˆ†æ­£åºæ’åˆ—ä½œä¸ºç»“æœï¼› IEEE-754çš„64ä½æµ®ç‚¹æ•°â—JavaScripté»˜è®¤é‡‡ç”¨IEEE-754çš„64ä½æµ®ç‚¹æ ¼å¼å­˜å‚¨æ•°å­—ï¼›â—IEEE-754çš„64ä½æµ®ç‚¹æ•°å­˜å‚¨æ–¹å¼ä½¿ç”¨64ä½å­˜å‚¨æµ®ç‚¹æ•°ï¼Œå¹¶å°†64ä½åˆ’åˆ†ä¸º1ä½ç¬¦å·ä½ã€11ä½æŒ‡æ•°ä½ã€52ä½å°¾æ•°ä½ä¸‰éƒ¨åˆ†ï¼Œå…·ä½“å¦‚ä¸‹ã€‚ï¼ˆ1ï¼‰ç¬¦å·ä½(sign)ï¼š0è¡¨ç¤ºæ­£æ•°ï¼Œ1è¡¨ç¤ºè´Ÿæ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¼šå‡ºç°+0å’Œ-0çš„åŸå› ï¼›ï¼ˆ2ï¼‰æŒ‡æ•°ä½(exponent)ï¼šè¡¨ç¤ºæ¬¡æ–¹æ•°ï¼Œç”±äºæŒ‡æ•°åˆ†æ­£è´Ÿï¼Œçº¦å®šä¸­é—´æ•°(äºŒè¿›åˆ¶011 1111 1111ï¼Œå³2^10-1&#x3D;1023)å¯¹åº”çš„çœŸå€¼æ˜¯0ï¼Œäºæ˜¯â€œçœŸå€¼&#x3D;å­˜å‚¨å€¼-1023â€ï¼ˆæ‰€ä»¥æœ€é«˜ä½æ˜¯1æ—¶æ˜¯æ­£æ•°ï¼Œæœ€é«˜ä½æ˜¯0æ—¶æ˜¯è´Ÿæ•°æˆ–é›¶ï¼‰ï¼Œçº¦å®šå­˜å‚¨å€¼çš„æœ€å°å€¼000 0000 0000(çœŸå€¼-1023)ä¸æœ€å¤§å€¼111 1111 1111(çœŸå€¼1024)ä½œç‰¹æ®Šç”¨é€”ï¼Œæ‰€ä»¥æŒ‡æ•°ä½çœŸå€¼å–å€¼çš„èŒƒå›´æ˜¯[-1022, 1023]ï¼Œè¿™ä¸ªèŒƒå›´å†…çš„æ•°å­—ç§°ä¸ºnormal numberï¼›ï¼ˆ3ï¼‰å°¾æ•°ä½(fraction)ï¼šè¡¨ç¤ºå°¾æ•°ï¼Œå°¾æ•°ä½è¶…å‡ºéƒ¨åˆ†é‡‡ç”¨è¿›1èˆ0ï¼› â—æ•°å­—å­˜å‚¨å‰å…ˆå°†å…¶è½¬ä¸ºäºŒè¿›åˆ¶ä¸‹çš„ç§‘å­¦è®¡æ•°æ³•çš„å½¢å¼ï¼Œä¸ºäº†æœ€å¤§é™åº¦ä½¿ç”¨å­˜å‚¨ç©ºé—´ï¼Œå­˜å‚¨normal numberæ—¶å°†ç§‘å­¦è®¡æ•°æ³•ä¸­â€œ1.â€å‰ç¼€çœç•¥ï¼Œä»è€Œå¯ä»¥è®©ç²¾åº¦å¤šä¸€ä½å˜æˆ53ä½ï¼ŒæŒ‰ç…§â€œ(âˆ’1)^signÃ—(1.fraction)Ã—2^(exponentâˆ’1023)â€è®¡ç®—çœŸå€¼ï¼›â—å­˜å‚¨ç»å¯¹å€¼å°äºnormal numberèŒƒå›´çš„æ•°å­—ï¼ˆç§°ä¸ºsubnormal numberï¼‰æ—¶ï¼Œä¸å†é™åˆ¶å…ˆè½¬æ¢ä¸º1.0å‰ç¼€çš„ç§‘å­¦è®¡æ•°æ³•ä»è€Œå¯è¡¨ç¤ºæ›´å°çš„æ•°å­—ï¼ˆå°è‡³2^(-(1022+52))&#x3D;2^(-1074)ï¼‰ï¼Œå­˜å‚¨submormal numberçš„æ ‡è¯†æ˜¯æŒ‡æ•°ä½å­˜å‚¨å€¼ä¸ºå…¨0ï¼Œæ­¤æ—¶æŒ‰ç…§&quot;(âˆ’1)^signÃ—0.fractionÃ—2^(âˆ’1022)&quot;è®¡ç®—çœŸå€¼ï¼ˆæŒ‡æ•°ä½å–å€¼-1022è€Œä¸æ˜¯æŒ‰ç…§&quot;exponent-1023&quot;è®¡ç®—ï¼Œå› ä¸ºsubnormal numberç›¸æ¯”normal numberä¸çœç•¥&quot;1.0&quot;å‰ç¼€ç›¸å½“äºå°æ•°ç‚¹å¤šå·¦ç§»äº†ä¸€ä½ï¼Œå³0.10Ã—2^(-1022)&#x3D;&#x3D;&#x3D;1.0Ã—2^(-1023)ï¼‰ï¼›â—æŒ‡æ•°ä½å­˜å‚¨å€¼ä¸ºå…¨1å¯¹åº”çš„ç‰¹æ®Šå€¼ï¼šï¼ˆ1ï¼‰å°¾æ•°ä½ä¸ºå…¨0æ—¶ï¼Œè¡¨ç¤ºå€¼ä¸ºInfinityï¼›ï¼ˆ2ï¼‰å°¾æ•°ä½é0æ—¶ï¼Œè¡¨ç¤ºNaNï¼Œå°¾æ•°ä½å­˜å‚¨ç©ºé—´è¢«ç§°ä¸ºNaNçš„payloadï¼Œå¯ç”¨äºå­˜å‚¨ç›¸å…³ä¿¡æ¯æ¯”å¦‚ä½•åŸå› å¯¼è‡´çš„NaNï¼›â—æ•°å­—13.125æŒ‰ç…§IEEE-754æ ‡å‡†å­˜å‚¨åˆ°64ä½ç©ºé—´çš„è¿‡ç¨‹ï¼šï¼ˆ1ï¼‰æ•°å­—è½¬ä¸ºäºŒè¿›åˆ¶å½¢å¼ï¼Œå³1101.001ï¼›ï¼ˆ2ï¼‰è½¬ä¸ºäºŒè¿›åˆ¶ä¸‹çš„ç§‘å­¦è®¡æ•°æ³•ï¼Œå³1.101001Ã—2^3ï¼Œå­˜å‚¨0.101001å°æ•°ç‚¹åéƒ¨åˆ†åˆ°å°¾æ•°ä½ï¼ŒæŒ‡æ•°ä½å­˜å‚¨3+1023&#x3D;1026è½¬äºŒè¿›åˆ¶&#x3D;10000000010ï¼›ï¼ˆ3ï¼‰äºæ˜¯64ä½ç©ºé—´æ‰€å­˜å‚¨å†…å®¹ä¸º0 10000000010 1010010000000000000000000000000000000000000000000000â—åŒç²¾åº¦ä¸‹çš„å®‰å…¨æ•´æ•°èŒƒå›´æ˜¯[-2^53, 2^53]ï¼Œå› ä¸ºåªèƒ½å­˜å‚¨53ä½æœ‰æ•ˆæ•°å­—ä½ï¼Œè¶…è¿‡53ä½çš„æœ‰æ•ˆæ•°å­—ä½å°†ä¸¢å¤±ï¼Œè¶…å‡ºå®‰å…¨æ•´æ•°èŒƒå›´çš„å€¼åªè¦æœ‰æ•ˆæ•°å­—ä½ä¸è¶…è¿‡53ä½è¿˜æ˜¯å¯ä»¥æ­£ç¡®å­˜å‚¨çš„ï¼Œå¦‚2^54ã€2^100ï¼› IEEE-754çš„32ä½æµ®ç‚¹æ•°â—IEEE-754å­˜å‚¨æµ®ç‚¹æ•°éƒ½æ˜¯å°†å­˜å‚¨ç©ºé—´åˆ’åˆ†ä¸ºç¬¦å·ä½ã€æŒ‡æ•°ä½ã€å°¾æ•°ä½ï¼Œä»¥ä¸‹æ˜¯å•ç²¾åº¦32ä½æµ®ç‚¹æ•°å„åŒºåŸŸçš„åˆ’åˆ†ä½æ•°ï¼Œå­˜å‚¨æ–¹å¼ä¸64ä½åŒç†ï¼› IEEE-754åœ¨çº¿æ•°å­—è½¬æ¢å·¥å…·ç½‘å€"},{"title":"ä»0.1+0.2ä¸ç­‰äº0.3æƒ³åˆ°çš„","date":"2020-06-12T05:57:05.000Z","path":"knowledge/ä»0-1-0-2ä¸ç­‰äº0-3æƒ³åˆ°çš„.html","tags":[{"name":"javascript","slug":"javascript","permalink":"https://congzhou09.github.io/tags/javascript/"},{"name":"è®¡ç®—æœºåŸºç¡€","slug":"è®¡ç®—æœºåŸºç¡€","permalink":"https://congzhou09.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"}],"text":"äºŒè¿›åˆ¶æ— æ³•ç²¾ç¡®å­˜å‚¨0.1â™‚åè¿›åˆ¶ä¸‹ä¸€ä¸ªç®€å•çš„å°æ•°0.1ï¼Œåœ¨äºŒè¿›åˆ¶ä¸‹å´å˜æˆæ— é™å¾ªç¯å°æ•°0.0 0011 0011 0011...è¿›è€Œæ— æ³•ç²¾ç¡®çš„å­˜å‚¨ï¼Œæ˜¯ä¸æ˜¯è¯´æ˜äºŒè¿›åˆ¶æœ‰ç¼ºé™·ï¼Ÿâ™‚ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼šï¼ˆ1ï¼‰å°æ•°åˆ†ä¸ºæœ‰é™å°æ•°ã€æ— é™å¾ªç¯å°æ•°ã€æ— é™ä¸å¾ªç¯å°æ•°ï¼Œå…¶ä¸­æœ‰é™å°æ•°å’Œæ— é™å¾ªç¯å°æ•°éƒ½å¯ä»¥è½¬æ¢æˆæœ‰ç†æ•°èŒƒå›´å†…çš„åˆ†æ•°å½¢å¼ï¼Œåè¿›åˆ¶ä¸‹çš„0.1ä¹Ÿå°±æ˜¯åˆ†æ•°1&#x2F;10ï¼›ï¼ˆ2ï¼‰æ— è®ºç”¨å¤šå°‘è¿›åˆ¶è¡¨ç¤ºå°æ•°ï¼Œå°æ•°çš„å€¼éƒ½æ˜¯é€šè¿‡âˆ‘m*n^kè®¡ç®—å¾—åˆ°(nä¸ºè¿›åˆ¶æ•°ã€mä¸ºåº•æ•°ã€kä¸ºæŒ‡æ•°)ï¼Œåè¿›åˆ¶ä¸‹çš„1&#x2F;3(0.3â€¦)ã€1&#x2F;7(0.142857â€¦)æ˜¯æ— é™å¾ªç¯å°æ•°ï¼Œä½†å®ƒä»¬åˆ†åˆ«å’Œä¸ƒè¿›åˆ¶ä¸‹å´éƒ½è¡¨ç¤ºä¸ºæœ‰é™å°æ•°0.1ï¼›ï¼ˆ3ï¼‰å› æ­¤åˆ†æ•°åœ¨æ‰€æœ‰è¿›åˆ¶ä¸‹éƒ½å­˜åœ¨æ— é™å¾ªç¯å°æ•°ï¼Œåªæ˜¯å„è¿›åˆ¶ä¸‹å“ªäº›åˆ†æ•°å±äºæ— é™å¾ªç¯å°æ•°çš„è¿™ä¸ªèŒƒå›´æ˜¯ä¸ä¸€æ ·çš„ï¼› 0.1+0.2ä¸ç­‰äº0.3â™€åœ¨JavaScriptç¯å¢ƒå’ŒJavaçš„System.out.printlnæ‰“å°0.1+0.2çš„ç»“æœéƒ½æ˜¯ &quot;0.30000000000000004&quot;ï¼Œåœ¨C&#x2F;C++è¯­è¨€ç¯å¢ƒä¸‹printfæ‰“å°çš„ç»“æœæ˜¯&quot;0.300000&quot;ï¼Œæ˜¯ä¸æ˜¯è¯´æ˜C&#x2F;C++è¡¨ç¤ºå°æ•°çš„ç²¾åº¦æ›´é«˜ï¼Ÿâ™€ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼šï¼ˆ1ï¼‰è‡ª1985å¹´èµ·ï¼ŒåŒ…æ‹¬Cã€C++ã€Javaã€JavaScriptåœ¨å†…çš„æ‰€æœ‰ç¼–ç¨‹è¯­è¨€éƒ½é‡‡ç”¨IEEE-754æ ‡å‡†å®ç°æµ®ç‚¹æ•°çš„å­˜å‚¨ï¼›ï¼ˆ2ï¼‰Javaå’ŒJavaScriptç¯å¢ƒä¸‹æ‰“å°å€¼é»˜è®¤ä¿ç•™äº†å°æ•°ç‚¹å17ä½ï¼Œè€Œåœ¨C&#x2F;C++ç¯å¢ƒä¸‹æ‰“å°å€¼é»˜è®¤ä¿ç•™äº†6ä½æ˜¯äº§ç”Ÿä¸Šè¿°å·®å¼‚ç°è±¡çš„åŸå› ï¼›ï¼ˆ3ï¼‰C&#x2F;C++ç¯å¢ƒä¸‹é€šè¿‡ä»¥ä¸‹è¯­å¥æ˜¾å¼å¾—è®¾ç½®æ‰“å°å°æ•°ç‚¹å17ä½åŒæ ·ä¼šæ‰“å°&quot;0.30000000000000004&quot;ï¼› 1printf(&quot;0.1+0.2== %.17f\\n&quot;, 0.1+0.2); 0.1+0.1ç­‰äº0.2â–²åœ¨å„ç¯å¢ƒä¸‹&quot;0.1+0.2&#x3D;&#x3D;0.3&quot;ç»“æœæ˜¯falseï¼Œ&quot;0.1+0.1&#x3D;&#x3D;0.2&quot;ç»“æœå´æ˜¯trueï¼Œè€Œä¸”åœ¨JavaScriptç¯å¢ƒå’ŒJavaçš„System.out.printlnæ‰“å°&quot;0.1+0.1&quot;çš„ç»“æœéƒ½æ˜¯&quot;0.2&quot;ï¼Œä¸ºä»€ä¹ˆï¼Ÿâ–²åŸå› æ˜¯ï¼šï¼ˆ1ï¼‰æŒ‰ç…§IEEE-754å­˜å‚¨ï¼Œ0.1å’Œ0.1çš„å­˜å‚¨å€¼ç›¸åŠ ç»“æœå­˜å‚¨åçš„å€¼ä¸0.2ç›´æ¥å­˜å‚¨çš„å€¼ä¸€è‡´ï¼›ï¼ˆ2ï¼‰æŒ‰ç…§IEEE-754å­˜å‚¨ï¼Œ0.1å’Œ0.2çš„å­˜å‚¨å€¼ç›¸åŠ ç»“æœå­˜å‚¨åçš„å€¼ä¸0.3ç›´æ¥å­˜å‚¨çš„å€¼ä¸ä¸€è‡´ï¼›"},{"title":"webpacké¡¹ç›®ä¼˜é›…ä½¿ç”¨ServiceWorker","date":"2020-05-07T10:50:14.000Z","path":"practice/webpacké¡¹ç›®ä¼˜é›…ä½¿ç”¨ServiceWorker.html","tags":[{"name":"ServiceWorker","slug":"ServiceWorker","permalink":"https://congzhou09.github.io/tags/ServiceWorker/"},{"name":"webpack","slug":"webpack","permalink":"https://congzhou09.github.io/tags/webpack/"},{"name":"æŒ‰éœ€åŠ è½½","slug":"æŒ‰éœ€åŠ è½½","permalink":"https://congzhou09.github.io/tags/%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD/"}],"text":"ç®€ä»‹â—æ­¤å¤„å°†â€œä¼˜é›…â€çš„å«ä¹‰å®šä¹‰ä¸ºä¸¤ä¸ªæ–¹é¢ï¼šï¼ˆ1ï¼‰åº”ç”¨webpackç”Ÿæ€ç®€åŒ–ServiceWorkerçš„é…ç½®ï¼›ï¼ˆ2ï¼‰ServiceWorkerçš„å¼€å…³æ§åˆ¶ä¸ç›¸å…³åº“çš„æŒ‰éœ€åŠ è½½ï¼›â—ç¬¬ä¸€æ–¹é¢å…·ä½“æ˜¯offline-pluginæ’ä»¶çš„åº”ç”¨ï¼›â—ç¬¬äºŒæ–¹é¢æ˜¯åŠ¨æ€è·å–å‰ç«¯é…ç½®ä¸webpackçš„Code Splitingæœºåˆ¶çš„åº”ç”¨ï¼› offline-pluginæ’ä»¶çš„åº”ç”¨â—‹webpackç”Ÿæ€æä¾›äº†offline-pluginç”¨äºæ–¹ä¾¿åœ°ä½¿ç”¨ServiceWorkerï¼Œé¦–å…ˆåœ¨é¡¹ç›®å†…å®‰è£…æ­¤ä¾èµ–ï¼›â—‹ç„¶åå¯¹offline-pluginè¿›è¡Œé…ç½®ä¸å¼•å…¥ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸¤éƒ¨åˆ†ï¼šï¼ˆ1ï¼‰ä½œä¸ºwebpackæ’ä»¶åœ¨é¡¹ç›®webpacké…ç½®æ–‡ä»¶ä¸­å¢åŠ æ­¤pluginsçš„é…ç½®ï¼›ï¼ˆ2ï¼‰ä½œä¸ºjsåº“åœ¨main.jsä¸­å¼•å…¥ä¸å®ä¾‹åŒ–è¿è¡Œæ—¶å¯¹è±¡ï¼›â—‹åœ¨ServiceWorkeræ›´æ–°å®‰è£…å®Œæˆåå¼ºåˆ¶ç”Ÿæ•ˆé€šè¿‡åœ¨ä»¥ä¸Šï¼ˆ1ï¼‰éƒ¨åˆ†é…ç½®&quot;events:true&quot;å’Œåœ¨ä»¥ä¸Šï¼ˆ2ï¼‰éƒ¨åˆ†ä¸­å¤„ç†onUpdateReadyå’ŒonUpdatedä¸¤ä¸ªäº‹ä»¶å›è°ƒå®ç°ï¼› åŠ¨æ€è·å–å‰ç«¯é…ç½®â– ä¸ºæ–¹ä¾¿çº¿ä¸Šç¯å¢ƒä¸‹å¿…è¦æ—¶å€™å…³é—­ServiceWorkeræœºåˆ¶ï¼Œå°†ServiceWorkerçš„å¼€å…³é…ç½®åœ¨æœåŠ¡ç«¯ï¼Œå½“å‰æ˜¯å¦å¯ç”¨ç”±ä»æœåŠ¡å™¨è·å–åˆ°çš„å¼€å…³å–å€¼å†³å®šï¼›â– å½“è·å–åˆ°çš„å¼€å…³å€¼ä¸ºfalseåˆ™è¿›è¡ŒServiceWorkerçš„æ³¨é”€ä»¥ä¿è¯ServiceWorkerçš„å½»åº•å…³é—­ï¼› Code Splitingæœºåˆ¶çš„åº”ç”¨â–²é€šè¿‡splitChunkså°†offline-pluginæ˜¾å¼æ‹†åˆ†ä¸ºç‹¬ç«‹çš„chunkï¼›â–²main.jsä¸­ä½¿ç”¨åŠ¨æ€importçš„æ–¹å¼å¼•å…¥offline-pluginçš„è¿è¡Œæ—¶classï¼›â–²å¦‚æ­¤å®ç°äº†å¯¹offline-pluginçš„æŒ‰éœ€åŠ è½½ï¼› ä»£ç å®ä¾‹â—†webpacké…ç½®æ–‡ä»¶å¢åŠ å¦‚ä¸‹å†…å®¹ï¼š 12345678910111213141516171819202122232425262728293031323334var OfflinePlugin = require(&#x27;offline-plugin&#x27;);module.exports = &#123; â€¦â€¦ optimization: &#123; â€¦â€¦ splitChunks: &#123; minSize: 0, // å…³æ‰ç‹¬ç«‹chunkæœ€å°å¤§å°çš„é™åˆ¶ cacheGroups: &#123; offline: &#123; // å°†offline-pluginæ˜¾å¼æ‹†åˆ†æˆç‹¬ç«‹çš„chunk test: /offline-plugin/, name: &#x27;offline&#x27;, chunks: &#x27;all&#x27;, priority: 3 &#125;, â€¦â€¦ &#125; â€¦â€¦ plugins: [ â€¦â€¦ new OfflinePlugin(&#123; AppCache: false, //`offline-plugin`é»˜è®¤æ”¯æŒ`AppCache`ï¼Œä½†æ˜¯`AppCache`è‰æ¡ˆå·²ç»è¢«webæ ‡å‡†æ‰€åºŸå¼ƒï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚ä½†æ˜¯ç”±äºä»ç„¶æœ‰éƒ¨åˆ†æµè§ˆå™¨æ”¯æŒï¼Œæ‰€ä»¥æ’ä»¶é»˜è®¤æä¾›è¿™ä¸ªåŠŸèƒ½ã€‚ safeToUseOptionalCaches: true, // å»é™¤`additional | optional`è·¯å¾„æ£€æŸ¥ä¸ç¡®å®šæ—¶æ‰“å°çš„è­¦å‘Š ServiceWorker: &#123; events: true //ç”¨äºå½“å‰æ§åˆ¶é¡µé¢çš„swçš„å¼ºåˆ¶æ›´æ–° &#125;, caches: &#123; //ç¼“å­˜å†…å®¹çš„ç²¾ç»†æ§åˆ¶ main: [&#x27;index.html&#x27;, &#x27;*/vconsole.min.js&#x27;], additional: [&#x27;*/js/common.*.js&#x27;, &#x27;*/js/app.*.js&#x27;, &#x27;*/js/vendor.*.js&#x27;], optional: [&#x27;:rest:&#x27;] &#125; &#125;) ]&#125;; â—†main.jsæ–‡ä»¶å¢åŠ å¦‚ä¸‹å†…å®¹ï¼š 1234567891011121314151617181920212223242526272829303132// Service Workerif (&#x27;serviceWorker&#x27; in navigator) &#123; if (config.serviceWorker) &#123;// ä»æœåŠ¡å™¨è·å–åˆ°çš„ServiceWorkerå¼€å…³å€¼ setTimeout(() =&gt; &#123;// é˜²æ­¢å¹²æ‰°ä¸»ç¨‹åºåˆå§‹åŒ–é€Ÿåº¦ï¼Œå°†ServiceWorkerçš„åˆå§‹åŒ–æ”¾åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œé˜Ÿåˆ—çš„é˜Ÿå°¾ console.log(&#x27;serviceWorker init&#x27;); import(&#x27;offline-plugin/runtime&#x27;).then(swRuntime =&gt;&#123; swRuntime.install(&#123; onUpdateReady: () =&gt; &#123; console.log(&#x27;sw onUpdateReady&#x27;); swRuntime.applyUpdate(); // ä½œç”¨ç›¸å½“äºåŸç”ŸServiceWorkerçš„self.skipWaiting() &#125;, onUpdated: () =&gt; &#123; // ä½œç”¨ç›¸å½“äºåŸç”ŸServiceWorkerçš„ç›‘å¬ controllerchange äº‹ä»¶ console.log(&#x27;sw onUpdated&#x27;); window.location.reload(); &#125; &#125;); &#125;, 0); &#125; else &#123; // æ³¨é”€Service Workeræ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹ç‰‡æ®µï¼š navigator.serviceWorker.getRegistration().then(registration =&gt; &#123; registration &amp;&amp; registration .unregister() .then(boolean =&gt; &#123; boolean ? console.log(&#x27;Service Workeræ³¨é”€æˆåŠŸ&#x27;) : console.log(&#x27;Service Workeræ³¨é”€å¤±è´¥&#x27;); &#125;) .catch(error =&gt; &#123; console.log(`Service Workeræ³¨é”€å¼‚å¸¸:$&#123;error&#125;`); &#125;); &#125;); &#125;&#125;"},{"title":"å¾®æœåŠ¡åŸºæœ¬ç†è§£","date":"2020-02-17T03:18:41.000Z","path":"knowledge/å¾®æœåŠ¡åŸºæœ¬ç†è§£.html","tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"https://congzhou09.github.io/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"}],"text":"ç®€ä»‹â—‡å¾®æœåŠ¡æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œç”±Martin Fowlerä¸James Lewisäº2014å¹´æå‡ºï¼›â—‡å¾®æœåŠ¡æ–¹å¼æ˜¯ä½¿ç”¨ä¸€å¥—å°æœåŠ¡æ¥å¼€å‘å•ä¸ªåº”ç”¨ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨è‡ªå·±çš„è¿›ç¨‹ä¸­ï¼ˆæ¯ä¸ªæœåŠ¡å¯çœ‹ä½œä¸€ä¸ªå°çš„åº”ç”¨ï¼‰ï¼Œå¹¶ä½¿ç”¨è½»é‡çº§æœºåˆ¶é€šä¿¡ï¼Œé€šå¸¸æ˜¯HTTP APIï¼Œè¿™äº›æœåŠ¡èƒ½å¤Ÿé€šè¿‡ç‹¬ç«‹çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€å®ç°ï¼Œä»¥åŠä¸åŒæ•°æ®å­˜å‚¨æŠ€æœ¯ï¼Œå¹¶ä¿æŒæœ€ä½é™åº¦çš„é›†ä¸­å¼ç®¡ç†ï¼›â—‡å¾®æœåŠ¡ç†å¿µï¼šæœ‰æ•ˆæ‹†åˆ†æœåŠ¡ï¼Œæä¾›ä¸€å¥—ç»Ÿä¸€åŸºç¡€æ¶æ„ä½¿å¾—å„ä¸ªå¾®æœåŠ¡èƒ½ç‹¬ç«‹çš„éƒ¨ç½²ã€è¿è¡Œã€å‡çº§ï¼Œå…·æœ‰è½»é‡çº§çš„é€šä¿¡æœºåˆ¶è¿›è¡Œé€šä¿¡ï¼Œåœ¨ç»“æ„ä¸Šæ¾è€¦åˆè€Œåœ¨åŠŸèƒ½ä¸Šè¡¨ç°ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œå®ç°åº”ç”¨çš„æ•æ·å¼€å‘ä¸éƒ¨ç½²ï¼›â—‡æœåŠ¡æ‹†åˆ†åŸåˆ™ï¼šå½“ä¸€å—ä¸šåŠ¡ä¸ä¾èµ–æˆ–æå°‘ä¾èµ–å…¶å®ƒæœåŠ¡ï¼Œæœ‰ç‹¬ç«‹çš„ä¸šåŠ¡è¯­ä¹‰ï¼Œä¸ºè¶…è¿‡2ä¸ªçš„å…¶ä»–æœåŠ¡æˆ–å®¢æˆ·ç«¯æä¾›æ•°æ®ï¼Œé‚£ä¹ˆå®ƒå°±åº”è¯¥è¢«æ‹†åˆ†æˆä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡æ¨¡å—ï¼›â—‡å¾®æœåŠ¡ç›¸å…³å¼€å‘å·¥å…·ï¼šï¼ˆ1ï¼‰Spring Cloudä¸ºå¼€å‘è€…æä¾›äº†åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€æ™ºèƒ½è·¯ç”±ã€å¾®ä»£ç†ã€æ§åˆ¶æ€»çº¿ç­‰å¼€å‘å·¥å…·åŒ…ï¼›ï¼ˆ2ï¼‰Dubboï¼ˆ3ï¼‰Dropwizardï¼ˆå…³æ³¨å•ä¸ªå¾®æœåŠ¡çš„å¼€å‘ï¼‰â—‡æœåŠ¡é—´é€šä¿¡æ–¹å¼ï¼šï¼ˆ1ï¼‰RESTï¼ŒåŒæ­¥æ–¹å¼ï¼ˆ2ï¼‰RPCï¼ŒåŒæ­¥æ–¹å¼ï¼ˆ3ï¼‰æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¼‚æ­¥æ–¹å¼ å•ä½“æ¶æ„ç›¸å¯¹å¾®æœåŠ¡æ¶æ„çš„ç¼ºç‚¹â—ä»£ç ä¸æ¨¡å—è¶Šå¤šï¼Œé€»è¾‘å¤æ‚æ€§è¶Šé«˜è¶Šéš¾ç†è§£ï¼Œè¶Šéš¾è§£å†³é‡åˆ°çš„é—®é¢˜ï¼›â—é¡¹ç›®éƒ¨ç½²ä¸å¯åŠ¨é€Ÿåº¦é€æ¸å˜æ…¢ï¼Œä¿®å¤å±€éƒ¨æ¨¡å—é—®é¢˜éœ€è¦é‡å¯æ•´ä¸ªé¡¹ç›®ä½¿é—®é¢˜å¤„ç†é€Ÿåº¦å˜æ…¢ï¼›â—æ–°æŠ€æœ¯é‡æ„ä¸å‡çº§é¡¹ç›®çš„æˆæœ¬é€æ¸å˜é«˜ï¼Œæ–°åŠ æ¨¡å—ä½¿ç”¨æ–°æŠ€æœ¯å—é™åˆ¶ï¼ŒåŠ å…¥æ•°æ®åˆ†æä¸ç›‘æ§å®¹æ˜“å‡ºç°æ€§èƒ½ç“¶é¢ˆï¼›â—ä¸åˆ©äºæŒ‰å„æ¨¡å—éœ€æ±‚ä¼¸ç¼©èµ„æºï¼ˆCPU&#x2F;å†…å­˜&#x2F;æ•°æ®åº“ï¼‰ï¼›å¾®æœåŠ¡æ¶æ„ç›¸å¯¹å•ä½“æ¶æ„çš„ç¼ºç‚¹â–³ç»´æŠ¤é¡¹ç›®å˜å¤šï¼Œå¤„ç†åˆ†å¸ƒå¼çš„åœºæ™¯å˜å¤šï¼Œéœ€è¦æ›´å¼ºçš„æ•…éšœå¤„ç†æœºåˆ¶æœºåˆ¶ï¼› é‡è¦éƒ¨ä»¶â—APIç½‘å…³ï¼ˆ1ï¼‰åå°æœåŠ¡çš„èšåˆï¼Œåœ¨å‰ç«¯ä¸åå°ä¹‹é—´æä¾›ç»Ÿä¸€çš„æœåŠ¡å…¥å£ï¼Œè®©å¾®æœåŠ¡å¯¹å‰ç«¯é€æ˜ï¼›ï¼ˆ2ï¼‰æä¾›å®‰å…¨ã€è¿‡æ»¤ã€æµé‡æ§åˆ¶ç­‰APIç®¡ç†åŠŸèƒ½ï¼›â—æœåŠ¡å‘ç°ï¼Œåˆ†å¸ƒå¼ç®¡ç†å„æœåŠ¡é“¾æ¥ä¿¡æ¯çš„æ³¨å†Œä¸æ›´æ–°ï¼ˆä¾‹ï¼šZookeeperã€Eurekaã€Consulã€Etcdï¼‰ï¼›â—æ•…éšœå¤„ç†a.å‡å°‘æ•…éšœæœºç‡ï¼ˆ1ï¼‰ç›‘æ§ï¼Œå„æœåŠ¡è®¾ç½®ç›‘æ§æŒ‡æ ‡ä¸æä¾›çŠ¶æ€ï¼Œé‡‡é›†å™¨é‡‡é›†ï¼ŒUIå‘ˆç°ï¼ˆä¾‹ï¼šRedisExporterã€MySQLExporterã€Prometheusã€Grafanaï¼‰ï¼›b.é™ä½æ•…éšœå¯¹æ•´ä½“çš„å½±å“ï¼ˆ1ï¼‰é™çº§ï¼Œå½“æŸæœåŠ¡çš„ä¸‹æ¸¸éæ ¸å¿ƒæœåŠ¡åœæ­¢å·¥ä½œï¼Œåˆ™æš‚æ—¶å°†å…¶å…³é—­ï¼Œä¿è¯æ ¸å¿ƒä¸šåŠ¡ä¸ä¸­æ–­ï¼›ï¼ˆ2ï¼‰ç†”æ–­ï¼Œä¸ºäº†é¿å…æ¯æ¬¡è¯·æ±‚éƒ½ç­‰å¾…è¶…æ—¶å¯¼è‡´é“¾è·¯èµ„æºé•¿æ—¶å ç”¨è¿›è€Œå¯¼è‡´è¯·æ±‚å †ç§¯ï¼Œæ¯ä¸ªæœåŠ¡å¯¹å…¶ä¸‹æ¸¸æœåŠ¡ä½¿ç”¨ç†”æ–­æœºåˆ¶å¿«é€Ÿè¿”å›å¤±è´¥å¹¶é€šè¿‡å®šæ—¶å¥åº·æ£€æŸ¥è‡ªåŠ¨æ¢å¤ï¼› ï¼ˆ3ï¼‰é™æµï¼ŒæœåŠ¡é¢å¯¹ç¬æ—¶æµé‡è¿‡å¤§æƒ…å†µçš„è‡ªæˆ‘ä¿æŠ¤ï¼Œæ¨èåŒºåˆ†æœåŠ¡çš„é™æµç­–ç•¥ï¼Œå¯åº”å¯¹æŸä¸ªæœåŠ¡ç”±äºä»£ç é—®é¢˜å‘èµ·çš„å¤§é‡è¯·æ±‚ï¼› c.æä¾›æ•…éšœæ’æŸ¥æ•ˆç‡ ï¼ˆ1ï¼‰é“¾è·¯è·Ÿè¸ªï¼ˆä¾‹ï¼šDapperã€Zipkinï¼‰ï¼ŒæŸ¥çœ‹è¯·æ±‚ç»è¿‡å“ªäº›æœåŠ¡èŠ‚ç‚¹åŠå„è‡ªçš„å“åº”æ—¶é•¿ ï¼ˆ2ï¼‰æ—¥å¿—åˆ†æï¼Œå„æœåŠ¡æ—¥å¿—é‡‡é›†ä¸æ£€ç´¢æ”¯æŒï¼Œé€šå¸¸ç”¨ELKå®ç°ï¼› ### åº”ç”¨å®ä¾‹ â– é…ç½®ç®¡ç†æœåŠ¡ ï¼ˆ1ï¼‰é…ç½®ç®¡ç†æœåŠ¡é›†ä¸­ç®¡ç†å…¶ä»–å„å¾®æœåŠ¡åœ¨å„è¿è¡Œç¯å¢ƒä¸‹çš„é…ç½®ï¼Œé…ç½®æ”¯æŒå®æ—¶åŠ¨æ€ä¿®æ”¹ä¸è‡ªåŠ¨æ›´æ–°åˆ°å…¶ä»–å„å¾®æœåŠ¡ï¼Œæ”¯æŒç‰ˆæœ¬æ§åˆ¶ä¸å†…å®¹å®¡è®¡ï¼› ï¼ˆ2ï¼‰æ¯ä¸ªä»é…ç½®ç®¡ç†æœåŠ¡è¯·æ±‚è‡ªå·±çš„é…ç½®å¹¶ç¼“å­˜æœ¬åœ°ï¼› ï¼ˆ3ï¼‰ç»å…¸æ¡ˆä¾‹ï¼šApolloã€Spring Cloudé»˜è®¤ä½¿ç”¨Gitå­˜å‚¨é…ç½®å†…å®¹ï¼›"},{"title":"é…ç½®å…¬å¸GitLabå’Œä¸ªäººGitHubä½¿ç”¨ä¸åŒçš„Nameå’ŒEmail","date":"2020-02-04T06:55:04.000Z","path":"handbook/é…ç½®å…¬å¸GitLabå’Œä¸ªäººGitHubä½¿ç”¨ä¸åŒçš„Nameå’ŒEmail.html","tags":[{"name":"git","slug":"git","permalink":"https://congzhou09.github.io/tags/git/"}],"text":"â—‡Git v2.13åŠä¹‹åçš„ç‰ˆæœ¬æ”¯æŒæ¡ä»¶é…ç½®includeï¼ˆconditional configuration includesï¼‰ï¼Œé¦–å…ˆè¿›è¡Œå¿…è¦çš„gitç‰ˆæœ¬å‡çº§ï¼›â—‡é…ç½®å…¨å±€é»˜è®¤çš„nameå’Œemailä¸ºå…¬å¸çš„Nameå’ŒEmailï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 12git config set --global user.name yuancongzhougit config set --global user.email yuancongzhou@company.com â—‡é…ç½®å®Œæˆåï¼Œåœ¨å½“å‰ç”¨æˆ·æ–‡ä»¶å¤¹ä¸‹çš„&quot;.gitconfig&quot;å¯ä»¥çœ‹åˆ°å·²é…ç½®çš„ä¿¡æ¯å¦‚ä¸‹ï¼Œå…¶å®ä¹Ÿå¯ç›´æ¥ç¼–è¾‘è¿™ä¸ª&quot;.gitconfig&quot;æ–‡ä»¶ï¼› 123[user] name = yuancongzhou email = yuancongzhou@company.com â—‡åŒç›®å½•ä¸‹å†åˆ›å»ºä¸€ä¸ªgité…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶åä¾‹å¦‚&quot;.gitconfig_github&quot;ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ 123[user] name = congzhou09 email = yuancongzhou@yeah.net â—‡&quot;.gitconfig&quot;æ–‡ä»¶å¢åŠ å¦‚ä¸‹å†…å®¹ï¼Œå…¶ä¸­çš„gitdirå…³é”®å­—ç”¨äºæ¨¡å¼åŒ¹é…ï¼ˆå¯ä½¿ç”¨gitdir&#x2F;iè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå½“æŸgitç›®å½•çš„.gitè·¯å¾„åŒ¹é…è¿™ä¸ªæ¨¡å¼çš„æ—¶å€™ï¼Œå…¶èŒƒå›´å†…çš„å„å˜é‡å°†ç”Ÿæ•ˆï¼›æ³¨æ„å…¶ä¸­æ–‡ä»¶å¤¹åéœ€è¦å®Œæ•´å¹¶ä¸”&quot;&#x2F;&quot;æ˜¯å¿…é¡»çš„ï¼› 12[includeIf &quot;gitdir:Git_mine/&quot;] path = .gitconfig_github"},{"title":"webpacké¡¹ç›®è‡ªåŠ¨ä»£ç æ£€æŸ¥ä¸æ ¼å¼åŒ–çš„å®ç°","date":"2019-11-26T10:09:38.000Z","path":"handbook/webpacké¡¹ç›®è‡ªåŠ¨ä»£ç æ£€æŸ¥ä¸æ ¼å¼åŒ–çš„å®ç°.html","tags":[{"name":"webpack","slug":"webpack","permalink":"https://congzhou09.github.io/tags/webpack/"}],"text":"å½“å‰è§£å†³æ–¹æ¡ˆâ— ä½¿ç”¨ editorconfig æ§åˆ¶ä¹¦å†™ä»£ç æœŸé—´çš„åŸºæœ¬é£æ ¼ç»Ÿä¸€ã€‚â— ä½¿ç”¨ eslint åšä»£ç è¯­æ³•æ£€æŸ¥ï¼Œå®ç°ä»£ç è´¨é‡æ§åˆ¶ã€‚â— ä½¿ç”¨ prettier åšä»£ç æ ¼å¼åŒ–ï¼Œå®ç°ç»Ÿä¸€é£æ ¼ã€‚â— git commit ä¹‹å‰æ‰§è¡Œè‡ªåŠ¨ä¿®å¤ï¼Œæ— æ³•è‡ªåŠ¨ä¿®å¤çš„åœ°æ–¹æ‰‹åŠ¨ä¿®æ”¹ã€‚ ps: ç”±äº eslint ä¹ŸåŒ…å«äº†ä»£ç æ ¼å¼åŒ–åŠŸèƒ½ï¼Œæ‰€ä»¥ prettier ä»…åšé js ç±»ä»£ç (js&#x2F;ts&#x2F;tsx&#x2F;jsx)çš„æ ¼å¼åŒ–ã€‚ VSCode ç¯å¢ƒé…ç½®(IDE çš„é…ç½®æ­¤å¤„åªä»¥ VSCode ä¸ºä¾‹)â—‹ ç›®çš„æ˜¯è®© IDE æ’ä»¶çš„æ ¼å¼åŒ–ä¸å‘½ä»¤è¡Œæ‰§è¡Œå‘½ä»¤çš„æ ¼å¼åŒ–ç»Ÿä¸€ä½¿ç”¨ prettierã€‚â—‹ å®‰è£…å¦‚ä¸‹æ’ä»¶ï¼šEditorConfig for VS Codeã€ESLintã€Veturã€Prettier-Code formatterã€‚â—‹ ç”±äºè·Ÿ Prettier é‡å¤ä¸é”®ä½å†²çªï¼Œå¦‚æœæœ‰ Beautify æ’ä»¶åˆ™åˆ æ‰ã€‚â—‹ æ‰“å¼€ VSCode çš„ setting.json æ–‡ä»¶ï¼Œå¢åŠ å¦‚ä¸‹é…ç½®å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930313233/*************veturç›¸å…³*****************/&quot;vetur.format.defaultFormatter.html&quot;: &quot;prettier&quot;,&quot;vetur.validation.template&quot;: false,&quot;vetur.validation.script&quot;: false,&quot;[vue]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;octref.vetur&quot;&#125;,/*************eslintç›¸å…³*****************/&quot;eslint.format.enable&quot;: true,&quot;eslint.validate&quot;: [ &#123; &quot;language&quot;: &quot;javascript&quot;, &quot;autoFix&quot;: true &#125;, &quot;javascriptreact&quot;, &#123; &quot;language&quot;: &quot;vue&quot;, &quot;autoFix&quot;: true &#125;],/*************prettierç›¸å…³*****************/&quot;[javascript]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;&#125;,&quot;[html]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;&#125;,&quot;[sass]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;&#125;,&quot;[typescriptreact]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;&#125;, æœ¬æœºç¯å¢ƒé…ç½®â—‡ è€ƒè™‘ç‰ˆæœ¬å…¼å®¹ä¸æ¨èå…¨å±€å®‰è£… eslintï¼Œé€šè¿‡å…¨å±€å®‰è£… eslint-cli ä»¥å®ç°å¯¹å…¨å±€ eslint å‘½ä»¤çš„æ”¯æŒã€‚ é¡¹ç›®å†…é…ç½®â—† æ ¹ç›®å½•ä¸‹çš„&quot;.editorconfig&quot; æ–‡ä»¶å†…å®¹å¦‚ä¸‹(æ­¤å¤„ä»¥ç©º 2 æ ¼ä½œä¸ºæ ‡å‡†)ï¼š 123456789# EditorConfig is awesome: https://EditorConfig.org# top-most EditorConfig fileroot = true[*]charset = utf-8indent_style = spaceindent_size = 2end_of_line = lfinsert_final_newline = true â—† è¿è¡Œå¦‚ä¸‹å‘½ä»¤ä»¥å®‰è£… eslintã€babel-eslintã€prettierã€eslint-config-googleã€eslint-config-prettierã€eslint-plugin-prettier 1yarn add -D eslint babel-eslint prettier eslint-config-google eslint-config-prettier eslint-plugin-prettier â—† æ ¹ç›®å½•ä¸‹çš„&quot;.prettierrc&quot;æ–‡ä»¶å†…å®¹ï¼š 123456&#123; &quot;singleQuote&quot;: true, &quot;trailingComma&quot;: &quot;all&quot;, &quot;printWidth&quot;: 140, &quot;endOfLine&quot;: &quot;lf&quot;&#125; â—† æ ¹ç›®å½•ä¸‹çš„&quot;package.json&quot; æ–‡ä»¶ä¸­å¢åŠ åä¸º&quot;codecheck&quot;çš„ scriptï¼š 1&quot;codecheck&quot;: &quot;eslint --ext .jsx,.js,.vue,.ts,.tsx --fix src &amp;&amp; prettier --write src/**/*.(css,scss,less) --log-level warn&quot; vue é¡¹ç›®â—‡ å®‰è£… eslint-plugin-vueï¼ˆä½¿ eslint æ”¯æŒ vue è¯­æ³•çš„å®˜æ–¹æ’ä»¶ï¼‰â—‡ æ ¹ç›®å½•ä¸‹çš„&quot;.eslintrc.js&quot;æ–‡ä»¶ï¼š 1234567891011121314module.exports = &#123; root: true, extends: [&#x27;google&#x27;, &#x27;plugin:vue/essential&#x27;, &#x27;plugin:prettier/recommended&#x27;], env: &#123; &quot;browser&quot;: true, &quot;commonjs&quot;: true, &quot;es6&quot;: true, &quot;node&quot;: true &#125;, parserOptions: &#123; parser: &#x27;babel-eslint&#x27;, sourceType: &#x27;module&#x27; //é…ç½®JSæ–‡ä»¶åŠ è½½æ¨¡å¼: script--scriptæ ‡ç­¾æ–¹å¼ module--es6çš„importæ–¹å¼ &#125;&#125; react é¡¹ç›®â— å®‰è£… eslint-plugin-reactâ— æ ¹ç›®å½•ä¸‹çš„&quot;.eslintrc.js&quot;æ–‡ä»¶ï¼š 12345678910111213141516171819module.exports = &#123; root: true, extends: [&#x27;google&#x27;, &#x27;plugin:react/recommended&#x27;, &#x27;plugin:prettier/recommended&#x27;], env: &#123; &quot;browser&quot;: true, &quot;commonjs&quot;: true, &quot;es6&quot;: true, &quot;node&quot;: true &#125;, parser: &#x27;babel-eslint&#x27;, parserOptions: &#123; sourceType: &#x27;module&#x27; &#125;, settings:&#123; react: &#123; version: &#x27;detect&#x27; &#125; &#125;&#125; å¦‚æœä½¿ç”¨äº† babel-eslint æ— æ³•è¯†åˆ«çš„ typescript ç‰¹æ€§â—‹ eslint çš„ parser æ”¹ç”¨â€œ@typescript-eslint&#x2F;parserâ€ï¼Œå¹¶å®‰è£…â€œ@typescript-eslint&#x2F;eslint-pluginâ€æ’ä»¶ï¼š 12yarn remove babel-eslintyarn add -D @typescript-eslint/parser @typescript-eslint/eslint-plugin â—‹ â€œ.eslint.jsâ€æ–‡ä»¶ä¿®æ”¹å¦‚ä¸‹éƒ¨åˆ†ï¼š 1234&#123; plugins: [&quot;@typescript-eslint&quot;], parser: &#x27;@typescript-eslint/parser&#x27;,&#125; æ‰‹åŠ¨è¿›è¡Œä»£ç æ£€æŸ¥â—‹ å‘½ä»¤è¡Œè¿è¡Œï¼šnpm run codecheck å¼ºåˆ¶è¿›è¡Œ git æäº¤å‰çš„ä»£ç æ£€æŸ¥â–³ é¢„å¤‡çŸ¥è¯†ï¼šï¼ˆ1ï¼‰é€šè¿‡åœ¨ git hooks é‡Œé…ç½®å„ç§é¢„å¤„ç†è„šæœ¬ï¼Œæ¯”å¦‚ä»£ç æ£€æŸ¥æˆ–è€…è·‘å•å…ƒæµ‹è¯•ä¹‹ç±»çš„äº‹æƒ…ï¼Œå¦‚æœæˆ‘ä»¬çš„ä»£ç æ²¡æœ‰é€šè¿‡ä»£ç æ£€æŸ¥æˆ–è€…æµ‹è¯•ç”¨ä¾‹è¦†ç›–ç‡ä¸å¤Ÿï¼Œæˆ‘ä»¬çš„ push ç”šè‡³ commit ä¼šç›´æ¥è¢«æ‹’ç»ã€‚ï¼ˆ2ï¼‰é¢„å¤„ç†è„šæœ¬ä½äº git é¡¹ç›®ä¸‹éšè—æ–‡ä»¶å¤¹â€œ.gitâ€çš„â€œhooksâ€æ–‡ä»¶å¤¹ä¸­ã€‚â–³husky å¯ç”¨äºè‡ªåŠ¨å®Œæˆä¸Šè¿°åŠ¨ä½œï¼Œä½¿ç”¨æ–¹æ³•ï¼šï¼ˆ1ï¼‰å®‰è£… huskyã€‚ï¼ˆ2ï¼‰æ‰§è¡Œ&quot;npx husky install&quot;æ‰“å¼€ git hooks æ”¯æŒã€‚ï¼ˆ3ï¼‰ä¸ºä½¿é¡¹ç›®æ¯æ¬¡ install ä¹‹åé»˜è®¤æ‰§è¡Œï¼ˆ2ï¼‰ä¸­å‘½ä»¤ï¼Œåœ¨ package.json çš„â€œscriptsâ€œä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š 1234&quot;script&quot;: &#123; &quot;prepare&quot;: &quot;husky install&quot;, ... ...&#125; ï¼ˆ4ï¼‰å°†ä»£ç æ£€æŸ¥å‘½ä»¤æ·»åŠ ä¸º hookï¼Œæ‰§è¡Œï¼šnpx husky add .husky&#x2F;pre-commit &quot;npm run codecheck&quot;ï¼Œæ­¤å‘½ä»¤å°†åˆ›å»ºæ–‡ä»¶&quot;.husky&#x2F;pre-commit&quot;ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ã€‚ 1234#!/usr/bin/env sh. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;npm run codecheck â–³ ä»¥ä¸Šæ“ä½œä¹‹åï¼Œé¡¹ç›® commit å‰å°†è‡ªåŠ¨æ‰§è¡Œä»£ç æ£€æŸ¥è„šæœ¬ï¼Œç»“æœå°†åœ¨æ‰§è¡Œ commit çš„çª—å£ä¸­è¾“å‡ºã€‚ â–³ å¯¹ codecheck çš„æ”¹è¿›ï¼ˆ1ï¼‰å½“å‰ codecheck è„šæœ¬å¯¹æŒ‡å®šèŒƒå›´çš„ä»£ç åšå…¨é‡å¤„ç†ï¼Œå½“ä»£ç é‡å¤§æ—¶ä¼šæ‹–æ…¢é€Ÿåº¦ã€‚æ­¤æ—¶å¯ä½¿ç”¨&quot;lint-staged&quot;å°†èŒƒå›´é™å®šåœ¨å¤„äº staged çŠ¶æ€çš„æ–‡ä»¶(å³æ–‡ä»¶è¢«æ‰§è¡Œè¿‡ git add)ã€‚ï¼ˆ2ï¼‰å®‰è£… lint-stagedï¼Œå°†å¦‚ä¸‹ lint-staged çš„é…ç½®å¢åŠ åˆ° package.json æ–‡ä»¶çš„ç¬¬ä¸€çº§å­—æ®µï¼Œlint-staged ä¹Ÿæ”¯æŒå…¶ä»–é…ç½®æ–¹å¼ï¼Œå‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š 1234&quot;lint-staged&quot;: &#123; &quot;./src/!(**/node_modules)/*.&#123;ts,tsx,js,jsx,vue&#125;&quot;: &quot;eslint --fix&quot;, &quot;./src/!(**/node_modules)/*.&#123;css,scss,less&#125;&quot;: &quot;prettier --write&quot;&#125; ï¼ˆ3ï¼‰å°† husky çš„ pre-commit å†…å®¹æ”¹ä¸º: yarn lint-stagedã€‚ å¸¸è§é—®é¢˜â—‡ æŸäº›å¿…é¡»è¿èƒŒè§„åˆ™çš„åœ°æ–¹ï¼ˆå¦‚æœåŠ¡å™¨æ¥å£çš„å‚æ•°ï¼‰ï¼Œé€šè¿‡å¦‚ä¸‹ eslint ä¸“ç”¨æ³¨é‡Šå¿½ç•¥å¯¹å…¶åšè‡ªåŠ¨åŒ–æ£€æŸ¥ä¸æ ¼å¼åŒ–ï¼Œä¾‹ï¼š 12345678910axios(&#123; method: &#x27;get&#x27;, url: &#x27;oneUrl&#x27;, data: &#123; /* eslint-disable */ para_first: 1, para_second: 2 /* eslint-enable */ &#125;&#125;) â—‡ prettier å‘½ä»¤ä¸­çš„ file pattern ä¹‹å‰ä½¿ç”¨çš„æ˜¯&quot;src&#x2F;**&#x2F;*.{css,scss,less}&quot;ï¼Œå½“æŸ¥æ‰¾ä¸åˆ°ä»»ä½•æ–‡ä»¶æ—¶å€™ä¼šæŠ¥â€œNo files matching the patternâ€é”™è¯¯ï¼Œæ”¹æˆ&quot;src&#x2F;**&#x2F;*.(css,scss,less)&quot;å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ã€‚ â—‡ lint-staged é»˜è®¤ä»¥å¹¶å‘æ–¹å¼æ‰§è¡Œä»»åŠ¡ï¼Œå†…å®¹è¾ƒå¤šæ—¶å¯èƒ½å¯¼è‡´å†…å­˜ä¸è¶³è€Œè¢«å¼ºåˆ¶é€€å‡ºï¼Œæ·»åŠ  --concurrent &lt;number | false&gt; å‚æ•°ä»¥é™åˆ¶å¹¶å‘æ•°é‡æˆ–å…³é—­å¹¶å‘ã€‚ å‚è€ƒæ–‡çŒ®â—prettier å®˜æ–¹æ–‡æ¡£â—file pattern è¯­æ³•â—husky å®˜æ–¹æ–‡æ¡£â—ESLint + VSCode: How to Format Your Code Using .eslintrc"},{"title":"æµè§ˆå™¨ç»„æˆä¸JSè¿è¡Œæ—¶ç¯å¢ƒ","date":"2019-11-05T04:00:01.000Z","path":"knowledge/æµè§ˆå™¨ç»„æˆä¸JSè¿è¡Œæ—¶ç¯å¢ƒ.html","tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"https://congzhou09.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"text":"ä»æµè§ˆå™¨ç»„æˆåˆ° JS è¿è¡Œæ—¶ç¯å¢ƒâ—† æµè§ˆå™¨ç»„æˆç›¸å…³å†…å®¹æ•´ç†åˆ°äº†è¿™ç¯‡æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ä¸çº¿ç¨‹ã€‚â—† æµè§ˆå™¨å†…æ ¸å®ä¾‹ä¸­çš„ä»¥ä¸‹å‡ é¡¹å†…å®¹è¢«ç§°ä¸ºâ€œJS è¿è¡Œæ—¶ç¯å¢ƒï¼ˆJS Runtime Environmentï¼‰â€ï¼šï¼ˆ1ï¼‰JS å¼•æ“ã€‚ï¼ˆ2ï¼‰äº‹ä»¶å¾ªç¯(Event Loop)ã€‚ï¼ˆ3ï¼‰ä»»åŠ¡é˜Ÿåˆ—(Task Queue)ã€‚ï¼ˆ4ï¼‰Web&#x2F;DOM APIï¼ŒåŒ…æ‹¬å¦‚ setTimeout ç­‰å®šæ—¶å™¨å‡½æ•°ã€Ajax ç­‰ç½‘ç»œè¯·æ±‚ã€DOM æ“ä½œä¸äº‹ä»¶ç›‘å¬ï¼Œè¿™äº› API å¯¹è¿è¡Œæ—¶ç¯å¢ƒå¯è§ï¼Œå…·ä½“çš„çº¿ç¨‹çº§å®ç°ç”±æµè§ˆå™¨æä¾›ã€‚ â—† äº‹ä»¶å¾ªç¯ç›¸å…³è§„èŒƒä¸å±äº ECMA èŒƒç•´ï¼Œå®ƒä»¬çº¦å®šäºHTML Living Standardã€‚â—† JS è¿è¡Œæ—¶ç¯å¢ƒä¸¾ä¾‹ï¼šChrome å’Œ Node.js ä½¿ç”¨äº†ç›¸åŒçš„ JS å¼•æ“ V8ï¼Œä½†å…·æœ‰ä¸åŒçš„ JS è¿è¡Œæ—¶ç¯å¢ƒã€‚ JS å¼•æ“â—‹ JS å¼•æ“ä¸­é™¤äº†æ‰§è¡Œä»£ç çš„è§£é‡Šå™¨ï¼ˆInterpreterï¼‰ä¹‹å¤–ï¼Œä¸»è¦åŒ…å«ä¸Šå›¾å·¦ä¾§é»‘æ¡†ä¸­çš„ä¸¤éƒ¨åˆ†ï¼šå†…å­˜å †ï¼ˆMemory Heapï¼‰ã€è°ƒç”¨æ ˆï¼ˆCall Stackï¼‰ã€‚â—‹ V8 å¼•æ“ä¸­è¿˜ä¼šæœ‰ä¸ªå³æ—¶ç¼–è¯‘å™¨ï¼ˆJust-In-Time, JIT compilerï¼‰ä½œä¸ºè§£é‡Šå™¨çš„è¾…åŠ©ï¼Œè§£é‡Šå™¨å•çº¯æŒ‰è¡Œè§£é‡Šå’Œæ‰§è¡Œæºä»£ç ï¼ŒJIT ç¼–è¯‘å™¨åˆ™ä¼šå‘ç°å¹¶ç¼–è¯‘ä¼˜åŒ–è¢«é¢‘ç¹æ‰§è¡Œçš„ä»£ç å—ã€‚â—‹ å†…å­˜å †ç”¨äºå­˜å‚¨ä»£ç æ‰§è¡ŒæœŸé—´çš„å˜é‡å’Œå‡½æ•°ã€‚â—‹ è°ƒç”¨æ ˆç”¨äºè®°å½•ä»£ç æ‰§è¡Œä½ç½®åŠç›¸å…³çŠ¶æ€ä¿¡æ¯ï¼Œæ¯ä¸ªæ ˆå¸§å¯¹åº”ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡çš„å‰ç½®çŸ¥è¯†æ•´ç†åœ¨è¿™ç¯‡ã€‚â—‹ ä½¿ç”¨æµè§ˆå™¨å¼€å‘å·¥å…·å¤„ç†å¼‚å¸¸æŠ›å‡ºçš„æ ˆè¿½è¸ª(stack trace)æ­£æ˜¯å¼‚å¸¸å‘ç”Ÿæ—¶çš„è°ƒç”¨æ ˆçŠ¶æ€ã€‚â—‹ JS å¼•æ“æ‰§è¡Œ JS ä»£ç çš„è¿‡ç¨‹ï¼š è§£é‡Šå™¨åˆ›å»ºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡å¹¶ä½œä¸ºæ ˆå¸§æ·»åŠ åˆ°è°ƒç”¨æ ˆï¼Œç„¶ååœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒæ‰§è¡Œä»£ç ã€‚ æ‰§è¡ŒæœŸé—´å¦‚æœé‡åˆ°å‡½æ•°è°ƒç”¨æˆ– eval è¡¨è¾¾å¼å°±åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä½œä¸ºæ ˆå¸§æ·»åŠ åˆ°è°ƒç”¨æ ˆæ ˆé¡¶å¹¶åˆ‡æ¢åˆ°æ–°çš„æ ˆå¸§æ‰§è¡Œå…¶ä¸­ä»£ç ã€‚ æ‰§è¡ŒæœŸé—´å¦‚æœå†é‡åˆ°å‡½æ•°è°ƒç”¨æˆ– eval è¡¨è¾¾å¼é‡å¤æ­¥éª¤ 2ã€‚ åœ¨å½“å‰æ ˆå¸§æ‰§è¡Œå®Œä»£ç åï¼Œè§£é‡Šå™¨å°†å½“å‰æ ˆå¸§ä»è°ƒç”¨æ ˆå¼¹å‡ºå’Œé”€æ¯ï¼Œç„¶ååˆ‡æ¢åˆ°å‰ä¸€ä¸ªæ ˆå¸§ç»§ç»­æ‰§è¡Œã€‚ é‡å¤æ­¥éª¤ 2, 3, 4 ç›´åˆ°è°ƒç”¨æ ˆæ¸…ç©ºã€‚ â—‹ ä»¥ä¸‹é¢ä»£ç æ®µä¸ºä¾‹ï¼Œéšç€ä»£ç æ‰§è¡Œï¼Œè°ƒç”¨æ ˆå˜åŒ–è¿‡ç¨‹å¦‚ä¸‹å›¾ã€‚ 12345678function multiply(x, y) &#123; return x * y;&#125;function printSquare(x) &#123; var s = multiply(x, x); console.log(s);&#125;printSquare(5); â—‹ JS å¼•æ“è¿è¡Œåœ¨ Render çº¿ç¨‹ï¼Œå•çº¿ç¨‹ä¼˜åŠ¿æ˜¯ä¸éœ€è¦å¤„ç†æ­»é”ä¹‹ç±»çš„å¤šçº¿ç¨‹é—®é¢˜ï¼Œç¼ºé™·æ˜¯è€—æ—¶çš„ JS æ‰§è¡Œä¼šé˜»å¡ Render çº¿ç¨‹å¼•èµ·é¡µé¢æ›´æ–°æ¸²æŸ“ä¸äº¤äº’äº‹ä»¶å¾—ä¸åˆ°åŠæ—¶å¤„ç†ï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ç”šè‡³å¡æ­»ï¼ŒChrome æµè§ˆå™¨å½“é˜»å¡æŒç»­è¶…è¿‡ä¸€å®šæ—¶é—´ä¼šå‡ºç°å¦‚ä¸‹å¼¹çª—ã€‚ äº‹ä»¶å¾ªç¯ä¸ä»»åŠ¡é˜Ÿåˆ—â—‹ æµè§ˆå™¨å†…æ ¸ä¸­ç»´æŠ¤äº†å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼ŒRender çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆå…¶ä¸­åŒ…æ‹¬ JS å¼•æ“è¦æ‰§è¡Œçš„ä»£ç æ®µåŠ Eventã€Timerã€ç½‘ç»œè¯·æ±‚ã€æ•°æ®è®¿é—®ç­‰ JS å›è°ƒï¼‰ä¼šå…ˆè¢«å­˜å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹‹åæŒ‰ç…§ç±»å‹ä¼˜å…ˆçº§ç­‰å› ç´ åœ¨æœ€åˆé€‚çš„æ—¶æœºè¢«æ‰§è¡Œï¼Œç»´æŠ¤ä»»åŠ¡é˜Ÿåˆ—ä¸å†³å®šä»»åŠ¡æ‰§è¡Œæ—¶æœºçš„ä¸»ä½“ç§°ä¸º Event Loopã€‚â—‹ HTML Standard ä¸­å®šä¹‰äº†å¤šç§ Event Loopï¼Œæ­¤å¤„çš„ Event Loop æ˜¯å…¶ä¸­çš„â€œwindow event loopâ€(web worker ç¯å¢ƒå¯¹åº”çš„æ˜¯ worker event loop)ã€‚â—‹ æ¯ä¸ª Event Loop å¯¹åº”ä¸€ä¸ªæˆ–å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—(task queue)ä¸ä¸€ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—(microtask queue)ï¼Œä¸åŒç§ç±»ä»»åŠ¡æºçš„ä»»åŠ¡è¿›å…¥ç›¸åº”çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸åŒä»»åŠ¡æºä»»åŠ¡æœ‰ä¸åŒçš„ä¼˜å…ˆçº§æƒé‡ï¼Œå±äºåŒä¸€ä¸ªä»»åŠ¡æºçš„å¤šä¸ªä»»åŠ¡ä¸ä¼šä¹±åºæ‰§è¡Œã€‚â—‹ task åœ¨ V8 ä¸­è¢«ç§°ä¸ºå®ä»»åŠ¡(macrotask)ï¼Œè€Œ microtask åœ¨ ECMAScript ä¸­è¢«ç§°ä¸º jobã€‚â—‹ å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å¾®ä»»åŠ¡åœ¨å½“å‰è°ƒç”¨æ ˆä¸ºç©ºè€Œè¿˜æœªå°†æ§åˆ¶æƒè¿˜ç»™ Event Loop çš„æ—¶å€™è¢«æ‰§è¡Œï¼Œå¯ç”¨äºåœ¨å½“å‰ä¸€è½® Event Loop ä¹‹å†…åšä»»åŠ¡çš„æ¨è¿Ÿæ‰§è¡Œã€‚â—‹ æ‰§è¡Œå¾®ä»»åŠ¡é˜¶æ®µä¼šå°†å½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—å†…çš„æ‰€æœ‰å¾®ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œä»è€Œä¿è¯è¿™äº›å¾®ä»»åŠ¡æ‰§è¡ŒæœŸé—´æ‰€å¤„çš„ç¯å¢ƒçŠ¶æ€æ˜¯åŸºæœ¬ä¸€è‡´çš„ï¼Œæ²¡æœ‰â€œç»è¿‡äº†ä¸€æ¬¡æ›´æ–°æ¸²æŸ“â€ã€â€œå¤„ç†è¿‡å®šæ—¶å™¨å›è°ƒæˆ–äº‹ä»¶å›è°ƒâ€æˆ–â€œæ¥æ”¶åˆ°äº†ç½‘ç»œæ•°æ®æ›´æ–°â€ç­‰æ–¹é¢çš„å·®å¼‚ã€‚â—‹ å¾®ä»»åŠ¡çš„ä»»åŠ¡æºå¦‚ä¸‹ 123Promiseçš„then|catch|finallyå¤„ç†å‡½æ•°ä»¥åŠä¸å…¶ç­‰ä»·çš„awaitçš„è¿”å›å€¼å¤„ç†MutationObserverçš„å¤„ç†å‡½æ•°queueMicrotaskæ³¨å†Œçš„å‡½æ•° â—‹ å…¶ä»–æ–¹å¼å¦‚ setTimeoutã€requestIdleCallbackã€MessageChannel ç­‰æ³¨å†Œçš„å›è°ƒå‡½æ•°éƒ½å±äºå®ä»»åŠ¡ã€‚æœ‰ä¸ªä¾‹å¤–çš„ requestAnimationFrameï¼Œå®ƒçš„å›è°ƒå‡½æ•°ä¸åœ¨å®ä»»åŠ¡æˆ–å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œè€Œè¢«å­˜æ”¾åœ¨æ¸²æŸ“å¼•æ“å†…éƒ¨çš„å¸§å›è°ƒé˜Ÿåˆ—é‡Œã€‚â—‹ ç›®å‰(20210104)ä¸åŒç±»å‹ä»»åŠ¡ä¼˜å…ˆçº§ç­–ç•¥æœªåœ¨ HTML Living Standard ä¸­æŒ‡å®šï¼Œä¸åŒæµè§ˆå™¨ä¸­è¡¨ç°å¯èƒ½ä¸ä¸€è‡´ï¼Œå¦‚ä¸‹ä¾‹ MessageChannel ä¸ setTimeout åœ¨ä¸åŒæµè§ˆå™¨çš„ä¼˜å…ˆçº§å·®å¼‚å¯¼è‡´çš„è¡¨ç°ä¸ä¸€è‡´ã€‚ 12345678910111213141516171819202122232425setTimeout(function() &#123; console.log(&#x27;setTimeout1&#x27;);&#125;, 0);setTimeout(function() &#123; console.log(&#x27;setTimeout2&#x27;);&#125;, 1);var channel = new MessageChannel();channel.port1.onmessage = function(event) &#123; console.log(&#x27;postMessage&#x27; + event.data);&#125;;channel.port2.postMessage(0);channel.port2.postMessage(1);channel.port2.postMessage(2);setTimeout(function() &#123; console.log(&#x27;setTimeout3&#x27;);&#125;, 0);setTimeout(function() &#123; console.log(&#x27;setTimeout4&#x27;);&#125;, 0);setTimeout(function() &#123; console.log(&#x27;setTimeout5&#x27;);&#125;, 0);// Chromeè¾“å‡ºï¼špostMessage0 setTimeout1 setTimeout3 setTimeout4 setTimeout5 setTimeout2 postMessage1 postMessage2ï¼Œç”±äºsetTimeoutçš„æœ€å°4msèŠ‚æµé™åˆ¶æ‰€ä»¥postMessage0åœ¨setTimeout1ä¹‹å‰ï¼Œä½†ä»ä¼˜å…ˆçº§ä¸ŠsetTimeouté«˜äºMessageChannelã€‚// Firefoxè¾“å‡ºï¼špostMessage0 postMessage1 postMessage2 setTimeout1 setTimeout3 setTimeout4 setTimeout5 setTimeout2ï¼Œå¯è§Firefoxä¸­MessageChannelä¼˜å…ˆçº§é«˜äºsetTimeoutã€‚ â—‹ Event Loop ä¸æ–­æŒ‰ç…§ä»¥ä¸‹å¤„ç†æ¨¡å‹(event loop processing model)æ‰§è¡Œä»»åŠ¡ï¼š ä»æŸä¸ªï¼ˆå…·ä½“é€‰æ‹©ç­–ç•¥ç”±æµè§ˆå™¨å†³å®šï¼‰å®ä»»åŠ¡é˜Ÿåˆ—å–å‡ºæœ€è€çš„ runnable task äº¤ç»™ JS å¼•æ“æ‰§è¡Œè‡³è°ƒç”¨æ ˆä¸ºç©ºï¼ˆå…³äº runnableï¼šåŒä¸€ä¸ª Event Loop å¯ä»¥è¢«å¤šä¸ª Document å…±ç”¨ï¼ŒæŸäº› Document å¯èƒ½å½“å‰å¹¶ä¸å¤„äº active çŠ¶æ€ï¼Œä»å±äºè¿™ç§ Document çš„ä»»åŠ¡å°±ä¸æ˜¯ runnable çš„ï¼‰ã€‚ ä¸æ–­ä»å¾®ä»»åŠ¡é˜Ÿåˆ—è·å–æœ€è€çš„ microtask äº¤ç»™ JS å¼•æ“æ‰§è¡Œï¼Œç›´è‡³å¾®ä»»åŠ¡é˜Ÿåˆ—æ¸…ç©ºã€‚ å¤„ç†æ›´æ–°æ¸²æŸ“ï¼Œæµè§ˆå™¨æ”¶é›†å½“å‰ Event Loop å…³è”çš„æ‰€æœ‰ Documentï¼Œå¹¶æ’é™¤æ®å…¶â€œå½“å‰åˆ·æ–°å¸§ç‡â€è¿˜æœªåˆ°è¾¾ä¸‹ä¸€å¸§æ—¶é—´çš„ Documentï¼Œç„¶åè¿›ä¸€æ­¥æ’é™¤â€œè‚¯å®šæ²¡å¿…è¦ç”Ÿæˆæ–°çš„é¡µé¢å¸§â€çš„ Documentï¼Œç„¶åå¯¹ç­›é€‰åçš„æ¯ä¸ª Document ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹ç±»å‹ä»»åŠ¡ã€‚(1)åˆ¤æ–­ä¸æ ‡è¯† autofocus å€™é€‰å…ƒç´ (2)åˆ¤æ–­ä¸è§¦å‘ resize äº‹ä»¶(3)åˆ¤æ–­ä¸è§¦å‘ scroll äº‹ä»¶(4)åˆ¤æ–­ä¸è§¦å‘ media query ç±»äº‹ä»¶(5)åˆ¤æ–­ä¸è§¦å‘ css animation ç±»äº‹ä»¶(6)åˆ¤æ–­ä¸è§¦å‘ fullscreen ç±»äº‹ä»¶(7)æ‰§è¡Œ animation callbacks (ä¹Ÿå°±æ˜¯é€šè¿‡ requestAnimationFrame æ³¨å†Œçš„å›è°ƒå‡½æ•°)(8)æ›´æ–° intersection observations(9)æ¸²æŸ“ç”Ÿæˆæ–°çš„é¡µé¢å¸§(è¯¦ç»†è¿‡ç¨‹æ•´ç†åœ¨è¿™ç¯‡ç½‘é¡µæ¸²æŸ“è¿‡ç¨‹) å¦‚æœä»¥ä¸Šä¸‰æ­¥éƒ½æ²¡æœ‰è¦æ‰§è¡Œçš„ä»»åŠ¡åˆ™è¿›å…¥ idle é˜¶æ®µï¼Œå°†å½“å‰æ³¨å†Œäº idle é˜¶æ®µï¼ˆé€šè¿‡ requestIdleCallback æ³¨å†Œï¼‰çš„æ‰€æœ‰å›è°ƒå‡½æ•°æ·»åŠ åˆ°ä»»åŠ¡æºä¸º idle-task çš„å®ä»»åŠ¡é˜Ÿåˆ—ã€‚ JS è¿è¡Œæ—¶ç¯å¢ƒçš„åŠ¨æ€è¿è¡Œè¿‡ç¨‹â™‚ JS å¼•æ“è¿è¡Œçš„ä»£ç å‡æ¥è‡ªäºä»»åŠ¡é˜Ÿåˆ—(åŒ…æ‹¬æœ€åˆçš„ html æ–‡æ¡£ä¸­&lt;script&gt;æ ‡ç­¾å†…çš„å…¨å±€ä½œç”¨åŸŸä»£ç )ï¼Œé˜Ÿåˆ—ä¸­ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºç”± Event Loop æ§åˆ¶ã€‚â™‚ JS æ‰§è¡Œä»£ç æœŸé—´é‡åˆ°çš„äº‹ä»¶ç›‘å¬ã€Ajax è¯·æ±‚ã€å®šæ—¶å™¨ç­‰ Web&#x2F;DOM API è°ƒç”¨ç”± API å®ç°å±‚æ‰§è¡Œã€‚â™‚ Web API å®Œæˆæ—¶çš„å›è°ƒå‡½æ•°è¢«ä½œä¸ºæ–°ä»»åŠ¡æ·»åŠ åˆ°ç›¸åº”ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸ä¼šç«‹å³å½±å“å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç ï¼Œä¹Ÿæ— é¡»ç­‰å¾…ã€‚â™‚ Event Loop ä¼šåœ¨åˆé€‚æ—¶æœº( JS å¼•æ“çš„è°ƒç”¨æ ˆå½“å‰ä¸ºç©ºæ˜¯å…¶å¿…è¦æ¡ä»¶)å°†å›è°ƒå‡½æ•°ä»ä»»åŠ¡é˜Ÿåˆ—å–å‡ºå¹¶äº¤ç»™ JS å¼•æ“æ‰§è¡Œã€‚ åŒæ­¥ä¸å¼‚æ­¥ã€é˜»å¡ä¸éé˜»å¡â™€ ç»“åˆä¸Šè¿° JS è¿è¡Œæ—¶ç¯å¢ƒè¿è¡Œ JS ä»£ç çš„ä¸¤ä¸ªç‰¹æ€§ï¼šåŒæ­¥ä¸å¼‚æ­¥ã€é˜»å¡ä¸éé˜»å¡ï¼ˆ1ï¼‰åŒæ­¥å’Œé˜»å¡æŒ‡çš„æ˜¯ JS å¼•æ“æ˜¯å•çº¿ç¨‹æ‰§è¡Œä»£ç çš„å¹¶ä¸”è¿è¡Œåœ¨ Render çº¿ç¨‹ï¼Œåœ¨ JS å¼•æ“æ‰§è¡Œä»£ç è‡³å…¶è°ƒç”¨æ ˆæ¸…ç©ºä¹‹å‰ï¼Œ Render çº¿ç¨‹è´Ÿè´£çš„æ›´æ–°æ¸²æŸ“äº¤äº’äº‹ä»¶å¤„ç†ç­‰å…¶ä»–ä»»åŠ¡æ˜¯è¢«é˜»å¡çš„ã€‚ï¼ˆ2ï¼‰å¼‚æ­¥å’Œéé˜»å¡æŒ‡çš„æ˜¯ JS ä»£ç æ‰§è¡ŒæœŸé—´è°ƒç”¨çš„æµè§ˆå™¨æ‰€æä¾› Web&#x2F;DOM API ä¸åœ¨å½“å‰çº¿ç¨‹åŒæ­¥æ‰§è¡Œï¼Œè€Œæ˜¯ç»§ç»­å‘ä¸‹æ‰§è¡Œåé¢çš„ä»£ç ï¼ŒWeb&#x2F;DOM API çš„æ‰§è¡Œç»“æœæ˜¯é€šè¿‡ä¹‹åå›è°ƒå‡½æ•°å¾—åˆ°çš„ï¼ŒEvent Loop ä¸ä»»åŠ¡é˜Ÿåˆ—æ˜¯å®ç°éé˜»å¡ç‰¹æ€§çš„å…³é”®æœºåˆ¶ã€‚ çŸ¥è¯†åº”ç”¨â–  å…³äº requestAnimationFrame çš„ç†è§£Q: åœ¨å½“å‰è½® Event Loop è°ƒç”¨ requestAnimationFrame æ³¨å†Œçš„å›è°ƒå‡½æ•°æ‰§è¡Œæ—¶æœºæ˜¯åœ¨ä¸‹ä¸€è½® Event Loop ä¹‹å‰å—ï¼ŸA: ä¸ä¸€å®šï¼Œæ ¹æ®ä»¥ä¸Š Event Loop å¤„ç†æ¨¡å‹ç¬¬ 3 æ¡ï¼Œä¸‹ä¸€è½® Event Loop è¾¾åˆ°å½“å‰åˆ·æ–°å¸§ç‡çš„ä¸‹ä¸€å¸§æ—¶é—´æ‰ä¼šè¢«æ‰§è¡Œï¼Œå¦åˆ™å°±æ˜¯åœ¨ä¹‹åæ»¡è¶³æ—¶é—´æ¡ä»¶çš„é‚£ä¸€è½® Event Loop ä¸­æ‰§è¡Œã€‚Q: è°ƒç”¨ requestAnimationFrame åŠæ‰§è¡Œå…¶å›è°ƒå‡½æ•°æ‰€å¤„çš„ Event Loop ä¸­å¦‚æœæ²¡æœ‰æ–° Frame ç”Ÿæˆï¼ŒrequestAnimationFrame çš„å›è°ƒå‡½æ•°è¿˜ä¼šæ‰§è¡Œå—ï¼ŸA: ä¼šæ‰§è¡Œï¼Œæ ¹æ®ä»¥ä¸Š Event Loop å¤„ç†æ¨¡å‹ç¬¬ 3 æ¡ç¬¬(7)(9)å°æ¡ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ä¸æ›´æ–°æ¸²æŸ“æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¤„ç†é˜¶æ®µï¼Œå›è°ƒå‡½æ•°ä»ç„¶å°†åœ¨æ»¡è¶³å¸§ç‡æ—¶é—´çš„é‚£ä¸€è½® Event Loop æ‰§è¡Œï¼Œæ­¤è¡Œä¸ºä¸ MDN ä¸­å¯¹ requestAnimationFrame å‡½æ•°çš„è¯´æ˜(å‘Šè¯‰æµè§ˆå™¨æ¥ä¸‹æ¥å°†æ‰§è¡Œä¸€ä¸ªå¼•èµ·æ›´æ–°æ¸²æŸ“çš„æ“ä½œï¼Œè€Œåœ¨æ›´æ–°æ¸²æŸ“æ–°å¸§ä¹‹å‰è¦å…ˆæ‰§è¡Œæ‰€æ³¨å†Œçš„å›è°ƒå‡½æ•°)ä¸å†²çªã€‚â–  å®ç°é¡µé¢å†…å¯è§çš„æ•°å­—å¿«é€Ÿå¢é•¿ï¼Œç”±äºæ›´æ–°æ¸²æŸ“åªå¯èƒ½å‘ç”Ÿåœ¨ task æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€ä»¥å°†å¢é•¿ä½œä¸º task æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œä»£ç ç¤ºä¾‹ä¸è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š 123456789101112131415&lt;p style=&quot;will-change: contents&quot; id=&quot;counter&quot;&gt;0&lt;/p&gt;&lt;button onclick=&quot;startCount();&quot;&gt;start&lt;/button&gt;&lt;script&gt; var pElem = document.querySelector(&#x27;#counter&#x27;); function startCount() &#123; var curNum = 0; function count() &#123; pElem.innerHTML = ++curNum; if (curNum &lt; 200) &#123; setTimeout(count, 0); &#125; &#125; count(); &#125;&lt;/script&gt; 0 start var pElem = document.querySelector('#counter'); function startCount() { var curNum = 0; function count() { pElem.innerHTML = ++curNum; if (curNum < 200) { setTimeout(count, 0); } } count(); } å‚è€ƒæ–‡çŒ®â— How JavaScript Works ç³»åˆ—â— requestAnimationFrame Scheduling For Nerdsâ— Task scheduling in Blinkâ— HTML Living Standardâ— The JavaScript Call Stack - What It Is and Why It&#39;s Necessaryâ— Using microtasks in JavaScript with queueMicrotask()â— In depth: Microtasks and the JavaScript runtime environmentâ— Tasks, microtasks, queues and schedulesâ— When will requestAnimationFrame be executedâ— Understanding Event Loopâ— Is there a faster way to yield to Javascript event loop than setTimeout(0)â— Concurrency model and the event loopâ— Event loop: microtasks and macrotasks"},{"title":"React Nativeå·¥ç¨‹å¢åŠ Expoæ”¯æŒ","date":"2019-08-14T12:21:11.000Z","path":"practice/React-Nativeå·¥ç¨‹å¢åŠ Expoæ”¯æŒ.html","tags":[{"name":"React Native","slug":"React-Native","permalink":"https://congzhou09.github.io/tags/React-Native/"},{"name":"Expo","slug":"Expo","permalink":"https://congzhou09.github.io/tags/Expo/"}],"text":"è¡ŒåŠ¨å‰çš„è€ƒè™‘â—†åŸæœ‰çš„React Nativeå·¥ç¨‹æ˜¯åœ¨Windowsä¸‹å®‰è£…å®ŒAndroidå¼€å‘ç¯å¢ƒåä½¿ç”¨å‘½ä»¤&quot;react-native init&quot;ç”Ÿæˆçš„ï¼Œçœ‹åˆ°å­˜å‚¨Android SDKæ‰€éœ€çš„30G+çš„ç¡¬ç›˜å’ŒAndroidæ¨¡æ‹Ÿå™¨è¿è¡Œæ‰€éœ€çš„8G+å†…å­˜é¢„ç®—ï¼Œæƒ³åœ¨è‡ªå·±çš„ä¾¿æºæœºä¸Šæä¸€å¥—ç›¸åŒç¯å¢ƒè´Ÿæ‹…å®åœ¨å¤ªé‡ï¼› â—†çœ‹åˆ°Expoæ—¶è¢«å…¶ç®€ç»ƒçš„å¼€å‘æµç¨‹æ‰€å¸å¼•ï¼Œè€Œç¯å¢ƒè½»é‡å¤ªå¤šäº†ï¼Œä¹ŸåŒæ ·æ”¯æŒä»£ç ä¿®æ”¹ä¿å­˜åè‡ªåŠ¨åˆ·æ–°å†…å®¹ã€‚è®¾æƒ³åˆ©äºExpoèƒ½éšæ—¶éšåœ°ç”¨ä¾¿æºæœºå¼€å‘APPï¼Œåˆ°æ„å»ºå‘å¸ƒæ—¶å€™å†ä½¿ç”¨ç¬¨é‡çš„Androidç¯å¢ƒï¼Œå¾ˆç¾å¥½ï¼› â—†React Nativeä¸­æ–‡å®˜ç½‘è­¦å‘ŠExpoå¤§é‡ä¾èµ–äºå›½å¤–ç½‘ç»œç¯å¢ƒï¼Œåªç”¨äºå­¦ä¹ ã€æ¼”ç¤ºã€è¯•éªŒç­‰ï¼Œä¸å»ºè®®å›½å†…ä½¿ç”¨ã€‚æˆ‘çš„ç›®çš„å°±æ˜¯ç”¨äºå¼€å‘è¿‡ç¨‹æ–¹ä¾¿çœ‹æ•ˆæœï¼Œå®è·µåå‘ç°ä»…ä»…åœ¨å®‰è£…Expoç¯å¢ƒå’Œåˆ›å»ºå·¥ç¨‹çš„æ—¶å€™æ‰éœ€è¦å›½å¤–ç½‘ç»œç¯å¢ƒï¼› å°è¯•åŸºç¡€çš„React Nativeé¡¹ç›®æ­¥éª¤æ€»ç»“å¦‚ä¸‹ï¼šâ—†å®‰è£…Expoç¯å¢ƒï¼Œä½¿ç”¨â€œreact-native initâ€å‘½ä»¤åˆ›å»ºä¸ªæ–°çš„React Nativeå·¥ç¨‹ï¼›â—†è¿›å…¥React Nativeå·¥ç¨‹ç›®å½•ä¸‹åˆ›å»ºå¯è¿è¡Œçš„Expoçš„å·¥ç¨‹ï¼šexpo init demo ï¼›â—†è¿›å…¥demoç›®å½•ï¼Œä¸ºâ€œapp.jsonâ€æ–‡ä»¶å¢åŠ å¦‚ä¸‹packagerOptsé…ç½®å†…å®¹ï¼Œä»¥æŒ‡å®šä½¿ç”¨è‡ªå®šä¹‰çš„metroé…ç½®æ–‡ä»¶ï¼› 123456789101112&#123; &quot;expo&quot;: &#123; &quot;name&quot;: &quot;demo&quot;, &quot;slug&quot;: &quot;demo&quot;, &quot;privacy&quot;: &quot;public&quot;, &quot;sdkVersion&quot;: &quot;33.0.0&quot;, &quot;packagerOpts&quot;: &#123; &quot;projectRoots&quot;: &quot;&quot;, &quot;config&quot;: &quot;metro.config.js&quot; &#125;, ... ...&#125; â—†æ–°å»ºâ€œmetro.config.jsâ€æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ã€‚å…¶ä¸­çš„blacklistREé…ç½®äº†ä¸€ä¸ªæ­£åˆ™ï¼Œæ‰“åŒ…æ—¶ä¼šå¿½ç•¥æ‰æ­£åˆ™åŒ¹é…åˆ°çš„è·¯å¾„ã€‚å› ä¸ºåœ¨æ ¹ç›®å½•ä¸‹çš„node_modulesä¸­ä¼šå­˜åœ¨ä¸demoç›®å½•ä¸‹node_modulesä¸­ç›¸åŒçš„åº“ï¼Œä¾‹å¦‚react-native, react, prop-typesï¼Œå¦‚æœä¸å¿½ç•¥å°±ä¼šä½¿å¾—providesModuleåœ¨è§£ææ—¶äº§ç”Ÿé‡åï¼Œä»è€Œå¯¼è‡´jest-haste-mapæŠ¥é”™ã€‚ 123456789101112131415161718192021222324const path = require(&#x27;path&#x27;);const blacklist = require(&#x27;metro-config/src/defaults/blacklist&#x27;);const escapeRegexString = require(&#x27;escape-regex-string&#x27;);module.exports = &#123; resolver: &#123; blacklistRE: blacklist([ new RegExp( `^$&#123;escapeRegexString(path.resolve(__dirname, &#x27;..&#x27;, &#x27;node_modules&#x27;))&#125;\\\\/.*$`, ), ]), providesModuleNodeModules: [ &#x27;react-native&#x27;, &#x27;react&#x27; ], extraNodeModules: &#123; &#x27;@babel/runtime&#x27;: path.resolve(__dirname, &#x27;node_modules/@babel/runtime&#x27;), &#125;, &#125;, projectRoot: path.resolve(__dirname), watchFolders: [ path.resolve(__dirname, &#x27;..&#x27;), ],&#125;; â—†å®‰è£…â€œmetro.config.jsâ€æ–‡ä»¶ä¸­ç”¨åˆ°çš„escape-regex-stringï¼Œæ‰§è¡Œï¼šyarn add escape-regex-string ï¼›â—†ä¿®æ”¹App.jså°†åŸReact Nativeçš„Appä½œä¸ºç»„ä»¶å¼•å…¥ï¼Œå¦‚ä¸‹ï¼š 1234567import App from &#x27;../App&#x27;;export default function Demo() &#123; return ( &lt;App /&gt; );&#125; â—†å›åˆ°ä¸Šä¸€çº§çš„React Nativeå·¥ç¨‹ç›®å½•ï¼Œä¿®æ”¹&quot;metro.config.js&quot;æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç›®çš„æ˜¯å¿½ç•¥demoæ–‡ä»¶å¤¹ä¸‹çš„node_modulesä¸­çš„åº“ï¼› 123456789101112131415161718192021const path = require(&#x27;path&#x27;);const blacklist = require(&#x27;metro-config/src/defaults/blacklist&#x27;);const escapeRegexString = require(&#x27;escape-regex-string&#x27;);module.exports = &#123; resolver: &#123; blacklistRE: blacklist([ new RegExp( `$&#123;escapeRegexString(path.resolve(__dirname, &#x27;./demo&#x27;, &#x27;node_modules&#x27;))&#125;`, ) ]) &#125;, transformer: &#123; getTransformOptions: async () =&gt; (&#123; transform: &#123; experimentalImportSupport: false, inlineRequires: false, &#125;, &#125;), &#125;&#125;; â—†å®‰è£…â€œmetro.config.jsâ€æ–‡ä»¶ä¸­ç”¨åˆ°çš„escape-regex-stringï¼Œæ‰§è¡Œï¼šyarn add escape-regex-string ï¼›â—†ä»¥ä¸Šå³åˆ›å»ºäº†æ”¯æŒExpoçš„æœ€åŸºç¡€React Nativeé¡¹ç›®çš„å¼€å‘ç¯å¢ƒï¼Œç›´è§‚ä¸Šçš„ä¿®æ”¹æ˜¯ï¼šï¼ˆ1ï¼‰å¢åŠ äº†demoæ–‡ä»¶å¤¹ï¼›ï¼ˆ2ï¼‰å¢åŠ äº†escape-regex-stringçš„ä¾èµ–ï¼›ï¼ˆ3ï¼‰metroé…ç½®ä¸­å¢åŠ äº†å¿½ç•¥æ–‡ä»¶å¤¹ï¼›â—†é¡¹ç›®éœ€è¦å®‰è£…æ–°çš„npmä¾èµ–çš„æ­¥éª¤ï¼šï¼ˆ1ï¼‰React Nativeé¡¹ç›®ä¸­å®‰è£…ä¾èµ–ï¼›ï¼ˆ2ï¼‰Expoé¡¹ç›®ä¸­å®‰è£…ä¾èµ–ï¼›ï¼ˆ3ï¼‰Expoçš„metroé…ç½®ä¸­å¢åŠ ä¾èµ–å¯¹åº”çš„extraNodeModulesé¡¹ï¼Œå¦‚å¢åŠ â€œreact-navigationâ€åï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹æ ·å­ï¼š 1234extraNodeModules: &#123; &#x27;@babel/runtime&#x27;: path.resolve(__dirname, &#x27;node_modules/@babel/runtime&#x27;), &#x27;react-navigation&#x27;: path.resolve(__dirname, &#x27;node_modules/react-navigation&#x27;), &#125;, â—†ä¹‹åå°±å¯åœ¨demoç›®å½•ä¸‹ä½¿ç”¨expoå¼€å‘ä¸Šä¸€å±‚ç›®å½•çš„React Nativeå·¥ç¨‹äº†ï¼Œè¿è¡Œâ€œnpm startâ€å³å¯å¼€å§‹ï¼›â—†å‚è€ƒé¡¹ç›®åœ°å€ï¼ŒæŸ¥çœ‹git logå¯çœ‹åˆ°å¤§è‡´æ”¹é€ è¿‡ç¨‹ï¼› å°è¯•çœŸå®çš„React Nativeé¡¹ç›®åŸºç¡€React Nativeé¡¹ç›®å°è¯•æˆåŠŸä¹‹åå¯¹äºçœŸå®é¡¹ç›®çš„æ”¹é€ ä¹Ÿæ¯”è¾ƒæœ‰ä¿¡å¿ƒäº†ï¼ŒæŒ‰ç…§æ€»ç»“çš„æ€è·¯æ­¥éª¤å¯¹ä¸€ä¸ªçœŸå®é¡¹ç›®åšå°è¯•ï¼Œé‡åˆ°äº†å¦‚ä¸‹å‡ ä¸ªå‘ï¼šâ—‡Iconsï¼ˆ1ï¼‰React Nativeé€šå¸¸ä½¿ç”¨çš„å›¾æ ‡åº“æ˜¯â€œreact-native-vector-iconsâ€ï¼ŒExpoä½¿ç”¨çš„å›¾æ ‡åº“æ˜¯â€œ@expo&#x2F;vector-iconsâ€ï¼Œå®ƒå¯¹â€œreact-native-vector-iconsâ€å¢åŠ äº†ä¸€å±‚å…¼å®¹ä¹‹åçš„åº“ï¼Œé»˜è®¤æ˜¯åŒ…å«åœ¨Expoä¸­çš„ï¼›ï¼ˆ2ï¼‰React Nativeå¼•å…¥å›¾æ ‡çš„è¯­æ³•å¦‚ï¼šimport MaterialIcon from &quot;react-native-vector-icons&#x2F;MaterialIconsï¼Œè€ŒExpoå¼•å…¥å›¾æ ‡çš„è¯­æ³•å¦‚ï¼šimport { MaterialIcons } from &#39;@expo&#x2F;vector-icons&#39;ï¼›ï¼ˆ3ï¼‰åŸé¡¹ç›®ä¸­çš„__import MaterialIcon from &quot;react-native-vector-icons&#x2F;MaterialIcons&quot;è¯­å¥åœ¨Expoè¿è¡Œç¯å¢ƒä¸‹ä¼šè¢«è‡ªåŠ¨è§£ææˆ__import MaterialIcon from &quot;@expo&#x2F;vector-icons&#x2F;MaterialIconsï¼Œè¿™åœ¨Expoä¸­ä¼šå¼•èµ·æŠ¥é”™ï¼›ï¼ˆ4ï¼‰æŒ‰ç…§Expoå¼•å…¥å›¾æ ‡çš„è¯­æ³•ï¼Œå°†åŸé¡¹ç›®çš„__import MaterialIcon from &quot;react-native-vector-icons&#x2F;MaterialIcons&quot;__è¯­å¥æ”¹ä¸º__import {MaterialIcons} from &quot;react-native-vector-icons&quot;__æ‰èƒ½é€šè¿‡ç¼–è¯‘ï¼Œä½†è¿™æ ·å°±å½±å“äº†åŸé¡¹ç›®çš„ä»£ç å†…å®¹å’Œæ­£å¸¸ç¼–è¯‘ï¼›ï¼ˆ5ï¼‰ç›®å‰æœªå‘ç°Expoç¯å¢ƒä¸­æ§åˆ¶è‡ªåŠ¨è§£æçš„metroé…ç½®é¡¹ï¼›â—‡SplashScreenï¼ˆ1ï¼‰åŸé¡¹ç›®ä¸­ä½¿ç”¨äº†â€œreact-native-splash-screenâ€å®ç°å¯åŠ¨é¡µï¼Œè™½ç„¶ä½¿ç”¨ä¸Šä¸€æ­¥ä¸­çš„æ–¹æ³•å¼•å…¥hå’ŒæŒ‡å®šäº†â€œreact-native-splash-screenâ€ï¼Œä½†åœ¨è°ƒç”¨SplashScreenå‡½æ•°æ—¶è¿˜æ˜¯ä¼šæŠ¥å¦‚ä¸‹æ‰¾ä¸åˆ°splashåº“çš„é”™è¯¯ï¼› ï¼ˆ2ï¼‰â€œreact-native-splash-screenâ€å®˜æ–¹æ–‡æ¡£æŒ‡å‡ºåœ¨Androidå’ŒiOSç¯å¢ƒä¸‹åˆ†åˆ«éœ€è¦æ‰§è¡Œlinkå’Œå¢åŠ é…ç½®æ‰å¯æ­£å¸¸å·¥ä½œï¼Œè€Œåœ¨Expoç¯å¢ƒè¯¥å¦‚ä½•é…ç½®æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°ï¼›ï¼ˆ3ï¼‰Expoå®˜æ–¹æ–‡æ¡£æš‚æœªæ‰¾åˆ°å…³äºå¦‚ä½•link libçš„è¯´æ˜ï¼› ç»“è®ºä»¥ä¸Šï¼Œå¾—å‡ºç»“è®ºï¼šç›®å‰åœ¨ä¿æŒåŸReact Nativeä»£ç æ­£å¸¸çš„å‰æä¸‹ï¼Œä¸ºå·¥ç¨‹å¢åŠ Expoå¼€å‘æ–¹å¼æ”¯æŒçš„æƒ³æ³•æ— æ³•å®ç°ã€‚"},{"title":"Taroä½¿ç”¨ä¸å¼€å‘é’‰é’‰å°ç¨‹åº","date":"2019-08-02T07:02:50.000Z","path":"practice/Taroä½¿ç”¨ä¸å¼€å‘é’‰é’‰å°ç¨‹åº.html","tags":[{"name":"Taro","slug":"Taro","permalink":"https://congzhou09.github.io/tags/Taro/"},{"name":"å°ç¨‹åºæ¡†æ¶","slug":"å°ç¨‹åºæ¡†æ¶","permalink":"https://congzhou09.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A1%86%E6%9E%B6/"},{"name":"Eåº”ç”¨","slug":"Eåº”ç”¨","permalink":"https://congzhou09.github.io/tags/E%E5%BA%94%E7%94%A8/"},{"name":"é’‰é’‰å°ç¨‹åº","slug":"é’‰é’‰å°ç¨‹åº","permalink":"https://congzhou09.github.io/tags/%E9%92%89%E9%92%89%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"text":"é€‰æ‹©Taroå‰çš„è€ƒè™‘â– é’‰é’‰äº2019å¹´6æœˆä¸­æ—¬å‡çº§åŸâ€œEåº”ç”¨â€ä¸ºâ€œå°ç¨‹åºâ€ï¼ŒåŒæ—¶å‡çº§äº†å°ç¨‹åºå¼€å‘è€…å·¥å…·ï¼Œå¯ä»¥å…¼å®¹é˜¿é‡Œå·´å·´æ——ä¸‹æ‰‹æ·˜ã€æ”¯ä»˜å®ç­‰ä¸åŒäº§å“çš„è¿è¡Œç¯å¢ƒé’‰é’‰å°ç¨‹åºï¼› â– æ ¹æ®å®˜æ–¹è¯´æ˜ï¼ŒEåº”ç”¨å’Œæ”¯ä»˜å®å°ç¨‹åºä½¿ç”¨ç›¸åŒçš„å°ç¨‹åºé€šç”¨æ¡†æ¶ï¼Œæ”¯æŒé€šç”¨ç»„ä»¶å’ŒAPIï¼Œç„¶ååˆ†åˆ«æœ‰è‡ªå·±æ‰©å±•çš„ç»„ä»¶å’ŒAPIï¼Œå¦‚ä¸‹å›¾ï¼› â– Taroæ”¯æŒå¼€å‘æ”¯ä»˜å®å°ç¨‹åºï¼Œè¿›è€Œå¯ä»¥æ”¯æŒé’‰é’‰å°ç¨‹åºçš„å¼€å‘ï¼› Taroé€šç”¨ä½¿ç”¨æ–¹æ³•â—ç¯å¢ƒå®‰è£…ï¼šnpm install -g @tarojs&#x2F;cli ï¼› â—åˆ›å»ºé¡¹ç›®ï¼štaro init myApp ï¼› â—åŸºç¡€è¦ç‚¹ï¼šhttps://nervjs.github.io/taro/docs/tutorial.html â—ç»„ä»¶æ‰‹å†Œï¼šhttps://nervjs.github.io/taro/docs/components-desc.html â—æ·»åŠ reduxæ”¯æŒï¼š ï¼ˆ1ï¼‰å®‰è£…reduxï¼Œredux-thunk(éœ€è¦æ”¯æŒå¼‚æ­¥actionçš„è¯)ï¼› ï¼ˆ2ï¼‰å®‰è£…@tarojs&#x2F;reduxï¼Œç›¸å½“äºreacté¡¹ç›®ä¸­çš„&quot;react-redux&quot;ï¼Œå¯¹åº”çš„ç”¨æ³•å¦‚â€œimport { Provider } from &#39;@tarojs&#x2F;redux&#39;â€ï¼› å¼€å‘é’‰é’‰å°ç¨‹åºæ­¥éª¤â—†è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œæ ¹æ®è¦æ„å»ºçš„å°ç¨‹åºç±»å‹è¿è¡Œç›¸åº”çš„devæˆ–buildå‘½ä»¤ï¼Œå¦‚ï¼šnpm run dev:alipayï¼Œå°†åœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆdistç›®å½• ï¼› â—†ä½¿ç”¨é’‰é’‰å°ç¨‹åºå¼€å‘è€…å·¥å…·æ‰“å¼€distç›®å½•å°†è‡ªåŠ¨è¯†åˆ«å°ç¨‹åºç±»å‹ï¼Œå¹¶ç›‘æµ‹distç›®å½•å†…çš„å˜åŒ–è‡ªåŠ¨ç¼–è¯‘å’Œæ˜¾ç¤ºé¢„è§ˆï¼› â—†devæ¨¡å¼ä¸‹Taroä¼šç›‘æµ‹srcçš„å˜åŒ–è‡ªåŠ¨å°†ä¿®æ”¹ç¼–è¯‘åˆ°distç›®å½•ï¼› â—†é’‰é’‰åŸºç¡€è¦ç‚¹ä¸ç»„ä»¶æ‰‹å†Œï¼šhttps://open-doc.dingtalk.com/microapp/dev/framework-overview â—†å°ç¨‹åºå®˜æ–¹Demoï¼šåœ¨å°ç¨‹åºå¼€å‘è€…å·¥å…·ä¸­æ–°å»ºé¡¹ç›®ï¼Œé€‰æ‹©â€œæ¨¡æ¿é€‰å–â€åˆ›å»ºå³å¯ï¼› å¼€å‘é’‰é’‰å°ç¨‹åºè¿‡å‘è®°å½•â–¡Taro.requestä¸æ”¯æŒé’‰é’‰å°ç¨‹åºï¼Œéœ€ä½¿ç”¨é’‰é’‰æä¾›çš„&quot;dd.httpRequest&quot;å‘é€Ajaxè¯·æ±‚ï¼› â–¡é¡¹ç›®æ€»å…¥å£æ–‡ä»¶app.jsxä¸­&quot;Taro.render(, document.getElementById(&#39;app&#39;));&quot;è¯­å¥å…¶å®æ˜¯ä¸€ç›´éƒ½æ‰§è¡Œçš„ï¼Œå³ä½¿åˆ æ‰ä¹Ÿä¼šæ­£å¸¸æ¸²æŸ“å°ç¨‹åºï¼Œæ‰€ä»¥æƒ³ç¡®åˆ‡åœ°åœ¨å°ç¨‹åºæ¸²æŸ“ä¹‹å‰dosomethingæ˜¯åšä¸åˆ°çš„ï¼› â–¡ä¸è¦åœ¨é¡¹ç›®æ€»å…¥å£æ–‡ä»¶app.jsxä¸­è°ƒç”¨é’‰é’‰çš„&quot;dd.alertã€dd.showToast&quot;ç­‰äº¤äº’UIç±»APIï¼Œè¯­å¥å¹¶ä¸ç”Ÿæ•ˆï¼› â–¡&quot;é€šè®¯å½•é€‰äºº&quot;åŠŸèƒ½åœ¨PCç«¯å°ç¨‹åºå¼€å‘è€…å·¥å…·ä¸­ä¸å¯ç”¨ï¼Œåœ¨æ‰‹æœºç«¯é¢„è§ˆåŠŸèƒ½æ­£å¸¸ã€‚å…¶ä¸­çš„&quot;responseUserOnly&quot;å‚æ•°å–å€¼ä¸ºtrueæ—¶åœ¨æ‰‹æœºç«¯é€‰æ‹©éƒ¨é—¨ä¼šå¼•èµ·é’‰é’‰é—ªé€€ï¼› â–¡Taroæœªå®ç°å®Œæ•´çš„Reactè¯­æ³•ï¼ˆ1ï¼‰ä¸æ”¯æŒâ€œprops.childrenâ€ï¼Œå¯¼è‡´ä¸æ”¯æŒéœ€è¦ä¼ é€’å­å­™ç»„ä»¶çš„ç»„ä»¶å°è£…ï¼›ï¼ˆ2ï¼‰exporté€šè¿‡connectåŒ…è£…çš„ç»„ä»¶ï¼Œè¢«åŒ…è£…ç»„ä»¶å¿…é¡»åœ¨åŒä¸€ä¸ªæ–‡ä»¶å†…å®šä¹‰è€Œä¸èƒ½æ˜¯importå¼•å…¥çš„ç»„ä»¶ï¼Œå¦åˆ™æŠ¥é”™â€œæœªæ‰¾åˆ° Taro.Component çš„ç±»å®šä¹‰â€ï¼›"},{"title":"Apolloå‰ç«¯æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º","date":"2019-06-07T08:48:09.000Z","path":"handbook/Apolloå‰ç«¯æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º.html","tags":[{"name":"apollo","slug":"apollo","permalink":"https://congzhou09.github.io/tags/apollo/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://congzhou09.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"å¼€å‘ç¯å¢ƒ","slug":"å¼€å‘ç¯å¢ƒ","permalink":"https://congzhou09.github.io/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"}],"text":"åˆ†æâ—‹Apolloé¡¹ç›®ä¸­å‰ç«¯ä»£ç ä½äºâ€œApollo\\apollo-portal\\src\\main\\resources\\staticâ€ç›®å½•ä¸‹ã€‚ â—‹å‰ç«¯ä½¿ç”¨çš„æ¡†æ¶å’Œåº“æ˜¯jQuery+bootstrap+æ—©æœŸAngularJSï¼Œæ²¡æœ‰webpacké…ç½®å’Œå‰ç«¯å¼€å‘æœåŠ¡å™¨ã€‚ç„¶åå…¶ä¸­çš„APIè¯·æ±‚ä½¿ç”¨çš„éƒ½æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ²¡æœ‰ç»Ÿä¸€é…ç½®APIè¯·æ±‚å‰ç¼€çš„åœ°æ–¹ã€‚å¦å¤–å­˜åœ¨éajaxæ–¹å¼çš„APIè¯·æ±‚ï¼Œä¹Ÿå­˜åœ¨æœåŠ¡å™¨APIè¿”å›å€¼æ˜¯htmlé¡µé¢ç›¸å¯¹è·¯å¾„çš„æƒ…å†µï¼Œæ‰€ä»¥å®ƒå¹¶æœªå®ç°å®Œå…¨çš„å‰åç«¯åˆ†ç¦»ã€‚ â—‹ä¸ºå®ç°å‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œéœ€è¦å¼€å‘ç¯å¢ƒä¸‹çš„httpæœåŠ¡å™¨ï¼Œå®ƒåšä¸¤ä¸ªäº‹æƒ…ï¼šï¼ˆ1ï¼‰å‰ç«¯ä»£ç çš„httpè®¿é—®ï¼ˆ2ï¼‰ä»£ç ä¸­è®¿é—®æœåŠ¡å™¨APIç›¸å¯¹åœ°å€çš„è½¬å‘ã€‚ ç¯å¢ƒæ­å»ºâ—å¼€å‘ç¯å¢ƒhttpæœåŠ¡å™¨ä½¿ç”¨nginxå®Œæˆï¼Œnginxçš„å®‰è£…ä¸åŸºç¡€é…ç½®æ­¤å¤„ç•¥ã€‚ â—ä¸ºApolloåˆ›å»ºä¸€ä»½nginxé…ç½®ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011121314server &#123; listen 80; #æ³¨æ„ç«¯å£å ç”¨ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–ç«¯å£ expires -1; #é˜²æ­¢ç¼“å­˜ location ~* \\.(html|js|css) &#123; root &quot;H:\\\\Project_work\\\\apollo\\\\apollo-portal\\\\src\\\\main\\\\resources\\\\static&quot;; #Apolloå‰ç«¯ä»£ç è·¯å¾„ &#125; location / &#123; proxy_set_header HOST $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://172.16.1.119:8088; #è¦è¿æ¥çš„æµ‹è¯•ApolloæœåŠ¡å™¨åœ°å€ &#125;&#125; â—å¯ç”¨nginxå¹¶åº”ç”¨å¦‚ä¸Šé…ç½®ï¼Œè®¿é—®åœ°å€ http:&#x2F;&#x2F;æœ¬åœ°IP å°±å¯ä»¥å¼€å§‹Apolloå‰ç«¯çš„æœ¬åœ°è°ƒè¯•å¼€å‘äº†ã€‚"},{"title":"supersetå‰ç«¯æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º","date":"2019-05-10T11:07:51.000Z","path":"handbook/supersetå‰ç«¯æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º.html","tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://congzhou09.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"å¼€å‘ç¯å¢ƒ","slug":"å¼€å‘ç¯å¢ƒ","permalink":"https://congzhou09.github.io/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"},{"name":"superset","slug":"superset","permalink":"https://congzhou09.github.io/tags/superset/"}],"text":"é¡¹ç›®ç»“æ„superseté¡¹ç›®åŒ…å«å‰ç«¯åå°éƒ¨åˆ†ï¼Œå‰ç«¯éƒ¨åˆ†ä½äºè·¯å¾„â€œ&#x2F;superset&#x2F;assetsâ€ä¸‹ã€‚ å®‰è£…npmä¾èµ–åŒ…å‘½ä»¤è¡Œè¿›å…¥assetsç›®å½•ä¸‹ï¼Œæ‰§è¡Œnpm install(æˆ–æ›´å¿«çš„yarn install)ã€‚ ä¿®æ”¹webpacké…ç½®ä¿®æ”¹webpacké…ç½®æ–‡ä»¶â€œsuperset&#x2F;assets&#x2F;webpack.config.jsâ€ï¼Œå…¶ä¸­çš„proxyæ”¹ä¸ºè”è°ƒåå°æœåŠ¡å™¨çš„åœ°å€ï¼Œä¾‹å¦‚æœåŠ¡å™¨ipåœ°å€ä¸º172.16.2.249ï¼Œåˆ™å†™ä¸ºå¦‚ä¸‹å½¢å¼ï¼š 12345proxy: &#123; context: () =&gt; true, &#x27;/&#x27;: `http://172.16.1.119:$&#123;supersetPort&#125;`, target: `http://172.16.1.119:$&#123;supersetPort&#125;`, &#125;, å¯åŠ¨æœ¬åœ°è°ƒè¯•åœ¨assetsç›®å½•ä¸‹å‘½ä»¤è¡Œæ‰§è¡Œï¼šnpm run dev-server windowsç¯å¢ƒä¸‹webpackæ‰“åŒ…windowsä¸‹æ‰§è¡Œâ€œnpm run buildâ€æŠ¥é”™&quot;æ— æ³•è¯†åˆ«NODE_ENV&quot;ï¼Œè§£å†³åŠæ³•ï¼šå®‰è£…&quot;cross-env&quot;ä¹‹åï¼Œé‡æ–°æ‰§è¡Œâ€œnpm run buildâ€ï¼Œå³å¯æ­£å¸¸ç”Ÿæˆæ‰“åŒ…æ–‡ä»¶åœ¨distæ–‡ä»¶å¤¹ä¸­ 2020å¹´9æœˆè¡¥å……â—åæ¥å¼€å‘ä¸­å‘ç°è¿™æ ·é…ç½®ä¹‹åå‰ç«¯æ”¶åˆ°çš„ç½‘é¡µå†…å®¹ä»ç„¶æ˜¯ä»æœåŠ¡å™¨è¿”å›çš„ï¼Œæ­¤æ–¹å¼æœªè¢«ä½¿ç”¨ï¼›â—superseté¡¹ç›®æ–°ç‰ˆæœ¬å·²ç»æ˜ç¡®å‰åç«¯åˆ†ç¦»å¹¶åœ¨æ–‡æ¡£ä¸­ç»™å‡ºäº†å‰ç«¯ç‹¬ç«‹è°ƒè¯•çš„æ–¹æ³•ï¼›"},{"title":"ajaxè·å–ä¸æ“ä½œå›¾ç‰‡äºŒè¿›åˆ¶æµå¹¶æ˜¾ç¤º","date":"2019-03-21T11:48:19.000Z","path":"practice/ajaxè·å–ä¸æ“ä½œå›¾ç‰‡äºŒè¿›åˆ¶æµå¹¶æ˜¾ç¤º.html","tags":[{"name":"äºŒè¿›åˆ¶æµ","slug":"äºŒè¿›åˆ¶æµ","permalink":"https://congzhou09.github.io/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%B5%81/"},{"name":"ä½æ“ä½œ","slug":"ä½æ“ä½œ","permalink":"https://congzhou09.github.io/tags/%E4%BD%8D%E6%93%8D%E4%BD%9C/"}],"text":"åœºæ™¯ä¸ºä¿æŠ¤ç”¨æˆ·éšç§ï¼Œå›¾ç‰‡ä¸Šä¼ è‡³æœåŠ¡å™¨åæœåŠ¡å™¨åšäº†æŒ‰ä½å¼‚æˆ–å¤„ç†ï¼Œè¾¾åˆ°æ— æ³•ç›´æ¥é€šè¿‡å›¾ç‰‡é“¾æ¥æˆ–å›¾ç‰‡æ–‡ä»¶æŸ¥çœ‹ç”¨æˆ·æ‰€ä¸Šä¼ å›¾ç‰‡å†…å®¹çš„ç›®çš„ã€‚å¦‚æ­¤å°±è¦æ±‚å‰ç«¯å±•ç¤ºæ—¶å¯¹å›¾ç‰‡äºŒè¿›åˆ¶æµåšç›¸åçš„ä½æ“ä½œæ‰èƒ½å±•ç¤ºå›¾ç‰‡å†…å®¹ã€‚ å…³é”®ä»£ç ä¸æ³¨é‡Šæ­¤å¤„ç”¨åŸç”Ÿæ–¹å¼ä¹¦å†™ï¼Œå®é™…åº”ç”¨æ—¶æ ¹æ®æ‰€ä½¿ç”¨ ajax åº“çš„è¯­æ³•ä¿®æ”¹ 123456789101112131415161718192021const request = new XMLHttpRequest();//æ„é€ getæ–¹æ³•ç”¨äºå¼‚æ­¥è¯·æ±‚å›¾ç‰‡é“¾æ¥request.open(&#x27;get&#x27;, &quot;/img/encripted.jpg&quot;, true);//ä»¥arraybufferçš„ç±»å‹è§£ææœåŠ¡å™¨è¿”å›æ•°æ®request.responseType = &#x27;arraybuffer&#x27;;//å¾—åˆ°æœåŠ¡å™¨æ•°æ®åçš„å›è°ƒå‡½æ•°request.onload = function()&#123; const data = request.response; //ä½¿ç”¨DataViewéå†ä¸æ“ä½œäºŒè¿›åˆ¶æµ let bufferReader = new DataView(data); let bufferStr = &#x27;&#x27;; //ä»¥æ¯8ä½ä¸ºä¸€ç»„ï¼Œæ¯ç»„æŒ‰ç…§æ— ç¬¦å·æ•´æ•°è§£ææˆå­—ç¬¦ä¸² for(let i=0;i&lt;bufferReader.byteLength;i++) &#123; //å‡è®¾æœåŠ¡å™¨åšçš„æ˜¯æŒ‰ä½ä¸100åšå¼‚æˆ–å¤„ç†ï¼Œåˆ™æ­¤å¤„å†åšä¸€æ¬¡å¼‚æˆ–å¤„ç†å³å¯å°†æ•°æ®æ¢å¤ bufferStr += String.fromCharCode(bufferReader.getUint8(i) ^ 100); &#125; //å°†å­—ç¬¦ä¸²è½¬ä¸ºBase64ç¼–ç æ ¼å¼ï¼Œä½¿ç”¨Base64å›¾ç‰‡æ ¼å¼å±•ç¤ºå›¾ç‰‡æ•°æ®å†…å®¹ $(&#x27;#the-img&#x27;).attr(&#x27;src&#x27;, `data:image/png;base64, $&#123;window.btoa(bufferStr)&#125;`);&#125;;request.send(); å…³é”®æŠ€æœ¯ç‚¹è§£ææŒ‡å®š ajax è¯·æ±‚çš„è¿”å›æ•°æ®ç±»å‹â— ajax è¯·æ±‚çš„ responseType å‚æ•°æŒ‡å®šå°†ä»¥å“ªç§æ•°æ®ç±»å‹çš„æ•°æ®ç»“æ„è§£ææœåŠ¡å™¨è¿”å›æ•°æ®ï¼Œè¿›è€Œä½¿ç”¨æ•°æ®ç±»å‹æä¾›çš„å¯¹åº”å‡½æ•°å¯¹æ•°æ®è¿›è¡Œè¯»å–æˆ–å†™å…¥æ“ä½œï¼Œå¯å–å€¼åŠå«ä¹‰å¯å‚è€ƒMDN web doc ä¹‹ XMLHttpRequest.responseTypeã€‚ å¤„ç†äºŒè¿›åˆ¶æ•°æ®â— å¤„ç†äºŒè¿›åˆ¶æ•°æ®éœ€è¦å…ˆå°†åŸå§‹äºŒè¿›åˆ¶æ•°æ®å­˜æ”¾åœ¨ä¸€æ®µè¿ç»­çš„å†…å­˜åŒºåŸŸä¸­ï¼ŒArrayBuffer å¯¹è±¡å°±æ˜¯ç”¨æ¥æ˜ å°„ä¸€æ®µé€šç”¨çš„ã€å›ºå®šé•¿åº¦çš„å†…å­˜ç¼“å†²åŒºçš„ï¼Œé€šè¿‡ ArrayBuffer çš„ byteLength å±æ€§å¯å¾—åˆ°ç¼“å†²åŒºçš„å­—èŠ‚æ•°ï¼Œä½†å®ƒæœªæä¾›ç›´æ¥æŒ‰å­—èŠ‚æ“ä½œç¼“å†²åŒºçš„å‡½æ•°ï¼ŒæŒ‰å­—èŠ‚æ“ä½œéœ€è¦é€šè¿‡ ç±»å‹æ•°ç»„å¯¹è±¡ æˆ– DataView å¯¹è±¡ è¿›è¡Œã€‚ ä½¿ç”¨â€œç±»å‹æ•°ç»„å¯¹è±¡â€â— ç±»å‹æ•°ç»„å¯¹è±¡åŒ…å«ä»¥ä¸‹å‡ ç§ç±»å‹ ä»¥ Int8Array ä¸ºä¾‹ï¼ŒåŸºç¡€ç”¨æ³•å¦‚ä¸‹ï¼š 123456789101112//arraybufferç¼“å†²åŒºlet buffer = new ArrayBuffer(8);//ä»¥int8Arrayç±»å‹è§£æç¼“å†²åŒºï¼Œå³ä»¥æ¯8ä½ä½œä¸ºä¸€ä¸ªå•ä½ï¼Œæ¯ä¸ªå•ä½ç”¨8ä½äºŒè¿›åˆ¶æœ‰ç¬¦å·æ•´æ•°è§£ælet int8Array1 = new Int8Array(buffer);//è¾“å‡ºå­—èŠ‚é•¿åº¦8ï¼Œè¿™ä¸ªå­—èŠ‚é•¿åº¦ä¸ä¼šéšç€è§£æç±»å‹ä¸åŒè€Œå˜åŒ–console.log(int8Array2.byteLength);//ä»¥30çš„æœ‰ç¬¦å·æ•´æ•°çš„äºŒè¿›åˆ¶(å³äºŒè¿›åˆ¶åºåˆ—:00011110)å¡«å……ç¼“å†²åŒºçš„å‰8ä½int8Array1[0] = 30;//int8Array2è§£æåŒæ ·çš„ç¼“å†²åŒºlet int8Array2 = new Int8Array(buffer);// è¾“å‡º30 è¯´æ˜ç¼“å†²åŒºå·²ç»è¢«int8Array1ä¿®æ”¹console.log(int8Array2[0]); ä½¿ç”¨â€œDataView å¯¹è±¡â€â— DataView é€šè¿‡ä¸€ç³»åˆ— get å’Œ set æ–¹æ³•ï¼ˆset å’Œ get åæ¥ç±»å‹æ•°ç»„å¯¹è±¡çš„ç±»å‹åï¼Œå¦‚ setUint8ï¼‰è¯»å–æˆ–å†™å…¥ç¼“å†²åŒºã€‚åŸºç¡€ç”¨æ³•å¦‚ä¸‹ï¼š 12345678910//arraybufferç¼“å†²åŒºlet buffer = new ArrayBuffer(8);//ä»¥DataViewè§£æç¼“å†²åŒºlet bufferReader = new DataView(buffer);//è¾“å‡ºå­—èŠ‚é•¿åº¦8ï¼Œè¿™ä¸ªå­—èŠ‚é•¿åº¦ä¸ä¼šéšç€è§£æç±»å‹ä¸åŒè€Œå˜åŒ–console.log(bufferReader.byteLength);//ä»¥30çš„æœ‰ç¬¦å·æ•´æ•°çš„äºŒè¿›åˆ¶(å³äºŒè¿›åˆ¶åºåˆ—:00011110)å¡«å……ç¼“å†²åŒºçš„å‰8ä½bufferReader.setInt8(0, 30);// è¾“å‡º30 ç¼“å†²åŒºå·²ç»è¢«bufferReaderä¿®æ”¹console.log(bufferReader.getInt8(0)); å¯¹äºŒè¿›åˆ¶æ•°æ®çš„å­—ç¬¦ç¼–ç â— String çš„é™æ€æ–¹æ³•&quot;fromCharCode&quot;æ¥å—ä¸€ä¸ª Unicode å€¼å‚æ•°ï¼Œè¿”å›è¿™ä¸ª Unicode å€¼å¯¹åº”çš„å­—ç¬¦ã€‚â— Base64 æ˜¯ä¸€ç§åŸºäº 64 ä¸ªå¯æ‰“å°å­—ç¬¦è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„æ–¹æ³•ï¼Œè½¬æ¢è¿‡ç¨‹ä¸­æ¯ 6 ä½ä¸ºä¸€ç»„ï¼Œè¯¦æƒ…æ•´ç†åœ¨è¿™ç¯‡ã€‚â— WindowOrWorkerGlobalScope.btoa()ç”¨äºä» String å¯¹è±¡åˆ›å»ºä¸€ä¸ª Base64 ç¼–ç çš„ ASCII å­—ç¬¦ä¸²ï¼Œè½¬æ¢è¿‡ç¨‹ä¸­å­—ç¬¦ä¸²é‡Œçš„æ¯ä¸ªå­—ç¬¦éƒ½è¢«è§†ä¸ºä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®å­—èŠ‚ã€‚"},{"title":"Dockeréƒ¨ç½²å‰ç«¯é¡¹ç›®","date":"2019-03-01T11:25:56.000Z","path":"practice/Dockeréƒ¨ç½²å‰ç«¯é¡¹ç›®.html","tags":[{"name":"Docker","slug":"Docker","permalink":"https://congzhou09.github.io/tags/Docker/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"https://congzhou09.github.io/tags/%E5%AE%B9%E5%99%A8/"},{"name":"å‰ç«¯é¡¹ç›®","slug":"å‰ç«¯é¡¹ç›®","permalink":"https://congzhou09.github.io/tags/%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE/"},{"name":"web","slug":"web","permalink":"https://congzhou09.github.io/tags/web/"}],"text":"å¯¹äºâ€œé€šè¿‡ nginx è®¿é—®ç½‘ç«™èµ„æºæ–‡ä»¶â€å½¢å¼çš„å‰ç«¯é¡¹ç›®ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼å°†é¡¹ç›®éƒ¨ç½²åˆ° Docker å®¹å™¨ã€‚ èµ„æºæ–‡ä»¶æ‹·è´åˆ°å®¹å™¨æ–¹å¼â—Š å‡è®¾å‰ç«¯å‘å¸ƒå‹ç¼©åŒ…&quot;dist.tar.gz&quot;å†…éƒ¨ç»“æ„æ˜¯ dist æ–‡ä»¶å¤¹-&gt;index.htnl&amp;static æ–‡ä»¶å¤¹ã€‚â—Š å‘å¸ƒåŒ…åŒç›®å½•ä¸‹åˆ›å»º nginx é…ç½®æ–‡ä»¶&quot;default.conf&quot;ï¼Œä¾‹ï¼š 123456789101112131415server &#123; listen 80 default_server; location / &#123; root /usr/share/nginx/html/dist; index index.html; try_files $uri $uri/ /index.html = 404; &#125; location ~* \\.(js|css|ttf|png)$ &#123; root /usr/share/nginx/html/dist; add_header Cache-Control &quot;public, max-age=31536000, immutable&quot;; add_header Vary Accept-Encoding; &#125;&#125; â—Š å‘å¸ƒåŒ…åŒç›®å½•ä¸‹åˆ›å»º Dockerfileï¼Œå†…å®¹ç¤ºä¾‹å¦‚ä¸‹ï¼Œå…¶ä¸­çš„ dist.tar.gz æ–‡ä»¶ Docker ä¼šè‡ªåŠ¨åšè§£å‹ï¼Œå¦‚æœæ˜¯æ–‡ä»¶å¤¹ distï¼Œæ³¨æ„ Docker å°†åªæ‹·è´ dist æ–‡ä»¶å¤¹å†…éƒ¨çš„å†…å®¹ã€‚ 12345FROM nginx:latestLABEL maintainer &quot;Congzhou&quot;ADD dist.tar.gz /usr/share/nginx/htmlADD default.conf /etc/nginx/conf.dEXPOSE 80 â—Š æ„å»ºé•œåƒï¼šdocker build -t imageName . ã€‚â—Š è¿è¡Œæµ‹è¯•é•œåƒï¼šdocker run -p 4000:80 imageName --name containerName ;â—Š æµè§ˆå™¨è®¿é—® ip:4000; æœ¬åœ°ç›®å½•æŒ‚è½½åˆ°å®¹å™¨æ–¹å¼â— è¿è¡Œæµ‹è¯•é•œåƒï¼šdocker run -p 4000:80 -v &#x2F;home&#x2F;docker_congzhou&#x2F;my_project&#x2F;nginx_conf:&#x2F;etc&#x2F;nginx&#x2F;conf.d -v &#x2F;home&#x2F;docker_congzhou&#x2F;my_project&#x2F;nginx_file:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html nginx --name containerName ;â— æµè§ˆå™¨è®¿é—® ip:4000;â— é€šè¿‡ docker çš„å·(volume)æœºåˆ¶å®ç°å°†å®¿ä¸»æœºä¸Šçš„æœ¬åœ°ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ï¼Œè¿™æ ·æ‰€åšçš„ä¿®æ”¹ä¸ä¼šéšç€å®¹å™¨é‡å¯è€Œä¸¢å¤±ï¼Œä¸”åœ¨å®¿ä¸»æœºå¯¹åº”çš„ Volume æŒ‚è½½ç›®å½•ä¸‹åšä¿®æ”¹å°†åœ¨å®¹å™¨ä¸­ç”Ÿæ•ˆã€‚ ä½¿ç”¨æ•°æ®å®¹å™¨çš„æ–¹å¼â—† åˆ›å»ºåŒ…å«æŒ‡å®šç›®å½•æŒ‚è½½çš„æ•°æ®å®¹å™¨ 1docker create -v /home/docker_congzhou/my_project/nginx_conf:/etc/nginx/conf.d -v /home/docker_congzhou/my_project/nginx_file:/usr/share/nginx/html --name project_data nginx â—† docker run --rm -p 80:80 --volumes-from project_data nginx ä¸‰ç§æ–¹å¼æ¯”è¾ƒâ—‡ èµ„æºæ–‡ä»¶æ‹·è´åˆ°å®¹å™¨æ–¹å¼ ç¼ºç‚¹ï¼ˆ1ï¼‰è¿è¡Œå¤šä¸ª container æ—¶æ¯ä¸ª container å†…éƒ½æœ‰ä¸€ä»½èµ„æºã€‚ï¼ˆ2ï¼‰ç”±äº docker å®¹å™¨æ¯æ¬¡é‡å¯éƒ½æ˜¯ä¸€ä¸ªæ–°çš„ç¯å¢ƒï¼Œåœ¨ docker å®¹å™¨å†…åšçš„ä¿®æ”¹å°†è¢«è¿˜åŸï¼Œå½“éœ€è¦ä¿®æ”¹ nginx é…ç½®æ–‡ä»¶æˆ–é™æ€èµ„æºæ—¶éœ€è¦é‡æ–°æ„å»ºé•œåƒã€‚ ä¼˜ç‚¹ï¼ˆ1ï¼‰é€šè¿‡å‘½ä»¤è¡Œè‡ªåŠ¨åŒ–æ“ä½œï¼Œåˆ©äºé›†æˆåˆ° CI&#x2F;CD æµç¨‹ï¼Œæ›´æ–¹ä¾¿åœ°å®Œæˆæ»šåŠ¨æ›´æ–°ã€æœåŠ¡å™¨è¿ç§»ã€å›æ»šç­‰æ“ä½œã€‚ â—‡ æœ¬åœ°ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å’Œä½¿ç”¨æ•°æ®å®¹å™¨çš„æ–¹å¼ä¼˜ç¼ºç‚¹ä¸ä»¥ä¸Šç›¸åã€‚"},{"title":"Dockerå¸¸ç”¨å‘½ä»¤","date":"2019-02-02T02:05:12.000Z","path":"handbook/Dockerå¸¸ç”¨å‘½ä»¤.html","tags":[{"name":"Docker","slug":"Docker","permalink":"https://congzhou09.github.io/tags/Docker/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"https://congzhou09.github.io/tags/%E5%AE%B9%E5%99%A8/"}],"text":"â— æŸ¥çœ‹ docker ç‰ˆæœ¬ï¼šdocker --versionâ— æŸ¥çœ‹ docker è¯¦ç»†çŠ¶æ€ï¼šdocker infoâ— æŸ¥çœ‹æœ¬åœ° imageï¼ˆ1ï¼‰æŸ¥çœ‹å¯ç”¨çš„ï¼šdocker image lsï¼ˆ2ï¼‰æŸ¥çœ‹æ‰€æœ‰çš„ï¼šdocker image ls -aâ— è¿è¡Œ imageï¼šdocker run options imageNameï¼ˆ1ï¼‰å…¶ä¸­çš„ options å¯å–å€¼å¦‚ä¸‹ 123456â—‡ åå°è¿è¡Œï¼ˆdetached modeï¼‰ï¼Œæ·»åŠ â€œ-dâ€å‚æ•°ï¼Œå°†è¿”å›å®¹å™¨IDã€‚â—‡ é€šè¿‡â€œ-pâ€å‚æ•°å®ç°ç«¯å£æ˜ å°„ï¼Œä¾‹ï¼šâ€œ-p 4000:80â€å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„4000ç«¯å£ï¼Œçœç•¥å‚æ•°é»˜è®¤å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºéšæœºç«¯å£ã€‚â—‡ -i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ã€‚â—‡ -t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ã€‚â—‡ --nameï¼š ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåå­—ã€‚â—‡ --rmï¼šå®¹å™¨é€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤å®¹å™¨åŠå…¶æ–‡ä»¶ç³»ç»Ÿï¼Œæ³¨æ„ä¸èƒ½ä¸-dåŒæ—¶ä½¿ç”¨ï¼Œå³åªèƒ½è‡ªåŠ¨æ¸…ç†foregroundå®¹å™¨ï¼Œæ³¨æ„ï¼šå¦‚æœDockerfileä¸­åŒ…å«VOLUMEè¯­å¥åˆ™ä¸€å®šè¦å¸¦ä¸Šæ­¤å‚æ•°ã€‚ â— è¿›å…¥ container ç¯å¢ƒ 1sudo docker exec -it containerID /bin/bash â— é€€å‡º container ç¯å¢ƒï¼šæŒ‰&quot;ctrl+q&quot;å¿«æ·é”®ã€‚â— åˆ é™¤ imageï¼ˆ1ï¼‰åˆ é™¤æŸä¸ªï¼šdocker image rm imageIDï¼ˆ2ï¼‰åˆ é™¤æœ¬æœºæ‰€æœ‰ imageï¼šdocker image rm $(docker image ls -a -q)ï¼ˆ3ï¼‰åˆ é™¤æœªè¢«ä½¿ç”¨çš„ imageï¼ˆdangling imageï¼‰ï¼šdocker image pruneâ— æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„ container å®ä¾‹åŠçŠ¶æ€ï¼šï¼ˆ1ï¼‰docker container ls æˆ– docker psã€‚ï¼ˆ2ï¼‰åŒæ—¶åˆ—ä¸¾æœªåœ¨è¿è¡Œçš„å®ä¾‹åˆ™å¢åŠ &quot;--all&quot;(å¯ç®€å†™ä¸ºâ€œ-aâ€)å‚æ•°ã€‚ï¼ˆ3ï¼‰æ·»åŠ â€œ-qâ€å‚æ•°åˆ™åªåˆ—å‡º container çš„ IDã€‚â— ä¼˜é›…åœ°ç»“æŸæ­£åœ¨è¿è¡Œçš„ imageï¼šdocker conatiner stop ContainerName_or_ContainerIDâ— å¼ºåˆ¶ç»“æŸæ­£åœ¨è¿è¡Œçš„ imageï¼šdocker conatiner kill ContainerName_or_ContainerIDâ— åˆ é™¤å®¹å™¨ï¼šï¼ˆ1ï¼‰åˆ é™¤æŸä¸ªï¼šdocker container rm ContainerName_or_ContainerIDï¼ˆ2ï¼‰åˆ é™¤æœ¬æœºæ‰€æœ‰å®¹å™¨ï¼šdocker container rm $(docker container ls -a -q)ï¼ˆ3ï¼‰åˆ é™¤æœ¬æœºæ‰€æœ‰æœªè¿è¡Œçš„å®¹å™¨ï¼šdocker container pruneâ— ç»„å»º swarmï¼ˆ1ï¼‰ä¸ºå½“å‰æœºå™¨å¼€å¯ swarm æ¨¡å¼å°†å…¶è®¾ç½®ä¸º swarm managerï¼šdocker swarm initï¼ˆ2ï¼‰å°†å…¶ä»–æœºå™¨åŠ å…¥ swarmdocker swarm joinâ— è¿›å…¥å®¹å™¨çš„ bash å‘½ä»¤è¡Œï¼šdocker exec -it containerName_or_conatinerID bashâ— æŸ¥çœ‹æ‰€æœ‰ service çš„çŠ¶æ€ï¼ˆ1ï¼‰docker service ls ï¼Œè¾“å‡ºç¤ºä¾‹å¦‚ä¸‹ ï¼ˆ2ï¼‰docker stack services stackName ï¼Œè¾“å‡ºä¸ stackname å…³è”çš„æ‰€æœ‰ service çš„çŠ¶æ€ã€‚â— æŸ¥çœ‹ service ä¸­çš„æ‰€æœ‰ taskï¼šdocker service ps serviceName ã€‚â— æŸ¥çœ‹ task ä¸­çš„æ‰€æœ‰ taskï¼šdocker stack ps stackName ã€‚â— åœæ­¢åº”ç”¨(stack)ï¼šdocker stack rm stackName ã€‚"},{"title":"DockerçŸ¥è¯†æ•´ç†","date":"2018-12-21T03:18:08.000Z","path":"knowledge/DockerçŸ¥è¯†æ•´ç†.html","tags":[{"name":"Docker","slug":"Docker","permalink":"https://congzhou09.github.io/tags/Docker/"},{"name":"å®¹å™¨","slug":"å®¹å™¨","permalink":"https://congzhou09.github.io/tags/%E5%AE%B9%E5%99%A8/"},{"name":"è™šæ‹ŸåŒ–","slug":"è™šæ‹ŸåŒ–","permalink":"https://congzhou09.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"}],"text":"é€šè¯†â—‹ å®¹å™¨ä¸è™šæ‹Ÿæœºçš„åŒºåˆ«ï¼ˆ1ï¼‰è™šæ‹Ÿæœºåœ¨ Hypervisior ä¹‹ä¸Šè™šæ‹Ÿå‡ºä¸€å¥—å®Œæ•´æ“ä½œç³»ç»Ÿï¼Œæä¾›çš„èµ„æºé€šå¸¸è¶…è¿‡å¤§éƒ¨åˆ†åº”ç”¨æ‰€éœ€ã€‚ï¼ˆ2ï¼‰å®¹å™¨åœ¨ Docker Engine ä¹‹ä¸Šä»…è™šæ‹Ÿå‡ºä¸€ä¸ªåº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„åŸºç¡€æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒä»¥ç‹¬ç«‹åŸç”Ÿè¿›ç¨‹çš„æ–¹å¼è¿è¡Œåœ¨ Linuxï¼Œæœ‰è‡ªå·±éš”ç¦»çš„è¿è¡Œç¯å¢ƒï¼Œä½†åˆä¸å…¶ä»–è¿›ç¨‹å’Œå®¹å™¨å…±äº«ä¸»æœºå†…æ ¸ï¼Œé™¤äº†è¿è¡Œåº”ç”¨ç¨‹åºä¹‹å¤–åŸºæœ¬ä¸æ¶ˆè€—é¢å¤–çš„ç³»ç»Ÿèµ„æºï¼Œæ¯”è™šæ‹Ÿæœºæ–¹å¼æ›´è½»é‡ã€‚ â—‹ Docker CEï¼Œå³ Docker Community Editionï¼Œç”¨äºå¼€å‘äººå‘˜å’Œå°å›¢é˜Ÿç†Ÿæ‚‰ Docker å’Œè¯•éªŒåŸºäºå®¹å™¨çš„ appã€‚â—‹Docker EEï¼Œå³ Docker Enterprise Editionï¼Œé¢å‘ä¼ä¸šçº§å…³é”®åº”ç”¨ã€‚â—‹EE æ˜¯ CE çš„è¶…é›†ï¼Œä»£ç ä»“åº“å±‚é¢ï¼ŒCE ä½äº EE çš„ä¸Šæ¸¸ï¼ŒCE åœ¨å‘å¸ƒåæä¾› 7 ä¸ªæœˆæ”¯æŒï¼ŒEE æä¾› 24 ä¸ªæœˆã€‚â—‹ ä¸‰ç§ç±»å‹çš„ release åŒ…ï¼šstable(ç¨³å®šç‰ˆï¼Œç‰ˆæœ¬å·å¦‚ stable-18.09)ã€test(ç¨³å®šç‰ˆå‘å¸ƒå‰çš„æµ‹è¯•ç‰ˆï¼Œç‰ˆæœ¬å·å¦‚ test-18.09)ã€nightly(åˆå edge ç‰ˆï¼Œæ˜¯å½“å‰æœ€æ–°ç‰ˆï¼Œç‰ˆæœ¬å·å¦‚ 0.0.0-20180720214833-f61e0f7)ï¼Œæ¯æ¬¡ç¨³å®šç‰ˆåŒæ—¶å‘å¸ƒ CE å’Œ EEã€‚â—‹Docker æ˜¯ä¸ªç”¨äºé€šè¿‡å®¹å™¨æŠ€æœ¯å¼€å‘ã€éƒ¨ç½²å’Œè¿è¡Œåº”ç”¨çš„å¹³å°ï¼ŒLinux ä¸­çš„å®¹å™¨æ˜¯ä¹‹å‰å·²æœ‰çš„æ¦‚å¿µï¼Œä½¿ç”¨å®¹å™¨éƒ¨ç½²åº”ç”¨æ˜¯æ–°çš„ä¸œè¥¿ï¼Œä½¿ç”¨ Linux çš„å®¹å™¨éƒ¨ç½²åº”ç”¨ç§°ä¸ºâ€œå®¹å™¨åŒ–â€ã€‚â—‹ å®¹å™¨åŒ–ä¼˜ç‚¹ï¼šï¼ˆ1ï¼‰å®¹å™¨æ˜¯äº’ç›¸éš”ç¦»çš„è¿›ç¨‹ï¼Œç›´æ¥è¿è¡Œåœ¨ Linux ä¹‹ä¸Šï¼Œå¹¶ä¸æ¯”æ™®é€šè¿›ç¨‹å ç”¨æ›´å¤šå†…å­˜ï¼Œæ˜¯è½»é‡çš„ï¼Œå¤šä¸ªå®¹å™¨å¯å…±äº«ä¸»æœºèµ„æºã€‚ï¼ˆ2ï¼‰æ”¯æŒçƒ­æ›´æ–°éƒ¨ç½²ã€‚ï¼ˆ3ï¼‰æ ¹æ®éœ€è¦çµæ´»å¢å‡å®¹å™¨çš„æ•°é‡ã€‚â—‹ é•œåƒ(image)æ˜¯åŒ…å«è¿è¡Œä¸€ä¸ªåº”ç”¨çš„æ‰€æœ‰å¿…éœ€å†…å®¹(åŒ…æ‹¬åº“ã€ç¯å¢ƒã€é…ç½®æ–‡ä»¶)çš„ packageã€‚â—‹ é•œåƒé€šè¿‡ Dockerfile æ¥å®šä¹‰ã€‚â—‹ å®¹å™¨(container)æ˜¯é•œåƒçš„è¿è¡Œå®ä¾‹ï¼Œé€šè¿‡å‘½ä»¤â€œdocker psâ€æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚â—‹Docker æ¨¡å¼è¿è¡Œçš„åº”ç”¨åœ¨æ¶æ„ä¸Šè‡ªåº•å‘ä¸ŠåŒ…å«ä¸‰å±‚ï¼šSwarm(éå¿…é¡»)ã€Containerã€Servicesã€Stackï¼ˆ1ï¼‰è¿è¡Œ Docker åº”ç”¨çš„ä¸»æœºé›†ç¾¤(cluster)ç§°ä¸ºâ€œswarmâ€ï¼Œé€šè¿‡åœ¨æœºå™¨ä¸Šè¿è¡Œ Docker å¹¶(å¯ä»¥æ˜¯ç‰©ç†æœºæˆ–è™šæ‹Ÿæœº)åŠ å…¥ swarmï¼Œä¸€ä¸ª docker åº”ç”¨å¯éƒ¨ç½²åœ¨ swarm é›†ç¾¤ä¸Šï¼Œè¿è¡Œäºå¤šå°æœºå™¨ã€‚swarm ä¸­çš„ä¸€å°æœºå™¨ç§°ä¸ºä¸€ä¸ªèŠ‚ç‚¹(node)ã€‚ï¼ˆ2ï¼‰swarm é›†ç¾¤ä¸­æœ‰ä¸€å°æœºå™¨ä½œä¸º swarm managerï¼Œåœ¨ swarm manager æ‰§è¡Œè¿è¡Œäº swarm ä¸Šçš„ docker å‘½ä»¤æˆ–æˆæƒå…¶ä»–æœºå™¨ä½œä¸º worker åŠ å…¥å½“å‰ swarmã€‚ï¼ˆ3ï¼‰container æ˜¯ä¸€ä¸ªè¿è¡Œçš„ imageã€‚ï¼ˆ4ï¼‰åˆ†å¸ƒå¼åº”ç”¨çš„ä¸åŒç»„æˆéƒ¨åˆ†ç§°ä¸º serviceï¼ŒDocker æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ª service åŒ…å«è¿è¡Œè‡ªåŒä¸€ä¸ª image çš„ä¸€ä¸ªæˆ–å¤šä¸ª containerï¼Œservice åŒæ—¶å®šä¹‰äº†å¦‚ä½•ç¼–æ’è¿™äº› container ä»¥å®ç° service çš„æ•´ä½“è¡Œä¸ºè¡¨ç°ï¼Œservice å†…æ¯ä¸ª container ç§°ä¸º taskã€‚ï¼ˆ5ï¼‰stack ç”¨äºå®šä¹‰å¤šä¸ª service çš„è¡Œä¸ºã€‚ï¼ˆ6ï¼‰service é€šè¿‡ compose æ–‡ä»¶ç¼–æ’ container çš„è¡Œä¸ºï¼Œè€ŒåŒä¸€ä¸ª compose æ–‡ä»¶ä¸­å¯ä»¥é…ç½®å¤šä¸ª serviceï¼Œè¿™å‡ ä¸ª service ç»„æˆä¸€ä¸ª stackï¼Œè¿™ä¸ª compose æ–‡ä»¶ä¹Ÿå°±æˆäº†ç¼–æ’ stack è¡Œä¸ºçš„æ–‡ä»¶ã€‚â—‹ ä¸€ä¸ª Docker åº”ç”¨è¿è¡Œæ‰€éœ€ç¯å¢ƒæ— é¡»å®‰è£…åˆ°å®¿ä¸»ç³»ç»Ÿï¼Œåªéœ€è¦å¼•å…¥æ‰€éœ€ç¯å¢ƒçš„é•œåƒã€‚â—‹repository å’Œ registryï¼ˆ1ï¼‰repositoryï¼šæ˜¯é•œåƒçš„é›†åˆï¼Œç±»ä¼¼é¡¹ç›®ä»£ç å·²ç»è¢«ç¼–è¯‘å¥½çš„ GitHub é¡¹ç›®ã€‚ï¼ˆ2ï¼‰registryï¼šæ˜¯ repository çš„é›†åˆã€‚registry ä¸Šçš„æ¯ä¸ªè´¦å·å¯ä»¥åˆ›å»ºå¤šä¸ª repositoryï¼Œdocker å‘½ä»¤è¡Œé»˜è®¤ä½¿ç”¨ public registryï¼ˆ3ï¼‰DTR(Docker Trusted Registry)ï¼šæ˜¯æ”¯æŒå®‰è£…åœ¨é˜²ç«å¢™ä¹‹åçš„ä¼ä¸šçº§ registryï¼Œå¯ä»¥ä½œä¸ºæŒç»­é›†æˆçš„ä¸€éƒ¨åˆ†ï¼Œæä¾› web è®¿é—®çš„æ–¹å¼ç®¡ç†é•œåƒã€‚ Dockerfileâ—Dockfile æ˜¯ä¸€ç§è¢« Docker ç¨‹åºè§£é‡Šçš„è„šæœ¬ï¼ŒDockerfile ç”±ä¸€æ¡ä¸€æ¡çš„æŒ‡ä»¤ç»„æˆï¼Œæ¯æ¡æŒ‡ä»¤å¯¹åº” Linux ä¸‹é¢çš„ä¸€æ¡å‘½ä»¤ã€‚â—Dockerfile æœ‰è‡ªå·±ä¹¦å†™æ ¼å¼å’Œæ”¯æŒçš„å‘½ä»¤ï¼ŒDocker ç¨‹åºè§£å†³è¿™äº›å‘½ä»¤é—´çš„ä¾èµ–å…³ç³»ï¼Œç±»ä¼¼äº Makefileï¼Œæ ¹æ®æŒ‡ä»¤ç”Ÿæˆå®šåˆ¶çš„ imageã€‚â— æŒ‡ä»¤å¿½ç•¥å¤§å°å†™ï¼Œå»ºè®®ä½¿ç”¨å¤§å†™ã€‚æ¯ä¸€è¡Œåªæ”¯æŒä¸€æ¡æŒ‡ä»¤ï¼Œæ¯æ¡æŒ‡ä»¤å¯ä»¥æºå¸¦å¤šä¸ªå‚æ•°ã€‚â— æŒ‡ä»¤åˆ†ä¸ºä¸¤ç§ï¼šæ„å»ºæŒ‡ä»¤å’Œè®¾ç½®æŒ‡ä»¤ã€‚â—æ„å»ºæŒ‡ä»¤ç”¨äºæ„å»ºé•œåƒï¼Œå…¶æŒ‡å®šçš„æ“ä½œä¸ä¼šåœ¨å®¹å™¨ä¸Šæ‰§è¡Œã€‚ï¼ˆ1ï¼‰ADD ä¸ COPY ç”¨äºæŠŠæ–‡ä»¶æ‹·è´åˆ°å®¹å™¨ï¼ŒåŒºåˆ«æ˜¯ï¼šADD æŒ‡ä»¤åŒ…å«ç±»ä¼¼ tar çš„è§£å‹åŠŸèƒ½ï¼Œè€Œ COPY åªæ˜¯å•çº¯å¤åˆ¶æ–‡ä»¶ã€‚â—è®¾ç½®æŒ‡ä»¤ç”¨äºè®¾ç½® image çš„å±æ€§ï¼Œå…¶æŒ‡å®šçš„æ“ä½œå°†åœ¨å®¹å™¨ä¸Šæ‰§è¡Œã€‚â— å®ä¾‹ï¼š 12345678# FROM æŒ‡ä»¤ç”¨äºæŒ‡å®šåŸºç¡€é•œåƒFROM nginx:latest# LABEL æŒ‡ä»¤ä¸ºæ„å»ºçš„é•œåƒè®¾ç½®ä½œè€…ä¿¡æ¯LABEL maintainer &quot;Congzhou&quot;VOLUME [&quot;/home/docker_congzhou/my_project/agt_jinzhong/nginx_conf&quot;,&quot;/etc/nginx/conf.d&quot;]VOLUME [&quot;/home/docker_congzhou/my_project/agt_jinzhong/nginx_file/&quot;,&quot;/usr/share/nginx/html&quot;]# EXPOSE æŒ‡ä»¤å£°æ˜è¿è¡Œæ—¶å®¹å™¨æä¾›çš„æœåŠ¡ç«¯å£ã€‚EXPOSE 80 Volumeâ—‹Docker çš„æ–‡ä»¶ç³»ç»Ÿç§°ä¸º Union File System(è”åˆæ–‡ä»¶ç³»ç»Ÿ)ï¼Œè‡ªåº•å‘ä¸ŠåŒ…æ‹¬åªè¯»å±‚å’Œè¯»å†™å±‚ï¼Œå½“åœ¨è¿è¡Œä¸­çš„å®¹å™¨ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šå°†æ–‡ä»¶ä»åªè¯»å±‚å¤åˆ¶è¯»å†™å±‚ï¼Œåªè¯»å±‚çš„æ–‡ä»¶ä»ç„¶å­˜åœ¨ä¸”æ˜¯æœªä¿®æ”¹çŠ¶æ€ã€‚â—‹ é»˜è®¤æƒ…å†µä¸‹å®¹å™¨å†…çš„æ•°æ®åªå­˜åœ¨äºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œéšç€å®¹å™¨çš„åˆ é™¤è€Œåˆ é™¤ã€‚â—‹Volume çš„ç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿä¿å­˜ï¼ˆæŒä¹…åŒ–ï¼‰æ•°æ®ä»¥åŠå…±äº«å®¹å™¨é—´çš„æ•°æ®ï¼Œä»è€Œåˆ é™¤å®¹å™¨æ—¶ä¸ä¼šè‡ªåŠ¨åˆ é™¤å®¹å™¨å¯¹åº”çš„ volume æ•°æ®ã€‚â—‹Volume æ˜¯ç»•è¿‡é»˜è®¤è”åˆæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•æˆ–è€…æ–‡ä»¶ï¼Œä»¥æ­£å¸¸çš„æ–‡ä»¶æˆ–è€…ç›®å½•çš„å½¢å¼å­˜åœ¨äºå®¿ä¸»æœºä¸Šï¼Œå®¿ä¸»æœºå’Œå®¹å™¨è®¿é—®çš„æ˜¯åŒä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå®¿ä¸»æˆ–å®¹å™¨å†…åšçš„ä¿®æ”¹ä¹Ÿå°†åœ¨å¯¹é¢ç”Ÿæ•ˆã€‚â—‹ è®¾ç½® Volume æœ‰ä¸¤ç§æ–¹å¼ï¼šï¼ˆ1ï¼‰è¿è¡Œæ—¶ä½¿ç”¨&quot;-v&quot;å‚æ•°ï¼ˆ2ï¼‰åœ¨ Dockerfile ä¸­é€šè¿‡ä½¿ç”¨ VOLUME æŒ‡ä»¤ã€‚â—‹ è¿è¡Œæ—¶ä½¿ç”¨-v å‚æ•°ï¼ˆ1ï¼‰å°† docker æŸç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºï¼Œä¾‹ï¼š 123docker run -p 80:80 -v /data nginx:latest #å°†å®¹å™¨çš„&quot;/data&quot;ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºæŸç›®å½•(å…·ä½“ç›®å½•ç”±dockeråˆ†é…)#å…·ä½“å®¿ä¸»æœºç›®å½•ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼Œè¾“å‡ºç»“æœä¸­çš„Mounts-&gt;Sourceå’ŒMounts-&gt;Destinationåˆ—ä¸¾äº†ç›®å½•æ˜ å°„å…³ç³»docker inspect containerName #å¯è§å…¶ä¸­å°†å®¹å™¨çš„â€œ/dataâ€ç›®å½•æŒ‚è½½ä»£ç†å®¿ä¸»æœºâ€œ/var/lib/docker/volumes/4e..../_dataâ€ç›®å½• ï¼ˆ2ï¼‰å°† docker æŸç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºçš„æŒ‡å®šæŸç›®å½•ï¼Œä¾‹ï¼š 1docker run -p 80:80 -v /home/docker_data:/data nginx:latest #å°†å®¿ä¸»æœºçš„&quot;/home/docker_data&quot;ç›®å½•æŒ‚è½½åˆ°dockerçš„&quot;/data&quot;ç›®å½• â—‹Dockerfile ä¸­ä½¿ç”¨ VOLUME æŒ‡ä»¤ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼Œæ­¤æ–¹å¼ä¸æ”¯æŒå°† docker ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºçš„æŒ‡å®šç›®å½•ã€‚è¿™ç§æ–¹å¼ä¸æ¨èï¼Œå®¹æ˜“å¯åŠ¨ image æ—¶å¿˜è®°æ·»åŠ &quot;-rm&quot;å‚æ•°å¯¼è‡´ container é€€å‡ºååœ¨å®¿ä¸»æœºä¸Šå¯¹åº”çš„ volume ç›®å½•æœªåšé”€æ¯å¤„ç†ï¼Œè¿›è€Œéšç€å¤šæ¬¡å¯åŠ¨äº§ç”Ÿå¤§é‡åƒåœ¾æ–‡ä»¶ã€‚ 12FROM nginx:latestVOLUME /data â—‹ æŸ¥çœ‹æ‰€æœ‰çš„ volumeï¼š docker volume lsâ—‹ æ‰¹é‡åˆ é™¤å­¤å• volumeï¼š docker volume rm $(docker volume ls -qf dangling&#x3D;true)â—‹ å¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯ä½¿ç”¨çº¯æ•°æ®å®¹å™¨ï¼ˆdata containerï¼‰æ¥æŒä¹…åŒ–æ•°æ®åº“ã€é…ç½®æ–‡ä»¶æˆ–è€…æ•°æ®æ–‡ä»¶ç­‰ï¼ˆ1ï¼‰åˆ›å»ºæ•°æ®å®¹å™¨ï¼Œä¾‹ï¼šdocker create -v &#x2F;data --name data_container ubuntu ï¼Œä» ubuntuï¼ˆç”¨ä¸åº”ç”¨æ•°æ®çš„å®¹å™¨ç›¸åŒçš„ imageï¼‰åˆ›å»ºåä¸º data çš„æ•°æ®å®¹å™¨ï¼Œå°†å®¿ä¸»æœºçš„æŸç›®å½•(å…·ä½“ç›®å½•ç”± docker åˆ†é…)æŒ‚è½½åœ¨åˆ°å®¹å™¨ä¸­çš„&#x2F;data ç›®å½•ã€‚ï¼ˆ2ï¼‰é€šè¿‡ docker run çš„â€œ--volumes-fromâ€å‚æ•°ä½¿ç”¨æ•°æ®å®¹å™¨çš„é…ç½®å®Œæˆç›®å½•çš„æŒ‚è½½ï¼Œä¾‹ï¼šdocker run --name work_container --volumes-from data_container ubuntuã€‚"},{"title":"è™šæ‹ŸæœºæŠ€æœ¯çŸ¥è¯†æ•´ç†","date":"2018-12-11T10:49:56.000Z","path":"knowledge/è™šæ‹ŸæœºæŠ€æœ¯çŸ¥è¯†æ•´ç†.html","tags":[{"name":"è™šæ‹ŸåŒ–","slug":"è™šæ‹ŸåŒ–","permalink":"https://congzhou09.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"},{"name":"è™šæ‹Ÿæœº","slug":"è™šæ‹Ÿæœº","permalink":"https://congzhou09.github.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"}],"text":"æ¦‚å¿µâ— è™šæ‹ŸåŒ–æŠ€æœ¯ç›®å‰åˆ†ä¸ºâ€œåŸºäºè™šæ‹Ÿæœºâ€å’Œâ€œåŸºäºå®¹å™¨â€ä¸¤ç§ï¼Œå‰è€…å·²ç»æœ‰æ•°åå¹´æˆç†Ÿå†å²ï¼Œæœ¬æ–‡è®¨è®ºå‰è€…ã€‚â— è™šæ‹Ÿæœºåˆåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ç›´æ¥å®‰è£…åœ¨è£¸æœºä¸Šï¼Œå¦ä¸€ç§æ˜¯å®‰è£…åœ¨æ“ä½œç³»ç»Ÿä¸Šã€‚ï¼ˆ1ï¼‰è£¸æœºä¸Šçš„è™šæ‹Ÿæœºï¼Œè™šæ‹ŸåŒ–å±‚ï¼ˆå›¾ä¸­çš„è™šæ‹ŸåŒ–è½¯ä»¶ï¼‰ç›´æ¥è¿è¡Œåœ¨ç³»ç»Ÿç¡¬ä»¶ä¸Šï¼Œåˆ›å»ºç¡¬ä»¶å…¨ä»¿çœŸå®ä¾‹ï¼Œè¢«ç§°ä¸ºâ€œè£¸æœºâ€ï¼Œä¹Ÿç§°ä¸ºâ€œè£¸é‡‘å±æ¶æ„â€ï¼Œå¦‚ä¸‹å›¾ã€‚ ï¼ˆ2ï¼‰æ“ä½œç³»ç»Ÿä¸Šçš„è™šæ‹Ÿæœºï¼Œè™šæ‹ŸåŒ–å±‚ï¼ˆå›¾ä¸­çš„è™šæ‹ŸåŒ–è½¯ä»¶ï¼‰è¿è¡Œåœ¨ä¼ ç»Ÿæ“ä½œç³»ç»Ÿä¹‹ä¸Šï¼ŒåŒæ ·åˆ›å»ºçš„æ˜¯ç¡¬ä»¶å…¨ä»¿çœŸå®ä¾‹ï¼Œè¢«ç§°ä¸ºâ€œæ‰˜ç®¡â€ï¼Œä¹Ÿç§°ä¸ºâ€œå®¿ä¸»æ¶æ„â€ï¼Œå¦‚ä¸‹å›¾ã€‚è™šæ‹Ÿæœºä¸­åº”ç”¨ç¨‹åºè°ƒç”¨ç¡¬ä»¶èµ„æºæ—¶éœ€è¦ç»è¿‡ï¼šè™šæ‹Ÿæœºæ“ä½œç³»ç»Ÿå†…æ ¸-&gt;è™šæ‹ŸåŒ–è½¯ä»¶çš„ Hypervisor-&gt;å®¿ä¸»æœºæ“ä½œç³»ç»Ÿå†…æ ¸ ï¼Œå¯¼è‡´æ€§èƒ½æ˜¯ä¸‰ç§è™šæ‹ŸåŒ–æŠ€æœ¯ä¸­æœ€å·®çš„ã€‚ â— è™šæ‹ŸåŒ–è½¯ä»¶çš„æ ¸å¿ƒæ˜¯ Hypervisorï¼Œä¹Ÿå«è™šæ‹Ÿæœºç›‘è§†å™¨ï¼ˆVirtual Machine Monitorï¼Œç®€ç§° VMMï¼‰ï¼Œå®ƒæ˜¯è¿è¡Œåœ¨ç¡¬ä»¶(ç‰©ç†ç¡¬ä»¶æˆ–è™šæ‹Ÿç¡¬ä»¶)å’Œæ“ä½œç³»ç»Ÿä¹‹é—´çš„ä¸­é—´è½¯ä»¶å±‚ï¼Œå¯å…è®¸å¤šä¸ªæ“ä½œç³»ç»Ÿå’Œåº”ç”¨å…±äº«ä¸€å¥—åŸºç¡€ç¡¬ä»¶ï¼Œå¯ä»¥å°†å…¶çœ‹ä½œæ˜¯è™šæ‹Ÿç¯å¢ƒä¸­çš„â€œå…ƒæ“ä½œç³»ç»Ÿâ€ï¼Œç”±å®ƒåè°ƒè™šæ‹Ÿæœºè®¿é—®æ‰€æœ‰ç¡¬ä»¶ã€‚ å¸¸è§ç¤ºä¾‹â—† å¸¸è§çš„è£¸é‡‘å±å‹ï¼ˆè£¸æœºå‹ï¼‰ï¼ˆ1ï¼‰VMware vSphereï¼Œå…¶æ ¸å¿ƒæ˜¯ ESXï¼ˆæ–°äº§å“ç§° ESXiï¼‰ï¼ŒESX çš„ hypervisor ç»„ä»¶ç§°ä¸º VMKernelï¼ŒVMkernel ä¼šä» LinuxKernel å®Œå…¨æ¥ç®¡å¯¹ç¡¬ä»¶çš„æ§åˆ¶æƒï¼Œè€Œè¯¥ Linux Kernel ä½œä¸º VMkernel çš„é¦–ä¸ªè™šæ‹Ÿæœºï¼Œç”¨äºæ‰¿è½½ ESX çš„ serviceConsoleï¼Œå®ç°æœ¬åœ°çš„ä¸€äº›ç®¡ç†åŠŸèƒ½ã€‚vSphere è™šæ‹Ÿæœºä¸ç‰©ç†æœºæ¶æ„å¯¹æ¯”å¦‚ä¸‹ï¼š ç‰©ç†æœºæ¶æ„ vSphere è™šæ‹Ÿæœºæ¶æ„ ESX æ¶æ„ ï¼ˆ2ï¼‰Microsoft Hyper-Vï¼Œæœ‰ç‹¬ç«‹ç‰ˆ(å¦‚ Hyper-V Server 2008)å’Œå†…åµŒç‰ˆ(å¦‚ Windows Server 2008)ä¸¤ç§å‘å¸ƒç‰ˆæœ¬ã€‚ï¼ˆ3ï¼‰Xenï¼Œç”±å‰‘æ¡¥å¤§å­¦å¼€å‘ï¼Œå¼€æ”¾æºä»£ç çš„è™šæ‹Ÿæœºï¼Œæ”¯æŒæ›´å¹¿æ³›çš„ CPU æ¶æ„ï¼Œå‰ä¸¤è€…åªæ”¯æŒ CISC çš„ X86&#x2F;X86_64 CPU æ¶æ„ï¼ŒXEN é™¤æ­¤ä¹‹å¤–è¿˜æ”¯æŒ RISC CPU æ¶æ„ï¼Œå¦‚ IA64ã€ARM ç­‰ã€‚ï¼ˆ4ï¼‰KVMï¼ˆKernel-based Virtual Machineï¼‰ï¼Œå­—é¢æ„æ€æ˜¯åŸºäºå†…æ ¸çš„è™šæ‹Ÿæœºï¼Œå®ƒåˆ©ç”¨äº† CPU çš„ç¡¬ä»¶è¾…åŠ©è™šæ‹ŸåŒ–èƒ½åŠ›ï¼Œå¹¶é‡ç”¨äº† Linux å†…æ ¸çš„è¯¸å¤šåŠŸèƒ½ï¼Œä½¿å¾— KVM æœ¬èº«æ˜¯éå¸¸ç˜¦å°ï¼Œä»ä¸¥æ ¼æ„ä¹‰æ¥è¯´ï¼ŒKVM æœ¬èº«å¹¶ä¸æ˜¯ Hypervisorï¼Œå®ƒä»…æ˜¯ Linux å†…æ ¸ä¸­çš„ä¸€ä¸ªå¯è£…è½½æ¨¡å—ï¼Œå…¶åŠŸèƒ½æ˜¯å°† Linux å†…æ ¸è½¬æ¢æˆä¸€ä¸ªè£¸é‡‘å±çš„ Hypervisorã€‚è¿™ç›¸å¯¹äºå…¶å®ƒè£¸é‡‘å±æ¶æ„æ¥è¯´æ˜¯éå¸¸ç‰¹åˆ«çš„ï¼Œæœ‰äº›ç±»ä¼¼äºå®¿ä¸»æ¶æ„ï¼Œæœ‰äººç§°å…¶æ˜¯â€œåŠè£¸é‡‘å±æ¶æ„â€ã€‚ä¸€ä¸ªæ™®é€šçš„ linux è¿›ç¨‹æœ‰ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼šå†…æ ¸å’Œç”¨æˆ·ï¼Œ KVM å¢åŠ äº†ç¬¬ä¸‰ ç§æ¨¡å¼ï¼šå®¢æˆ·æ¨¡å¼ï¼ˆæœ‰è‡ªå·±çš„å†…æ ¸æ¨¡å¼å’Œç”¨æˆ·æ¨¡å¼ï¼‰ï¼Œè¿™ä½¿å¾— Linux å†…æ ¸å¯ä»¥å°†ä¸»æœºè¿›ç¨‹å’Œè™šæ‹Ÿæœºè¿›è¡Œç»Ÿä¸€çš„ç®¡ç†å’Œè°ƒåº¦ã€‚KVM ä¸ Xen ä¸€æ ·æ”¯æŒé X86 CPU æ¶æ„ã€‚ â—† å¸¸è§çš„å®¿ä¸»å‹ï¼ˆä¸»æœºå‹ï¼‰ï¼šï¼ˆ1ï¼‰VMware Serverï¼Œå¯è¿è¡Œåœ¨ Windows å’Œ Linux ä¸Šã€‚ï¼ˆ2ï¼‰VMware Workstationï¼Œè¿è¡Œåœ¨ Windows å’Œ Linux ä¸Šã€‚ï¼ˆ3ï¼‰Fusionï¼Œåªèƒ½è¿è¡Œåœ¨è‹¹æœçš„ Mac OS ä¸Šã€‚"},{"title":"çœŸæ­£å®ç°elment.uiçš„æŒ‰éœ€å¼•å…¥","date":"2018-09-14T02:03:24.000Z","path":"practice/çœŸæ­£å®ç°elment-uiçš„æŒ‰éœ€å¼•å…¥.html","tags":[{"name":"webpack","slug":"webpack","permalink":"https://congzhou09.github.io/tags/webpack/"},{"name":"æŒ‰éœ€åŠ è½½","slug":"æŒ‰éœ€åŠ è½½","permalink":"https://congzhou09.github.io/tags/%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD/"},{"name":"vue","slug":"vue","permalink":"https://congzhou09.github.io/tags/vue/"},{"name":"elment.ui","slug":"elment-ui","permalink":"https://congzhou09.github.io/tags/elment-ui/"}],"text":"element.uiå®˜ç½‘æ–‡æ¡£ç»™å‡ºçš„æŒ‰éœ€å¼•å…¥ç»„ä»¶çš„è¯´æ˜ï¼Œå±äºæ˜¯åœ¨main.jsä¸­ä¸ºVueæ³¨å†Œå…¨å±€ç»„ä»¶çš„æ–¹å¼ï¼ŒæŸé¡µé¢å³ä½¿ä¸ä½¿ç”¨æŸç»„ä»¶ä¹Ÿä¼šåœ¨æ‰“åŒ…ä»£ç ä¸­åŒ…å«å®ƒï¼Œå¦‚æœå¸Œæœ›æŸä¸ªç»„ä»¶ä»…ä»…åœ¨å•ç‹¬é¡µé¢é‡ŒæŒ‰éœ€å¼•å…¥ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æœ¬æ–‡æ–¹æ³•ã€‚ å®˜æ–¹æ–¹æ³•å®˜æ–¹æ–¹æ³•åˆ†ä¸¤æ­¥ï¼šï¼ˆ1ï¼‰å®‰è£…babel-plugin-componentï¼Œä¿®æ”¹â€œ.babelrcâ€æ–‡ä»¶å†…å®¹ï¼›ï¼ˆç»éªŒè¯æ­¤æ­¥éª¤ä¸å†éœ€è¦ï¼Œç¯å¢ƒï¼šwebpack-4.18.0ã€vue-2.5.17ï¼Œç”±äºwebpack2ä¹‹åimportåŸç”Ÿæ”¯æŒES6æ‰€ä»¥æœªä½¿ç”¨babelï¼‰ï¼ˆ2ï¼‰åœ¨ main.js ä¸­å•ç‹¬importç»„ä»¶å¹¶æ³¨å†Œä¸ºå…¨å±€ç»„ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516/****************main.js******************/import Vue from &#x27;vue&#x27;;import &#123; Button, Select &#125; from &#x27;element-ui&#x27;;import App from &#x27;./App.vue&#x27;;Vue.component(Button.name, Button);Vue.component(Select.name, Select);/* æˆ–å†™ä¸º * Vue.use(Button) * Vue.use(Select) */new Vue(&#123; el: &#x27;#app&#x27;, render: h =&gt; h(App)&#125;); çœŸæ­£æŒ‰éœ€å¼•å…¥çš„æ–¹æ³•æ€è·¯å°±æ˜¯æŠŠå¼•ç”¨å’Œæ³¨å†Œç»„ä»¶çš„æ“ä½œè½¬åœ¨vueé¡µé¢å†…è¿›è¡Œï¼Œä»¥å±€éƒ¨æ³¨å†ŒButtonä¸ºä¾‹ï¼š 1234567891011121314151617181920212223/****************onePage.vue******************/&lt;template&gt; &lt;div class=&quot;container&quot;&gt; &lt;el-button&gt;é»˜è®¤æŒ‰é’®&lt;/el-button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script type=&quot;text/ecmascript-6&quot;&gt; import &#123; Button &#125; from &#x27;element-ui&#x27;; export default&#123; data()&#123; return &#123; //balaba &#125;; &#125;, components:&#123; ElButton: Button &#125; &#125;&lt;/script&gt;&lt;style rel=&quot;stylesheet/scss&quot; lang=&quot;scss&quot; scoped&gt;&lt;/style&gt; æ³¨æ„componentsé‚£é‡Œä¸è¦ç®€å†™æˆâ€œButtonâ€ï¼Œå› ä¸ºç»„ä»¶åå­—æ˜¯â€œElButtonâ€è€Œä¸æ˜¯åŒåçš„â€œButtonâ€æ‰€ä»¥ä¸èƒ½ç®€å†™ã€‚è¿™é‡Œçš„â€œElButtonâ€å…¶å®å°±æ˜¯å®˜ç½‘æ–¹æ³•ä¸­çš„â€œButton.nameâ€çš„å€¼ï¼Œæˆ‘æ˜¯é€šè¿‡è°ƒè¯•çŸ¥é“çš„ã€‚ç›®å‰ç”¨è¿‡çš„ç»„ä»¶nameéƒ½æ˜¯å‰é¢åŠ ä¸Šâ€œElâ€å‰ç¼€ï¼Œå¦‚æœæŸä¸ªç»„ä»¶æ³¨å†Œå¤±è´¥åˆ™éœ€è¦è°ƒè¯•æˆ–element-uiæºç ä¸­æŸ¥æ‰¾å…¶çœŸå®çš„nameå€¼ã€‚æˆ–è€…ä½¿ç”¨å¦‚ä¸‹é€šç”¨ä½†ä¸ç¾è§‚çš„å†™æ³•ï¼š 1234567891011121314&lt;script type=&quot;text/ecmascript-6&quot;&gt; import &#123; Button &#125; from &#x27;element-ui&#x27;; let exportObj = &#123; data()&#123; return &#123; //balaba &#125;; &#125; &#125;; exportObj.components = &#123;&#125;; exportObj.components[Button.name] = Button; export default exportObj;&lt;/script&gt;"},{"title":"é’‰é’‰å¾®åº”ç”¨å¼€å‘ç¯å¢ƒæ­å»º","date":"2018-08-21T03:11:05.000Z","path":"handbook/é’‰é’‰å¾®åº”ç”¨å¼€å‘ç¯å¢ƒæ­å»º.html","tags":[{"name":"é’‰é’‰","slug":"é’‰é’‰","permalink":"https://congzhou09.github.io/tags/%E9%92%89%E9%92%89/"}],"text":"åˆ›å»ºå¾®åº”ç”¨â—‡åœ¨é’‰é’‰å¼€æ”¾å¹³å°ä¸­åˆ›å»ºå¾®åº”ç”¨ï¼ŒæœåŠ¡å™¨å‡ºå£IPå¡«å†™ä¸ºå½“å‰æ‰€ç”¨ç½‘ç»œçš„å…¬ç½‘å‡ºå£IPï¼›â—‡å¦‚æœå¾®åº”ç”¨è¦æ”¯æŒPCç«¯è®¿é—®åˆ™ä¹Ÿå¡«å†™&quot;PCç«¯é¦–é¡µåœ°å€&quot;ï¼› é…ç½®é¦–é¡µåœ°å€â—å¯åŠ¨æœ¬åœ°å¼€å‘ç¯å¢ƒæœåŠ¡å™¨ï¼Œä»¥åœ°å€ &quot;http://192.168.1.10:8080&quot; ä¸ºä¾‹ï¼›â—é¦–é¡µåœ°å€æœ‰ä½¿ç”¨ç©¿é€å·¥å…·ä¸ä¸ä½¿ç”¨ç©¿é€å·¥å…·ä¸¤ç§æ–¹å¼ï¼› ä½¿ç”¨ç©¿é€å·¥å…·â—ä½¿ç”¨é’‰é’‰æä¾›çš„å†…ç½‘ç©¿é€å·¥å…·æ‰§è¡Œå¦‚ä¸‹æ ¼å¼çš„å‘½ä»¤ï¼š 1ding -config=./ding.cfg -subdomain=congzhou 8080 â—ä»¥ä¸Šå‘½ä»¤æ‰§è¡Œåæ‰“å°ä¿¡æ¯ç¤ºä¾‹å¦‚ä¸‹ï¼Œè¡¨ç¤ºå°†å°†å…¬ç½‘åŸŸæ˜ å°„åˆ°æœ¬åœ°æˆåŠŸï¼› 12345678910ngrokTunnel Status onlineVersion 1.7/1.7Forwarding http://congzhou.vaiwan.com:8081 -&gt; 127.0.0.1:8080Forwarding https://congzhou.vaiwan.com:8081 -&gt; 127.0.0.1:8080Web Interface 127.0.0.1:4040# Conn 434Avg Conn Time 47277.91ms â—æ­¤æ—¶é€šè¿‡æ§åˆ¶å°ä¸­æ˜¾ç¤ºçš„ç½‘å€ &quot;http://congzhou.vaiwan.com&quot; ï¼ˆæ³¨æ„ä¸è¦å¸¦ç«¯å£å·ï¼‰å°±å¯ä»¥è®¿é—®åˆ°æœ¬åœ°çš„ &quot;http://192.168.1.10:8080&quot; ï¼Œå°†ç½‘å€é…ç½®åˆ°&quot;é¦–é¡µåœ°å€&quot;é¡¹å³å¯åœ¨å¾®åº”ç”¨ä¸­è®¿é—®ï¼› ä¸ä½¿ç”¨ç©¿é€å·¥å…·â–¡åæ¥å‘ç°ä¸ä½¿ç”¨ç©¿é€å·¥å…·è€Œç›´æ¥å¡«å†™æœ¬åœ°åœ°å€ &quot;http://192.168.1.10:8080&quot; ä¹Ÿæ˜¯å¯ä»¥è®¿é—®çš„(ä»Šå¤©2020å¹´10æœˆ21æ—¥ä»å¯ä»¥)ï¼Œåªè¦è®¿é—®ç»ˆç«¯ä¸å¼€å‘ç¯å¢ƒå¤„äºåŒä¸€ä¸ªå±€åŸŸç½‘ï¼› è°ƒè¯•â– å®‰è£…é’‰é’‰RCç‰ˆå®¢æˆ·ç«¯ï¼Œå¹¶åœ¨OAå·¥ä½œå°æ‰“å¼€å¾®åº”ç”¨é¡µé¢ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—® &quot;http://localhost:16888&quot; ï¼Œå³å¯è°ƒè¯•å½“å‰æ‰“å¼€çš„å¾®åº”ç”¨é¡µé¢ï¼›â– ä¸Šè¿°è°ƒè¯•æ–¹å¼ç›®å‰å·²ä¸å¯ç”¨(ä»Šå¤©2020å¹´10æœˆ21æ—¥ä»ä¸å¯ç”¨)ï¼Œæµè§ˆå™¨æ§åˆ¶å°æŠ¥é”™â€œinspector.js:2978 document.registerElement is not a functionâ€ï¼Œåªå¥½æ”¹ç”¨VConsoleä¸Erudaä¹‹ç±»è°ƒè¯•é¢æ¿äº†ï¼Œæ¨èä¸€ä¸ªæ›´æ–¹ä¾¿åœ°éšè—ä¸æ˜¾ç¤ºè°ƒè¯•é¢æ¿çš„å·¥å…·åº“ï¼šclick-passwordï¼›"},{"title":"ä½¿ç”¨talkingdataåœ¨webé¡¹ç›®ä¸­é‡‡é›†æ•°æ®","date":"2018-08-02T02:52:54.000Z","path":"handbook/ä½¿ç”¨talkingdataåœ¨webé¡¹ç›®ä¸­é‡‡é›†æ•°æ®.html","tags":[{"name":"talkingdata","slug":"talkingdata","permalink":"https://congzhou09.github.io/tags/talkingdata/"}],"text":"Webé¡¹ç›®ä¸­ä½¿ç”¨talkingdataçš„&quot;æ¸¸æˆè¿è¥åˆ†æ&quot;æ­¥éª¤å¦‚ä¸‹ï¼šâ—†ç™»å½•ç³»ç»Ÿï¼Œè¿›å…¥â€œGameAnalyticsæ¸¸æˆè¿è¥åˆ†æâ€ï¼› å›¾1 \"æ¸¸æˆè¿è¥åˆ†æ\"å…¥å£ â—†åˆ›å»ºäº§å“ï¼Œå¾—åˆ°App Id ï¼› å›¾2 å¡«å†™äº§å“ä¿¡æ¯å®Œæˆåˆ›å»ºï¼Œå¾—åˆ°App Id â—†webé¡µé¢ä¸­æ·»åŠ scriptæ ‡ç­¾ï¼› 1234//å¯¹äºæ™®é€šçš„httpè¿æ¥ç½‘ç«™ï¼Œä½¿ç”¨çš„è°ƒç”¨åœ°å€ï¼š&lt;script src=&quot;http://sdk.talkingdata.com/g/h5/v1/æ‚¨çš„APPID&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;//å¦‚æœæ‚¨çš„ç½‘ç«™ä½¿ç”¨httpsè¿æ¥ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹åœ°å€ï¼š&lt;script src=&quot;https://h5.talkingdata.com/g/h5/v1/æ‚¨çš„APPID&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt; â—†è°ƒç”¨å¦‚ä¸‹ä¸¤ä¸ªå‡½æ•°ï¼Œå®Œæˆè°ƒè¯•ä¸æ•°æ®ç»Ÿè®¡ï¼› 12345678//æ ‡è¯†è´¦æˆ·TDGA.Account(&#123; accountId: æ ‡è¯†è´¦æˆ·çš„ID&#125;);//æ ‡è¯†äº‹ä»¶TDGA.onEvent(&#x27;äº‹ä»¶åç§°&#x27;, &#123; äº‹ä»¶å‚æ•°: äº‹ä»¶å‚æ•°å€¼&#125;);"},{"title":"JSçš„ç»§æ‰¿","date":"2018-05-09T01:42:09.000Z","path":"knowledge/jsçš„ç»§æ‰¿.html","tags":[{"name":"javascript","slug":"javascript","permalink":"https://congzhou09.github.io/tags/javascript/"}],"text":"è¦ç‚¹â— åœ¨ ES6 ä¹‹å‰ï¼Œç±»ä»¥åŠç±»çš„ç»§æ‰¿æœºåˆ¶æ²¡æœ‰æ˜ç¡®å®šä¹‰ï¼Œé€šè¿‡æ¨¡ä»¿æ¥å®ç°ï¼Œä»¥ä¸‹å†…å®¹é’ˆå¯¹ ES6 ä¹‹å‰åœºæ™¯ã€‚â— ä» ES6 å¼€å§‹ï¼Œç±»å’Œç»§æ‰¿æœ‰äº†å®šä¹‰ï¼Œåˆ†åˆ«é€šè¿‡ class å’Œ extends å®ç°ã€‚â— Babel å¯¹äº class å’Œ extends å‘ ES6 ä¹‹å‰çš„è½¬è¯‘ï¼Œä½¿ç”¨çš„å°±æ˜¯ä»¥ä¸‹å†…å®¹ä¸­â€œå¯„ç”Ÿç»„åˆå¼ç»§æ‰¿â€çš„æ–¹å¼ã€‚ å¯¹è±¡å†’å……(object masquerading)â– &quot;å¯¹è±¡å†’å……&quot;ä¹Ÿç§°ä¸º&quot;å€Ÿç”¨æ„é€ å‡½æ•°&quot;ï¼Œé€šè¿‡ä»¥å­ç±»æ„é€ å‡½æ•°çš„ä¸Šä¸‹æ–‡æ‰§è¡Œçˆ¶ç±»æ„é€ å‡½æ•°æ¥å®ç°ï¼Œä¾‹ï¼š 1234567891011121314function ClassA(color) &#123; this.color = color; this.sayColor = function () &#123; alert(this.color); &#125;;&#125;function ClassB(color, name) &#123; ClassA.call(this, color); this.name = name; this.sayName = function () &#123; alert(this.name); &#125;;&#125; â–  ç¼ºç‚¹ï¼šï¼ˆ1ï¼‰åªèƒ½ç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•°ä¸­çš„å®šä¹‰ã€‚ï¼ˆ2ï¼‰çˆ¶ç±»æ„é€ å‡½æ•°ä¸­å®šä¹‰çš„æ–¹æ³•åœ¨æ¯æ¬¡å­ç±»å®ä¾‹åŒ–çš„æ—¶å€™ä¹Ÿä¼šè¢«åˆ›å»ºä¸€éã€‚ åŸå‹é“¾(prototype chaining)â–  åŸå‹é“¾æ–¹å¼é€šè¿‡å°†çˆ¶ç±»å®ä¾‹èµ‹å€¼ç»™å­ç±»æ„é€ å‡½æ•°çš„ prototype å®ç°ã€‚â–  å®ä¾‹ï¼š 123456789101112131415161718192021222324function ClassA(color) &#123; this.color = color; this.colorArr = [color];&#125;ClassA.prototype.sayColor = function () &#123; alert(this.color);&#125;;function ClassB() &#123; this.name = &quot;&quot;;&#125;ClassB.prototype = new ClassA(&#x27;white&#x27;); // æ‰€æœ‰ClassBå®ä¾‹çš„__proto__éƒ½æŒ‡å‘è¿™ä¸ªClassAçš„å®ä¾‹ClassB.prototype.constructor = ClassB; // æ‰‹åŠ¨æŒ‡å®šconstructorå±æ€§å€¼ClassB.prototype.sayName = function () &#123; alert(this.name);&#125;;var objOne = new ClassB();var objTwo = new ClassB();objOne.color = &#x27;red&#x27;; // å°†åˆ›å»ºobjOneè‡ªå·±çš„â€˜colorâ€™å±æ€§è€Œä¸ä¼šæ”¹å˜åŸå‹é“¾ä¸­çš„colorobjOne.colorArr.push(&#x27;red&#x27;);console.log(`color: $&#123;objOne.color&#125;, colorArr: $&#123;objOne.colorArr&#125;`);// æ‰“å° color: red, colorArr: white,redconsole.log(`color: $&#123;objTwo.color&#125;, colorArr: $&#123;objTwo.colorArr&#125;`);// æ‰“å° color: white, colorArr: white,red â–  ç¼ºç‚¹ï¼šï¼ˆ1ï¼‰åœ¨å­ç±»å®ä¾‹åŒ–çš„æ—¶å€™æ— æ³•ç»™çˆ¶ç±»æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚ï¼ˆ2ï¼‰ç”±äºæ‰€æœ‰å­ç±»å®ä¾‹çš„[[Prototype]]å…±äº«åŒä¸€ä¸ªçˆ¶ç±»å®ä¾‹ï¼Œæ”¹å†™çˆ¶ç±»ä¸­å¼•ç”¨ç±»å‹çš„æˆå‘˜å˜é‡å°†é€ æˆç›¸äº’æ±¡æŸ“ï¼ˆéå¼•ç”¨ç±»å‹å˜é‡æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºä¼šåœ¨å­ç±»å®ä¾‹ä¸Šåˆ›å»ºæ–°å±æ€§ï¼‰ã€‚ ç»„åˆç»§æ‰¿ï¼ˆå¯¹è±¡å†’å…… + åŸå‹é“¾ï¼‰â–  ç»„åˆç»§æ‰¿æ˜¯å¯¹è±¡å†’å……æ–¹æ³•ä¸åŸå‹é“¾æ–¹æ³•çš„ç»“åˆï¼Œèåˆäº†ä¸¤ç§æ–¹æ³•çš„ä¼˜ç‚¹ï¼šï¼ˆ1ï¼‰é€šè¿‡åŸå‹é“¾ç»§æ‰¿åŸå‹çš„å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°æ–¹æ³•ä¸å…±äº«å±æ€§çš„å¤ç”¨ã€‚ï¼ˆ2ï¼‰é€šè¿‡å¯¹è±¡å†’å……ç»§æ‰¿å®ä¾‹çš„å±æ€§ï¼Œä¿è¯æ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±çš„å±æ€§ã€‚â–  ä¾‹ï¼š 1234567891011121314151617function ClassA(color) &#123; this.color = color; this.colorArr = [color];&#125;ClassA.prototype.sayColor = function () &#123; alert(this.color);&#125;;function ClassB(color, name) &#123; ClassA.call(this, color); this.name = name;&#125;ClassB.prototype = new ClassA();ClassB.prototype.constructor = ClassB;ClassB.prototype.sayName = function () &#123; alert(this.name);&#125;; â–  ä¸€ç‚¹ç‘•ç–µï¼šçˆ¶ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡ã€‚ä½†ä¸èƒ½ç›´æ¥&quot;ClassB.prototype &#x3D; ClassA.prototype&quot;ï¼Œå› ä¸ºä¼šå¯¼è‡´å­ç±»ä¿®æ”¹ prototype ä¹Ÿä¿®æ”¹äº†çˆ¶ç±»çš„ prototype;â–  è§£å†³æ„é€ å‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡çš„é—®é¢˜ä¹‹å‰å…ˆäº†è§£â€œåŸå‹å¼ç»§æ‰¿â€ä¸â€œå¯„ç”Ÿå¼ç»§æ‰¿â€ã€‚â–  åŸå‹å¼ç»§æ‰¿å’Œå¯„ç”Ÿç»§æ‰¿ç”±é“æ ¼æ‹‰æ–¯Â·å…‹ç½—å…‹ç¦å¾·(Douglas Crockfordï¼Œä¹Ÿæ˜¯ JSON çš„æå‡ºäºº)äº 2006 å¹´å·¦å³æå‡ºå’Œæ¨å¹¿ã€‚â–  åŸå‹å¼ç»§æ‰¿å’Œå¯„ç”Ÿç»§æ‰¿æ²¡æœ‰ä½¿ç”¨ä¸¥æ ¼æ„ä¹‰ä¸Šçš„æ„é€ å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰åˆ›å»ºå­ç±»ï¼Œè€Œæ˜¯å€ŸåŠ©åŸå‹é“¾åŸºäºå·²æœ‰çš„ä¸€ä¸ªçˆ¶ç±»å®ä¾‹æ¥ç›´æ¥åˆ›å»ºå­ç±»å®ä¾‹ï¼Œæä¾›äº†ä¸€ç§æœ‰åˆ«äºä¼ ç»Ÿ new æ–¹å¼åˆ›å»ºå­ç±»å®ä¾‹çš„æ€è·¯ã€‚ åŸå‹å¼ç»§æ‰¿â–  åŸå‹å¼ç»§æ‰¿ä¸åŸå‹é“¾ç»§æ‰¿ä¸€æ ·åˆ©ç”¨çš„æ˜¯è®¾ç½®å­ç±»åŸå‹é“¾ï¼ŒåŒºåˆ«æ˜¯æ²¡æœ‰æ˜¾å¼åˆ›å»ºå­ç±»è€Œæ˜¯ç›´æ¥åˆ›å»ºå­ç±»å®ä¾‹å¹¶è®¾ç½®å­ç±»å®ä¾‹çš„[[Prototype]]ä¸ºçˆ¶ç±»å®ä¾‹ï¼Œå…·ä½“ä½“ç°åœ¨å¦‚ä¸‹çš„ createObj å‡½æ•°ã€‚â–  ä¸å…³å¿ƒçˆ¶ç±»å®ä¾‹æ˜¯å¦‚ä½•è¢«åˆ›å»ºçš„ï¼Œé€šè¿‡ç›´æ¥å°†çˆ¶ç±»å®ä¾‹æ”¾åœ¨å­ç±»å®ä¾‹çš„åŸå‹é“¾ä¸Šçš„æ–¹å¼è¾¾åˆ°çˆ¶ç±»ä¹Ÿå¤„äºå­ç±»å®ä¾‹çš„åŸå‹é“¾ä¸Šçš„ç›®çš„ï¼Œä¾‹ï¼š 1234567891011121314151617181920212223function ClassA(color) &#123; this.color = color; this.colorArr = [color];&#125;ClassA.prototype.sayColor = function () &#123; alert(this.color);&#125;;var oneObjA = new ClassA(&#x27;white&#x27;);function createObj(o) &#123; //æ­¤è¿‡ç¨‹è¢«ES5æ–°å¢çš„Object.create()æ–¹æ³•å®ç° function F()&#123;&#125; F.prototype = o; // ç›¸å½“äºåŸå‹é“¾ç»§æ‰¿ä¸­çš„â€œClassB.prototype = new ClassA()â€ return new F();&#125;var oneObjB = createObj(oneObjA);var anotherObjB = Object.create(oneObjA);console.log(oneObjB instanceof ClassA);// trueconsole.log(anotherObjB instanceof ClassA);// trueoneObjB.colorArr.push(&#x27;red&#x27;);console.log(anotherObjB.colorArr); // [&quot;white&quot;, &quot;red&quot;]ï¼ŒåŸå‹é“¾ä¸Šçš„å…±äº«å±æ€§ å¯„ç”Ÿå¼(parasitic)ç»§æ‰¿â–  å¯„ç”Ÿå¼ç»§æ‰¿æ˜¯å¯¹åŸå‹å¼ç»§æ‰¿çš„è¿›ä¸€æ­¥å°è£…ä¸æ‰©å±•ã€‚æ€è·¯æ˜¯å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°å†…é€šè¿‡åŸå‹å¼ç»§æ‰¿åˆ›å»ºæ–°å¯¹è±¡ï¼Œå¹¶å¯¹è¿™ä¸ªæ–°å¯¹è±¡è¿›è¡Œå¢å¼º(å¢åŠ è‡ªå®šä¹‰å±æ€§)ï¼Œæœ€åè¿”å›è¿™ä¸ªæ–°å¯¹è±¡ï¼Œå®ä¾‹ï¼š 1234567function createObj2 (o) &#123; var clone = createObj(o); // åˆ›å»ºæ–°å¯¹è±¡ç»§æ‰¿çˆ¶ç±» clone.sayName = function () &#123; // å¢å¼ºæ–°å¯¹è±¡ console.log(&#x27;hi&#x27;); &#125; return clone; // è¿”å›è¿™ä¸ªæ–°å¯¹è±¡&#125; å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼ˆå¯¹è±¡å†’å…… + å¯„ç”Ÿï¼‰â–  å°†çˆ¶ç±»çš„ prototype ä½œä¸ºè¢«ç»§æ‰¿å®ä¾‹ï¼Œé€šè¿‡å¯„ç”Ÿå¼ç»§æ‰¿å®ç°å­ç±» prototype ä»…å¯¹çˆ¶ç±» prototype çš„ç»§æ‰¿ï¼Œè§£å†³ç»„åˆç»§æ‰¿æ–¹å¼æ„é€ å‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡çš„é—®é¢˜ï¼Œä¾‹ï¼š 123456789101112131415161718192021222324252627function ClassA(color) &#123; this.color = color; this.colorArr = [color];&#125;ClassA.prototype.sayColor = function () &#123; alert(this.color);&#125;;function ClassB(color, name) &#123; ClassA.call(this, color); this.name = name;&#125;inheritClass(ClassB, ClassA);function inheritClass(subType, superType) &#123; var onePrototype = Object.create(superType.prototype); // åˆ›å»ºæ–°å¯¹è±¡ç»§æ‰¿çˆ¶ç±» onePrototype.constructor = subType; // å¢å¼ºæ–°å¯¹è±¡ subType.prototype = onePrototype;// æŒ‡å®šæ–°å¯¹è±¡&#125;;ClassB.prototype.sayName = function () &#123; alert(this.name);&#125;;var oneObjB = new ClassB(&#x27;red&#x27;, &#x27;rose&#x27;);oneObjB.sayName();oneObjB.sayColor();"},{"title":"é€šè¿‡babelæ­å»ºå¯ä½¿ç”¨async/awaitçš„Node.jsè¿è¡Œç¯å¢ƒ","date":"2018-03-22T08:03:06.000Z","path":"practice/é€šè¿‡babelæ­å»ºå¯ä½¿ç”¨asyncã€awaitçš„Node.jsè¿è¡Œç¯å¢ƒ.html","tags":[{"name":"Node.js","slug":"Node-js","permalink":"https://congzhou09.github.io/tags/Node-js/"}],"text":"Node.js ç‰ˆæœ¬7ä»¥ä¸‹ åŸç”Ÿä¸æ”¯æŒES6çš„async&#x2F;awaitå†™æ³•ï¼Œé€šè¿‡bebelçš„runtimeå®æ—¶ç¿»è¯‘å®ç°async&#x2F;awaitå†™æ³•çš„æ”¯æŒï¼Œåœ¨Node.js-v6.11.0çš„expressé¡¹ç›®ä¸‹äº²æµ‹å¯ç”¨ã€‚ ps: koaå®˜ç½‘é¦–é¡µ&quot;Async Functions with Babel&quot;å°èŠ‚ä¹Ÿæœ‰ä»‹ç» å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š â—å®‰è£…&quot;babel-core&quot; 1npm install --save babel-core â—å®‰è£…&quot;babel-preset-env&quot;ã€&quot;babel-runtime&quot; 12npm install --save babel-preset-envnpm install --save babel-runtime â—é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º&quot;.babelrc&quot;æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ 123456789101112131415161718192021&#123; &quot;presets&quot;: [ [ &quot;env&quot;, &#123; &quot;target&quot;: &#123; &quot;node&quot;: &quot;current&quot; &#125; &#125; ] ], &quot;plugins&quot;: [ [ &quot;transform-runtime&quot;, &#123; &quot;polyfill&quot;: false, &quot;regenerator&quot;: true &#125; ] ] &#125; â—é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºå¯åŠ¨æ–‡ä»¶&quot;index.js&quot;ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œå…¶ä¸­çš„&quot;app.js&quot;æ˜¯é¡¹ç›®æœ¬æ¥çš„å¯åŠ¨æ–‡ä»¶ 12345require(&#x27;babel-core/register&#x27;);require(&#x27;./app.js&#x27;);require(&quot;babel-core&quot;).transform(&quot;code&quot;, &#123; plugins: [&quot;transform-runtime&quot;]&#125;);"},{"title":"JSçš„åŸå‹é“¾ã€newã€constructorã€instanceof","date":"2018-03-07T11:51:05.000Z","path":"knowledge/jsçš„åŸå‹é“¾ã€newã€constructorã€instanceof.html","tags":[{"name":"javascript","slug":"javascript","permalink":"https://congzhou09.github.io/tags/javascript/"}],"text":"åŸå‹é“¾â–¡ JS ä¸­ï¼Œæ¯ä¸ªå¯¹è±¡ï¼ˆåŒ…æ‹¬å†…éƒ¨å¯¹è±¡ã€å®¿ä¸»å¯¹è±¡ã€è‡ªå®šä¹‰å¯¹è±¡ï¼Œä»¥åŠåŸå§‹ç±»å‹å€¼è‡ªåŠ¨è½¬æˆçš„åŒ…è£…å¯¹è±¡ï¼‰éƒ½æœ‰ä¸€ä¸ª[[Prototype]]å†…éƒ¨å±æ€§ï¼Œä¸ºäº†è¡¨ç¤ºç‰¹æ€§æ˜¯å†…éƒ¨å€¼ï¼Œç”¨ä¸¤ä¸ªæ–¹æ‹¬å·åŠ ä»¥åŒºåˆ†ã€‚å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœè¿™ä¸ªå±æ€§ä¸å­˜åœ¨ï¼Œåˆ™ä¼šå»å¯¹è±¡çš„[[Prototype]]ä¸­æ‰¾è¿™ä¸ªå±æ€§ï¼Œè€Œè¿™ä¸ª[[Prototype]]çš„å–å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸ªå¯¹è±¡å¹¶ä¹Ÿæ‹¥æœ‰[[Prototype]]å±æ€§ï¼Œå¯ä»¥ç»§ç»­åœ¨å…¶ä¸­æŸ¥æ‰¾å±æ€§ï¼Œæ­¤æœºåˆ¶ç§°ä¸ºåŸå‹é“¾(prototype chain)ã€‚â–¡ Firefoxã€Safariã€Chrome ç›®å‰éƒ½æ”¯æŒé€šè¿‡__proto__å±æ€§å¾—åˆ°[[Prototype]]çš„å–å€¼ï¼Œæ­¤éæ ‡å‡†æ–¹å¼ä¸è¢«æ¨èäºç”Ÿäº§ç¯å¢ƒï¼Œæ ‡å‡†æ–¹å¼æ˜¯é€šè¿‡è°ƒç”¨å‡½æ•° Object.getPrototypeOf() å¾—åˆ°ã€‚â–¡ è¦è®¨è®º[[Prototype]]å±æ€§çš„å–å€¼ï¼Œéœ€è¦å…ˆæåˆ° prototype å±æ€§ â†“ã€‚ prototype å’Œ constructorâ— JS ä¸­ï¼Œæ¯ä¸ªå‡½æ•°ä¸ä»…æœ‰[[Prototype]]å±æ€§ï¼Œè¿˜éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§ã€‚â— prototype å±æ€§çš„å–å€¼ï¼ˆ1ï¼‰å–å€¼é€šå¸¸æ˜¯ä¸ªå¯¹è±¡ï¼Œæ­¤å¯¹è±¡ä¸ä»…æœ‰[[Prototype]]å±æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ª constructor å±æ€§ï¼Œconstructor çš„é»˜è®¤å€¼æ˜¯è¿™ä¸ªå‡½æ•°æœ¬èº«ã€‚ï¼ˆ2ï¼‰å–å€¼çš„ç‰¹æ®Šæƒ…å†µï¼šFunction.prototype çš„å–å€¼å®é™…ä¹Ÿæ˜¯ä¸ªå¯¹è±¡ï¼Œå®ƒä¹Ÿæœ‰[[Prototype]]å±æ€§ï¼Œä¹Ÿæœ‰ constructor å±æ€§ä¸”é»˜è®¤å€¼ä¾ç„¶æ˜¯ Function å‡½æ•°æœ¬èº«ä½†å®ƒä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨ï¼Œä½†æ²¡æœ‰ prototype å±æ€§ï¼ˆå³ Function.prototype.prototype &#x3D;&#x3D;&#x3D; undefinedï¼‰ã€‚è¿™ä¸ªå¯¹è±¡è¿˜ç‰¹æ®Šåœ¨å®ƒä¹Ÿå…·æœ‰å‡½æ•°ç±»å‹çš„ç‰¹å¾ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œè¿™ä¸€ç‚¹å®˜æ–¹ç»™çš„åŸå› æ˜¯å¯¹æ—©æœŸç‰ˆæœ¬çš„å…¼å®¹ã€‚ Function.prototypeçš„ç‰¹æ®Šå–å€¼ [[Prototype]] å±æ€§çš„å–å€¼â—† [[Prototype]]å±æ€§çš„å–å€¼é€šå¸¸æ˜¯å…¶æ‰€å±ç±»å‹çš„ prototype å±æ€§å€¼ã€‚ï¼ˆ1ï¼‰æœ¬åœ°å¯¹è±¡ç±»å‹ï¼ˆå¦‚ Arrayã€Objectã€Dateã€Functionï¼‰çš„[[Prototype]]å–å€¼éƒ½æ˜¯ Function.prototype çš„å€¼ã€‚ï¼ˆ2ï¼‰å¯¹äºé€šè¿‡ new æ„é€ å‡ºæ¥çš„è‡ªå®šä¹‰å¯¹è±¡ï¼Œå…¶æ‰€å±ç±»å‹å°±æ˜¯å¯¹åº”çš„è‡ªå®šä¹‰ç±»ï¼Œæ‰€ä»¥å…¶[[Prototype]]çš„å€¼å°±æ˜¯è‡ªå®šä¹‰ç±»çš„æ„é€ å‡½æ•°çš„ prototype å±æ€§å€¼ã€‚ â—† å–å€¼çš„ç‰¹æ®Šæƒ…å†µï¼šï¼ˆ1ï¼‰Object.prototype.__proto__ çš„å€¼æ˜¯ nullï¼Œå®ƒæ˜¯åŸå‹é“¾åœ¨ [[Prototype]] å±æ€§ä¸Šçš„ç»ˆç‚¹ã€‚ï¼ˆ2ï¼‰é€šè¿‡ Object.create()åˆ›å»ºçš„å¯¹è±¡ï¼Œå…¶__proto__å€¼ç”±ä¼ å…¥å‚æ•°å†³å®šã€‚ 1234var oneObj = Object.create(&#123;a:1&#125;);console.log(oneObj.__proto__); // &#123;a:1&#125;oneObj = Object.create(null);console.log(oneObj.__proto__); // æ‰“å°undefined è€Œä¸æ˜¯null ç†è§£å®ä¾‹â™‚ ç†è§£å®ä¾‹ 1 123456789101112131415161718192021var A= 19;console.log(A.__proto__);//æ‰“å°Number.prototypeçš„å€¼ï¼Œè§ä¸‹å›¾1console.log(A.__proto__ === Number.prototype);//æ‰“å°truevar B= &#123;&#125;;console.log(B.__proto__ === Object.prototype);//æ‰“å°trueconsole.log(Array.prototype.__proto__ === Object.prototype);//æ‰“å°trueconsole.log(Object.prototype.__proto__ === Object.prototype);//æ‰“å°falseconsole.log(Object.prototype.__proto__);//æ‰“å°nullconsole.log(Array.__proto__ === Function.prototype);//æ‰“å°trueconsole.log(Object.__proto__ === Function.prototype);//æ‰“å°trueconsole.log(Function.__proto__ === Function.prototype);//æ‰“å°truefunction C()&#123; console.log(&quot;I am cc&quot;);&#125;console.log(C.__proto__===Function.prototype);//æ‰“å°true å›¾1 Açš„__proto__å±æ€§å€¼ â™‚ ç†è§£å®ä¾‹ 2 1234567var Person = function () &#123; &#125;;var Programmer = function () &#123; &#125;;Programmer.prototype = new Person();var p = new Programmer();console.log(p.__proto__.__proto__ === Person.prototype); // æ‰“å°true â™‚ ç†è§£å®ä¾‹ 3 123456789function foo()&#123; return 0;&#125;console.log(foo.prototype);//æ‰“å°ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡å€¼åŒ…å«ä¸¤ä¸ªå±æ€§ï¼šconsoturctorä¸__proto__ï¼Œå¦‚ä¸‹å›¾2console.log(foo.prototype.constructor===foo);//æ‰“å°trueconsole.log(foo.prototype.__proto__===Object.prototype)//æ‰“å°trueconsole.log(foo.prototype.constructor.__proto__===Function.prototype);//æ‰“å°true å›¾2 fooçš„prototypeå±æ€§çš„å–å€¼ newâ—‹ JS ä¸­ new çš„è¿‡ç¨‹åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥(ä»¥è¯­å¥â€œvar obj&#x3D; new Base()â€ä¸ºä¾‹)ï¼šï¼ˆ1ï¼‰var obj&#x3D;{}; &#x2F;&#x2F;åˆ›å»ºç©ºå¯¹è±¡ã€‚ï¼ˆ2ï¼‰obj çš„[[Prototype]]å±æ€§èµ‹å€¼ä¸º Base.prototypeã€‚ï¼ˆ3ï¼‰Base.call(obj); &#x2F;&#x2F; ä»¥ obj ä½œä¸ºä¸Šä¸‹æ–‡è°ƒç”¨ Base å‡½æ•°ï¼ˆå³ Base ç±»çš„æ„é€ å‡½æ•°ï¼‰ instanceofâ˜… &quot;A instanceof B&quot;ç”¨äºåˆ¤æ–­ A æ˜¯å¦æ˜¯ B çš„å®ä¾‹ï¼Œè¿ç®—è¿‡ç¨‹ï¼šé¦–å…ˆç¡®å®š A ä¸æ˜¯åŸå§‹ç±»å‹å­—é¢å€¼ï¼ˆåŸå§‹ç±»å‹å­—é¢å€¼çš„ instanceof è¿ç®—ç»“æœéƒ½æ˜¯ falseï¼‰ï¼Œç„¶ååˆ¤æ–­ B çš„ prototype å±æ€§æ˜¯å¦å¤„äº A çš„åŸå‹é“¾ä¸Šã€‚â˜… å®ä¾‹ç†è§£ï¼š 1234567891011121314151617181920212223242526272829303132333435Object instanceof Object; //true/*è§£æï¼šObject.__proto__===Function.prototypeï¼Œè€ŒFunction.prototype.__proto__===Object.prototypeï¼Œå› æ­¤Object.prototypeåœ¨Objectçš„åŸå‹é“¾ä¸Š*/Function instanceof Function; //true/*è§£æï¼šFunction.__proto__===Function.prototypeï¼Œå› æ­¤Function.prototypeåœ¨Functionçš„åŸå‹é“¾ä¸Š*/Function instanceof Object; //true/*è§£æï¼šFunction.__proto__===Function.prototypeï¼Œè€ŒFunction.prototype.__proto__===Object.prototypeï¼Œå› æ­¤Object.prototypeåœ¨Functionçš„åŸå‹é“¾ä¸Š*/String instanceof String; //false/*è§£æï¼šString.__proto__===Function.protypeï¼Œè€ŒFunction.prototype.__proto__===Object.prototypeï¼Œç„¶åObject.prototype.__proto__===nullï¼Œå› æ­¤String.prototypeä¸åœ¨Stringçš„åŸå‹é“¾ä¸Š*/var oneNumber= 19;oneNumber instanceof Number; //falseoneNumber instanceof Object; //false/*è§£æï¼šè™½ç„¶oneNumber.__proto__===Number.prototypeï¼Œä½†æ˜¯åŸå§‹ç±»å‹å­—é¢å€¼çš„instanceofè¿”å›éƒ½æ˜¯false */Number.MAX_VALUE instanceof Number; //falseNaN instanceof Number; //falsevar oneString= &quot;Haha&quot;;oneString instanceof String; //false/*è§£æï¼šä»¥ä¸Šéƒ½æ˜¯åŸå§‹ç±»å‹å­—é¢å€¼*/[2,3] instanceof Array; //true(&#123;a:2&#125;) instanceof Object; //true/*è§£æï¼šéåŸå§‹ç±»å‹çš„å­—é¢å€¼*/"},{"title":"JSå¯¹è±¡å±æ€§çš„å¯æšä¸¾æ€§(enumerable)","date":"2018-03-06T15:49:35.000Z","path":"knowledge/jså¯¹è±¡å±æ€§çš„å¯æšä¸¾æ€§.html","tags":[{"name":"javascript","slug":"javascript","permalink":"https://congzhou09.github.io/tags/javascript/"}],"text":"åŸºæœ¬è§„åˆ™â˜… JS å¯¹è±¡å±æ€§çš„å¯æšä¸¾æ€§å°†å½±å“æšä¸¾(enumeration)çš„ç»“æœï¼Œå¦‚æœå±æ€§çš„ enumerable ä¸º falseï¼Œæšä¸¾æ—¶å°±ä¸ä¼šå–è¿™ä¸ªå±æ€§ã€‚â˜… æšä¸¾æ–¹å¼åˆ—ä¸¾ï¼šfor...inã€Object.entries()ã€Object.keys()ã€Object.values()ã€JSON.stringify()ã€Object.assign()ã€å±•å¼€è¿ç®—ç¬¦ã€‚â˜… é€šè¿‡å¸¸è§„èµ‹å€¼æ·»åŠ çš„å±æ€§éƒ½æ˜¯å¯æšä¸¾çš„ã€å¯ä¿®æ”¹çš„ã€å¯åˆ é™¤çš„ã€‚â˜… å†…éƒ¨å±æ€§å’Œå†…éƒ¨æ–¹æ³•ï¼ˆå¦‚ constructorã€[[Prototype]]ï¼‰é»˜è®¤éƒ½æ˜¯ä¸å¯æšä¸¾çš„ã€‚ åˆ†ç±»ä¸æ¯”è¾ƒâ™‚ Object.assign() ä¸ å±•å¼€è¿ç®—ç¬¦ çš„æšä¸¾ç‰¹æ€§ä¸€è‡´ï¼Œå–å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§ï¼ŒåŒ…å« Symbol ç±»å‹å±æ€§ã€‚â™‚ ä¸‹é¢çš„æšä¸¾æ–¹å¼éƒ½ä¸åŒ…å« Symbol ç±»å‹å±æ€§ã€‚Object.getOwnPropertySymbols()ç”¨äºæšä¸¾å¯¹è±¡è‡ªèº«çš„ä»… Symbol ç±»å‹å±æ€§ã€‚â™‚ Object.entries()ã€Object.values() ä¸ Object.keys()çš„æšä¸¾ç‰¹æ€§ä¸€è‡´ã€‚â™‚ for...in ä¸ Object.keys() çš„åŒºåˆ«æ˜¯ï¼šå‰è€…åŒ…å«å¯¹è±¡ ç»§æ‰¿è‡ªåŸå‹å¯¹è±¡çš„ å¯æšä¸¾å±æ€§ï¼Œè€Œåè€…åªåŒ…æ‹¬ å¯¹è±¡è‡ªèº«çš„ å¯æšä¸¾å±æ€§ã€‚â™‚ JSON.stringify() è¯»å–å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§ï¼Œå¹¶å¿½ç•¥å…¶ä¸­ç±»å‹ä¸º Undefinedã€Functionã€Symbol çš„å±æ€§ï¼Œå¹¶å°†å±æ€§å’Œå€¼åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²ã€‚â™‚ Object.getOwnPropertyNames() è·å–å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰ï¼ˆåŒ…æ‹¬å¯æšä¸¾å’Œä¸å¯æšä¸¾ï¼‰å±æ€§çš„åç§°ã€‚ é…ç½®ä¸æ“ä½œâ™€ Object.defineProperty()ï¼ˆ1ï¼‰ç”¨äºä¸ºå¯¹è±¡æ·»åŠ æ–°å±æ€§æˆ–ä¿®æ”¹å·²æœ‰å±æ€§ã€‚ï¼ˆ2ï¼‰å‡½æ•°ç”¨æ³• Object.defineProperty(obj , prop , descriptor )ï¼Œå…¶ä¸­ obj æ˜¯å¾…æ·»åŠ æˆ–ä¿®æ”¹å±æ€§çš„å¯¹è±¡ï¼Œprop æ˜¯å¾…æ·»åŠ æˆ–ä¿®æ”¹çš„å±æ€§åç§°ï¼Œdescriptor æ˜¯ä¸€ä¸ªåŒ…å«å¯¹å±æ€§æè¿°çš„å¯¹è±¡ã€‚descriptor å¿…ç„¶æ˜¯&quot;data descriptor&quot;å’Œ&quot;access descriptor&quot;ä¸¤ç§å½¢å¼ä¸­çš„ä¸€ç§ã€‚ï¼ˆ3ï¼‰&quot;data descriptor&quot;ç‹¬æœ‰çš„å±æ€§ï¼švalueï¼ˆå±æ€§çš„å€¼ï¼Œé»˜è®¤ä¸º undefinedï¼‰ï¼Œwritableï¼ˆæ˜¯å¦å¯å†™ï¼Œé»˜è®¤ä¸º falseã€‚ä¸å½±å“å±æ€§æ˜¯å¦å¯è¢« deleteã€‚ï¼‰ï¼ˆ4ï¼‰&quot;access descriptor&quot;ç‹¬æœ‰çš„å±æ€§ï¼šgetï¼ˆå‡½æ•°è¿”å›å€¼ä½œä¸ºå±æ€§çš„å€¼ï¼Œé»˜è®¤ä¸º undefinedï¼‰å’Œ setï¼ˆé€šè¿‡è°ƒç”¨æ­¤å‡½æ•°æ”¹å˜ get å‡½æ•°çš„è¿”å›å€¼ï¼Œé»˜è®¤ä¸º undefinedï¼‰ï¼ˆ5ï¼‰&quot;data descriptor&quot;å’Œ&quot;access descriptor&quot;å…¬æœ‰çš„å±æ€§ï¼šenumerableï¼ˆå¯æšä¸¾æ€§ï¼Œé»˜è®¤ä¸º falseï¼‰ï¼Œconfigurableï¼ˆdescriptor çš„ç±»å‹æ˜¯å¦å¯å˜å¹¶ä¸”å±æ€§æ˜¯å¦å¯è¢« deleteï¼Œé»˜è®¤ä¸º falseï¼‰ã€‚ï¼ˆ6ï¼‰ä½¿ç”¨ Object.defineProperty é…ç½®å¯¹è±¡å·²æœ‰å±æ€§çš„åŒç±» descriptor æ—¶ï¼Œæ”¯æŒå¢é‡ã€‚â™€ Object.getOwnPropertyDescriptor() å’Œ Object.getOwnPropertyDescriptors() ç”¨äºè·å– descriptor çš„å†…å®¹ã€‚â™€ Object.preventExtensions() é˜»æ­¢å¯¹è±¡æ·»åŠ æ–°çš„å±æ€§ï¼Œå¯¹è±¡ä¹Ÿä¸å†èƒ½æ”¹å˜[[Prototype]]çš„æŒ‡å‘ã€‚â™€ Object.seal() åœ¨ preventExtensions çš„åŒæ—¶ï¼Œä¹Ÿä½¿å¯¹è±¡æ‰€æœ‰å·²æœ‰å±æ€§çš„ configurable ä¸º falseã€‚â™€ Object.freeze() åœ¨ preventExtensions çš„åŒæ—¶ï¼Œä¹Ÿä½¿å¯¹è±¡æ‰€æœ‰å·²æœ‰å±æ€§çš„ configurable å’Œ writable ä¸º falseã€‚ä½†é€šè¿‡&quot;access descriptor&quot;å®šä¹‰çš„å±æ€§ä»ç„¶å¯èµ‹å€¼ã€‚ å®ä¾‹ 11234567891011121314151617181920212223242526272829303132333435363738394041424344function A()&#123; this.va=1; &#125; A.prototype.vb=2; var a= new A(); Object.defineProperty(a, &quot;vc&quot;, &#123;value:3&#125;); var inArr= []; for(var para in a) &#123; inArr.push(para); &#125; console.log(Object.keys(a)); // [&quot;va&quot;] console.log(Object.getOwnPropertyNames(a)); // [&quot;va&quot;, &quot;vc&quot;] console.log(JSON.stringify(a)); // &#123;&quot;va&quot;:1&#125; console.log(inArr); // [&quot;va&quot;, &quot;vb&quot;]a[&quot;vc&quot;]= 8;console.log(a[&quot;vc&quot;]); // 3delete a[&quot;vc&quot;]; // deleteå°†è¿”å›falseconsole.log(a[&quot;vc&quot;]); // 3Object.defineProperty(a, &quot;vd&quot;, &#123;value:4, writable: true&#125;);a[&quot;vd&quot;]= 8;console.log(a[&quot;vd&quot;]); // 8delete a[&quot;vd&quot;]; // deleteå°†è¿”å›falseconsole.log(a[&quot;vd&quot;]); // 8Object.defineProperty(a, &quot;ve&quot;, &#123;value:4, configurable: true&#125;);a[&quot;ve&quot;] = 2;console.log(a[&quot;ve&quot;]); // 4Object.defineProperty(a, &quot;ve&quot;, &#123;writable:true&#125;);console.log(a[&quot;ve&quot;]); // 4a[&quot;ve&quot;] = 2;console.log(a[&quot;ve&quot;]); // 2delete a[&quot;ve&quot;]; // deleteå°†è¿”å›trueconsole.log(a[&quot;ve&quot;]); // undefined å®ä¾‹ 2123456789101112131415function Person(name)&#123; this.name = name;&#125;Person.prototype.getName = function()&#123; return this.name ;&#125;;function Stuff1(name, id)&#123; this.name = name; this.id = id;&#125;for(var fn in Person.prototype)&#123; Stuff1.prototype[fn] = Person.prototype[fn];&#125;var piupiu1 = new Stuff1(&quot;piupiu1&quot;,&quot;008&quot;);console.log(piupiu1.constructor === Stuff1);//æ‰“å°true è§£æ:Person.prototypeçš„ä¸‰ä¸ªå±æ€§(constructor, getName, [[Prototype]])ï¼Œä»…æœ‰getNameå±æ€§å¯æšä¸¾ï¼Œäºæ˜¯Stuff1.prototypeä»…ä»…ç»§æ‰¿äº†â€œgetNameâ€å±æ€§ï¼Œæ‰“å°çš„constructorä»æ˜¯è‡ªå·±çš„ã€‚"},{"title":"nginxé™åˆ¶è¯·æ±‚é¢‘ç‡","date":"2018-01-04T11:00:06.000Z","path":"practice/nginxé™åˆ¶è¯·æ±‚é¢‘ç‡.html","tags":[{"name":"nginx","slug":"nginx","permalink":"https://congzhou09.github.io/tags/nginx/"}],"text":"nginxå¯ä»¥é€šè¿‡ngx_http_limit_req_moduleå’Œngx_http_limit_conn_moduleè¿™ä¸¤ä¸ªæ¨¡å—çš„é…ç½®æ¥é™åˆ¶è¯·æ±‚é¢‘ç‡ã€‚ ngx_http_limit_req_moduleæ¨¡å—â—‡ngx_http_limit_req_moduleé’ˆå¯¹è‡ªå®šä¹‰çš„keyæ¥é™åˆ¶è¯·æ±‚çš„å¤„ç†é€Ÿåº¦ï¼Œå°¤å…¶æ˜¯æ¥æºäºåŒä¸€ä¸ªIPåœ°å€çš„è¯·æ±‚ï¼Œé€Ÿåº¦é™åˆ¶é€šè¿‡__æ¼æ¡¶ç®—æ³•(leaky bucket)__å®ç°ã€‚â—‡ä¸»è¦ä½¿ç”¨limit_req_zoneå’Œlimit_reqæŒ‡ä»¤ã€‚ é…ç½®å®ä¾‹: 1234567891011http &#123; limit_req_zone $binary_remote_addr zone=gameend:50m rate=10r/s; ... server &#123; ... location /api/ &#123; limit_req zone=gameend burst=50 nodelay; limit_req_status 503; #é»˜è®¤503ï¼Œæ­¤è¡Œå¯çœç•¥ &#125; &#125;&#125; â˜…â€œlimit_req_zoneâ€é‚£ä¸€è¡Œå®šä¹‰äº†åç§°ä¸ºâ€œgameendâ€çš„åŒºåŸŸï¼ˆåŒºåŸŸå¯å®šä¹‰å¤šä¸ªï¼Œåœ¨ä¹‹åçš„å¼•ç”¨å¤„ç”Ÿæ•ˆï¼‰ï¼Œä½¿ç”¨â€œ$binary_remote_addrâ€é”®è¡¨ç¤ºå¯¹å„ä¸ªä¸åŒçš„IPèµ·ä½œç”¨ï¼Œåˆ†é…50Må…±äº«å­˜å‚¨ç©ºé—´ç”¨æ¥ä¿å­˜é”®çš„çŠ¶æ€å‚æ•°ï¼Œå¹³å‡å¤„ç†çš„è¯·æ±‚é¢‘ç‡ä¸è¶…è¿‡æ¯ç§’10æ¬¡ï¼ˆrate&#x3D;10r&#x2F;sï¼‰ã€‚è¿™é‡Œä½¿ç”¨â€œ$binary_remote_addrâ€è€Œä¸æ˜¯â€œ$remote_addrâ€æ˜¯å› ä¸ºä½¿ç”¨â€œ$binary_remote_addrâ€æ‰€å ç”¨å­˜å‚¨ç©ºé—´æ˜¯å›ºå®šçš„ï¼ˆçŠ¶æ€å‚æ•°åœ¨32ä½æœºå’Œ64ä½æœºä¸Šåˆ†åˆ«å ç”¨64å­—èŠ‚å’Œ128å­—èŠ‚ï¼Œäºæ˜¯1Mç©ºé—´åœ¨32ä½æœºå’Œ64ä½æœºä¸Šåˆ†åˆ«èƒ½å­˜å‚¨16000ä¸ªå’Œ8000ä¸ªçŠ¶æ€ã€‚å½“åŸŸçš„å­˜å‚¨ç©ºé—´è€—å°½ï¼Œå¯¹äºåç»­æ‰€æœ‰è¯·æ±‚ï¼ŒæœåŠ¡å™¨éƒ½ä¼šè¿”å› 503ï¼›â˜…â€œlimit_reqâ€é‚£ä¸€è¡Œå¼•ç”¨ä¸Šé¢å®šä¹‰çš„åŒºåŸŸï¼Œå¯¹è¯·æ±‚è·¯å¾„&quot;&#x2F;api&#x2F;&quot;ç”Ÿæ•ˆï¼ŒåŒæ—¶é€šè¿‡â€œburstâ€å…è®¸å»¶æ—¶å¤„ç†ä¸€å®šæ•°é‡çš„è¯·æ±‚ï¼ˆbursté»˜è®¤å€¼ä¸º0ï¼‰ï¼Œå½“è¯·æ±‚é€Ÿåº¦è¶…è¿‡æ¯ç§’10æ¬¡ä½†è¶…è¿‡çš„è¯·æ±‚æ•°é‡åˆæ²¡è¶…è¿‡50ï¼ˆburst&#x3D;50ï¼‰æ—¶ï¼Œä¼šå»¶è¿Ÿå¤„ç†è¯·æ±‚ï¼Œè€Œä¸æ˜¯è¢«ç«‹å³è¿”å›503ï¼ˆlimit_req_status 503ï¼‰ï¼Œå¢åŠ â€œnodelayâ€å‚æ•°åˆ™ä»¥ä¸Šæƒ…å½¢ä¸‹çš„è¯·æ±‚ç«‹å³è¢«å¤„ç†ï¼Œä¸ä¼šè¢«å»¶è¿Ÿï¼› ngx_http_limit_conn_moduleæ¨¡å—â—‡ngx_http_limit_conn_moduleé’ˆå¯¹è‡ªå®šä¹‰çš„keyæ¥é™åˆ¶è¿æ¥æ•°ï¼Œå°¤å…¶æ˜¯æ¥è‡ªäºåŒä¸€ä¸ªipåœ°å€çš„è¿æ¥ï¼Œæ­¤å¤„ä¸€ä¸ªè¿æ¥çš„å®šä¹‰æ˜¯æœ‰ä¸€ä¸ªæœåŠ¡å™¨æ­£åœ¨å¤„ç†çš„è¯·æ±‚å¹¶ä¸”è¯·æ±‚å¤´å·²ç»è¢«è¯»å–ã€‚â—‡ä¸»è¦ä½¿ç”¨limit_conn_zoneå’Œlimit_connæŒ‡ä»¤ã€‚ é…ç½®å®ä¾‹: 12345678910http &#123; limit_conn_zone $binary_remote_addr zone=gameend:10m; ... server &#123; ... location /download/ &#123; limit_conn gameend 1; &#125; &#125;&#125; â˜…â€œlimit_conn_zone â€é‚£ä¸€è¡Œå®šä¹‰äº†åç§°ä¸ºâ€œgameendâ€çš„åŒºåŸŸï¼ˆåŒºåŸŸå¯å®šä¹‰å¤šä¸ªï¼Œåœ¨ä¹‹åçš„å¼•ç”¨å¤„ç”Ÿæ•ˆï¼‰,åˆ†é…10Må…±äº«å­˜å‚¨ç©ºé—´ç”¨æ¥ä¿å­˜é”®çš„çŠ¶æ€å‚æ•°ï¼Œå½“åŸŸçš„å­˜å‚¨ç©ºé—´è€—å°½ï¼Œå¯¹äºåç»­æ‰€æœ‰è¯·æ±‚ï¼ŒæœåŠ¡å™¨éƒ½ä¼šè¿”å› 503ï¼›â˜…â€œlimit_connâ€é‚£ä¸€è¡Œå¼•ç”¨ä¸Šé¢å®šä¹‰çš„åŒºåŸŸï¼Œå¯¹è¯·æ±‚è·¯å¾„&quot;&#x2F;download&#x2F;&quot;ç”Ÿæ•ˆï¼ŒåŒæ—¶å°†æœ€å¤§å…è®¸è¿æ¥æ•°è®¾ç½®ä¸º1ï¼Œå½“è¿æ¥æ•°è¶…è¿‡1ï¼ŒæœåŠ¡å™¨è¿”å› 503é”™è¯¯ï¼› å‚è€ƒ: [å®˜æ–¹æ–‡æ¡£](http://nginx.org/en/docs/)"},{"title":"JSçš„é—­åŒ…","date":"2017-11-13T09:11:50.000Z","path":"knowledge/jsçš„é—­åŒ….html","tags":[{"name":"javascript","slug":"javascript","permalink":"https://congzhou09.github.io/tags/javascript/"}],"text":"é—­åŒ…çš„å®šä¹‰â—‹ ä»æ¦‚å¿µä¸Šè®²ï¼Œé—­åŒ…æ˜¯â€œåŒ…å«ä¸Šå±‚ä½œç”¨åŸŸå˜é‡çš„å‡½æ•°â€ä¸â€œå‡½æ•°ç›¸å…³å¼•ç”¨ç¯å¢ƒâ€ä¸¤è€…ç»„æˆçš„å®ä½“ã€‚å…¶ä¸­çš„â€œå‡½æ•°ç›¸å…³å¼•ç”¨ç¯å¢ƒâ€å°±æ˜¯å‡½æ•°çš„è¯æ³•ç¯å¢ƒé“¾ï¼Œæ˜¯æ‰€æœ‰å‡½æ•°è¢«æ‰§è¡Œå‰éƒ½ä¼šè¢«åˆ›å»ºçš„ã€‚å› æ­¤åœ¨å¹¿ä¹‰ä¸Šåªè¦å‡½æ•°å†…éƒ¨å¼•ç”¨äº†å¤–éƒ¨å˜é‡å°±æ„æˆé—­åŒ…ã€‚è¯æ³•ç¯å¢ƒç›¸å…³å†…å®¹æ•´ç†åœ¨è¿™ç¯‡ã€‚â—‹ ç»å¸¸è®¨è®ºçš„é—­åŒ…å‡ºç°åœ¨â€œå±€éƒ¨ä½œç”¨åŸŸä¸­å†…åµŒå‡½æ•°â€çš„åœºæ™¯ï¼Œä¸”åŒæ—¶æ»¡è¶³ä¸¤ä¸ªè¦ç‚¹ï¼šï¼ˆ1ï¼‰å†…åµŒå‡½æ•°å¼•ç”¨äº†ä¸Šå±‚ä½œç”¨åŸŸçš„å˜é‡ï¼ˆ2ï¼‰å†…åµŒå‡½æ•°è¢«ä¼ é€’åˆ°æ‰€åœ¨ä½œç”¨åŸŸçš„å¤–é¢â—‹ å¯¹äºå‡½æ•°ä½œç”¨åŸŸæ„æˆçš„å±€éƒ¨ä½œç”¨åŸŸæ¥è¯´ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°å†…åµŒå‡½æ•°çš„åœºæ™¯ï¼Œå½“å†…åµŒå‡½æ•°å¼•ç”¨äº†å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œå†…åµŒå‡½æ•°åˆé€šè¿‡ return æˆ–èµ‹å€¼æ–¹å¼ä¼ é€’åˆ°å¤–é¢ï¼Œå°±å¯ä»¥è¾¾åˆ°â€œå¤–éƒ¨å‡½æ•°æ‰§è¡Œç»“æŸåä»å¯è®¿é—®å¤–éƒ¨å‡½æ•°ä½œç”¨åŸŸå†…å˜é‡â€çš„æ•ˆæœï¼Œå¦‚æ­¤å°±æ„æˆäº†ä¸€ä¸ªé—­åŒ…ã€‚â—‹ åœ¨å—çº§ä½œç”¨åŸŸä¸­çš„å†…åµŒå‡½æ•°ï¼Œä½¿ç”¨åŒæ ·æ€è·¯ä¹Ÿå¯ä»¥æ„æˆé—­åŒ…ï¼Œå¦‚ä¸‹ä¾‹ï¼š 12345678910var things = &#123;&#125;;for (let i = 0; i &lt; 3; i++) &#123; things[&#x27;fun&#x27; + i] = function() &#123; console.log(i); &#125;;&#125;things[&#x27;fun0&#x27;](); // 0things[&#x27;fun1&#x27;](); // 1things[&#x27;fun2&#x27;](); // 2 â˜†è§£æï¼šæ ¹æ® MDN çš„è¯´æ˜ï¼Œforæ‹¬å·ä¸­ä½¿ç”¨varå£°æ˜çš„å˜é‡å­˜åœ¨äºforå¾ªç¯ä½“å¤–é¢ï¼Œè€Œä½¿ç”¨letå£°æ˜çš„å˜é‡å­˜åœ¨äºforå¾ªç¯ä½“ä¹‹å†…çš„å—çº§ä½œç”¨åŸŸã€‚ é—­åŒ…çš„ç”¨é€”â—† ä»å¤–éƒ¨è®¿é—®å±€éƒ¨ä½œç”¨åŸŸå†…çš„å†…å®¹ã€‚â—† å°†å±€éƒ¨å†…å®¹ä¿æŒåœ¨å†…å­˜ä¸­ã€‚ ç†è§£å®ä¾‹å®ä¾‹ 112345678function f1()&#123; var f1v = 2; return function()&#123; return f1v; &#125;&#125;var getF1vFun = f1();console.log(getF1vFun()); // æ‰“å°f1vçš„å€¼2 â˜†è¯´æ˜ï¼šâ€œå‡½æ•°å†…åµŒå‡½æ•°â€çš„ç»å…¸åœºæ™¯ã€‚å½“å‡½æ•°f1æ‰§è¡Œå®Œæ¯•ï¼Œå…¶ä¸­è¢«é—­åŒ…å¼•ç”¨çš„å±€éƒ¨å˜é‡f1vä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ã€‚ å®ä¾‹ 212345678var oneArr=[1,2,3];for(var i=0;i&lt;oneArr.length;i++)&#123; setTimeout(function()&#123; var oneElem= oneArr[i]; console.log(oneElem); &#125;, 1000*i); // 3ç§’å†…æ¯éš”1ç§’æ‰“å°ä¸€æ¬¡undefined&#125; â˜†è§£æï¼šä¼ å…¥setTimeoutçš„å‡½æ•°ä¸­å¼•ç”¨äº†å¤–éƒ¨å˜é‡iæ„æˆå¹¿ä¹‰é—­åŒ…ï¼Œä½†varå£°æ˜çš„iå˜é‡å­˜åœ¨äºå¾ªç¯ä½“å¤–é¢çš„å…¨å±€ä½œç”¨åŸŸï¼Œé—­åŒ…ä¸­ä¿ç•™çš„iä¹Ÿæ˜¯å…¨å±€ä½œç”¨åŸŸä¸­çš„å˜é‡iï¼ŒsetTimeoutçš„å›è°ƒå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œiå€¼å·²ç»æ˜¯forå¾ªç¯æ‰§è¡Œå®Œæ¯•åçš„å€¼3ï¼Œå°†æ‰“å°ä¸‰æ¬¡oneArr[3]ã€‚ å®ä¾‹ 31234567891011var oneArr=[1,2,3];for(var i=0;i&lt;oneArr.length;i++)&#123; setTimeout((function(index)&#123; return function()&#123; var oneElem= oneArr[index]; console.log(oneElem); &#125;; &#125;)(i), 1000*i); // 3ç§’å†…æ¯éš”1ç§’ä¾æ¬¡æ‰“å°1,2,3&#125; â˜†è§£æï¼šåœ¨ä¸ºsetTimeoutä¼ å…¥å›è°ƒå‡½æ•°çš„ä½ç½®ï¼Œé€šè¿‡æ„é€ â€œå‡½æ•°å†…åµŒå‡½æ•°çš„é—­åŒ…â€å°†å±€éƒ¨ä½œç”¨åŸŸå‚æ•°indexä¿æŒåœ¨äº†å†…å­˜ä¸­ã€‚ å®ä¾‹ 412345678var oneArr=[1,2,3];for(let i=0;i&lt;oneArr.length;i++)&#123; setTimeout(function()&#123; var oneElem= oneArr[i]; console.log(oneElem); &#125;, 1000*i); // 3ç§’å†…æ¯éš”1ç§’ä¾æ¬¡æ‰“å°1,2,3&#125; â˜†è§£æï¼šâ€œå—çº§ä½œç”¨åŸŸå†…åµŒå‡½æ•°çš„é—­åŒ…â€åœºæ™¯ï¼Œå†…åµŒå‡½æ•°å¼•ç”¨å±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡iï¼Œåˆå°†å†…åµŒå‡½æ•°ä»¥ä¼ å…¥setTimeoutæ³¨å†Œå›è°ƒå‡½æ•°çš„æ–¹å¼ä¼ å‡ºã€‚"},{"title":"JSçš„ä½œç”¨åŸŸä¸ä¸Šä¸‹æ–‡ä¸æ‰§è¡Œä¸Šä¸‹æ–‡","date":"2017-11-12T12:02:56.000Z","path":"knowledge/jsçš„ä½œç”¨åŸŸä¸ä¸Šä¸‹æ–‡ä¸æ‰§è¡Œä¸Šä¸‹æ–‡.html","tags":[{"name":"javascript","slug":"javascript","permalink":"https://congzhou09.github.io/tags/javascript/"}],"text":"ä½œç”¨åŸŸâ—‹ ä½œç”¨åŸŸ(scope)æ˜¯ä»£ç å±‚é¢çš„æ¦‚å¿µï¼Œæ˜¯ä»£ç è¢«åˆ’åˆ†æˆçš„ä¸€ä¸ªä¸ªåŒºåŸŸï¼Œç”¨æ¥çº¦å®šä½äºä¸åŒåŒºåŸŸå˜é‡çš„å¯è®¿é—®ç‰¹æ€§ã€‚æ ¹æ®æ‰€åœ¨ä½ç½®ï¼Œä½œç”¨åŸŸå¯åˆ†ä¸ºå…¨å±€ä½œç”¨åŸŸå’Œå±€éƒ¨ä½œç”¨åŸŸï¼ˆå¦‚å‡½æ•°ä½œç”¨åŸŸã€å—çº§ä½œç”¨åŸŸï¼‰ã€‚â—‹ å—çº§ä½œç”¨åŸŸé€šè¿‡åœ¨{}é‡Œä½¿ç”¨ let æˆ– const å£°æ˜å˜é‡å®ç°ã€‚â—‹ å‡½æ•°ä½œç”¨åŸŸé€šè¿‡å‡½æ•°ä½“åˆ’åˆ†ã€‚â—‹ å…¨å±€ä½œç”¨åŸŸæ˜¯ä¸åœ¨ä»»ä½•å‡½æ•°ä½œç”¨åŸŸæˆ–å—çº§ä½œç”¨åŸŸä¸­çš„åŒºåŸŸã€‚ ä½œç”¨åŸŸé“¾â— ç”±äºå—å’Œå‡½æ•°ä½“å¯ä»¥åµŒå¥—ï¼Œä½¿ä½œç”¨åŸŸä¹Ÿå¯ä»¥å­˜åœ¨ä¸Šä¸‹å±‚åµŒå¥—å…³ç³»ï¼Œä¸Šä¸‹å±‚å…³ç³»å…·æœ‰ç§°ä¸ºâ€œä½œç”¨åŸŸé“¾(scope chain)â€çš„æœºåˆ¶ã€‚JS çº¦å®šä½œç”¨åŸŸé“¾æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼šï¼ˆ1ï¼‰åœ¨æ¯ä¸ªå±€éƒ¨ä½œç”¨åŸŸå†…å¯ä»¥å‘ä¸Šè®¿é—®ä¸Šå±‚å±€éƒ¨ä½œç”¨åŸŸç›´åˆ°å…¨å±€ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œä½†ä¸èƒ½å‘ä¸‹è®¿é—®åµŒå¥—å‡½æ•°æˆ–åµŒå¥—å—å†…çš„å˜é‡ã€‚ï¼ˆ2ï¼‰è‹¥åœ¨å±€éƒ¨ä½œç”¨åŸŸä½¿ç”¨ä¸€ä¸ªå˜é‡åœ¨å±€éƒ¨ä¸å­˜åœ¨ï¼Œåˆ™ä¸æ–­å‘ä¸Šå±‚æŸ¥æ‰¾ç›´è‡³æ‰¾åˆ°æˆ–åœ¨å…¨å±€ä½œç”¨åŸŸåˆ›å»ºï¼ˆéä¸¥æ ¼æ¨¡å¼ä¸”æ‰¾ä¸åˆ°æ—¶ï¼‰ã€‚ï¼ˆ3ï¼‰è‹¥åœ¨å±€éƒ¨ä½œç”¨åŸŸå£°æ˜ä¸€ä¸ªä¸ä¸Šå±‚å˜é‡åŒåçš„å˜é‡ï¼Œåˆ™åœ¨å±€éƒ¨ä½œç”¨åŸŸå†…å˜é‡å€¼ä¸ºä½œç”¨åŸŸå†…çš„å€¼ï¼Œè€Œåœ¨ä¸Šå±‚ä½œç”¨åŸŸåŒåå˜é‡ä»æ˜¯ä¸Šå±‚ä½œç”¨åŸŸå†…çš„å€¼ã€‚â— ç»ƒä¹ ï¼š 123456789var value = 1;function foo() &#123; console.log(value);// foo()å‡½æ•°å£°æ˜åœ¨å…¨å±€ä½œç”¨åŸŸï¼Œå‘ä¸ŠæŸ¥æ‰¾åˆ°valueåœ¨å…¨å±€ä½œç”¨åŸŸ&#125;function bar() &#123; var value = 2; // å±€éƒ¨åŒåvalueå˜é‡ï¼Œä¸å½±å“å…¨å±€valueå˜é‡å€¼ foo(); // å‘ä¸ŠæŸ¥æ‰¾åˆ°foo()å‡½æ•°åœ¨å…¨å±€ä½œç”¨åŸŸ&#125;bar(); // æ‰“å° 1 â— Chrome å¼€å‘è€…å·¥å…·å¯ä»¥æŸ¥çœ‹ä½œç”¨åŸŸé“¾ã€‚ä»¥ä¸Šè¿°â€œç»ƒä¹ â€ä¸ºä¾‹ï¼Œå½“è°ƒç”¨æ ˆ(Call Stack)æ‰§è¡Œåˆ° foo()å‡½æ•°å†…éƒ¨æ—¶ï¼Œèƒ½çœ‹åˆ° foo()çš„ä½œç”¨åŸŸé“¾å¦‚ä¸‹å›¾ 1ã€‚å¦‚æœå°† foo()çš„å®šä¹‰ç§»åŠ¨åœ¨ bar()å†…éƒ¨ï¼Œä½œç”¨åŸŸé“¾å°†å˜æˆå›¾ 2 çš„æ ·å­ã€‚ å›¾ 1 å›¾ 2 è¯æ³•ç¯å¢ƒâ—† è¯æ³•ç¯å¢ƒ(lexical environment)æœºåˆ¶å®ç°äº†ä½œç”¨åŸŸçš„ç‰¹æ€§ã€‚â—† æ¯ä¸ªä½œç”¨åŸŸéƒ½å¯¹åº”ä¸€ä¸ªè¯æ³•ç¯å¢ƒï¼Œè¯æ³•ç¯å¢ƒåœ¨ç›¸åº”ä½œç”¨åŸŸçš„ä»£ç è¢«è¯„ä¼°(evalute)çš„æ—¶å€™å°±è¢«åˆ›å»ºï¼Œå°±æ˜¯ä¸‹æ–‡ä¼šæåˆ°çš„â€œæ‰§è¡Œä¸Šä¸‹æ–‡çš„åˆ›å»ºé˜¶æ®µâ€ã€‚â—† è¯æ³•ç¯å¢ƒä¸­é™¤äº†å­˜å‚¨å½“å‰ä½œç”¨åŸŸå£°æ˜çš„å˜é‡å’Œå‡½æ•°ï¼Œè¿˜æœ‰ä¸ªâ€œå¤–éƒ¨è¯æ³•ç¯å¢ƒâ€å–å€¼ä¸ºä¸Šå±‚ä½œç”¨åŸŸçš„è¯æ³•ç¯å¢ƒçš„å¼•ç”¨ï¼Œç”±æ­¤å®ç°ä½œç”¨åŸŸé“¾çš„å»ºç«‹ã€‚ æ‰§è¡Œä¸Šä¸‹æ–‡â–¡ æ‰§è¡Œä¸Šä¸‹æ–‡(execution context)æ˜¯ JS ä»£ç æ‰§è¡Œæ¶‰åŠçš„çŠ¶æ€ä¿¡æ¯çš„ç»Ÿç§°ã€‚â–¡ æ ¹æ®ä»£ç æ®µçš„ä½ç½®ï¼Œå¯å°†æ‰§è¡Œä¸Šä¸‹æ–‡å¯åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼šï¼ˆ1ï¼‰å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œåœ¨æ‰€æœ‰ä»£ç è¿˜æœªæ‰§è¡Œå‰åˆ›å»ºï¼ˆ2ï¼‰å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå‡½æ•°è°ƒç”¨æ—¶åˆ›å»ºï¼ˆ3ï¼‰eval æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ‰§è¡Œ eval è¯­å¥æ—¶åˆ›å»ºã€‚â–¡ â€œå—çº§æ‰§è¡Œä¸Šä¸‹æ–‡â€æ˜¯ä¸å­˜åœ¨çš„(stackoverflow é—®ç­”)ï¼Œæ‰§è¡Œå—çº§ä»£ç æ—¶ä»ç„¶åœ¨å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¿›è¡Œã€‚â–¡ æ‰€æœ‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡å­˜å‚¨åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ(execution context stack)ï¼Œä¹Ÿç§°æ‰§è¡Œæ ˆï¼Œä¹Ÿç§°ä¸ºè°ƒç”¨æ ˆã€‚éšç€ä»£ç ä»å…¨å±€å…¥å£æ‰§è¡Œåˆ°è°ƒç”¨å‡½æ•°åˆ°å‡½æ•°è¿”å›ï¼Œæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¹Ÿä¸æ–­è¢«åˆ›å»ºã€å…¥æ ˆã€åˆ‡æ¢æ‰§è¡Œã€å‡ºæ ˆã€é”€æ¯ï¼Œå½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç æ®µå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡æ°¸è¿œåœ¨æ ˆé¡¶ã€‚æ­¤è¿‡ç¨‹å¯ä»¥å€ŸåŠ©ä»£ç æ‰§è¡Œå¯è§†åŒ–å·¥å…·ç›´è§‚äº†è§£ã€‚â–¡ æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½åŒ…å«åˆ›å»ºé˜¶æ®µ(creation phase)ä¸æ‰§è¡Œé˜¶æ®µ(execution phase)ï¼Œæ‰§è¡Œé˜¶æ®µæ‰çœŸæ­£æ‰§è¡Œä»£ç ã€‚â–¡ åˆ›å»ºé˜¶æ®µä¼šåšå¦‚ä¸‹äº‹æƒ…ï¼šï¼ˆ1ï¼‰åˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œåˆ›å»ºè¯æ³•ç¯å¢ƒå¹¶ä¸æ‰§è¡Œä¸Šä¸‹æ–‡å…³è”ã€‚ï¼ˆ2ï¼‰ä»£ç æ®µåŒºåŸŸä¸­å£°æ˜çš„å˜é‡ï¼Œä¸ºå…¶åˆ†é…ç©ºé—´ï¼Œå¦‚æœæ˜¯ var å£°æ˜åˆ™èµ‹å€¼ undefinedï¼Œå¦åˆ™ä¸èµ‹å€¼ã€‚ï¼ˆ3ï¼‰ä»£ç æ®µåŒºåŸŸä¸­å£°æ˜çš„å‡½æ•°ï¼Œå°†å…¶è½½å…¥å†…å­˜ã€‚ï¼ˆ4ï¼‰å°†å˜é‡å’Œå‡½æ•°è®°å½•åˆ°è¯æ³•ç¯å¢ƒã€‚â–¡ åˆ›å»ºé˜¶æ®µå¯¹å£°æ˜å˜é‡ä¸å‡½æ•°çš„å¤„ç†å®ç°äº†â€œå£°æ˜æå‰(hoisting)â€ã€‚let å’Œ const å£°æ˜çš„å˜é‡ä¹Ÿå®ç°äº†å£°æ˜æå‰ï¼Œåªæ˜¯ä¸èƒ½æå‰ä½¿ç”¨ï¼Œè¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡æå‰è®¿é—®å˜é‡äº§ç”Ÿçš„æŠ¥é”™ä¿¡æ¯å·®å¼‚éªŒè¯ã€‚â–¡ ç»ƒä¹ ï¼š 123456var v = &quot;yoyo&quot;;(function()&#123; console.log(v); // è¾“å‡ºâ€œundefinedâ€ï¼Œå±€éƒ¨å˜é‡vå£°æ˜æå‰ï¼Œä¸ä¸Šå±‚åŒåå˜é‡ä½¿ç”¨å±€éƒ¨å€¼ var v = &quot;check now&quot;; console.log(v); // è¾“å‡ºâ€œcheck nowâ€&#125;)(); â–¡ å¦ä¸€ä¸ªä»£ç æ‰§è¡Œå¯è§†åŒ–å·¥å…·(æ”¯æŒ ES6)ï¼Œæ”¯æŒ Pythonã€C ç­‰å…¶ä»–è¯­è¨€ã€‚ ä¸Šä¸‹æ–‡â–  ä¸Šä¸‹æ–‡(context)é€šå¸¸è¯´çš„å°±æ˜¯ this ã€‚â–  this å­˜åœ¨äºæ‰€æœ‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œthis çš„å–å€¼å–å†³äºå…¶æ‰€å¤„çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå…·ä½“è§„åˆ™å¦‚ä¸‹ï¼šï¼ˆ1ï¼‰åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œthis å€¼æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆé strict æ¨¡å¼ä¸‹ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒå°±æ˜¯ window ï¼‰ã€‚ï¼ˆ2ï¼‰åœ¨å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œthis å€¼æŒ‡å‘è°ƒç”¨å½“å‰å‡½æ•°çš„å¯¹è±¡ã€‚ï¼ˆ3ï¼‰eval æ‰§è¡Œä¸Šä¸‹æ–‡çš„ this å€¼è¿˜ä¸æ˜¯ direct eval è¿˜æ˜¯ indirect evalæœ‰å…³ï¼Œå¯¹äº direct evalï¼Œthis å€¼ä¸ eval è¯­å¥æ‰€åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡çš„ this ä¸€è‡´ï¼›å¯¹äº indirect evalï¼Œç­‰åŒäº eval è¯­å¥åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ­¤æ—¶ this å€¼æŒ‡å‘å…¨å±€å¯¹è±¡ã€‚â–  ç»ƒä¹  1 123456789101112131415161718192021222324252627282930var a = 20;var obj = &#123; a: 10, c: this.a + 20, fn: function () &#123; return this.a; &#125;&#125;class A &#123; constructor() &#123; this.a = 10; &#125; fn() &#123; return this.a; &#125; fn2 = () =&gt; &#123; return this.a; &#125;&#125;var objA = new A();console.log(obj.c); // 40ï¼Œcå±æ€§çš„å€¼åœ¨æ‰§è¡Œå®Œèµ‹å€¼è¯­å¥ä¹‹åå°±ç¡®å®šäº†ï¼Œè®¡ç®—å…¶å€¼æ—¶å¤„äºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡console.log(obj.fn()); // 10var oneFun = obj.fn; // oneFunçš„å€¼æ˜¯obj.fnçš„å‡½æ•°ä½“console.log(oneFun()); // 20oneFun = objA.fn;console.log(oneFun()); // Uncaught TypeError: Cannot read properties of undefinedã€‚oneFun = objA.fn2;console.log(oneFun()); // 10 å…¶ä¸­â€œobjA.fnâ€åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ—¶ this å–å€¼ä¸º undefinedï¼ŒåŸå› æ˜¯ class çš„ body å¼ºåˆ¶åœ¨ strict æ¨¡å¼ä¸‹æ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æ˜¾å¼æŒ‡å®š&quot;use strict&quot;ã€‚ â–  ç»ƒä¹  2 1234567891011121314var value = 1;var foo = &#123; value: 2, bar: function() &#123; return this.value; &#125;,&#125;;/* è¡¨è¾¾å¼ç»“æœæ˜¯foo.barçš„å‡½æ•°ä½“ï¼Œå‡½æ•°ä½“åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡æ‰§è¡Œ */console.log((foo.bar = foo.bar)()); // 1console.log((false || foo.bar)()); // 1console.log((foo.bar, foo.bar)()); // 1 å‚è€ƒæ–‡çŒ®â—‡ JavaScript Execution Context and Hoistingâ—‡ Understanding Execution Context in JavaScriptâ—‡ Understanding Scope and Context in JavaScriptâ—‡ What is the Difference Between Scope and Context in JavaScriptâ—‡ Javascript: Execution Context and Call Stackâ—‡ ECMA262 æ ‡å‡†â—‡ (1, eval)(&#39;this&#39;) vs eval(&#39;this&#39;) in JavaScript"}]