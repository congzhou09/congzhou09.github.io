<!DOCTYPE html><html><head><meta charset="utf-8"><title>React Native工程增加Expo支持 | Congzhou&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="React Native,Expo"><meta name="description" content="行动前的考虑◆原有的React Native工程是在Windows下安装完Android开发环境后使用命令&quot;react-native init&quot;生成的，看到存储Android SDK所需的30G+的硬盘和Android模拟器运行所需的8G+内存预算，想在自己的便携机上搞一套相同环境负担实在太重； ◆看到Expo时被其简练的开发流程所吸引，而环境轻量太多了，也同样支持代码修改保存"><meta property="og:type" content="article"><meta property="og:title" content="React Native工程增加Expo支持"><meta property="og:url" content="https://congzhou09.github.io/practice/React-Native%E5%B7%A5%E7%A8%8B%E5%A2%9E%E5%8A%A0Expo%E6%94%AF%E6%8C%81.html"><meta property="og:site_name" content="Congzhou&#39;s Blog"><meta property="og:description" content="行动前的考虑◆原有的React Native工程是在Windows下安装完Android开发环境后使用命令&quot;react-native init&quot;生成的，看到存储Android SDK所需的30G+的硬盘和Android模拟器运行所需的8G+内存预算，想在自己的便携机上搞一套相同环境负担实在太重； ◆看到Expo时被其简练的开发流程所吸引，而环境轻量太多了，也同样支持代码修改保存"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://congzhou09.github.io/practice/React-Native%E5%B7%A5%E7%A8%8B%E5%A2%9E%E5%8A%A0Expo%E6%94%AF%E6%8C%81/splash_screen_error.png"><meta property="article:published_time" content="2019-08-14T12:21:11.000Z"><meta property="article:modified_time" content="2025-03-19T13:37:34.640Z"><meta property="article:author" content="Congzhou"><meta property="article:tag" content="React Native"><meta property="article:tag" content="Expo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://congzhou09.github.io/practice/React-Native%E5%B7%A5%E7%A8%8B%E5%A2%9E%E5%8A%A0Expo%E6%94%AF%E6%8C%81/splash_screen_error.png"><link rel="alternate" type="application/atom+xml" title="Congzhou&#39;s Blog" href="/atom.xml"><link rel="shortcut icon" href="/tiger.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/lib/fancybox.css"><script>window.lazyScripts=[]</script><script src="/js/av-min.js"></script><script src="/js/util.min.js"></script><script src="/js/fancybox.umd.js"></script><meta name="generator" content="Hexo 7.2.0"></head><body><script>var VISIT_INFO={};defineObserveKey(VISIT_INFO,"totalPV"),defineObserveKey(VISIT_INFO,"curPagePV"),defineObserveKey(VISIT_INFO,"totalUV")</script><div id="loading" class="active"></div><aside id="menu"><div class="inner flex-row-vertical"><div class="brand-wrap"><img class="brand-wrap-img" finalsrc="/img/brand.jpg" src="/img/brand-loading.jpg" alt="brandBackground"><div class="brand"><a href="/" class="avatar waves-effect waves-circle waves-light"><img finalsrc="/img/avatar.jpg" src="/img/avatar-loading.jpg" style="width:100%" alt="avatar"></a><hgroup class="introduce"><div class="nickname" style="margin-left:5px">Congzhou</div><div class="mail"><span class="iconfont icon-youxiang" style="vertical-align:middle"></span><span>congzhou09@gmail.com</span></div><div class="github-link"><a target="_blank" href="https://github.com/congzhou09"><span class="iconfont icon-ic-github"></span>GitHub主页</a></div></hgroup><div class="hint-container"></div></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li class="waves-block waves-effect"><a href="/"><i class="iconfont icon icon-home" style="font-size:24px"></i>主页</a></li><li class="waves-block waves-effect"><a href="/archives"><i class="iconfont icon icon-archive" style="font-size:24px"></i>归档</a></li><li class="waves-block waves-effect"><a href="/tags"><i class="iconfont icon icon-tags" style="font-size:24px"></i>标签</a></li><li class="waves-block waves-effect"><a href="/categories"><i class="iconfont icon icon-categoryselected" style="font-size:24px"></i>分类</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" style="text-decoration:none" id="menu-toggle"><span class="iconfont icon-menu" style="font-size:21px;font-weight:700"></span></a><div class="flex-col header-title ellipsis">React Native工程增加Expo支持</div><div class="search-wrap" id="search-wrap"><input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" style="text-decoration:none" id="search"><span class="iconfont icon-search" style="font-size:24px;font-weight:700"></span></a></div></div></header><header class="content-header post-header"><div class="container fade-scale"><h2 class="title">React Native工程增加Expo支持</h2><h5 class="subtitle"><time datetime="2019-08-14T12:21:11.000Z" itemprop="datePublished" class="page-time">2019-08-14</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/practice/">实践总结</a></li></ul></h5></div></header><div class="container body-wrap"><aside class="post-widget"><nav class="post-toc-wrap" id="post-toc"><h4>目录</h4><ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%A1%8C%E5%8A%A8%E5%89%8D%E7%9A%84%E8%80%83%E8%99%91"><span class="post-toc-number">1.</span><span class="post-toc-text">行动前的考虑</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B0%9D%E8%AF%95%E5%9F%BA%E7%A1%80%E7%9A%84React-Native%E9%A1%B9%E7%9B%AE"><span class="post-toc-number">2.</span><span class="post-toc-text">尝试基础的React Native项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B0%9D%E8%AF%95%E7%9C%9F%E5%AE%9E%E7%9A%84React-Native%E9%A1%B9%E7%9B%AE"><span class="post-toc-number">3.</span><span class="post-toc-text">尝试真实的React Native项目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="post-toc-number">4.</span><span class="post-toc-text">结论</span></a></li></ol></nav></aside><article id="post-React-Native工程增加Expo支持" class="post-article article-type-post fade" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title">React Native工程增加Expo支持</h1><div class="post-meta"><time class="post-time" title="2019-08-14 20:21:11" datetime="2019-08-14T12:21:11.000Z" itemprop="datePublished">2019-08-14</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/practice/">实践总结</a></li></ul><span id="container_page_pv" title="文章总阅读量" style="display:none"><span class="iconfont icon-eye" style="margin-right:5px;font-size:12px"></span><span id="value_page_pv"></span></span></div><div class="post-content" id="post-content" itemprop="postContent"><h3 id="行动前的考虑"><a href="#行动前的考虑" class="headerlink" title="行动前的考虑"></a>行动前的考虑</h3><p>◆原有的React Native工程是在Windows下安装完Android开发环境后使用命令&quot;react-native init&quot;生成的，看到存储Android SDK所需的30G+的硬盘和Android模拟器运行所需的8G+内存预算，想在自己的便携机上搞一套相同环境负担实在太重；</p><p>◆看到Expo时被其简练的开发流程所吸引，而环境轻量太多了，也同样支持代码修改保存后自动刷新内容。设想利于Expo能随时随地用便携机开发APP，到构建发布时候再使用笨重的Android环境，很美好；</p><p>◆React Native中文官网警告Expo大量依赖于国外网络环境，只用于学习、演示、试验等，不建议国内使用。我的目的就是用于开发过程方便看效果，实践后发现仅仅在安装Expo环境和创建工程的时候才需要国外网络环境；</p><h3 id="尝试基础的React-Native项目"><a href="#尝试基础的React-Native项目" class="headerlink" title="尝试基础的React Native项目"></a>尝试基础的React Native项目</h3><p>步骤总结如下：<br>◆安装Expo环境，使用“react-native init”命令创建个新的React Native工程；<br>◆进入React Native工程目录下创建可运行的Expo的工程：expo init demo ；<br>◆进入demo目录，为“app.json”文件增加如下packagerOpts配置内容，以指定使用自定义的metro配置文件；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;expo&quot;: &#123;</span><br><span class="line">    &quot;name&quot;: &quot;demo&quot;,</span><br><span class="line">    &quot;slug&quot;: &quot;demo&quot;,</span><br><span class="line">    &quot;privacy&quot;: &quot;public&quot;,</span><br><span class="line">    &quot;sdkVersion&quot;: &quot;33.0.0&quot;,</span><br><span class="line">    &quot;packagerOpts&quot;: &#123;</span><br><span class="line">      &quot;projectRoots&quot;: &quot;&quot;,</span><br><span class="line">      &quot;config&quot;: &quot;metro.config.js&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">   ... ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>◆新建“metro.config.js”文件，内容如下。其中的blacklistRE配置了一个正则，打包时会忽略掉正则匹配到的路径。因为在根目录下的node_modules中会存在与demo目录下node_modules中相同的库，例如react-native, react, prop-types，如果不忽略就会使得providesModule在解析时产生重名，从而导致jest-haste-map报错。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">const blacklist = require(&#x27;metro-config/src/defaults/blacklist&#x27;);</span><br><span class="line">const escapeRegexString = require(&#x27;escape-regex-string&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    resolver: &#123;</span><br><span class="line">        blacklistRE: blacklist([</span><br><span class="line">            new RegExp(</span><br><span class="line">                `^$&#123;escapeRegexString(path.resolve(__dirname, &#x27;..&#x27;, &#x27;node_modules&#x27;))&#125;\\/.*$`,</span><br><span class="line">            ),</span><br><span class="line">        ]),</span><br><span class="line">        providesModuleNodeModules: [</span><br><span class="line">            &#x27;react-native&#x27;,</span><br><span class="line">            &#x27;react&#x27;</span><br><span class="line">        ],</span><br><span class="line">        extraNodeModules: &#123;</span><br><span class="line">            &#x27;@babel/runtime&#x27;: path.resolve(__dirname, &#x27;node_modules/@babel/runtime&#x27;),</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    projectRoot: path.resolve(__dirname),</span><br><span class="line">    watchFolders: [</span><br><span class="line">        path.resolve(__dirname, &#x27;..&#x27;),</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>◆安装“metro.config.js”文件中用到的escape-regex-string，执行：yarn add escape-regex-string ；<br>◆修改App.js将原React Native的App作为组件引入，如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import App from &#x27;../App&#x27;;</span><br><span class="line"></span><br><span class="line">export default function Demo() &#123;</span><br><span class="line">  return (</span><br><span class="line">      &lt;App /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>◆回到上一级的React Native工程目录，修改&quot;metro.config.js&quot;文件，内容如下，目的是忽略demo文件夹下的node_modules中的库；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">const blacklist = require(&#x27;metro-config/src/defaults/blacklist&#x27;);</span><br><span class="line">const escapeRegexString = require(&#x27;escape-regex-string&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    resolver: &#123;</span><br><span class="line">        blacklistRE: blacklist([</span><br><span class="line">            new RegExp(</span><br><span class="line">                `$&#123;escapeRegexString(path.resolve(__dirname, &#x27;./demo&#x27;, &#x27;node_modules&#x27;))&#125;`,</span><br><span class="line">            )</span><br><span class="line">        ])</span><br><span class="line">    &#125;,</span><br><span class="line">    transformer: &#123;</span><br><span class="line">        getTransformOptions: async () =&gt; (&#123;</span><br><span class="line">            transform: &#123;</span><br><span class="line">                experimentalImportSupport: false,</span><br><span class="line">                inlineRequires: false,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>◆安装“metro.config.js”文件中用到的escape-regex-string，执行：yarn add escape-regex-string ；<br>◆以上即创建了支持Expo的最基础React Native项目的开发环境，直观上的修改是：<br>（1）增加了demo文件夹；<br>（2）增加了escape-regex-string的依赖；<br>（3）metro配置中增加了忽略文件夹；<br>◆项目需要安装新的npm依赖的步骤：<br>（1）React Native项目中安装依赖；<br>（2）Expo项目中安装依赖；<br>（3）Expo的metro配置中增加依赖对应的extraNodeModules项，如增加“react-navigation”后，修改为如下样子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">extraNodeModules: &#123;</span><br><span class="line">            &#x27;@babel/runtime&#x27;: path.resolve(__dirname, &#x27;node_modules/@babel/runtime&#x27;),</span><br><span class="line">            &#x27;react-navigation&#x27;: path.resolve(__dirname, &#x27;node_modules/react-navigation&#x27;),</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure><p>◆之后就可在demo目录下使用expo开发上一层目录的React Native工程了，运行“npm start”即可开始；<br>◆<a target="_blank" rel="noopener" href="https://github.com/congzhou09/react-native-plus-expo">参考项目地址</a>，查看git log可看到大致改造过程；</p><h3 id="尝试真实的React-Native项目"><a href="#尝试真实的React-Native项目" class="headerlink" title="尝试真实的React Native项目"></a>尝试真实的React Native项目</h3><p>基础React Native项目尝试成功之后对于真实项目的改造也比较有信心了，按照总结的思路步骤对一个真实项目做尝试，遇到了如下几个坑：<br>◇Icons<br>（1）React Native通常使用的图标库是“react-native-vector-icons”，Expo使用的图标库是“@expo&#x2F;vector-icons”，它对“react-native-vector-icons”增加了一层兼容之后的库，默认是包含在Expo中的；<br>（2）React Native引入图标的语法如：<strong>import MaterialIcon from &quot;react-native-vector-icons&#x2F;MaterialIcons</strong>，而Expo引入图标的语法如：<strong>import { MaterialIcons } from &#39;@expo&#x2F;vector-icons&#39;</strong>；<br>（3）原项目中的__import MaterialIcon from &quot;react-native-vector-icons&#x2F;MaterialIcons&quot;<strong>语句在Expo运行环境下会被自动解析成__import MaterialIcon from &quot;@expo&#x2F;vector-icons&#x2F;MaterialIcons</strong>，这在Expo中会引起报错；<br>（4）按照Expo引入图标的语法，将原项目的__import MaterialIcon from &quot;react-native-vector-icons&#x2F;MaterialIcons&quot;__语句改为__import {MaterialIcons} from &quot;react-native-vector-icons&quot;__才能通过编译，但这样就影响了原项目的代码内容和正常编译；<br>（5）目前未发现Expo环境中控制自动解析的<a target="_blank" rel="noopener" href="https://facebook.github.io/metro/docs/en/configuration">metro配置项</a>；<br>◇SplashScreen<br>（1）原项目中使用了“react-native-splash-screen”实现启动页，虽然使用上一步中的方法引入h和指定了“react-native-splash-screen”，但在调用SplashScreen函数时还是会报如下找不到splash库的错误；</p><div class="img-container" style="width:50%"><img src="/practice/React-Native%E5%B7%A5%E7%A8%8B%E5%A2%9E%E5%8A%A0Expo%E6%94%AF%E6%8C%81/splash_screen_error.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>（2）“react-native-splash-screen”官方文档指出在Android和iOS环境下分别需要执行link和增加配置才可正常工作，而在Expo环境该如何配置暂时没有找到；<br>（3）<a target="_blank" rel="noopener" href="https://docs.expo.io/versions/v34.0.0/">Expo官方文档</a>暂未找到关于如何link lib的说明；</p><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>以上，得出结论：目前在保持原React Native代码正常的前提下，为工程增加Expo开发方式支持的想法无法实现。</p></div><blockquote class="post-copyright"><div class="content"></div><footer style="width:100%"><h5><span class="post-time">最后更新时间：<time datetime="2025-03-19T13:37:34.640Z" itemprop="dateUpdated">2025-03-19 21:37:34</time></span><span style="float:right"><img src="/img/avatar.jpg" alt="Congzhou">Congzhou</span></h5></footer></blockquote><div class="post-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Expo/" rel="tag">Expo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React-Native/" rel="tag">React Native</a></li></ul></div></div><nav class="post-nav flex-row flex-justify-between"><div class="prev"><a href="/knowledge/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BB%84%E6%88%90%E4%B8%8EJS%E8%BF%90%E8%A1%8C%E6%97%B6%E7%8E%AF%E5%A2%83.html" id="post-prev" class="post-nav-link"><div class="tips"><i class="iconfont icon-arrow1l"></i>Prev</div><h4 class="title">浏览器组成与JS运行时环境</h4></a></div><div class="next"><a href="/practice/Taro%E4%BD%BF%E7%94%A8%E4%B8%8E%E5%BC%80%E5%8F%91%E9%92%89%E9%92%89%E5%B0%8F%E7%A8%8B%E5%BA%8F.html" id="post-next" class="post-nav-link"><div class="tips">Next<i class="iconfont icon-arrow1r"></i></div><h4 class="title">Taro使用与开发钉钉小程序</h4></a></div></nav><div class="comments vcomment" id="comments"></div><script src="/js/valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)}),required_info="nick,mail".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)});new Valine({el:"#comments",appId:"tq4lHkryFNXHsw9SOypjPRwx-gzGzoHsz",appKey:"lFmuObNsezjTPj5e86R1TgOg",avatar:"mp",placeholder:"欢迎留言(支持Markdown语法), 将展示您邮箱绑定的Gravatar头像(如果有的话~)",meta:0==guest_info.length?GUEST_INFO:guest_info,pageSize:"10",recordIP:!1,requiredFields:required_info})</script></article></div><footer class="footer"><div class="bottom"><p><span>Copyright &copy; 2009-2025 Congzhou</span><span id="container_site_uv" style="display:none">总访客数：<span id="value_site_uv"></span></span><span id="container_site_pv" style="display:none">总访问量：<span id="value_site_pv"></span></span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light" style="text-decoration:none"><span class="iconfont icon-arrow-up" style="font-size:25px;font-weight:700"></span></a><script>var BLOG={ROOT:"/",SHARE:!1,REWARD:!1}</script><script src="/js/main.min.js"></script><div class="search-panel" id="search-panel"><ul class="search-result" id="search-result"></ul></div><template id="search-tpl"><li class="item"><a href="{path}" class="waves-block waves-effect"><div class="title ellipsis" title="{title}">{title}</div><div class="flex-row flex-middle"><div class="tags ellipsis">{tags}</div><time class="flex-col time">{date}</time></div></a></li></template><script src="/js/search.min.js"></script><script>Observer.callback=function(){var e=document.querySelector("#value_page_pv");e.innerText=VISIT_INFO.curPagePV,e.parentNode.style.display="inline-block"},VISIT_INFO.curPagePV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_pv");e.innerText=VISIT_INFO.totalPV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalPV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_uv");e.innerText=VISIT_INFO.totalUV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalUV,Observer.callback=null,setTimeout(function(){var a=AV.Object.extend("visit_pv"),e=AV.Object.extend("visit_uv"),t=new AV.Query(a),o=location.pathname;location.hostname.match("localhost")?(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times")}else VISIT_INFO.curPagePV=0})):(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times"),t.increment("times",1),t.save()}else{VISIT_INFO.curPagePV=0;var l=new a;l.set("url",o),l.set("times",1);var n=document.querySelector(".post-card-title").innerText;l.set("title",n),l.save()}}));var l=localStorage.getItem("blog_UID");l||(l=generateUID(),localStorage.setItem("blog_UID",l)),AV.Cloud.run("total_pv").then(function(e){VISIT_INFO.totalPV=e}),location.hostname.match("localhost")||AV.Cloud.run("rec_uv",{UID:l}).then(function(e){}),new AV.Query(e).count().then(function(e){VISIT_INFO.totalUV=e+1998})},100)</script><script>"serviceWorker"in navigator&&(window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("service-worker register ok")}).catch(function(e){console.log("service-worker register failed: "+e)})}),navigator.serviceWorker.addEventListener("controllerchange",function(){console.log("检测到缓存资源更新，刷新以获取新内容")}))</script></body></html>