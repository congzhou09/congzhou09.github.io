<!DOCTYPE html><html><head><meta charset="utf-8"><title>Base64编码与DataUrl | Congzhou&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Base64,DataUrl"><meta name="description" content="Base64 编码◇ Base64 是个二进制转文本的编码方案，它将每 3 个 8bit 数据表示为 4 个使用 6bit 编码的 Base64 字符。◇ Base64 是 Base 编码的一种，其他 Base 编码如：Base16、Base32，&quot;Base&quot;后的数字越小，用来编码的字符数量越少。◇ Base 编码的使用场景是在某些仅支持文本(甚至仅支持有限数量的文本字符)的环"><meta property="og:type" content="article"><meta property="og:title" content="Base64编码与DataUrl"><meta property="og:url" content="https://congzhou09.github.io/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl.html"><meta property="og:site_name" content="Congzhou&#39;s Blog"><meta property="og:description" content="Base64 编码◇ Base64 是个二进制转文本的编码方案，它将每 3 个 8bit 数据表示为 4 个使用 6bit 编码的 Base64 字符。◇ Base64 是 Base 编码的一种，其他 Base 编码如：Base16、Base32，&quot;Base&quot;后的数字越小，用来编码的字符数量越少。◇ Base 编码的使用场景是在某些仅支持文本(甚至仅支持有限数量的文本字符)的环"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://congzhou09.github.io/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl/string-bits.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl/bits-to-base-character.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl/data-url-as-source-mapping-url.png"><meta property="article:published_time" content="2022-12-31T13:58:56.000Z"><meta property="article:modified_time" content="2025-03-19T13:37:34.610Z"><meta property="article:author" content="Congzhou"><meta property="article:tag" content="Base64"><meta property="article:tag" content="DataUrl"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://congzhou09.github.io/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl/string-bits.png"><link rel="alternate" type="application/atom+xml" title="Congzhou&#39;s Blog" href="/atom.xml"><link rel="shortcut icon" href="/tiger.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/lib/fancybox.css"><script>window.lazyScripts=[]</script><script src="/js/av-min.js"></script><script src="/js/util.min.js"></script><script src="/js/fancybox.umd.js"></script><meta name="generator" content="Hexo 7.2.0"></head><body><script>var VISIT_INFO={};defineObserveKey(VISIT_INFO,"totalPV"),defineObserveKey(VISIT_INFO,"curPagePV"),defineObserveKey(VISIT_INFO,"totalUV")</script><div id="loading" class="active"></div><aside id="menu"><div class="inner flex-row-vertical"><div class="brand-wrap"><img class="brand-wrap-img" finalsrc="/img/brand.jpg" src="/img/brand-loading.jpg" alt="brandBackground"><div class="brand"><a href="/" class="avatar waves-effect waves-circle waves-light"><img finalsrc="/img/avatar.jpg" src="/img/avatar-loading.jpg" style="width:100%" alt="avatar"></a><hgroup class="introduce"><div class="nickname" style="margin-left:5px">Congzhou</div><div class="mail"><span class="iconfont icon-youxiang" style="vertical-align:middle"></span><span>congzhou09@gmail.com</span></div><div class="github-link"><a target="_blank" href="https://github.com/congzhou09"><span class="iconfont icon-ic-github"></span>GitHub主页</a></div></hgroup><div class="hint-container"></div></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li class="waves-block waves-effect"><a href="/"><i class="iconfont icon icon-home" style="font-size:24px"></i>主页</a></li><li class="waves-block waves-effect"><a href="/archives"><i class="iconfont icon icon-archive" style="font-size:24px"></i>归档</a></li><li class="waves-block waves-effect"><a href="/tags"><i class="iconfont icon icon-tags" style="font-size:24px"></i>标签</a></li><li class="waves-block waves-effect"><a href="/categories"><i class="iconfont icon icon-categoryselected" style="font-size:24px"></i>分类</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" style="text-decoration:none" id="menu-toggle"><span class="iconfont icon-menu" style="font-size:21px;font-weight:700"></span></a><div class="flex-col header-title ellipsis">Base64编码与DataUrl</div><div class="search-wrap" id="search-wrap"><input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" style="text-decoration:none" id="search"><span class="iconfont icon-search" style="font-size:24px;font-weight:700"></span></a></div></div></header><header class="content-header post-header"><div class="container fade-scale"><h2 class="title">Base64编码与DataUrl</h2><h5 class="subtitle"><time datetime="2022-12-31T13:58:56.000Z" itemprop="datePublished" class="page-time">2022-12-31</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/knowledge/">知识解惑</a></li></ul></h5></div></header><div class="container body-wrap"><aside class="post-widget"><nav class="post-toc-wrap" id="post-toc"><h4>目录</h4><ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Base64-%E7%BC%96%E7%A0%81"><span class="post-toc-number">1.</span><span class="post-toc-text">Base64 编码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Base64-%E7%A4%BA%E4%BE%8B"><span class="post-toc-number">2.</span><span class="post-toc-text">Base64 示例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="post-toc-number">2.1.</span><span class="post-toc-text">示例 1</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E7%A4%BA%E4%BE%8B-2"><span class="post-toc-number">2.2.</span><span class="post-toc-text">示例 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#JS-%E4%B8%AD%E7%9A%84-Base64-%E7%BC%96%E7%A0%81"><span class="post-toc-number">3.</span><span class="post-toc-text">JS 中的 Base64 编码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#DataUrl"><span class="post-toc-number">4.</span><span class="post-toc-text">DataUrl</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#DataUrl-%E7%A4%BA%E4%BE%8B"><span class="post-toc-number">5.</span><span class="post-toc-text">DataUrl 示例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E7%A4%BA%E4%BE%8B-1-1"><span class="post-toc-number">5.1.</span><span class="post-toc-text">示例 1</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E7%A4%BA%E4%BE%8B-2-1"><span class="post-toc-number">5.2.</span><span class="post-toc-text">示例 2</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E7%A4%BA%E4%BE%8B-3"><span class="post-toc-number">5.3.</span><span class="post-toc-text">示例 3</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="post-toc-number">6.</span><span class="post-toc-text">参考文献</span></a></li></ol></nav></aside><article id="post-Base64编码与DataUrl" class="post-article article-type-post fade" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title">Base64编码与DataUrl</h1><div class="post-meta"><time class="post-time" title="2022-12-31 21:58:56" datetime="2022-12-31T13:58:56.000Z" itemprop="datePublished">2022-12-31</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/knowledge/">知识解惑</a></li></ul><span id="container_page_pv" title="文章总阅读量" style="display:none"><span class="iconfont icon-eye" style="margin-right:5px;font-size:12px"></span><span id="value_page_pv"></span></span></div><div class="post-content" id="post-content" itemprop="postContent"><h4 id="Base64-编码"><a href="#Base64-编码" class="headerlink" title="Base64 编码"></a>Base64 编码</h4><p>◇ Base64 是个二进制转文本的编码方案，它将每 3 个 8bit 数据表示为 4 个使用 6bit 编码的 Base64 字符。<br>◇ Base64 是 Base 编码的一种，其他 Base 编码如：Base16、Base32，&quot;Base&quot;后的数字越小，用来编码的字符数量越少。<br>◇ Base 编码的使用场景是在某些仅支持文本(甚至仅支持有限数量的文本字符)的环境中存储或传输数据。<br>◇ Base 编码规则详细定义在<a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc4648">RFC4648</a>。<br>◇ Base64 编码的 6 个 bit 位，二进制值从 000000 到 111111 分别编码为字符“A-Z”，“a-z”，“0-9”，“+”，“&#x2F;” 。另外有个 padding 字符“&#x3D;”，当末尾 bit 组长度不够 24bit 的时候，用一个或两个“&#x3D;”标识编码前缺少几个 8bit 才够 24bit，从而在解码时能正确解码“&#x3D;”前的那个字符。<br>◇ 综上可得 Base64 编码结果有如下特性：<br>（0）Base64 编码结果中最多有 65 种字符。<br>（1）“&#x3D;”字符只可能出现在编码结果末尾，数量不会超过两个。<br>（2）编码结果的字符数量是 4 的倍数。<br>（3）编码后的结果字符如果使用 ASCII 编码存储或展示，由于每个 ASCII 字符占用 8bit 空间，也就是用每 8bit 存储原来数据的 6bit，所以占用存储空间大约是原数据的 8&#x2F;6&#x3D;4&#x2F;3 倍。</p><h4 id="Base64-示例"><a href="#Base64-示例" class="headerlink" title="Base64 示例"></a>Base64 示例</h4><h5 id="示例-1"><a href="#示例-1" class="headerlink" title="示例 1"></a>示例 1</h5><p>☆ 待编码数据是用 ASCII 编码的“Man”对应的二进制数据</p><p>● 编码前数据的二进制内容如下图。</p><div class="img-container" style="width:80%"><img src="/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl/string-bits.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>● 将每 24bit 分成 6bit 组，每个 6bit 组使用 Base64 字符表示如下，可得“TWFu”。</p><div class="img-container" style="width:80%"><img src="/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl/bits-to-base-character.png" class="" onerror="imgOnError(this)" data-fancybox></div><h5 id="示例-2"><a href="#示例-2" class="headerlink" title="示例 2"></a>示例 2</h5><p>☆ 待编码数据是用 ASCII 编码的“Mana”对应的二进制数据</p><p>● 编码前二进制数据是示例 1 二进制内容后接“01100001”。<br>● 将每 24bit 分成 6bit 组，第 1 个 24bit 组与示例 1 一致。第 2 个 24bit 组中第 1 个 6bit 组是“011000”对应字符“Y”，第 2 个 6bit 组是“01”末尾填充 0 得到“010000”对应字符“Q”。由于第 2 个 24bit 组只有 8bit，还差两个 8bit 才够 24bit，所以使用两个 padding 字符标识。最终编码就是“TWFuYQ&#x3D;&#x3D;”。</p><h4 id="JS-中的-Base64-编码"><a href="#JS-中的-Base64-编码" class="headerlink" title="JS 中的 Base64 编码"></a>JS 中的 Base64 编码</h4><p>○ JS 提供了<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/btoa">btoa()</a>函数用于将二进制字符串转为 Base64 字符串。例如调用 btoa(&quot;Mana&quot;)可得到&quot;TWFuYQ&#x3D;&#x3D;&quot;，即上述示例 2 的结果。另外有 atob()函数执行相反操作。<br>○ btoa() 函数将输入字符串中每个字符当做 1 字节二进制数据处理，如果输入字符串中包含有效长度超过 1 字节的字符，就会报异常错误。<br>○ JS 的字符是通过 UTF-16 编码的，每个字符占 2 字节空间，其中的 ASCII 字符虽然也占 2 字节，但仅第 1 个字节内是有效内容，第二个字节全零，所以 btoa()处理 ASCII 字符不会报异常。<br>○ 可以通过以下表达式取值长度是否大于 2 判断某字符有效长度是否超过 1 字节。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;string&gt;.charCodeAt(0).toString(16)</span><br></pre></td></tr></table></figure><h4 id="DataUrl"><a href="#DataUrl" class="headerlink" title="DataUrl"></a>DataUrl</h4><p>♂ Base64 编码的一个应用场景是在 HTML 或 CSS 文件中内嵌图片、SourceMap 等二进制资源，内嵌通过 DataUrl 实现。<br>♂ DataUrl 是种特殊的 url，它将数据内容直接嵌入在 url 里而不需要额外的外部文件。它以&quot;data:&quot;开头，包含如下 4 个部分。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</span><br></pre></td></tr></table></figure><p>♂ 其中 &lt;mediatype&gt; 是一个 MIME 类型字符串，标识 data 内容的格式，取值如“image&#x2F;jpeg”，“application&#x2F;x-www-form-urlencoded”，如果省略则按照“text&#x2F;plain;charset&#x3D;US-ASCII”处理。<br>♂ 当有“;base64”时表示 data 是经过 Base64 编码的。</p><h4 id="DataUrl-示例"><a href="#DataUrl-示例" class="headerlink" title="DataUrl 示例"></a>DataUrl 示例</h4><h5 id="示例-1-1"><a href="#示例-1-1" class="headerlink" title="示例 1"></a>示例 1</h5><p>☆ webpack 的 devtool 配置项</p><p>■ devtool 配置项的“inline-”和“eval-”两个前缀的含义是将 SourceMap 嵌入在打包文件中。<br>■ “inline-”方式，以“inline-source-map”为例，每个 bundle 对应一个 SourceMap，附加到整个 bundle 文件的末尾。<br>■ “eval-”方式，以“eval-source-map”为例，每个模块对应一个 SourceMap，附加到每个模块 eval 包裹内部的末尾。此种情况下，二次编译时能做到模块级 SourceMap 的单独替换，因此在 webpack dev rebuild 时更有速度优势。</p><div class="img-container" style="width:70%"><img src="/knowledge/Base64%E7%BC%96%E7%A0%81%E4%B8%8EDataUrl/data-url-as-source-mapping-url.png" class="" onerror="imgOnError(this)" data-fancybox></div><h5 id="示例-2-1"><a href="#示例-2-1" class="headerlink" title="示例 2"></a>示例 2</h5><p>☆ webpack 的 url-loader</p><p>■ url-loader 的 “<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/url-loader#options">options</a>” 提供了一个 “limit” 配置项，当文件大于这个配置项值时执行 file-loader 的行为，否则便将资源转换成 DataUrl 嵌入到引入位置。<br>■ url-loader 和 file-loader 自 webpack5 起被“<a target="_blank" rel="noopener" href="https://webpack.js.org/guides/asset-modules/#general-asset-type">module.rules.type</a>”配置项替代。</p><h5 id="示例-3"><a href="#示例-3" class="headerlink" title="示例 3"></a>示例 3</h5><p>☆ 占用空间最小的 base64 图片的 DataUrl</p><p>■ web 页面中有时需要一个有效的 <img onerror="imgOnError(this)" data-fancybox> 元素占位，通常将其 src 属性设置为如下 DataUrl 内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/gif;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==</span><br></pre></td></tr></table></figure><p>■ 这个字符串中的 Base64 编码内容是一个 1x1 像素的透明 GIF 图片的数据。</p><h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><p>◆<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Base64">Base64 wiki</a><br>◆<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs">MDN Data URLs</a><br>◆<a target="_blank" rel="noopener" href="https://webpack.js.org/configuration/devtool/#devtool">webpack devtool</a></p></div><blockquote class="post-copyright"><div class="content"></div><footer style="width:100%"><h5><span class="post-time">最后更新时间：<time datetime="2025-03-19T13:37:34.610Z" itemprop="dateUpdated">2025-03-19 21:37:34</time></span><span style="float:right"><img src="/img/avatar.jpg" alt="Congzhou">Congzhou</span></h5></footer></blockquote><div class="post-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Base64/" rel="tag">Base64</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DataUrl/" rel="tag">DataUrl</a></li></ul></div></div><nav class="post-nav flex-row flex-justify-between"><div class="prev"><a href="/problem/%E5%8A%A8%E6%80%81import%E5%BC%95%E8%B5%B7%E7%9A%84%E6%89%93%E5%8C%85%E4%BD%93%E7%A7%AF%E5%A2%9E%E5%A4%A7.html" id="post-prev" class="post-nav-link"><div class="tips"><i class="iconfont icon-arrow1l"></i>Prev</div><h4 class="title">动态import引起的打包体积增大</h4></a></div><div class="next"><a href="/knowledge/%E9%98%BF%E9%87%8C%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0-%E9%A1%B9%E7%9B%AE%E5%88%9D%E8%AF%86.html" id="post-next" class="post-nav-link"><div class="tips">Next<i class="iconfont icon-arrow1r"></i></div><h4 class="title">阿里低代码开源项目学习-项目初识</h4></a></div></nav><div class="comments vcomment" id="comments"></div><script src="/js/valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)}),required_info="nick,mail".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)});new Valine({el:"#comments",appId:"tq4lHkryFNXHsw9SOypjPRwx-gzGzoHsz",appKey:"lFmuObNsezjTPj5e86R1TgOg",avatar:"mp",placeholder:"欢迎留言(支持Markdown语法), 将展示您邮箱绑定的Gravatar头像(如果有的话~)",meta:0==guest_info.length?GUEST_INFO:guest_info,pageSize:"10",recordIP:!1,requiredFields:required_info})</script></article></div><footer class="footer"><div class="bottom"><p><span>Copyright &copy; 2009-2025 Congzhou</span><span id="container_site_uv" style="display:none">总访客数：<span id="value_site_uv"></span></span><span id="container_site_pv" style="display:none">总访问量：<span id="value_site_pv"></span></span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light" style="text-decoration:none"><span class="iconfont icon-arrow-up" style="font-size:25px;font-weight:700"></span></a><script>var BLOG={ROOT:"/",SHARE:!1,REWARD:!1}</script><script src="/js/main.min.js"></script><div class="search-panel" id="search-panel"><ul class="search-result" id="search-result"></ul></div><template id="search-tpl"><li class="item"><a href="{path}" class="waves-block waves-effect"><div class="title ellipsis" title="{title}">{title}</div><div class="flex-row flex-middle"><div class="tags ellipsis">{tags}</div><time class="flex-col time">{date}</time></div></a></li></template><script src="/js/search.min.js"></script><script>Observer.callback=function(){var e=document.querySelector("#value_page_pv");e.innerText=VISIT_INFO.curPagePV,e.parentNode.style.display="inline-block"},VISIT_INFO.curPagePV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_pv");e.innerText=VISIT_INFO.totalPV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalPV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_uv");e.innerText=VISIT_INFO.totalUV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalUV,Observer.callback=null,setTimeout(function(){var a=AV.Object.extend("visit_pv"),e=AV.Object.extend("visit_uv"),t=new AV.Query(a),o=location.pathname;location.hostname.match("localhost")?(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times")}else VISIT_INFO.curPagePV=0})):(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times"),t.increment("times",1),t.save()}else{VISIT_INFO.curPagePV=0;var l=new a;l.set("url",o),l.set("times",1);var n=document.querySelector(".post-card-title").innerText;l.set("title",n),l.save()}}));var l=localStorage.getItem("blog_UID");l||(l=generateUID(),localStorage.setItem("blog_UID",l)),AV.Cloud.run("total_pv").then(function(e){VISIT_INFO.totalPV=e}),location.hostname.match("localhost")||AV.Cloud.run("rec_uv",{UID:l}).then(function(e){}),new AV.Query(e).count().then(function(e){VISIT_INFO.totalUV=e+1998})},100)</script><script>"serviceWorker"in navigator&&(window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("service-worker register ok")}).catch(function(e){console.log("service-worker register failed: "+e)})}),navigator.serviceWorker.addEventListener("controllerchange",function(){console.log("检测到缓存资源更新，刷新以获取新内容")}))</script></body></html>