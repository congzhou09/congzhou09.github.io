<!DOCTYPE html><html><head><meta charset="utf-8"><title>&lt;State of GPT&gt;理解 | Congzhou&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="GPT"><meta name="description" content="▲ 对 Microsoft Build 2023 上 Andrej Karpathy 演讲State of GPT的学习整理。▲ 演讲 PPT 地址。 GPT Assistant 是如何训练得到的◇ 训练过程按先后顺序分为自左至右的 4 个阶段：Pretraining、Supervised Finetuning、Reward Modeling、Reinforcement Learning。◇ 每个"><meta property="og:type" content="article"><meta property="og:title" content="&lt;State of GPT&gt;理解"><meta property="og:url" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3.html"><meta property="og:site_name" content="Congzhou&#39;s Blog"><meta property="og:description" content="▲ 对 Microsoft Build 2023 上 Andrej Karpathy 演讲State of GPT的学习整理。▲ 演讲 PPT 地址。 GPT Assistant 是如何训练得到的◇ 训练过程按先后顺序分为自左至右的 4 个阶段：Pretraining、Supervised Finetuning、Reward Modeling、Reinforcement Learning。◇ 每个"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/training-pipeline.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/dataset-of-base-model.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/tokenization.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/params-of-gpt-vs-llama.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/base-model-training-process.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/current-models.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/chain-of-thought.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/tree-of-thoughts.png"><meta property="og:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/inspiration-from-gpt4.png"><meta property="article:published_time" content="2024-05-08T11:00:57.000Z"><meta property="article:modified_time" content="2025-03-19T13:37:34.642Z"><meta property="article:author" content="Congzhou"><meta property="article:tag" content="GPT"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://congzhou09.github.io/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/training-pipeline.png"><link rel="alternate" type="application/atom+xml" title="Congzhou&#39;s Blog" href="/atom.xml"><link rel="shortcut icon" href="/tiger.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/lib/fancybox.css"><script>window.lazyScripts=[]</script><script src="/js/av-min.js"></script><script src="/js/util.min.js"></script><script src="/js/fancybox.umd.js"></script><meta name="generator" content="Hexo 7.2.0"></head><body><script>var VISIT_INFO={};defineObserveKey(VISIT_INFO,"totalPV"),defineObserveKey(VISIT_INFO,"curPagePV"),defineObserveKey(VISIT_INFO,"totalUV")</script><div id="loading" class="active"></div><aside id="menu"><div class="inner flex-row-vertical"><div class="brand-wrap"><img class="brand-wrap-img" finalsrc="/img/brand.jpg" src="/img/brand-loading.jpg" alt="brandBackground"><div class="brand"><a href="/" class="avatar waves-effect waves-circle waves-light"><img finalsrc="/img/avatar.jpg" src="/img/avatar-loading.jpg" style="width:100%" alt="avatar"></a><hgroup class="introduce"><div class="nickname" style="margin-left:5px">Congzhou</div><div class="mail"><span class="iconfont icon-youxiang" style="vertical-align:middle"></span><span>congzhou09@gmail.com</span></div><div class="github-link"><a target="_blank" href="https://github.com/congzhou09"><span class="iconfont icon-ic-github"></span>GitHub主页</a></div></hgroup><div class="hint-container"></div></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li class="waves-block waves-effect"><a href="/"><i class="iconfont icon icon-home" style="font-size:24px"></i>主页</a></li><li class="waves-block waves-effect"><a href="/archives"><i class="iconfont icon icon-archive" style="font-size:24px"></i>归档</a></li><li class="waves-block waves-effect"><a href="/tags"><i class="iconfont icon icon-tags" style="font-size:24px"></i>标签</a></li><li class="waves-block waves-effect"><a href="/categories"><i class="iconfont icon icon-categoryselected" style="font-size:24px"></i>分类</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" style="text-decoration:none" id="menu-toggle"><span class="iconfont icon-menu" style="font-size:21px;font-weight:700"></span></a><div class="flex-col header-title ellipsis">&lt;State of GPT&gt;理解</div><div class="search-wrap" id="search-wrap"><input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" style="text-decoration:none" id="search"><span class="iconfont icon-search" style="font-size:24px;font-weight:700"></span></a></div></div></header><header class="content-header post-header"><div class="container fade-scale"><h2 class="title">&lt;State of GPT&gt;理解</h2><h5 class="subtitle"><time datetime="2024-05-08T11:00:57.000Z" itemprop="datePublished" class="page-time">2024-05-08</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/knowledge/">知识解惑</a></li></ul></h5></div></header><div class="container body-wrap"><aside class="post-widget"><nav class="post-toc-wrap" id="post-toc"><h4>目录</h4><ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#GPT-Assistant-%E6%98%AF%E5%A6%82%E4%BD%95%E8%AE%AD%E7%BB%83%E5%BE%97%E5%88%B0%E7%9A%84"><span class="post-toc-number">1.</span><span class="post-toc-text">GPT Assistant 是如何训练得到的</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Pretraining"><span class="post-toc-number">1.1.</span><span class="post-toc-text">Pretraining</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#SFT%EF%BC%88Supervised-finetuning%EF%BC%89"><span class="post-toc-number">1.2.</span><span class="post-toc-text">SFT（Supervised finetuning）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#RLHF%EF%BC%88reinforcement-learning-from-human-feedback-%EF%BC%89"><span class="post-toc-number">1.3.</span><span class="post-toc-text">RLHF（reinforcement learning from human feedback ）</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%9E%E8%B7%B5%E4%B8%AD%E5%A6%82%E4%BD%95%E6%9C%89%E6%95%88%E4%BD%BF%E7%94%A8-GPT-assistant"><span class="post-toc-number">2.</span><span class="post-toc-text">实践中如何有效使用 GPT assistant</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%9D%A5%E8%87%AA-GPT-4-%E7%9A%84%E6%BF%80%E5%8A%B1"><span class="post-toc-number">3.</span><span class="post-toc-text">来自 GPT-4 的激励</span></a></li></ol></nav></aside><article id="post-State-of-GPT-理解" class="post-article article-type-post fade" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title">&lt;State of GPT&gt;理解</h1><div class="post-meta"><time class="post-time" title="2024-05-08 19:00:57" datetime="2024-05-08T11:00:57.000Z" itemprop="datePublished">2024-05-08</time><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/knowledge/">知识解惑</a></li></ul><span id="container_page_pv" title="文章总阅读量" style="display:none"><span class="iconfont icon-eye" style="margin-right:5px;font-size:12px"></span><span id="value_page_pv"></span></span></div><div class="post-content" id="post-content" itemprop="postContent"><p>▲ 对 Microsoft Build 2023 上 Andrej Karpathy 演讲<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=bZQun8Y4L2A&t=1229s">State of GPT</a>的学习整理。<br>▲<a target="_blank" rel="noopener" href="https://karpathy.ai/stateofgpt.pdf">演讲 PPT 地址</a>。</p><h3 id="GPT-Assistant-是如何训练得到的"><a href="#GPT-Assistant-是如何训练得到的" class="headerlink" title="GPT Assistant 是如何训练得到的"></a>GPT Assistant 是如何训练得到的</h3><p>◇ 训练过程按先后顺序分为自左至右的 4 个阶段：Pretraining、Supervised Finetuning、Reward Modeling、Reinforcement Learning。<br>◇ 每个阶段都涉及 3 项内容：dataset、algorithm、model，其中 model 是通过 dataset+algorithm 训练得到的。</p><div class="img-container" style="width:98%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/training-pipeline.png" class="" onerror="imgOnError(this)" data-fancybox></div><h4 id="Pretraining"><a href="#Pretraining" class="headerlink" title="Pretraining"></a>Pretraining</h4><p>◇ 预训练阶段几乎占了整个训练 99% 的运算性能与运算时间。长达数月，其他三种阶段都属于微调，训练仅消耗数天甚至数小时。<br>◇ 预训练得到的模型称为 base model。base model 不同于 assistant model，用于内容预测生成而不是回答问题。<br>◇ 预训练数据有多种来源，例如 Meta 公司的 LLaMA 模型的数据来源如下图。既有网络爬取数据，也有高质量数据集。</p><div class="img-container" style="width:75%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/dataset-of-base-model.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>◇ 数据集内容在使用前会通过 tokenization 被转换成整数序列。</p><div class="img-container" style="width:80%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/tokenization.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>◇ LLaMA 相比 GPT-3 更擅长对大量文本数据做深入理解语义的任务（如阅读理解与问答），GPT 的优势是对写作、对话、翻译等各种通用任务都表现好。下图是 LLaMA 与 GPT-3 的训练参数的对比，其中 vocabulary size 表示训练数据包含的不重复词汇量，context length 表示训练的上下文长度，parameters 表示训练用到的参数数量，trained on tokens 表示训练数据转换成的 token 数量，可见 LLaMA 在 parameter 和 vocabulary 方面的数量更少但在 trained on tokens 方面的数量更多。模型表现受训练数据多个维度参数的影响。</p><div class="img-container" style="width:95%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/params-of-gpt-vs-llama.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>◇ 大致训练过程：训练数据被放到数组(B,T)，行数 B 表示输入分为多少批，列数 T 表示最大上下文长度。数组的每一行包含多条数据序列，各条序列之间有约定好的分隔符。训练目标是让 transformer 神经网络能够在任意单元格(以图中绿格为例)根据当前及其左侧所有单元格趋于准确地推断出红色单元格的内容。</p><div class="img-container" style="width:75%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/base-model-training-process.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>◇ 相较于传统的 NLP 模型，由于此处的 base model 在预训练过程中理解了大量文本结构与概念，针对特定任务对其进行微调时仅需较少的标注数据就能达到很好的性能。而从 GPT-2 开始，人们发现仅通过 prompt 而无需 finetuning 就能让 base model 较好完成某些特定任务，由此开启了“prompting over finetuning”的时代。</p><p>◇ GPT-2 的 base model 公布在官方 GitHub 仓库，GPT-3 的 base model 可通过官方 api 使用模型&quot;Devanshi&quot;调用，GPT-4 的 base model 没有发布。当前最好的 base model 是 LLaMA，但目前未支持商用。</p><p>◇ 下图是当前各模型信息。</p><div class="img-container" style="width:98%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/current-models.png" class="" onerror="imgOnError(this)" data-fancybox></div><h4 id="SFT（Supervised-finetuning）"><a href="#SFT（Supervised-finetuning）" class="headerlink" title="SFT（Supervised finetuning）"></a>SFT（Supervised finetuning）</h4><p>◆ 这一阶段的算法不变，只是数据集改成了 1-10 万数量的高质量&quot;prompt+response&quot;的问答示例，以向 assistant model 的方向训练。<br>◆ 训练结果模型称为 SFT model。</p><h4 id="RLHF（reinforcement-learning-from-human-feedback-）"><a href="#RLHF（reinforcement-learning-from-human-feedback-）" class="headerlink" title="RLHF（reinforcement learning from human feedback ）"></a>RLHF（reinforcement learning from human feedback ）</h4><p>□ RLHF 由 Reward modeling 和 Reinforcement learning 两个阶段组成。<br>□ Reward modeling 阶段的数据集量级在 10-100 万，内容是：上阶段 SFT model 对同一个 prompt 回答的多次 response+人为指定的效果分数排序。以此指导模型能针对一个 prompt 给相应的 response 打分。此阶段得到的模型称为 RM model。<br>□ Reinforcement learning 阶段的数据集量级在 1-10 万，内容是：prompt+SFT model 的多次回答+RM model 对相应回答的打分。以此强化模型针对 prompt 给出分数更高的 response。<br>□ 经过 RLHF 得到的模型称为 RLHF model。ChatGPT 就属于 RLHF model。<br>□ RLHF 提高了模型的结果分数但也使其丧失了部分多样性(variation)，于是在已知 N 个目标输出样例并期望得到具有更多多样性输出的场景，可以考虑使用 base model。<br>□ https://lmsys.org 网站提供了大语言模型(LLM)的竞技场(https://chat.lmsys.org/)，并会定期发布排名结果到blog(如：https://lmsys.org/blog/2023-12-07-leaderboard/)，目前排名靠前的模型都是RLHF model。</p><h3 id="实践中如何有效使用-GPT-assistant"><a href="#实践中如何有效使用-GPT-assistant" class="headerlink" title="实践中如何有效使用 GPT assistant"></a>实践中如何有效使用 GPT assistant</h3><p>■ 不同于人类从问题到答案的思维过程，transformer 的&quot;think&quot;是 tokens 维度的，它得出答案的过程是不断得基于现有 token(s) 预测下个 token。因此，当问题的回答需要推理时，通过将问题拆分步骤(Chain-of-Thought)的方式减少问题中每个 token 需要推理的数量，能得到更好的答案。拆分方式有两种：<br>（1）prompt 中按照拆分步骤的方式提供一组问答样例<br>（2）prompt 中说明&quot;分步骤思考&quot;(“think step by step”)</p><div class="img-container" style="width:60%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/chain-of-thought.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>■ 当生成答案期间如果有一个 token 偏离了问题，transformer 不会返回检查纠正而是继续基于已生成 token 继续生成后续内容。但可以通过带上历史问答内容重新提问上次回答是否满足提问需求使它对上次回答检查并返回纠正后的回答。目前有称为&quot;Tree of Thoughts&quot;方向的研究，目的是将许多 prompts 与树检索算法结合以动态得到最优的生成答案从而避免出现需要纠正的情况。</p><div class="img-container" style="width:90%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/tree-of-thoughts.png" class="" onerror="imgOnError(this)" data-fancybox></div><p>■ LLM 的&quot;心理癖好&quot;：LLM 仅倾向于模仿所有相关训练数据生成完整答案而不会对训练数据中不同级别的答案做区分，比如对于一个物理问题，训练数据中通常既有专家级别的答案也有学生级别的答案甚至还有开玩笑的答案，LLM 默认会同时模仿所有级别的答案，这时可通过设置“Let&#39;s work this out in a step by step way to be sure we have the right answer.”、“You&#39;re a leading expert on this topic.”、“Pretend you have IQ 120.”这样的 prompt 来排除对低质量答案的模仿。<br>■ 为 LLM 指定可以使用的 tools(or plugin) 的场景中，在 prompt 中告诉 LLM 不擅长对应 tool 的能力可以让 tool 的调用更准确，因为 LLM 并不知道它自己不擅长的方面。<br>■ 检索增强(retrieval-augmented)的 LLM，LLM 只有从训练数据得来的知识记忆(memory)，如果将检索得到的提问相关信息放入 LLM 的上下文窗口(可称为 working memory)就可以同时发挥两者优势得到更好的答案。当前出现的方案是将信息分块后存入向量存储(如 LlamaIndex)，针对提问先检索得到相关信息再将其组织成 prompt。<br>■ 在希望限制 LLM 按照固定模板格式输出结果的场景，可以使用<a target="_blank" rel="noopener" href="https://github.com/guidance-ai/guidance">guidance</a>。<br>■ finetuning 的本质是更新模型的参数权重，涉及更多专业技术，已知优化策略与相关工具：<br>（1）Parameter Efficient Finetuning(PEFT)。PEFT 是深度学习领域的一种优化策略，目标是在微调过程中尽可能减少需要更新的参数数量，而让模型的大部分参数权重固定，从而大幅降低 finetuning 成本。工具如：LoRA。<br>（2）Low-precision inference(低精度推理)。低精度推理是深度学习领域的一种优化策略，通过降低模型权重和激活的精度，减少模型的内存占用和计算需求而提高运行速度，在模型训练&#x2F;微调完成后使用。结合前面 PEFT 只针对微调部分做低精度推理也可降低计算成本。工具如：bitsandbytes。<br>■ 目前的 LLM 适合应用在与人为监督相结合的低风险领域，如灵感、建议、copilot。</p><h3 id="来自-GPT-4-的激励"><a href="#来自-GPT-4-的激励" class="headerlink" title="来自 GPT-4 的激励"></a>来自 GPT-4 的激励</h3><div class="img-container" style="width:95%"><img src="/knowledge/State-of-GPT-%E7%90%86%E8%A7%A3/inspiration-from-gpt4.png" class="" onerror="imgOnError(this)" data-fancybox></div></div><blockquote class="post-copyright"><div class="content"></div><footer style="width:100%"><h5><span class="post-time">最后更新时间：<time datetime="2025-03-19T13:37:34.642Z" itemprop="dateUpdated">2025-03-19 21:37:34</time></span><span style="float:right"><img src="/img/avatar.jpg" alt="Congzhou">Congzhou</span></h5></footer></blockquote><div class="post-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GPT/" rel="tag">GPT</a></li></ul></div></div><nav class="post-nav flex-row flex-justify-between"><div class="prev"><a href="/practice/%E5%9F%BA%E4%BA%8E%E9%98%BF%E9%87%8C%E4%BA%91ACK-Serverless%E6%90%AD%E5%BB%BA%E6%8C%89%E9%87%8F%E4%BB%98%E8%B4%B9%E7%9A%84gitlab-runner.html" id="post-prev" class="post-nav-link"><div class="tips"><i class="iconfont icon-arrow1l"></i>Prev</div><h4 class="title">基于阿里云ACK Serverless搭建按量付费的gitlab-runner</h4></a></div><div class="next"><a href="/practice/AFFiNE%E7%BA%AF%E5%89%8D%E7%AB%AF%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" id="post-next" class="post-nav-link"><div class="tips">Next<i class="iconfont icon-arrow1r"></i></div><h4 class="title">AFFiNE纯前端调试环境搭建</h4></a></div></nav><div class="comments vcomment" id="comments"></div><script src="/js/valine.min.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)}),required_info="nick,mail".split(",").filter(function(e){return-1<GUEST_INFO.indexOf(e)});new Valine({el:"#comments",appId:"tq4lHkryFNXHsw9SOypjPRwx-gzGzoHsz",appKey:"lFmuObNsezjTPj5e86R1TgOg",avatar:"mp",placeholder:"欢迎留言(支持Markdown语法), 将展示您邮箱绑定的Gravatar头像(如果有的话~)",meta:0==guest_info.length?GUEST_INFO:guest_info,pageSize:"10",recordIP:!1,requiredFields:required_info})</script></article></div><footer class="footer"><div class="bottom"><p><span>Copyright &copy; 2009-2025 Congzhou</span><span id="container_site_uv" style="display:none">总访客数：<span id="value_site_uv"></span></span><span id="container_site_pv" style="display:none">总访问量：<span id="value_site_pv"></span></span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light" style="text-decoration:none"><span class="iconfont icon-arrow-up" style="font-size:25px;font-weight:700"></span></a><script>var BLOG={ROOT:"/",SHARE:!1,REWARD:!1}</script><script src="/js/main.min.js"></script><div class="search-panel" id="search-panel"><ul class="search-result" id="search-result"></ul></div><template id="search-tpl"><li class="item"><a href="{path}" class="waves-block waves-effect"><div class="title ellipsis" title="{title}">{title}</div><div class="flex-row flex-middle"><div class="tags ellipsis">{tags}</div><time class="flex-col time">{date}</time></div></a></li></template><script src="/js/search.min.js"></script><script>Observer.callback=function(){var e=document.querySelector("#value_page_pv");e.innerText=VISIT_INFO.curPagePV,e.parentNode.style.display="inline-block"},VISIT_INFO.curPagePV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_pv");e.innerText=VISIT_INFO.totalPV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalPV,Observer.callback=null,Observer.callback=function(){var e=document.querySelector("#value_site_uv");e.innerText=VISIT_INFO.totalUV,e.parentNode.style.display="inline-block"},VISIT_INFO.totalUV,Observer.callback=null,setTimeout(function(){var a=AV.Object.extend("visit_pv"),e=AV.Object.extend("visit_uv"),t=new AV.Query(a),o=location.pathname;location.hostname.match("localhost")?(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times")}else VISIT_INFO.curPagePV=0})):(t.equalTo("url",o),t.find().then(function(e){if(e.length){var t=e[0];VISIT_INFO.curPagePV=t.get("times"),t.increment("times",1),t.save()}else{VISIT_INFO.curPagePV=0;var l=new a;l.set("url",o),l.set("times",1);var n=document.querySelector(".post-card-title").innerText;l.set("title",n),l.save()}}));var l=localStorage.getItem("blog_UID");l||(l=generateUID(),localStorage.setItem("blog_UID",l)),AV.Cloud.run("total_pv").then(function(e){VISIT_INFO.totalPV=e}),location.hostname.match("localhost")||AV.Cloud.run("rec_uv",{UID:l}).then(function(e){}),new AV.Query(e).count().then(function(e){VISIT_INFO.totalUV=e+1998})},100)</script><script>"serviceWorker"in navigator&&(window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("service-worker register ok")}).catch(function(e){console.log("service-worker register failed: "+e)})}),navigator.serviceWorker.addEventListener("controllerchange",function(){console.log("检测到缓存资源更新，刷新以获取新内容")}))</script></body></html>