!function(l,r){function n(){}function e(t){var e,i=t.offsetLeft,n=t.offsetTop;return t.offsetParent&&(i+=(e=arguments.callee(t.offsetParent)).x,n+=e.y),{x:i,y:n}}function a(){return r.documentElement.scrollTop||r.body.scrollTop}var t,o,s,c,d,h=r.body,u=r.querySelector.bind(r),m=r.querySelectorAll.bind(r),f=u("html"),g=u("#gotop"),v=u("#menu"),p=!1,L=u("#header"),y=u("#mask"),w=u("#menu-toggle"),x=u("#loading"),$=l.requestAnimationFrame,E=Array.prototype.forEach,b="ontouchstart"in l&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",S={goTop:function(t){var e=a(),i=2<arguments.length?arguments[1]:Math.abs(e-t)/12;e&&t<e?(l.scrollTo(0,Math.max(e-i,0)),$(arguments.callee.bind(this,t,i))):t&&e<t?(l.scrollTo(0,Math.min(e+i,t)),$(arguments.callee.bind(this,t,i))):this.toc.actived(t)},toggleGotop:function(t){t>l.innerHeight/2?g.classList.add("in"):g.classList.remove("in")},toggleMenu:function(t){var e;u("#main");t?(y.classList.add("in"),v.classList.add("show"),f.classList.add("lock")):(v.classList.remove("show"),y.classList.remove("in"),f.classList.remove("lock")),p||(t=u(".brand-wrap-img"),e=u(".avatar img"),t.setAttribute("src",t.getAttribute("finalsrc")),e.setAttribute("src",e.getAttribute("finalsrc")),p=!0)},fixedHeader:function(t){L.clientHeight<=t?L.classList.add("fixed"):L.classList.remove("fixed")},toc:(d=u("#post-toc"))&&d.children.length?(o=u(".post-header").clientHeight,s=L.clientHeight,c=u("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6"),d.querySelector('a[href="#'+encodeURIComponent(c[0].id)+'"]').parentNode.classList.add("active"),{fixed:function(t){o-s<=t?d.classList.add("fixed"):d.classList.remove("fixed")},actived:function(t){for(i=0,len=c.length;i<len;i++)t>e(c[i]).y-s-5&&(d.querySelector("li.active").classList.remove("active"),d.querySelector('a[href="#'+encodeURIComponent(c[i].id)+'"]').parentNode.classList.add("active"));t<e(c[0]).y&&(d.querySelector("li.active").classList.remove("active"),d.querySelector('a[href="#'+encodeURIComponent(c[0].id)+'"]').parentNode.classList.add("active"))}}):{fixed:n,actived:n},hideOnMask:[],modal:function(t){this.$modal=u(t),this.$off=this.$modal.querySelector(".close");var e=this;this.show=function(){y.classList.add("in"),e.$modal.classList.add("ready"),setTimeout(function(){e.$modal.classList.add("in")},0)},this.onHide=n,this.hide=function(){e.onHide(),y.classList.remove("in"),e.$modal.classList.remove("in"),setTimeout(function(){e.$modal.classList.remove("ready")},300)},this.toggle=function(){return e.$modal.classList.contains("in")?e.hide():e.show()},S.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener(b,this.hide)},share:function(){var e=u("#pageShare"),i=u("#shareFab"),t=new this.modal("#globalShare"),n=(u("#menuShare").addEventListener(b,t.toggle),i&&(i.addEventListener(b,function(){e.classList.toggle("in")},!1),r.addEventListener(b,function(t){i.contains(t.target)||e.classList.remove("in")},!1)),new this.modal("#wxShare"));n.onHide=t.hide,E.call(m(".wxFab"),function(t){t.addEventListener(b,n.toggle)})},reward:function(){var t=new this.modal("#reward"),t=(u("#rewardBtn").addEventListener(b,t.toggle),u("#rewardToggle")),e=u("#rewardCode");t&&t.addEventListener("change",function(){e.src=this.checked?this.dataset.alipay:this.dataset.wechat})},waterfall:function(){l.innerWidth<760||E.call(m(".waterfall"),function(t){var e=t.querySelectorAll(".waterfall-item"),i=[0,0];E.call(e,function(t){var e=i[0]<=i[1]?0:1;t.style.cssText="top:"+i[e]+"px;left:"+(0<e?"50%":0),i[e]+=t.offsetHeight}),t.style.height=Math.max(i[0],i[1])+"px",t.classList.add("in")})},tabBar:function(t){t.parentNode.parentNode.classList.toggle("expand")},page:(t=m(".fade, .fade-scale"),{loaded:function(){E.call(t,function(t){t.classList.add("in")}),0},unload:function(){E.call(t,function(t){t.classList.remove("in")}),0},visible:!1}),lightbox:void E.call(m(".img-lightbox"),function(t){new T(t)}),loadScript:function(t){t.forEach(function(t){var e=r.createElement("script");e.src=t.url,e.async=t.async,h.appendChild(e)})}};function T(t){this.$img=t.querySelector("img"),this.$overlay=t.querySelector("overlay"),this.margin=40,this.title=this.$img.title||this.$img.alt||"",this.isZoom=!1,this.calcRect=function(){s=h.clientWidth;var t=(c=h.clientHeight)-2*this.margin,e=n,i=a,t=(this.margin,Math.min(s<e?s/e:1,t<i?t/i:1));return{w:e*=t,h:i*=t,t:(c-i)/2-o.top,l:(s-e)/2-o.left+this.$img.offsetLeft}},this.setImgRect=function(t){this.$img.style.cssText="width: "+t.w+"px; max-width: "+t.w+"px; height:"+t.h+"px; top: "+t.t+"px; left: "+t.l+"px"},this.setFrom=function(){this.setImgRect({w:o.width,h:o.height,t:0,l:(t.offsetWidth-o.width)/2})},this.setTo=function(){this.setImgRect(this.calcRect())},this.addTitle=function(){this.title&&(this.$caption=r.createElement("div"),this.$caption.innerHTML=this.title,this.$caption.className="overlay-title",t.appendChild(this.$caption))},this.removeTitle=function(){this.$caption&&t.removeChild(this.$caption)};var n,a,o,s,c,e=this;this.zoomIn=function(){n=this.$img.naturalWidth||this.$img.width,a=this.$img.naturalHeight||this.$img.height,o=this.$img.getBoundingClientRect(),t.style.height=o.height+"px",t.classList.add("ready"),this.setFrom(),this.addTitle(),this.$img.classList.add("zoom-in"),setTimeout(function(){t.classList.add("active"),e.setTo(),e.isZoom=!0},0)},this.zoomOut=function(){this.isZoom=!1,t.classList.remove("active"),this.$img.classList.add("zoom-in"),this.setFrom(),setTimeout(function(){e.$img.classList.remove("zoom-in"),e.$img.style.cssText="",e.removeTitle(),t.classList.remove("ready"),t.removeAttribute("style")},300)},t.addEventListener("click",function(t){e.isZoom?e.zoomOut():"IMG"===t.target.tagName&&e.zoomIn()}),r.addEventListener("scroll",function(){e.isZoom&&e.zoomOut()}),l.addEventListener("resize",function(){e.isZoom&&e.zoomOut()})}l.addEventListener("load",function(){x.classList.remove("active"),S.page.loaded(),l.lazyScripts&&l.lazyScripts.length&&S.loadScript(l.lazyScripts)}),l.addEventListener("DOMContentLoaded",function(){S.waterfall();var t=a();S.toc.fixed(t),S.toc.actived(t),S.page.loaded()});var C,A=!1,M=u('a[href^="mailto"]'),k=(M&&M.addEventListener(b,function(){A=!0}),l.addEventListener("beforeunload",function(t){A?A=!1:S.page.unload()}),l.addEventListener("pageshow",function(){S.page.visible||S.page.loaded()}),l.addEventListener("resize",function(){l.BLOG.even=b="ontouchstart"in l?"touchstart":"click",S.toggleMenu(),S.waterfall()}),g.addEventListener(b,function(){$(S.goTop.bind(S,0))},!1),w.addEventListener(b,function(t){S.toggleMenu(!0),t.preventDefault()},!1),y.addEventListener(b,function(t){S.toggleMenu(),S.hideOnMask.forEach(function(t){t()}),t.preventDefault()},!1),r.addEventListener("scroll",function(){var t=a();S.toggleGotop(t),S.fixedHeader(t),S.toc.fixed(t),S.toc.actived(t)},!1),l.BLOG.SHARE&&S.share(),l.BLOG.REWARD&&S.reward(),S.noop=n,S.even=b,S.$=u,S.$$=m,Object.keys(S).reduce(function(t,e){return t[e]=S[e],t},l.BLOG),l.Waves&&(Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])),C=null,function(t){var e,i,n;C?clearTimeout(C):(t=t,e=document.querySelector("#mask"),(i=document.createElement("input")).style.height="0",i.style.opacity="0",i.value=t,e.appendChild(i),(t=document.createRange()).selectNode(i),0<(n=window.getSelection()).rangeCount&&n.removeAllRanges(),n.addRange(t),document.execCommand("copy"),n.removeAllRanges(),e.removeChild(i)),C=setTimeout(function(){clearTimeout(C),C=null},2e3)});document.querySelector(".mail").addEventListener("click",function(t){var e=document.querySelector(".hint-container"),i=document.createElement("div");i.className="hint",i.innerHTML="已复制",e.appendChild(i),setTimeout(function(){e.removeChild(i)},2500),k(t.currentTarget.lastElementChild.textContent)}),Fancybox.bind("[data-fancybox]",{contentClick:"close",showClass:"f-fadeFastIn",hideClass:"f-fadeFastOut",Images:{zoom:!1,Panzoom:{maxScale:2}},on:{reveal:function(t,e){e.imgErr&&t.close()}}})}(window,document);